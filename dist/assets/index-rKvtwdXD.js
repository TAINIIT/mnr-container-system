(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var L0={exports:{}},rc={},F0={exports:{}},gt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u1;function uE(){if(u1)return gt;u1=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),p=Symbol.iterator;function x(U){return U===null||typeof U!="object"?null:(U=p&&U[p]||U["@@iterator"],typeof U=="function"?U:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,y={};function S(U,I,Z){this.props=U,this.context=I,this.refs=y,this.updater=Z||v}S.prototype.isReactComponent={},S.prototype.setState=function(U,I){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,I,"setState")},S.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function C(){}C.prototype=S.prototype;function D(U,I,Z){this.props=U,this.context=I,this.refs=y,this.updater=Z||v}var N=D.prototype=new C;N.constructor=D,k(N,S.prototype),N.isPureReactComponent=!0;var b=Array.isArray,H=Object.prototype.hasOwnProperty,L={current:null},R={key:!0,ref:!0,__self:!0,__source:!0};function q(U,I,Z){var Y,P={},ne=null,J=null;if(I!=null)for(Y in I.ref!==void 0&&(J=I.ref),I.key!==void 0&&(ne=""+I.key),I)H.call(I,Y)&&!R.hasOwnProperty(Y)&&(P[Y]=I[Y]);var de=arguments.length-2;if(de===1)P.children=Z;else if(1<de){for(var E=Array(de),A=0;A<de;A++)E[A]=arguments[A+2];P.children=E}if(U&&U.defaultProps)for(Y in de=U.defaultProps,de)P[Y]===void 0&&(P[Y]=de[Y]);return{$$typeof:e,type:U,key:ne,ref:J,props:P,_owner:L.current}}function O(U,I){return{$$typeof:e,type:U.type,key:I,ref:U.ref,props:U.props,_owner:U._owner}}function V(U){return typeof U=="object"&&U!==null&&U.$$typeof===e}function X(U){var I={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(Z){return I[Z]})}var M=/\/+/g;function me(U,I){return typeof U=="object"&&U!==null&&U.key!=null?X(""+U.key):I.toString(36)}function ae(U,I,Z,Y,P){var ne=typeof U;(ne==="undefined"||ne==="boolean")&&(U=null);var J=!1;if(U===null)J=!0;else switch(ne){case"string":case"number":J=!0;break;case"object":switch(U.$$typeof){case e:case t:J=!0}}if(J)return J=U,P=P(J),U=Y===""?"."+me(J,0):Y,b(P)?(Z="",U!=null&&(Z=U.replace(M,"$&/")+"/"),ae(P,I,Z,"",function(A){return A})):P!=null&&(V(P)&&(P=O(P,Z+(!P.key||J&&J.key===P.key?"":(""+P.key).replace(M,"$&/")+"/")+U)),I.push(P)),1;if(J=0,Y=Y===""?".":Y+":",b(U))for(var de=0;de<U.length;de++){ne=U[de];var E=Y+me(ne,de);J+=ae(ne,I,Z,E,P)}else if(E=x(U),typeof E=="function")for(U=E.call(U),de=0;!(ne=U.next()).done;)ne=ne.value,E=Y+me(ne,de++),J+=ae(ne,I,Z,E,P);else if(ne==="object")throw I=String(U),Error("Objects are not valid as a React child (found: "+(I==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":I)+"). If you meant to render a collection of children, use an array instead.");return J}function ce(U,I,Z){if(U==null)return U;var Y=[],P=0;return ae(U,Y,"","",function(ne){return I.call(Z,ne,P++)}),Y}function ue(U){if(U._status===-1){var I=U._result;I=I(),I.then(function(Z){(U._status===0||U._status===-1)&&(U._status=1,U._result=Z)},function(Z){(U._status===0||U._status===-1)&&(U._status=2,U._result=Z)}),U._status===-1&&(U._status=0,U._result=I)}if(U._status===1)return U._result.default;throw U._result}var K={current:null},W={transition:null},j={ReactCurrentDispatcher:K,ReactCurrentBatchConfig:W,ReactCurrentOwner:L};function F(){throw Error("act(...) is not supported in production builds of React.")}return gt.Children={map:ce,forEach:function(U,I,Z){ce(U,function(){I.apply(this,arguments)},Z)},count:function(U){var I=0;return ce(U,function(){I++}),I},toArray:function(U){return ce(U,function(I){return I})||[]},only:function(U){if(!V(U))throw Error("React.Children.only expected to receive a single React element child.");return U}},gt.Component=S,gt.Fragment=n,gt.Profiler=s,gt.PureComponent=D,gt.StrictMode=r,gt.Suspense=d,gt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=j,gt.act=F,gt.cloneElement=function(U,I,Z){if(U==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+U+".");var Y=k({},U.props),P=U.key,ne=U.ref,J=U._owner;if(I!=null){if(I.ref!==void 0&&(ne=I.ref,J=L.current),I.key!==void 0&&(P=""+I.key),U.type&&U.type.defaultProps)var de=U.type.defaultProps;for(E in I)H.call(I,E)&&!R.hasOwnProperty(E)&&(Y[E]=I[E]===void 0&&de!==void 0?de[E]:I[E])}var E=arguments.length-2;if(E===1)Y.children=Z;else if(1<E){de=Array(E);for(var A=0;A<E;A++)de[A]=arguments[A+2];Y.children=de}return{$$typeof:e,type:U.type,key:P,ref:ne,props:Y,_owner:J}},gt.createContext=function(U){return U={$$typeof:l,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},U.Provider={$$typeof:i,_context:U},U.Consumer=U},gt.createElement=q,gt.createFactory=function(U){var I=q.bind(null,U);return I.type=U,I},gt.createRef=function(){return{current:null}},gt.forwardRef=function(U){return{$$typeof:u,render:U}},gt.isValidElement=V,gt.lazy=function(U){return{$$typeof:m,_payload:{_status:-1,_result:U},_init:ue}},gt.memo=function(U,I){return{$$typeof:f,type:U,compare:I===void 0?null:I}},gt.startTransition=function(U){var I=W.transition;W.transition={};try{U()}finally{W.transition=I}},gt.unstable_act=F,gt.useCallback=function(U,I){return K.current.useCallback(U,I)},gt.useContext=function(U){return K.current.useContext(U)},gt.useDebugValue=function(){},gt.useDeferredValue=function(U){return K.current.useDeferredValue(U)},gt.useEffect=function(U,I){return K.current.useEffect(U,I)},gt.useId=function(){return K.current.useId()},gt.useImperativeHandle=function(U,I,Z){return K.current.useImperativeHandle(U,I,Z)},gt.useInsertionEffect=function(U,I){return K.current.useInsertionEffect(U,I)},gt.useLayoutEffect=function(U,I){return K.current.useLayoutEffect(U,I)},gt.useMemo=function(U,I){return K.current.useMemo(U,I)},gt.useReducer=function(U,I,Z){return K.current.useReducer(U,I,Z)},gt.useRef=function(U){return K.current.useRef(U)},gt.useState=function(U){return K.current.useState(U)},gt.useSyncExternalStore=function(U,I,Z){return K.current.useSyncExternalStore(U,I,Z)},gt.useTransition=function(){return K.current.useTransition()},gt.version="18.3.1",gt}var d1;function sp(){return d1||(d1=1,F0.exports=uE()),F0.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h1;function dE(){if(h1)return rc;h1=1;var e=sp(),t=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function l(u,d,f){var m,p={},x=null,v=null;f!==void 0&&(x=""+f),d.key!==void 0&&(x=""+d.key),d.ref!==void 0&&(v=d.ref);for(m in d)r.call(d,m)&&!i.hasOwnProperty(m)&&(p[m]=d[m]);if(u&&u.defaultProps)for(m in d=u.defaultProps,d)p[m]===void 0&&(p[m]=d[m]);return{$$typeof:t,type:u,key:x,ref:v,props:p,_owner:s.current}}return rc.Fragment=n,rc.jsx=l,rc.jsxs=l,rc}var f1;function hE(){return f1||(f1=1,L0.exports=dE()),L0.exports}var a=hE(),T=sp(),Ed={},M0={exports:{}},br={},B0={exports:{}},U0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var m1;function fE(){return m1||(m1=1,(function(e){function t(W,j){var F=W.length;W.push(j);e:for(;0<F;){var U=F-1>>>1,I=W[U];if(0<s(I,j))W[U]=j,W[F]=I,F=U;else break e}}function n(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var j=W[0],F=W.pop();if(F!==j){W[0]=F;e:for(var U=0,I=W.length,Z=I>>>1;U<Z;){var Y=2*(U+1)-1,P=W[Y],ne=Y+1,J=W[ne];if(0>s(P,F))ne<I&&0>s(J,P)?(W[U]=J,W[ne]=F,U=ne):(W[U]=P,W[Y]=F,U=Y);else if(ne<I&&0>s(J,F))W[U]=J,W[ne]=F,U=ne;else break e}}return j}function s(W,j){var F=W.sortIndex-j.sortIndex;return F!==0?F:W.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,u=l.now();e.unstable_now=function(){return l.now()-u}}var d=[],f=[],m=1,p=null,x=3,v=!1,k=!1,y=!1,S=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(W){for(var j=n(f);j!==null;){if(j.callback===null)r(f);else if(j.startTime<=W)r(f),j.sortIndex=j.expirationTime,t(d,j);else break;j=n(f)}}function b(W){if(y=!1,N(W),!k)if(n(d)!==null)k=!0,ue(H);else{var j=n(f);j!==null&&K(b,j.startTime-W)}}function H(W,j){k=!1,y&&(y=!1,C(q),q=-1),v=!0;var F=x;try{for(N(j),p=n(d);p!==null&&(!(p.expirationTime>j)||W&&!X());){var U=p.callback;if(typeof U=="function"){p.callback=null,x=p.priorityLevel;var I=U(p.expirationTime<=j);j=e.unstable_now(),typeof I=="function"?p.callback=I:p===n(d)&&r(d),N(j)}else r(d);p=n(d)}if(p!==null)var Z=!0;else{var Y=n(f);Y!==null&&K(b,Y.startTime-j),Z=!1}return Z}finally{p=null,x=F,v=!1}}var L=!1,R=null,q=-1,O=5,V=-1;function X(){return!(e.unstable_now()-V<O)}function M(){if(R!==null){var W=e.unstable_now();V=W;var j=!0;try{j=R(!0,W)}finally{j?me():(L=!1,R=null)}}else L=!1}var me;if(typeof D=="function")me=function(){D(M)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,ce=ae.port2;ae.port1.onmessage=M,me=function(){ce.postMessage(null)}}else me=function(){S(M,0)};function ue(W){R=W,L||(L=!0,me())}function K(W,j){q=S(function(){W(e.unstable_now())},j)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){k||v||(k=!0,ue(H))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_getFirstCallbackNode=function(){return n(d)},e.unstable_next=function(W){switch(x){case 1:case 2:case 3:var j=3;break;default:j=x}var F=x;x=j;try{return W()}finally{x=F}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,j){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var F=x;x=W;try{return j()}finally{x=F}},e.unstable_scheduleCallback=function(W,j,F){var U=e.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?U+F:U):F=U,W){case 1:var I=-1;break;case 2:I=250;break;case 5:I=1073741823;break;case 4:I=1e4;break;default:I=5e3}return I=F+I,W={id:m++,callback:j,priorityLevel:W,startTime:F,expirationTime:I,sortIndex:-1},F>U?(W.sortIndex=F,t(f,W),n(d)===null&&W===n(f)&&(y?(C(q),q=-1):y=!0,K(b,F-U))):(W.sortIndex=I,t(d,W),k||v||(k=!0,ue(H))),W},e.unstable_shouldYield=X,e.unstable_wrapCallback=function(W){var j=x;return function(){var F=x;x=j;try{return W.apply(this,arguments)}finally{x=F}}}})(U0)),U0}var p1;function mE(){return p1||(p1=1,B0.exports=fE()),B0.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g1;function pE(){if(g1)return br;g1=1;var e=sp(),t=mE();function n(o){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+o,h=1;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+o+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function i(o,c){l(o,c),l(o+"Capture",c)}function l(o,c){for(s[o]=c,o=0;o<c.length;o++)r.add(c[o])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},p={};function x(o){return d.call(p,o)?!0:d.call(m,o)?!1:f.test(o)?p[o]=!0:(m[o]=!0,!1)}function v(o,c,h,g){if(h!==null&&h.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return g?!1:h!==null?!h.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function k(o,c,h,g){if(c===null||typeof c>"u"||v(o,c,h,g))return!0;if(g)return!1;if(h!==null)switch(h.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function y(o,c,h,g,w,_,B){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=g,this.attributeNamespace=w,this.mustUseProperty=h,this.propertyName=o,this.type=c,this.sanitizeURL=_,this.removeEmptyString=B}var S={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){S[o]=new y(o,0,!1,o,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var c=o[0];S[c]=new y(c,1,!1,o[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(o){S[o]=new y(o,2,!1,o.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){S[o]=new y(o,2,!1,o,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){S[o]=new y(o,3,!1,o.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(o){S[o]=new y(o,3,!0,o,null,!1,!1)}),["capture","download"].forEach(function(o){S[o]=new y(o,4,!1,o,null,!1,!1)}),["cols","rows","size","span"].forEach(function(o){S[o]=new y(o,6,!1,o,null,!1,!1)}),["rowSpan","start"].forEach(function(o){S[o]=new y(o,5,!1,o.toLowerCase(),null,!1,!1)});var C=/[\-:]([a-z])/g;function D(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var c=o.replace(C,D);S[c]=new y(c,1,!1,o,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var c=o.replace(C,D);S[c]=new y(c,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(o){var c=o.replace(C,D);S[c]=new y(c,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(o){S[o]=new y(o,1,!1,o.toLowerCase(),null,!1,!1)}),S.xlinkHref=new y("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(o){S[o]=new y(o,1,!1,o.toLowerCase(),null,!0,!0)});function N(o,c,h,g){var w=S.hasOwnProperty(c)?S[c]:null;(w!==null?w.type!==0:g||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(k(c,h,w,g)&&(h=null),g||w===null?x(c)&&(h===null?o.removeAttribute(c):o.setAttribute(c,""+h)):w.mustUseProperty?o[w.propertyName]=h===null?w.type===3?!1:"":h:(c=w.attributeName,g=w.attributeNamespace,h===null?o.removeAttribute(c):(w=w.type,h=w===3||w===4&&h===!0?"":""+h,g?o.setAttributeNS(g,c,h):o.setAttribute(c,h))))}var b=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,H=Symbol.for("react.element"),L=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),q=Symbol.for("react.strict_mode"),O=Symbol.for("react.profiler"),V=Symbol.for("react.provider"),X=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),me=Symbol.for("react.suspense"),ae=Symbol.for("react.suspense_list"),ce=Symbol.for("react.memo"),ue=Symbol.for("react.lazy"),K=Symbol.for("react.offscreen"),W=Symbol.iterator;function j(o){return o===null||typeof o!="object"?null:(o=W&&o[W]||o["@@iterator"],typeof o=="function"?o:null)}var F=Object.assign,U;function I(o){if(U===void 0)try{throw Error()}catch(h){var c=h.stack.trim().match(/\n( *(at )?)/);U=c&&c[1]||""}return`
`+U+o}var Z=!1;function Y(o,c){if(!o||Z)return"";Z=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(be){var g=be}Reflect.construct(o,[],c)}else{try{c.call()}catch(be){g=be}o.call(c.prototype)}else{try{throw Error()}catch(be){g=be}o()}}catch(be){if(be&&g&&typeof be.stack=="string"){for(var w=be.stack.split(`
`),_=g.stack.split(`
`),B=w.length-1,le=_.length-1;1<=B&&0<=le&&w[B]!==_[le];)le--;for(;1<=B&&0<=le;B--,le--)if(w[B]!==_[le]){if(B!==1||le!==1)do if(B--,le--,0>le||w[B]!==_[le]){var pe=`
`+w[B].replace(" at new "," at ");return o.displayName&&pe.includes("<anonymous>")&&(pe=pe.replace("<anonymous>",o.displayName)),pe}while(1<=B&&0<=le);break}}}finally{Z=!1,Error.prepareStackTrace=h}return(o=o?o.displayName||o.name:"")?I(o):""}function P(o){switch(o.tag){case 5:return I(o.type);case 16:return I("Lazy");case 13:return I("Suspense");case 19:return I("SuspenseList");case 0:case 2:case 15:return o=Y(o.type,!1),o;case 11:return o=Y(o.type.render,!1),o;case 1:return o=Y(o.type,!0),o;default:return""}}function ne(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case R:return"Fragment";case L:return"Portal";case O:return"Profiler";case q:return"StrictMode";case me:return"Suspense";case ae:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case X:return(o.displayName||"Context")+".Consumer";case V:return(o._context.displayName||"Context")+".Provider";case M:var c=o.render;return o=o.displayName,o||(o=c.displayName||c.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case ce:return c=o.displayName||null,c!==null?c:ne(o.type)||"Memo";case ue:c=o._payload,o=o._init;try{return ne(o(c))}catch{}}return null}function J(o){var c=o.type;switch(o.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=c.render,o=o.displayName||o.name||"",c.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ne(c);case 8:return c===q?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function de(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function E(o){var c=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function A(o){var c=E(o)?"checked":"value",h=Object.getOwnPropertyDescriptor(o.constructor.prototype,c),g=""+o[c];if(!o.hasOwnProperty(c)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var w=h.get,_=h.set;return Object.defineProperty(o,c,{configurable:!0,get:function(){return w.call(this)},set:function(B){g=""+B,_.call(this,B)}}),Object.defineProperty(o,c,{enumerable:h.enumerable}),{getValue:function(){return g},setValue:function(B){g=""+B},stopTracking:function(){o._valueTracker=null,delete o[c]}}}}function he(o){o._valueTracker||(o._valueTracker=A(o))}function G(o){if(!o)return!1;var c=o._valueTracker;if(!c)return!0;var h=c.getValue(),g="";return o&&(g=E(o)?o.checked?"true":"false":o.value),o=g,o!==h?(c.setValue(o),!0):!1}function Ie(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function oe(o,c){var h=c.checked;return F({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??o._wrapperState.initialChecked})}function Te(o,c){var h=c.defaultValue==null?"":c.defaultValue,g=c.checked!=null?c.checked:c.defaultChecked;h=de(c.value!=null?c.value:h),o._wrapperState={initialChecked:g,initialValue:h,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function xe(o,c){c=c.checked,c!=null&&N(o,"checked",c,!1)}function we(o,c){xe(o,c);var h=de(c.value),g=c.type;if(h!=null)g==="number"?(h===0&&o.value===""||o.value!=h)&&(o.value=""+h):o.value!==""+h&&(o.value=""+h);else if(g==="submit"||g==="reset"){o.removeAttribute("value");return}c.hasOwnProperty("value")?ye(o,c.type,h):c.hasOwnProperty("defaultValue")&&ye(o,c.type,de(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(o.defaultChecked=!!c.defaultChecked)}function fe(o,c,h){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var g=c.type;if(!(g!=="submit"&&g!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+o._wrapperState.initialValue,h||c===o.value||(o.value=c),o.defaultValue=c}h=o.name,h!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,h!==""&&(o.name=h)}function ye(o,c,h){(c!=="number"||Ie(o.ownerDocument)!==o)&&(h==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+h&&(o.defaultValue=""+h))}var ee=Array.isArray;function Pe(o,c,h,g){if(o=o.options,c){c={};for(var w=0;w<h.length;w++)c["$"+h[w]]=!0;for(h=0;h<o.length;h++)w=c.hasOwnProperty("$"+o[h].value),o[h].selected!==w&&(o[h].selected=w),w&&g&&(o[h].defaultSelected=!0)}else{for(h=""+de(h),c=null,w=0;w<o.length;w++){if(o[w].value===h){o[w].selected=!0,g&&(o[w].defaultSelected=!0);return}c!==null||o[w].disabled||(c=o[w])}c!==null&&(c.selected=!0)}}function Fe(o,c){if(c.dangerouslySetInnerHTML!=null)throw Error(n(91));return F({},c,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function et(o,c){var h=c.value;if(h==null){if(h=c.children,c=c.defaultValue,h!=null){if(c!=null)throw Error(n(92));if(ee(h)){if(1<h.length)throw Error(n(93));h=h[0]}c=h}c==null&&(c=""),h=c}o._wrapperState={initialValue:de(h)}}function dt(o,c){var h=de(c.value),g=de(c.defaultValue);h!=null&&(h=""+h,h!==o.value&&(o.value=h),c.defaultValue==null&&o.defaultValue!==h&&(o.defaultValue=h)),g!=null&&(o.defaultValue=""+g)}function jt(o){var c=o.textContent;c===o._wrapperState.initialValue&&c!==""&&c!==null&&(o.value=c)}function un(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function gr(o,c){return o==null||o==="http://www.w3.org/1999/xhtml"?un(c):o==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var ge,Je=(function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,h,g,w){MSApp.execUnsafeLocalFunction(function(){return o(c,h,g,w)})}:o})(function(o,c){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=c;else{for(ge=ge||document.createElement("div"),ge.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=ge.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;c.firstChild;)o.appendChild(c.firstChild)}});function qe(o,c){if(c){var h=o.firstChild;if(h&&h===o.lastChild&&h.nodeType===3){h.nodeValue=c;return}}o.textContent=c}var ot={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Mt=["Webkit","ms","Moz","O"];Object.keys(ot).forEach(function(o){Mt.forEach(function(c){c=c+o.charAt(0).toUpperCase()+o.substring(1),ot[c]=ot[o]})});function Ct(o,c,h){return c==null||typeof c=="boolean"||c===""?"":h||typeof c!="number"||c===0||ot.hasOwnProperty(o)&&ot[o]?(""+c).trim():c+"px"}function rn(o,c){o=o.style;for(var h in c)if(c.hasOwnProperty(h)){var g=h.indexOf("--")===0,w=Ct(h,c[h],g);h==="float"&&(h="cssFloat"),g?o.setProperty(h,w):o[h]=w}}var ga=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Rt(o,c){if(c){if(ga[o]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(n(137,o));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(n(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(n(61))}if(c.style!=null&&typeof c.style!="object")throw Error(n(62))}}function xa(o,c){if(o.indexOf("-")===-1)return typeof c.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ln=null;function Xa(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Ts=null,bs=null,As=null;function xi(o){if(o=Wl(o)){if(typeof Ts!="function")throw Error(n(280));var c=o.stateNode;c&&(c=zu(c),Ts(o.stateNode,o.type,c))}}function vu(o){bs?As?As.push(o):As=[o]:bs=o}function yu(){if(bs){var o=bs,c=As;if(As=bs=null,xi(o),c)for(o=0;o<c.length;o++)xi(c[o])}}function ku(o,c){return o(c)}function wu(){}var wl=!1;function Su(o,c,h){if(wl)return o(c,h);wl=!0;try{return ku(o,c,h)}finally{wl=!1,(bs!==null||As!==null)&&(wu(),yu())}}function vi(o,c){var h=o.stateNode;if(h===null)return null;var g=zu(h);if(g===null)return null;h=g[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(o=o.type,g=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!g;break e;default:o=!1}if(o)return null;if(h&&typeof h!="function")throw Error(n(231,c,typeof h));return h}var Sl=!1;if(u)try{var Qa={};Object.defineProperty(Qa,"passive",{get:function(){Sl=!0}}),window.addEventListener("test",Qa,Qa),window.removeEventListener("test",Qa,Qa)}catch{Sl=!1}function tf(o,c,h,g,w,_,B,le,pe){var be=Array.prototype.slice.call(arguments,3);try{c.apply(h,be)}catch(Oe){this.onError(Oe)}}var yi=!1,ho=null,z=!1,re=null,Q={onError:function(o){yi=!0,ho=o}};function te(o,c,h,g,w,_,B,le,pe){yi=!1,ho=null,tf.apply(Q,arguments)}function se(o,c,h,g,w,_,B,le,pe){if(te.apply(this,arguments),yi){if(yi){var be=ho;yi=!1,ho=null}else throw Error(n(198));z||(z=!0,re=be)}}function ie(o){var c=o,h=o;if(o.alternate)for(;c.return;)c=c.return;else{o=c;do c=o,(c.flags&4098)!==0&&(h=c.return),o=c.return;while(o)}return c.tag===3?h:null}function Ce(o){if(o.tag===13){var c=o.memoizedState;if(c===null&&(o=o.alternate,o!==null&&(c=o.memoizedState)),c!==null)return c.dehydrated}return null}function je(o){if(ie(o)!==o)throw Error(n(188))}function _e(o){var c=o.alternate;if(!c){if(c=ie(o),c===null)throw Error(n(188));return c!==o?null:o}for(var h=o,g=c;;){var w=h.return;if(w===null)break;var _=w.alternate;if(_===null){if(g=w.return,g!==null){h=g;continue}break}if(w.child===_.child){for(_=w.child;_;){if(_===h)return je(w),o;if(_===g)return je(w),c;_=_.sibling}throw Error(n(188))}if(h.return!==g.return)h=w,g=_;else{for(var B=!1,le=w.child;le;){if(le===h){B=!0,h=w,g=_;break}if(le===g){B=!0,g=w,h=_;break}le=le.sibling}if(!B){for(le=_.child;le;){if(le===h){B=!0,h=_,g=w;break}if(le===g){B=!0,g=_,h=w;break}le=le.sibling}if(!B)throw Error(n(189))}}if(h.alternate!==g)throw Error(n(190))}if(h.tag!==3)throw Error(n(188));return h.stateNode.current===h?o:c}function Ne(o){return o=_e(o),o!==null?Ee(o):null}function Ee(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var c=Ee(o);if(c!==null)return c;o=o.sibling}return null}var Me=t.unstable_scheduleCallback,Ve=t.unstable_cancelCallback,Ye=t.unstable_shouldYield,ze=t.unstable_requestPaint,Ue=t.unstable_now,ht=t.unstable_getCurrentPriorityLevel,Ut=t.unstable_ImmediatePriority,Ht=t.unstable_UserBlockingPriority,gn=t.unstable_NormalPriority,ki=t.unstable_LowPriority,js=t.unstable_IdlePriority,Fa=null,Fn=null;function _l(o){if(Fn&&typeof Fn.onCommitFiberRoot=="function")try{Fn.onCommitFiberRoot(Fa,o,void 0,(o.current.flags&128)===128)}catch{}}var xn=Math.clz32?Math.clz32:b2,E2=Math.log,T2=Math.LN2;function b2(o){return o>>>=0,o===0?32:31-(E2(o)/T2|0)|0}var _u=64,Cu=4194304;function Cl(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function Nu(o,c){var h=o.pendingLanes;if(h===0)return 0;var g=0,w=o.suspendedLanes,_=o.pingedLanes,B=h&268435455;if(B!==0){var le=B&~w;le!==0?g=Cl(le):(_&=B,_!==0&&(g=Cl(_)))}else B=h&~w,B!==0?g=Cl(B):_!==0&&(g=Cl(_));if(g===0)return 0;if(c!==0&&c!==g&&(c&w)===0&&(w=g&-g,_=c&-c,w>=_||w===16&&(_&4194240)!==0))return c;if((g&4)!==0&&(g|=h&16),c=o.entangledLanes,c!==0)for(o=o.entanglements,c&=g;0<c;)h=31-xn(c),w=1<<h,g|=o[h],c&=~w;return g}function A2(o,c){switch(o){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function j2(o,c){for(var h=o.suspendedLanes,g=o.pingedLanes,w=o.expirationTimes,_=o.pendingLanes;0<_;){var B=31-xn(_),le=1<<B,pe=w[B];pe===-1?((le&h)===0||(le&g)!==0)&&(w[B]=A2(le,c)):pe<=c&&(o.expiredLanes|=le),_&=~le}}function nf(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function zg(){var o=_u;return _u<<=1,(_u&4194240)===0&&(_u=64),o}function rf(o){for(var c=[],h=0;31>h;h++)c.push(o);return c}function Nl(o,c,h){o.pendingLanes|=c,c!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,c=31-xn(c),o[c]=h}function R2(o,c){var h=o.pendingLanes&~c;o.pendingLanes=c,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=c,o.mutableReadLanes&=c,o.entangledLanes&=c,c=o.entanglements;var g=o.eventTimes;for(o=o.expirationTimes;0<h;){var w=31-xn(h),_=1<<w;c[w]=0,g[w]=-1,o[w]=-1,h&=~_}}function af(o,c){var h=o.entangledLanes|=c;for(o=o.entanglements;h;){var g=31-xn(h),w=1<<g;w&c|o[g]&c&&(o[g]|=c),h&=~w}}var Pt=0;function Wg(o){return o&=-o,1<o?4<o?(o&268435455)!==0?16:536870912:4:1}var Hg,sf,Gg,$g,Vg,of=!1,Eu=[],Rs=null,Is=null,Ps=null,El=new Map,Tl=new Map,Ds=[],I2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qg(o,c){switch(o){case"focusin":case"focusout":Rs=null;break;case"dragenter":case"dragleave":Is=null;break;case"mouseover":case"mouseout":Ps=null;break;case"pointerover":case"pointerout":El.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tl.delete(c.pointerId)}}function bl(o,c,h,g,w,_){return o===null||o.nativeEvent!==_?(o={blockedOn:c,domEventName:h,eventSystemFlags:g,nativeEvent:_,targetContainers:[w]},c!==null&&(c=Wl(c),c!==null&&sf(c)),o):(o.eventSystemFlags|=g,c=o.targetContainers,w!==null&&c.indexOf(w)===-1&&c.push(w),o)}function P2(o,c,h,g,w){switch(c){case"focusin":return Rs=bl(Rs,o,c,h,g,w),!0;case"dragenter":return Is=bl(Is,o,c,h,g,w),!0;case"mouseover":return Ps=bl(Ps,o,c,h,g,w),!0;case"pointerover":var _=w.pointerId;return El.set(_,bl(El.get(_)||null,o,c,h,g,w)),!0;case"gotpointercapture":return _=w.pointerId,Tl.set(_,bl(Tl.get(_)||null,o,c,h,g,w)),!0}return!1}function Kg(o){var c=wi(o.target);if(c!==null){var h=ie(c);if(h!==null){if(c=h.tag,c===13){if(c=Ce(h),c!==null){o.blockedOn=c,Vg(o.priority,function(){Gg(h)});return}}else if(c===3&&h.stateNode.current.memoizedState.isDehydrated){o.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}o.blockedOn=null}function Tu(o){if(o.blockedOn!==null)return!1;for(var c=o.targetContainers;0<c.length;){var h=cf(o.domEventName,o.eventSystemFlags,c[0],o.nativeEvent);if(h===null){h=o.nativeEvent;var g=new h.constructor(h.type,h);Ln=g,h.target.dispatchEvent(g),Ln=null}else return c=Wl(h),c!==null&&sf(c),o.blockedOn=h,!1;c.shift()}return!0}function Yg(o,c,h){Tu(o)&&h.delete(c)}function D2(){of=!1,Rs!==null&&Tu(Rs)&&(Rs=null),Is!==null&&Tu(Is)&&(Is=null),Ps!==null&&Tu(Ps)&&(Ps=null),El.forEach(Yg),Tl.forEach(Yg)}function Al(o,c){o.blockedOn===c&&(o.blockedOn=null,of||(of=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,D2)))}function jl(o){function c(w){return Al(w,o)}if(0<Eu.length){Al(Eu[0],o);for(var h=1;h<Eu.length;h++){var g=Eu[h];g.blockedOn===o&&(g.blockedOn=null)}}for(Rs!==null&&Al(Rs,o),Is!==null&&Al(Is,o),Ps!==null&&Al(Ps,o),El.forEach(c),Tl.forEach(c),h=0;h<Ds.length;h++)g=Ds[h],g.blockedOn===o&&(g.blockedOn=null);for(;0<Ds.length&&(h=Ds[0],h.blockedOn===null);)Kg(h),h.blockedOn===null&&Ds.shift()}var fo=b.ReactCurrentBatchConfig,bu=!0;function O2(o,c,h,g){var w=Pt,_=fo.transition;fo.transition=null;try{Pt=1,lf(o,c,h,g)}finally{Pt=w,fo.transition=_}}function L2(o,c,h,g){var w=Pt,_=fo.transition;fo.transition=null;try{Pt=4,lf(o,c,h,g)}finally{Pt=w,fo.transition=_}}function lf(o,c,h,g){if(bu){var w=cf(o,c,h,g);if(w===null)Ef(o,c,g,Au,h),qg(o,g);else if(P2(w,o,c,h,g))g.stopPropagation();else if(qg(o,g),c&4&&-1<I2.indexOf(o)){for(;w!==null;){var _=Wl(w);if(_!==null&&Hg(_),_=cf(o,c,h,g),_===null&&Ef(o,c,g,Au,h),_===w)break;w=_}w!==null&&g.stopPropagation()}else Ef(o,c,g,null,h)}}var Au=null;function cf(o,c,h,g){if(Au=null,o=Xa(g),o=wi(o),o!==null)if(c=ie(o),c===null)o=null;else if(h=c.tag,h===13){if(o=Ce(c),o!==null)return o;o=null}else if(h===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;o=null}else c!==o&&(o=null);return Au=o,null}function Xg(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ht()){case Ut:return 1;case Ht:return 4;case gn:case ki:return 16;case js:return 536870912;default:return 16}default:return 16}}var Os=null,uf=null,ju=null;function Qg(){if(ju)return ju;var o,c=uf,h=c.length,g,w="value"in Os?Os.value:Os.textContent,_=w.length;for(o=0;o<h&&c[o]===w[o];o++);var B=h-o;for(g=1;g<=B&&c[h-g]===w[_-g];g++);return ju=w.slice(o,1<g?1-g:void 0)}function Ru(o){var c=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&c===13&&(o=13)):o=c,o===10&&(o=13),32<=o||o===13?o:0}function Iu(){return!0}function Jg(){return!1}function Mr(o){function c(h,g,w,_,B){this._reactName=h,this._targetInst=w,this.type=g,this.nativeEvent=_,this.target=B,this.currentTarget=null;for(var le in o)o.hasOwnProperty(le)&&(h=o[le],this[le]=h?h(_):_[le]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?Iu:Jg,this.isPropagationStopped=Jg,this}return F(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Iu)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Iu)},persist:function(){},isPersistent:Iu}),c}var mo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},df=Mr(mo),Rl=F({},mo,{view:0,detail:0}),F2=Mr(Rl),hf,ff,Il,Pu=F({},Rl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pf,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Il&&(Il&&o.type==="mousemove"?(hf=o.screenX-Il.screenX,ff=o.screenY-Il.screenY):ff=hf=0,Il=o),hf)},movementY:function(o){return"movementY"in o?o.movementY:ff}}),Zg=Mr(Pu),M2=F({},Pu,{dataTransfer:0}),B2=Mr(M2),U2=F({},Rl,{relatedTarget:0}),mf=Mr(U2),z2=F({},mo,{animationName:0,elapsedTime:0,pseudoElement:0}),W2=Mr(z2),H2=F({},mo,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),G2=Mr(H2),$2=F({},mo,{data:0}),ex=Mr($2),V2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},q2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},K2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Y2(o){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(o):(o=K2[o])?!!c[o]:!1}function pf(){return Y2}var X2=F({},Rl,{key:function(o){if(o.key){var c=V2[o.key]||o.key;if(c!=="Unidentified")return c}return o.type==="keypress"?(o=Ru(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?q2[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pf,charCode:function(o){return o.type==="keypress"?Ru(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?Ru(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),Q2=Mr(X2),J2=F({},Pu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),tx=Mr(J2),Z2=F({},Rl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pf}),eN=Mr(Z2),tN=F({},mo,{propertyName:0,elapsedTime:0,pseudoElement:0}),nN=Mr(tN),rN=F({},Pu,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),aN=Mr(rN),sN=[9,13,27,32],gf=u&&"CompositionEvent"in window,Pl=null;u&&"documentMode"in document&&(Pl=document.documentMode);var iN=u&&"TextEvent"in window&&!Pl,nx=u&&(!gf||Pl&&8<Pl&&11>=Pl),rx=" ",ax=!1;function sx(o,c){switch(o){case"keyup":return sN.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ix(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var po=!1;function oN(o,c){switch(o){case"compositionend":return ix(c);case"keypress":return c.which!==32?null:(ax=!0,rx);case"textInput":return o=c.data,o===rx&&ax?null:o;default:return null}}function lN(o,c){if(po)return o==="compositionend"||!gf&&sx(o,c)?(o=Qg(),ju=uf=Os=null,po=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return nx&&c.locale!=="ko"?null:c.data;default:return null}}var cN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ox(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c==="input"?!!cN[o.type]:c==="textarea"}function lx(o,c,h,g){vu(g),c=Mu(c,"onChange"),0<c.length&&(h=new df("onChange","change",null,h,g),o.push({event:h,listeners:c}))}var Dl=null,Ol=null;function uN(o){Ex(o,0)}function Du(o){var c=ko(o);if(G(c))return o}function dN(o,c){if(o==="change")return c}var cx=!1;if(u){var xf;if(u){var vf="oninput"in document;if(!vf){var ux=document.createElement("div");ux.setAttribute("oninput","return;"),vf=typeof ux.oninput=="function"}xf=vf}else xf=!1;cx=xf&&(!document.documentMode||9<document.documentMode)}function dx(){Dl&&(Dl.detachEvent("onpropertychange",hx),Ol=Dl=null)}function hx(o){if(o.propertyName==="value"&&Du(Ol)){var c=[];lx(c,Ol,o,Xa(o)),Su(uN,c)}}function hN(o,c,h){o==="focusin"?(dx(),Dl=c,Ol=h,Dl.attachEvent("onpropertychange",hx)):o==="focusout"&&dx()}function fN(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Du(Ol)}function mN(o,c){if(o==="click")return Du(c)}function pN(o,c){if(o==="input"||o==="change")return Du(c)}function gN(o,c){return o===c&&(o!==0||1/o===1/c)||o!==o&&c!==c}var va=typeof Object.is=="function"?Object.is:gN;function Ll(o,c){if(va(o,c))return!0;if(typeof o!="object"||o===null||typeof c!="object"||c===null)return!1;var h=Object.keys(o),g=Object.keys(c);if(h.length!==g.length)return!1;for(g=0;g<h.length;g++){var w=h[g];if(!d.call(c,w)||!va(o[w],c[w]))return!1}return!0}function fx(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function mx(o,c){var h=fx(o);o=0;for(var g;h;){if(h.nodeType===3){if(g=o+h.textContent.length,o<=c&&g>=c)return{node:h,offset:c-o};o=g}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=fx(h)}}function px(o,c){return o&&c?o===c?!0:o&&o.nodeType===3?!1:c&&c.nodeType===3?px(o,c.parentNode):"contains"in o?o.contains(c):o.compareDocumentPosition?!!(o.compareDocumentPosition(c)&16):!1:!1}function gx(){for(var o=window,c=Ie();c instanceof o.HTMLIFrameElement;){try{var h=typeof c.contentWindow.location.href=="string"}catch{h=!1}if(h)o=c.contentWindow;else break;c=Ie(o.document)}return c}function yf(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c&&(c==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||c==="textarea"||o.contentEditable==="true")}function xN(o){var c=gx(),h=o.focusedElem,g=o.selectionRange;if(c!==h&&h&&h.ownerDocument&&px(h.ownerDocument.documentElement,h)){if(g!==null&&yf(h)){if(c=g.start,o=g.end,o===void 0&&(o=c),"selectionStart"in h)h.selectionStart=c,h.selectionEnd=Math.min(o,h.value.length);else if(o=(c=h.ownerDocument||document)&&c.defaultView||window,o.getSelection){o=o.getSelection();var w=h.textContent.length,_=Math.min(g.start,w);g=g.end===void 0?_:Math.min(g.end,w),!o.extend&&_>g&&(w=g,g=_,_=w),w=mx(h,_);var B=mx(h,g);w&&B&&(o.rangeCount!==1||o.anchorNode!==w.node||o.anchorOffset!==w.offset||o.focusNode!==B.node||o.focusOffset!==B.offset)&&(c=c.createRange(),c.setStart(w.node,w.offset),o.removeAllRanges(),_>g?(o.addRange(c),o.extend(B.node,B.offset)):(c.setEnd(B.node,B.offset),o.addRange(c)))}}for(c=[],o=h;o=o.parentNode;)o.nodeType===1&&c.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<c.length;h++)o=c[h],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var vN=u&&"documentMode"in document&&11>=document.documentMode,go=null,kf=null,Fl=null,wf=!1;function xx(o,c,h){var g=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;wf||go==null||go!==Ie(g)||(g=go,"selectionStart"in g&&yf(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),Fl&&Ll(Fl,g)||(Fl=g,g=Mu(kf,"onSelect"),0<g.length&&(c=new df("onSelect","select",null,c,h),o.push({event:c,listeners:g}),c.target=go)))}function Ou(o,c){var h={};return h[o.toLowerCase()]=c.toLowerCase(),h["Webkit"+o]="webkit"+c,h["Moz"+o]="moz"+c,h}var xo={animationend:Ou("Animation","AnimationEnd"),animationiteration:Ou("Animation","AnimationIteration"),animationstart:Ou("Animation","AnimationStart"),transitionend:Ou("Transition","TransitionEnd")},Sf={},vx={};u&&(vx=document.createElement("div").style,"AnimationEvent"in window||(delete xo.animationend.animation,delete xo.animationiteration.animation,delete xo.animationstart.animation),"TransitionEvent"in window||delete xo.transitionend.transition);function Lu(o){if(Sf[o])return Sf[o];if(!xo[o])return o;var c=xo[o],h;for(h in c)if(c.hasOwnProperty(h)&&h in vx)return Sf[o]=c[h];return o}var yx=Lu("animationend"),kx=Lu("animationiteration"),wx=Lu("animationstart"),Sx=Lu("transitionend"),_x=new Map,Cx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ls(o,c){_x.set(o,c),i(c,[o])}for(var _f=0;_f<Cx.length;_f++){var Cf=Cx[_f],yN=Cf.toLowerCase(),kN=Cf[0].toUpperCase()+Cf.slice(1);Ls(yN,"on"+kN)}Ls(yx,"onAnimationEnd"),Ls(kx,"onAnimationIteration"),Ls(wx,"onAnimationStart"),Ls("dblclick","onDoubleClick"),Ls("focusin","onFocus"),Ls("focusout","onBlur"),Ls(Sx,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ml="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wN=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ml));function Nx(o,c,h){var g=o.type||"unknown-event";o.currentTarget=h,se(g,c,void 0,o),o.currentTarget=null}function Ex(o,c){c=(c&4)!==0;for(var h=0;h<o.length;h++){var g=o[h],w=g.event;g=g.listeners;e:{var _=void 0;if(c)for(var B=g.length-1;0<=B;B--){var le=g[B],pe=le.instance,be=le.currentTarget;if(le=le.listener,pe!==_&&w.isPropagationStopped())break e;Nx(w,le,be),_=pe}else for(B=0;B<g.length;B++){if(le=g[B],pe=le.instance,be=le.currentTarget,le=le.listener,pe!==_&&w.isPropagationStopped())break e;Nx(w,le,be),_=pe}}}if(z)throw o=re,z=!1,re=null,o}function Kt(o,c){var h=c[If];h===void 0&&(h=c[If]=new Set);var g=o+"__bubble";h.has(g)||(Tx(c,o,2,!1),h.add(g))}function Nf(o,c,h){var g=0;c&&(g|=4),Tx(h,o,g,c)}var Fu="_reactListening"+Math.random().toString(36).slice(2);function Bl(o){if(!o[Fu]){o[Fu]=!0,r.forEach(function(h){h!=="selectionchange"&&(wN.has(h)||Nf(h,!1,o),Nf(h,!0,o))});var c=o.nodeType===9?o:o.ownerDocument;c===null||c[Fu]||(c[Fu]=!0,Nf("selectionchange",!1,c))}}function Tx(o,c,h,g){switch(Xg(c)){case 1:var w=O2;break;case 4:w=L2;break;default:w=lf}h=w.bind(null,c,h,o),w=void 0,!Sl||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(w=!0),g?w!==void 0?o.addEventListener(c,h,{capture:!0,passive:w}):o.addEventListener(c,h,!0):w!==void 0?o.addEventListener(c,h,{passive:w}):o.addEventListener(c,h,!1)}function Ef(o,c,h,g,w){var _=g;if((c&1)===0&&(c&2)===0&&g!==null)e:for(;;){if(g===null)return;var B=g.tag;if(B===3||B===4){var le=g.stateNode.containerInfo;if(le===w||le.nodeType===8&&le.parentNode===w)break;if(B===4)for(B=g.return;B!==null;){var pe=B.tag;if((pe===3||pe===4)&&(pe=B.stateNode.containerInfo,pe===w||pe.nodeType===8&&pe.parentNode===w))return;B=B.return}for(;le!==null;){if(B=wi(le),B===null)return;if(pe=B.tag,pe===5||pe===6){g=_=B;continue e}le=le.parentNode}}g=g.return}Su(function(){var be=_,Oe=Xa(h),Be=[];e:{var De=_x.get(o);if(De!==void 0){var Ke=df,Qe=o;switch(o){case"keypress":if(Ru(h)===0)break e;case"keydown":case"keyup":Ke=Q2;break;case"focusin":Qe="focus",Ke=mf;break;case"focusout":Qe="blur",Ke=mf;break;case"beforeblur":case"afterblur":Ke=mf;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ke=Zg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ke=B2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ke=eN;break;case yx:case kx:case wx:Ke=W2;break;case Sx:Ke=nN;break;case"scroll":Ke=F2;break;case"wheel":Ke=aN;break;case"copy":case"cut":case"paste":Ke=G2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ke=tx}var Ze=(c&4)!==0,vn=!Ze&&o==="scroll",ke=Ze?De!==null?De+"Capture":null:De;Ze=[];for(var ve=be,Se;ve!==null;){Se=ve;var We=Se.stateNode;if(Se.tag===5&&We!==null&&(Se=We,ke!==null&&(We=vi(ve,ke),We!=null&&Ze.push(Ul(ve,We,Se)))),vn)break;ve=ve.return}0<Ze.length&&(De=new Ke(De,Qe,null,h,Oe),Be.push({event:De,listeners:Ze}))}}if((c&7)===0){e:{if(De=o==="mouseover"||o==="pointerover",Ke=o==="mouseout"||o==="pointerout",De&&h!==Ln&&(Qe=h.relatedTarget||h.fromElement)&&(wi(Qe)||Qe[Ja]))break e;if((Ke||De)&&(De=Oe.window===Oe?Oe:(De=Oe.ownerDocument)?De.defaultView||De.parentWindow:window,Ke?(Qe=h.relatedTarget||h.toElement,Ke=be,Qe=Qe?wi(Qe):null,Qe!==null&&(vn=ie(Qe),Qe!==vn||Qe.tag!==5&&Qe.tag!==6)&&(Qe=null)):(Ke=null,Qe=be),Ke!==Qe)){if(Ze=Zg,We="onMouseLeave",ke="onMouseEnter",ve="mouse",(o==="pointerout"||o==="pointerover")&&(Ze=tx,We="onPointerLeave",ke="onPointerEnter",ve="pointer"),vn=Ke==null?De:ko(Ke),Se=Qe==null?De:ko(Qe),De=new Ze(We,ve+"leave",Ke,h,Oe),De.target=vn,De.relatedTarget=Se,We=null,wi(Oe)===be&&(Ze=new Ze(ke,ve+"enter",Qe,h,Oe),Ze.target=Se,Ze.relatedTarget=vn,We=Ze),vn=We,Ke&&Qe)t:{for(Ze=Ke,ke=Qe,ve=0,Se=Ze;Se;Se=vo(Se))ve++;for(Se=0,We=ke;We;We=vo(We))Se++;for(;0<ve-Se;)Ze=vo(Ze),ve--;for(;0<Se-ve;)ke=vo(ke),Se--;for(;ve--;){if(Ze===ke||ke!==null&&Ze===ke.alternate)break t;Ze=vo(Ze),ke=vo(ke)}Ze=null}else Ze=null;Ke!==null&&bx(Be,De,Ke,Ze,!1),Qe!==null&&vn!==null&&bx(Be,vn,Qe,Ze,!0)}}e:{if(De=be?ko(be):window,Ke=De.nodeName&&De.nodeName.toLowerCase(),Ke==="select"||Ke==="input"&&De.type==="file")var tt=dN;else if(ox(De))if(cx)tt=pN;else{tt=fN;var rt=hN}else(Ke=De.nodeName)&&Ke.toLowerCase()==="input"&&(De.type==="checkbox"||De.type==="radio")&&(tt=mN);if(tt&&(tt=tt(o,be))){lx(Be,tt,h,Oe);break e}rt&&rt(o,De,be),o==="focusout"&&(rt=De._wrapperState)&&rt.controlled&&De.type==="number"&&ye(De,"number",De.value)}switch(rt=be?ko(be):window,o){case"focusin":(ox(rt)||rt.contentEditable==="true")&&(go=rt,kf=be,Fl=null);break;case"focusout":Fl=kf=go=null;break;case"mousedown":wf=!0;break;case"contextmenu":case"mouseup":case"dragend":wf=!1,xx(Be,h,Oe);break;case"selectionchange":if(vN)break;case"keydown":case"keyup":xx(Be,h,Oe)}var at;if(gf)e:{switch(o){case"compositionstart":var ut="onCompositionStart";break e;case"compositionend":ut="onCompositionEnd";break e;case"compositionupdate":ut="onCompositionUpdate";break e}ut=void 0}else po?sx(o,h)&&(ut="onCompositionEnd"):o==="keydown"&&h.keyCode===229&&(ut="onCompositionStart");ut&&(nx&&h.locale!=="ko"&&(po||ut!=="onCompositionStart"?ut==="onCompositionEnd"&&po&&(at=Qg()):(Os=Oe,uf="value"in Os?Os.value:Os.textContent,po=!0)),rt=Mu(be,ut),0<rt.length&&(ut=new ex(ut,o,null,h,Oe),Be.push({event:ut,listeners:rt}),at?ut.data=at:(at=ix(h),at!==null&&(ut.data=at)))),(at=iN?oN(o,h):lN(o,h))&&(be=Mu(be,"onBeforeInput"),0<be.length&&(Oe=new ex("onBeforeInput","beforeinput",null,h,Oe),Be.push({event:Oe,listeners:be}),Oe.data=at))}Ex(Be,c)})}function Ul(o,c,h){return{instance:o,listener:c,currentTarget:h}}function Mu(o,c){for(var h=c+"Capture",g=[];o!==null;){var w=o,_=w.stateNode;w.tag===5&&_!==null&&(w=_,_=vi(o,h),_!=null&&g.unshift(Ul(o,_,w)),_=vi(o,c),_!=null&&g.push(Ul(o,_,w))),o=o.return}return g}function vo(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function bx(o,c,h,g,w){for(var _=c._reactName,B=[];h!==null&&h!==g;){var le=h,pe=le.alternate,be=le.stateNode;if(pe!==null&&pe===g)break;le.tag===5&&be!==null&&(le=be,w?(pe=vi(h,_),pe!=null&&B.unshift(Ul(h,pe,le))):w||(pe=vi(h,_),pe!=null&&B.push(Ul(h,pe,le)))),h=h.return}B.length!==0&&o.push({event:c,listeners:B})}var SN=/\r\n?/g,_N=/\u0000|\uFFFD/g;function Ax(o){return(typeof o=="string"?o:""+o).replace(SN,`
`).replace(_N,"")}function Bu(o,c,h){if(c=Ax(c),Ax(o)!==c&&h)throw Error(n(425))}function Uu(){}var Tf=null,bf=null;function Af(o,c){return o==="textarea"||o==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var jf=typeof setTimeout=="function"?setTimeout:void 0,CN=typeof clearTimeout=="function"?clearTimeout:void 0,jx=typeof Promise=="function"?Promise:void 0,NN=typeof queueMicrotask=="function"?queueMicrotask:typeof jx<"u"?function(o){return jx.resolve(null).then(o).catch(EN)}:jf;function EN(o){setTimeout(function(){throw o})}function Rf(o,c){var h=c,g=0;do{var w=h.nextSibling;if(o.removeChild(h),w&&w.nodeType===8)if(h=w.data,h==="/$"){if(g===0){o.removeChild(w),jl(c);return}g--}else h!=="$"&&h!=="$?"&&h!=="$!"||g++;h=w}while(h);jl(c)}function Fs(o){for(;o!=null;o=o.nextSibling){var c=o.nodeType;if(c===1||c===3)break;if(c===8){if(c=o.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return o}function Rx(o){o=o.previousSibling;for(var c=0;o;){if(o.nodeType===8){var h=o.data;if(h==="$"||h==="$!"||h==="$?"){if(c===0)return o;c--}else h==="/$"&&c++}o=o.previousSibling}return null}var yo=Math.random().toString(36).slice(2),Ma="__reactFiber$"+yo,zl="__reactProps$"+yo,Ja="__reactContainer$"+yo,If="__reactEvents$"+yo,TN="__reactListeners$"+yo,bN="__reactHandles$"+yo;function wi(o){var c=o[Ma];if(c)return c;for(var h=o.parentNode;h;){if(c=h[Ja]||h[Ma]){if(h=c.alternate,c.child!==null||h!==null&&h.child!==null)for(o=Rx(o);o!==null;){if(h=o[Ma])return h;o=Rx(o)}return c}o=h,h=o.parentNode}return null}function Wl(o){return o=o[Ma]||o[Ja],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function ko(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(n(33))}function zu(o){return o[zl]||null}var Pf=[],wo=-1;function Ms(o){return{current:o}}function Yt(o){0>wo||(o.current=Pf[wo],Pf[wo]=null,wo--)}function Gt(o,c){wo++,Pf[wo]=o.current,o.current=c}var Bs={},nr=Ms(Bs),_r=Ms(!1),Si=Bs;function So(o,c){var h=o.type.contextTypes;if(!h)return Bs;var g=o.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===c)return g.__reactInternalMemoizedMaskedChildContext;var w={},_;for(_ in h)w[_]=c[_];return g&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=c,o.__reactInternalMemoizedMaskedChildContext=w),w}function Cr(o){return o=o.childContextTypes,o!=null}function Wu(){Yt(_r),Yt(nr)}function Ix(o,c,h){if(nr.current!==Bs)throw Error(n(168));Gt(nr,c),Gt(_r,h)}function Px(o,c,h){var g=o.stateNode;if(c=c.childContextTypes,typeof g.getChildContext!="function")return h;g=g.getChildContext();for(var w in g)if(!(w in c))throw Error(n(108,J(o)||"Unknown",w));return F({},h,g)}function Hu(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||Bs,Si=nr.current,Gt(nr,o),Gt(_r,_r.current),!0}function Dx(o,c,h){var g=o.stateNode;if(!g)throw Error(n(169));h?(o=Px(o,c,Si),g.__reactInternalMemoizedMergedChildContext=o,Yt(_r),Yt(nr),Gt(nr,o)):Yt(_r),Gt(_r,h)}var Za=null,Gu=!1,Df=!1;function Ox(o){Za===null?Za=[o]:Za.push(o)}function AN(o){Gu=!0,Ox(o)}function Us(){if(!Df&&Za!==null){Df=!0;var o=0,c=Pt;try{var h=Za;for(Pt=1;o<h.length;o++){var g=h[o];do g=g(!0);while(g!==null)}Za=null,Gu=!1}catch(w){throw Za!==null&&(Za=Za.slice(o+1)),Me(Ut,Us),w}finally{Pt=c,Df=!1}}return null}var _o=[],Co=0,$u=null,Vu=0,Jr=[],Zr=0,_i=null,es=1,ts="";function Ci(o,c){_o[Co++]=Vu,_o[Co++]=$u,$u=o,Vu=c}function Lx(o,c,h){Jr[Zr++]=es,Jr[Zr++]=ts,Jr[Zr++]=_i,_i=o;var g=es;o=ts;var w=32-xn(g)-1;g&=~(1<<w),h+=1;var _=32-xn(c)+w;if(30<_){var B=w-w%5;_=(g&(1<<B)-1).toString(32),g>>=B,w-=B,es=1<<32-xn(c)+w|h<<w|g,ts=_+o}else es=1<<_|h<<w|g,ts=o}function Of(o){o.return!==null&&(Ci(o,1),Lx(o,1,0))}function Lf(o){for(;o===$u;)$u=_o[--Co],_o[Co]=null,Vu=_o[--Co],_o[Co]=null;for(;o===_i;)_i=Jr[--Zr],Jr[Zr]=null,ts=Jr[--Zr],Jr[Zr]=null,es=Jr[--Zr],Jr[Zr]=null}var Br=null,Ur=null,tn=!1,ya=null;function Fx(o,c){var h=ra(5,null,null,0);h.elementType="DELETED",h.stateNode=c,h.return=o,c=o.deletions,c===null?(o.deletions=[h],o.flags|=16):c.push(h)}function Mx(o,c){switch(o.tag){case 5:var h=o.type;return c=c.nodeType!==1||h.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(o.stateNode=c,Br=o,Ur=Fs(c.firstChild),!0):!1;case 6:return c=o.pendingProps===""||c.nodeType!==3?null:c,c!==null?(o.stateNode=c,Br=o,Ur=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(h=_i!==null?{id:es,overflow:ts}:null,o.memoizedState={dehydrated:c,treeContext:h,retryLane:1073741824},h=ra(18,null,null,0),h.stateNode=c,h.return=o,o.child=h,Br=o,Ur=null,!0):!1;default:return!1}}function Ff(o){return(o.mode&1)!==0&&(o.flags&128)===0}function Mf(o){if(tn){var c=Ur;if(c){var h=c;if(!Mx(o,c)){if(Ff(o))throw Error(n(418));c=Fs(h.nextSibling);var g=Br;c&&Mx(o,c)?Fx(g,h):(o.flags=o.flags&-4097|2,tn=!1,Br=o)}}else{if(Ff(o))throw Error(n(418));o.flags=o.flags&-4097|2,tn=!1,Br=o}}}function Bx(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;Br=o}function qu(o){if(o!==Br)return!1;if(!tn)return Bx(o),tn=!0,!1;var c;if((c=o.tag!==3)&&!(c=o.tag!==5)&&(c=o.type,c=c!=="head"&&c!=="body"&&!Af(o.type,o.memoizedProps)),c&&(c=Ur)){if(Ff(o))throw Ux(),Error(n(418));for(;c;)Fx(o,c),c=Fs(c.nextSibling)}if(Bx(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(n(317));e:{for(o=o.nextSibling,c=0;o;){if(o.nodeType===8){var h=o.data;if(h==="/$"){if(c===0){Ur=Fs(o.nextSibling);break e}c--}else h!=="$"&&h!=="$!"&&h!=="$?"||c++}o=o.nextSibling}Ur=null}}else Ur=Br?Fs(o.stateNode.nextSibling):null;return!0}function Ux(){for(var o=Ur;o;)o=Fs(o.nextSibling)}function No(){Ur=Br=null,tn=!1}function Bf(o){ya===null?ya=[o]:ya.push(o)}var jN=b.ReactCurrentBatchConfig;function Hl(o,c,h){if(o=h.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(n(309));var g=h.stateNode}if(!g)throw Error(n(147,o));var w=g,_=""+o;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===_?c.ref:(c=function(B){var le=w.refs;B===null?delete le[_]:le[_]=B},c._stringRef=_,c)}if(typeof o!="string")throw Error(n(284));if(!h._owner)throw Error(n(290,o))}return o}function Ku(o,c){throw o=Object.prototype.toString.call(c),Error(n(31,o==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":o))}function zx(o){var c=o._init;return c(o._payload)}function Wx(o){function c(ke,ve){if(o){var Se=ke.deletions;Se===null?(ke.deletions=[ve],ke.flags|=16):Se.push(ve)}}function h(ke,ve){if(!o)return null;for(;ve!==null;)c(ke,ve),ve=ve.sibling;return null}function g(ke,ve){for(ke=new Map;ve!==null;)ve.key!==null?ke.set(ve.key,ve):ke.set(ve.index,ve),ve=ve.sibling;return ke}function w(ke,ve){return ke=Ks(ke,ve),ke.index=0,ke.sibling=null,ke}function _(ke,ve,Se){return ke.index=Se,o?(Se=ke.alternate,Se!==null?(Se=Se.index,Se<ve?(ke.flags|=2,ve):Se):(ke.flags|=2,ve)):(ke.flags|=1048576,ve)}function B(ke){return o&&ke.alternate===null&&(ke.flags|=2),ke}function le(ke,ve,Se,We){return ve===null||ve.tag!==6?(ve=j0(Se,ke.mode,We),ve.return=ke,ve):(ve=w(ve,Se),ve.return=ke,ve)}function pe(ke,ve,Se,We){var tt=Se.type;return tt===R?Oe(ke,ve,Se.props.children,We,Se.key):ve!==null&&(ve.elementType===tt||typeof tt=="object"&&tt!==null&&tt.$$typeof===ue&&zx(tt)===ve.type)?(We=w(ve,Se.props),We.ref=Hl(ke,ve,Se),We.return=ke,We):(We=vd(Se.type,Se.key,Se.props,null,ke.mode,We),We.ref=Hl(ke,ve,Se),We.return=ke,We)}function be(ke,ve,Se,We){return ve===null||ve.tag!==4||ve.stateNode.containerInfo!==Se.containerInfo||ve.stateNode.implementation!==Se.implementation?(ve=R0(Se,ke.mode,We),ve.return=ke,ve):(ve=w(ve,Se.children||[]),ve.return=ke,ve)}function Oe(ke,ve,Se,We,tt){return ve===null||ve.tag!==7?(ve=Ii(Se,ke.mode,We,tt),ve.return=ke,ve):(ve=w(ve,Se),ve.return=ke,ve)}function Be(ke,ve,Se){if(typeof ve=="string"&&ve!==""||typeof ve=="number")return ve=j0(""+ve,ke.mode,Se),ve.return=ke,ve;if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case H:return Se=vd(ve.type,ve.key,ve.props,null,ke.mode,Se),Se.ref=Hl(ke,null,ve),Se.return=ke,Se;case L:return ve=R0(ve,ke.mode,Se),ve.return=ke,ve;case ue:var We=ve._init;return Be(ke,We(ve._payload),Se)}if(ee(ve)||j(ve))return ve=Ii(ve,ke.mode,Se,null),ve.return=ke,ve;Ku(ke,ve)}return null}function De(ke,ve,Se,We){var tt=ve!==null?ve.key:null;if(typeof Se=="string"&&Se!==""||typeof Se=="number")return tt!==null?null:le(ke,ve,""+Se,We);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case H:return Se.key===tt?pe(ke,ve,Se,We):null;case L:return Se.key===tt?be(ke,ve,Se,We):null;case ue:return tt=Se._init,De(ke,ve,tt(Se._payload),We)}if(ee(Se)||j(Se))return tt!==null?null:Oe(ke,ve,Se,We,null);Ku(ke,Se)}return null}function Ke(ke,ve,Se,We,tt){if(typeof We=="string"&&We!==""||typeof We=="number")return ke=ke.get(Se)||null,le(ve,ke,""+We,tt);if(typeof We=="object"&&We!==null){switch(We.$$typeof){case H:return ke=ke.get(We.key===null?Se:We.key)||null,pe(ve,ke,We,tt);case L:return ke=ke.get(We.key===null?Se:We.key)||null,be(ve,ke,We,tt);case ue:var rt=We._init;return Ke(ke,ve,Se,rt(We._payload),tt)}if(ee(We)||j(We))return ke=ke.get(Se)||null,Oe(ve,ke,We,tt,null);Ku(ve,We)}return null}function Qe(ke,ve,Se,We){for(var tt=null,rt=null,at=ve,ut=ve=0,Un=null;at!==null&&ut<Se.length;ut++){at.index>ut?(Un=at,at=null):Un=at.sibling;var bt=De(ke,at,Se[ut],We);if(bt===null){at===null&&(at=Un);break}o&&at&&bt.alternate===null&&c(ke,at),ve=_(bt,ve,ut),rt===null?tt=bt:rt.sibling=bt,rt=bt,at=Un}if(ut===Se.length)return h(ke,at),tn&&Ci(ke,ut),tt;if(at===null){for(;ut<Se.length;ut++)at=Be(ke,Se[ut],We),at!==null&&(ve=_(at,ve,ut),rt===null?tt=at:rt.sibling=at,rt=at);return tn&&Ci(ke,ut),tt}for(at=g(ke,at);ut<Se.length;ut++)Un=Ke(at,ke,ut,Se[ut],We),Un!==null&&(o&&Un.alternate!==null&&at.delete(Un.key===null?ut:Un.key),ve=_(Un,ve,ut),rt===null?tt=Un:rt.sibling=Un,rt=Un);return o&&at.forEach(function(Ys){return c(ke,Ys)}),tn&&Ci(ke,ut),tt}function Ze(ke,ve,Se,We){var tt=j(Se);if(typeof tt!="function")throw Error(n(150));if(Se=tt.call(Se),Se==null)throw Error(n(151));for(var rt=tt=null,at=ve,ut=ve=0,Un=null,bt=Se.next();at!==null&&!bt.done;ut++,bt=Se.next()){at.index>ut?(Un=at,at=null):Un=at.sibling;var Ys=De(ke,at,bt.value,We);if(Ys===null){at===null&&(at=Un);break}o&&at&&Ys.alternate===null&&c(ke,at),ve=_(Ys,ve,ut),rt===null?tt=Ys:rt.sibling=Ys,rt=Ys,at=Un}if(bt.done)return h(ke,at),tn&&Ci(ke,ut),tt;if(at===null){for(;!bt.done;ut++,bt=Se.next())bt=Be(ke,bt.value,We),bt!==null&&(ve=_(bt,ve,ut),rt===null?tt=bt:rt.sibling=bt,rt=bt);return tn&&Ci(ke,ut),tt}for(at=g(ke,at);!bt.done;ut++,bt=Se.next())bt=Ke(at,ke,ut,bt.value,We),bt!==null&&(o&&bt.alternate!==null&&at.delete(bt.key===null?ut:bt.key),ve=_(bt,ve,ut),rt===null?tt=bt:rt.sibling=bt,rt=bt);return o&&at.forEach(function(cE){return c(ke,cE)}),tn&&Ci(ke,ut),tt}function vn(ke,ve,Se,We){if(typeof Se=="object"&&Se!==null&&Se.type===R&&Se.key===null&&(Se=Se.props.children),typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case H:e:{for(var tt=Se.key,rt=ve;rt!==null;){if(rt.key===tt){if(tt=Se.type,tt===R){if(rt.tag===7){h(ke,rt.sibling),ve=w(rt,Se.props.children),ve.return=ke,ke=ve;break e}}else if(rt.elementType===tt||typeof tt=="object"&&tt!==null&&tt.$$typeof===ue&&zx(tt)===rt.type){h(ke,rt.sibling),ve=w(rt,Se.props),ve.ref=Hl(ke,rt,Se),ve.return=ke,ke=ve;break e}h(ke,rt);break}else c(ke,rt);rt=rt.sibling}Se.type===R?(ve=Ii(Se.props.children,ke.mode,We,Se.key),ve.return=ke,ke=ve):(We=vd(Se.type,Se.key,Se.props,null,ke.mode,We),We.ref=Hl(ke,ve,Se),We.return=ke,ke=We)}return B(ke);case L:e:{for(rt=Se.key;ve!==null;){if(ve.key===rt)if(ve.tag===4&&ve.stateNode.containerInfo===Se.containerInfo&&ve.stateNode.implementation===Se.implementation){h(ke,ve.sibling),ve=w(ve,Se.children||[]),ve.return=ke,ke=ve;break e}else{h(ke,ve);break}else c(ke,ve);ve=ve.sibling}ve=R0(Se,ke.mode,We),ve.return=ke,ke=ve}return B(ke);case ue:return rt=Se._init,vn(ke,ve,rt(Se._payload),We)}if(ee(Se))return Qe(ke,ve,Se,We);if(j(Se))return Ze(ke,ve,Se,We);Ku(ke,Se)}return typeof Se=="string"&&Se!==""||typeof Se=="number"?(Se=""+Se,ve!==null&&ve.tag===6?(h(ke,ve.sibling),ve=w(ve,Se),ve.return=ke,ke=ve):(h(ke,ve),ve=j0(Se,ke.mode,We),ve.return=ke,ke=ve),B(ke)):h(ke,ve)}return vn}var Eo=Wx(!0),Hx=Wx(!1),Yu=Ms(null),Xu=null,To=null,Uf=null;function zf(){Uf=To=Xu=null}function Wf(o){var c=Yu.current;Yt(Yu),o._currentValue=c}function Hf(o,c,h){for(;o!==null;){var g=o.alternate;if((o.childLanes&c)!==c?(o.childLanes|=c,g!==null&&(g.childLanes|=c)):g!==null&&(g.childLanes&c)!==c&&(g.childLanes|=c),o===h)break;o=o.return}}function bo(o,c){Xu=o,Uf=To=null,o=o.dependencies,o!==null&&o.firstContext!==null&&((o.lanes&c)!==0&&(Nr=!0),o.firstContext=null)}function ea(o){var c=o._currentValue;if(Uf!==o)if(o={context:o,memoizedValue:c,next:null},To===null){if(Xu===null)throw Error(n(308));To=o,Xu.dependencies={lanes:0,firstContext:o}}else To=To.next=o;return c}var Ni=null;function Gf(o){Ni===null?Ni=[o]:Ni.push(o)}function Gx(o,c,h,g){var w=c.interleaved;return w===null?(h.next=h,Gf(c)):(h.next=w.next,w.next=h),c.interleaved=h,ns(o,g)}function ns(o,c){o.lanes|=c;var h=o.alternate;for(h!==null&&(h.lanes|=c),h=o,o=o.return;o!==null;)o.childLanes|=c,h=o.alternate,h!==null&&(h.childLanes|=c),h=o,o=o.return;return h.tag===3?h.stateNode:null}var zs=!1;function $f(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $x(o,c){o=o.updateQueue,c.updateQueue===o&&(c.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function rs(o,c){return{eventTime:o,lane:c,tag:0,payload:null,callback:null,next:null}}function Ws(o,c,h){var g=o.updateQueue;if(g===null)return null;if(g=g.shared,(Nt&2)!==0){var w=g.pending;return w===null?c.next=c:(c.next=w.next,w.next=c),g.pending=c,ns(o,h)}return w=g.interleaved,w===null?(c.next=c,Gf(g)):(c.next=w.next,w.next=c),g.interleaved=c,ns(o,h)}function Qu(o,c,h){if(c=c.updateQueue,c!==null&&(c=c.shared,(h&4194240)!==0)){var g=c.lanes;g&=o.pendingLanes,h|=g,c.lanes=h,af(o,h)}}function Vx(o,c){var h=o.updateQueue,g=o.alternate;if(g!==null&&(g=g.updateQueue,h===g)){var w=null,_=null;if(h=h.firstBaseUpdate,h!==null){do{var B={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};_===null?w=_=B:_=_.next=B,h=h.next}while(h!==null);_===null?w=_=c:_=_.next=c}else w=_=c;h={baseState:g.baseState,firstBaseUpdate:w,lastBaseUpdate:_,shared:g.shared,effects:g.effects},o.updateQueue=h;return}o=h.lastBaseUpdate,o===null?h.firstBaseUpdate=c:o.next=c,h.lastBaseUpdate=c}function Ju(o,c,h,g){var w=o.updateQueue;zs=!1;var _=w.firstBaseUpdate,B=w.lastBaseUpdate,le=w.shared.pending;if(le!==null){w.shared.pending=null;var pe=le,be=pe.next;pe.next=null,B===null?_=be:B.next=be,B=pe;var Oe=o.alternate;Oe!==null&&(Oe=Oe.updateQueue,le=Oe.lastBaseUpdate,le!==B&&(le===null?Oe.firstBaseUpdate=be:le.next=be,Oe.lastBaseUpdate=pe))}if(_!==null){var Be=w.baseState;B=0,Oe=be=pe=null,le=_;do{var De=le.lane,Ke=le.eventTime;if((g&De)===De){Oe!==null&&(Oe=Oe.next={eventTime:Ke,lane:0,tag:le.tag,payload:le.payload,callback:le.callback,next:null});e:{var Qe=o,Ze=le;switch(De=c,Ke=h,Ze.tag){case 1:if(Qe=Ze.payload,typeof Qe=="function"){Be=Qe.call(Ke,Be,De);break e}Be=Qe;break e;case 3:Qe.flags=Qe.flags&-65537|128;case 0:if(Qe=Ze.payload,De=typeof Qe=="function"?Qe.call(Ke,Be,De):Qe,De==null)break e;Be=F({},Be,De);break e;case 2:zs=!0}}le.callback!==null&&le.lane!==0&&(o.flags|=64,De=w.effects,De===null?w.effects=[le]:De.push(le))}else Ke={eventTime:Ke,lane:De,tag:le.tag,payload:le.payload,callback:le.callback,next:null},Oe===null?(be=Oe=Ke,pe=Be):Oe=Oe.next=Ke,B|=De;if(le=le.next,le===null){if(le=w.shared.pending,le===null)break;De=le,le=De.next,De.next=null,w.lastBaseUpdate=De,w.shared.pending=null}}while(!0);if(Oe===null&&(pe=Be),w.baseState=pe,w.firstBaseUpdate=be,w.lastBaseUpdate=Oe,c=w.shared.interleaved,c!==null){w=c;do B|=w.lane,w=w.next;while(w!==c)}else _===null&&(w.shared.lanes=0);bi|=B,o.lanes=B,o.memoizedState=Be}}function qx(o,c,h){if(o=c.effects,c.effects=null,o!==null)for(c=0;c<o.length;c++){var g=o[c],w=g.callback;if(w!==null){if(g.callback=null,g=h,typeof w!="function")throw Error(n(191,w));w.call(g)}}}var Gl={},Ba=Ms(Gl),$l=Ms(Gl),Vl=Ms(Gl);function Ei(o){if(o===Gl)throw Error(n(174));return o}function Vf(o,c){switch(Gt(Vl,c),Gt($l,o),Gt(Ba,Gl),o=c.nodeType,o){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:gr(null,"");break;default:o=o===8?c.parentNode:c,c=o.namespaceURI||null,o=o.tagName,c=gr(c,o)}Yt(Ba),Gt(Ba,c)}function Ao(){Yt(Ba),Yt($l),Yt(Vl)}function Kx(o){Ei(Vl.current);var c=Ei(Ba.current),h=gr(c,o.type);c!==h&&(Gt($l,o),Gt(Ba,h))}function qf(o){$l.current===o&&(Yt(Ba),Yt($l))}var an=Ms(0);function Zu(o){for(var c=o;c!==null;){if(c.tag===13){var h=c.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var Kf=[];function Yf(){for(var o=0;o<Kf.length;o++)Kf[o]._workInProgressVersionPrimary=null;Kf.length=0}var ed=b.ReactCurrentDispatcher,Xf=b.ReactCurrentBatchConfig,Ti=0,sn=null,An=null,Mn=null,td=!1,ql=!1,Kl=0,RN=0;function rr(){throw Error(n(321))}function Qf(o,c){if(c===null)return!1;for(var h=0;h<c.length&&h<o.length;h++)if(!va(o[h],c[h]))return!1;return!0}function Jf(o,c,h,g,w,_){if(Ti=_,sn=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,ed.current=o===null||o.memoizedState===null?ON:LN,o=h(g,w),ql){_=0;do{if(ql=!1,Kl=0,25<=_)throw Error(n(301));_+=1,Mn=An=null,c.updateQueue=null,ed.current=FN,o=h(g,w)}while(ql)}if(ed.current=ad,c=An!==null&&An.next!==null,Ti=0,Mn=An=sn=null,td=!1,c)throw Error(n(300));return o}function Zf(){var o=Kl!==0;return Kl=0,o}function Ua(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mn===null?sn.memoizedState=Mn=o:Mn=Mn.next=o,Mn}function ta(){if(An===null){var o=sn.alternate;o=o!==null?o.memoizedState:null}else o=An.next;var c=Mn===null?sn.memoizedState:Mn.next;if(c!==null)Mn=c,An=o;else{if(o===null)throw Error(n(310));An=o,o={memoizedState:An.memoizedState,baseState:An.baseState,baseQueue:An.baseQueue,queue:An.queue,next:null},Mn===null?sn.memoizedState=Mn=o:Mn=Mn.next=o}return Mn}function Yl(o,c){return typeof c=="function"?c(o):c}function e0(o){var c=ta(),h=c.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=o;var g=An,w=g.baseQueue,_=h.pending;if(_!==null){if(w!==null){var B=w.next;w.next=_.next,_.next=B}g.baseQueue=w=_,h.pending=null}if(w!==null){_=w.next,g=g.baseState;var le=B=null,pe=null,be=_;do{var Oe=be.lane;if((Ti&Oe)===Oe)pe!==null&&(pe=pe.next={lane:0,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null}),g=be.hasEagerState?be.eagerState:o(g,be.action);else{var Be={lane:Oe,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null};pe===null?(le=pe=Be,B=g):pe=pe.next=Be,sn.lanes|=Oe,bi|=Oe}be=be.next}while(be!==null&&be!==_);pe===null?B=g:pe.next=le,va(g,c.memoizedState)||(Nr=!0),c.memoizedState=g,c.baseState=B,c.baseQueue=pe,h.lastRenderedState=g}if(o=h.interleaved,o!==null){w=o;do _=w.lane,sn.lanes|=_,bi|=_,w=w.next;while(w!==o)}else w===null&&(h.lanes=0);return[c.memoizedState,h.dispatch]}function t0(o){var c=ta(),h=c.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=o;var g=h.dispatch,w=h.pending,_=c.memoizedState;if(w!==null){h.pending=null;var B=w=w.next;do _=o(_,B.action),B=B.next;while(B!==w);va(_,c.memoizedState)||(Nr=!0),c.memoizedState=_,c.baseQueue===null&&(c.baseState=_),h.lastRenderedState=_}return[_,g]}function Yx(){}function Xx(o,c){var h=sn,g=ta(),w=c(),_=!va(g.memoizedState,w);if(_&&(g.memoizedState=w,Nr=!0),g=g.queue,n0(Zx.bind(null,h,g,o),[o]),g.getSnapshot!==c||_||Mn!==null&&Mn.memoizedState.tag&1){if(h.flags|=2048,Xl(9,Jx.bind(null,h,g,w,c),void 0,null),Bn===null)throw Error(n(349));(Ti&30)!==0||Qx(h,c,w)}return w}function Qx(o,c,h){o.flags|=16384,o={getSnapshot:c,value:h},c=sn.updateQueue,c===null?(c={lastEffect:null,stores:null},sn.updateQueue=c,c.stores=[o]):(h=c.stores,h===null?c.stores=[o]:h.push(o))}function Jx(o,c,h,g){c.value=h,c.getSnapshot=g,ev(c)&&tv(o)}function Zx(o,c,h){return h(function(){ev(c)&&tv(o)})}function ev(o){var c=o.getSnapshot;o=o.value;try{var h=c();return!va(o,h)}catch{return!0}}function tv(o){var c=ns(o,1);c!==null&&_a(c,o,1,-1)}function nv(o){var c=Ua();return typeof o=="function"&&(o=o()),c.memoizedState=c.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Yl,lastRenderedState:o},c.queue=o,o=o.dispatch=DN.bind(null,sn,o),[c.memoizedState,o]}function Xl(o,c,h,g){return o={tag:o,create:c,destroy:h,deps:g,next:null},c=sn.updateQueue,c===null?(c={lastEffect:null,stores:null},sn.updateQueue=c,c.lastEffect=o.next=o):(h=c.lastEffect,h===null?c.lastEffect=o.next=o:(g=h.next,h.next=o,o.next=g,c.lastEffect=o)),o}function rv(){return ta().memoizedState}function nd(o,c,h,g){var w=Ua();sn.flags|=o,w.memoizedState=Xl(1|c,h,void 0,g===void 0?null:g)}function rd(o,c,h,g){var w=ta();g=g===void 0?null:g;var _=void 0;if(An!==null){var B=An.memoizedState;if(_=B.destroy,g!==null&&Qf(g,B.deps)){w.memoizedState=Xl(c,h,_,g);return}}sn.flags|=o,w.memoizedState=Xl(1|c,h,_,g)}function av(o,c){return nd(8390656,8,o,c)}function n0(o,c){return rd(2048,8,o,c)}function sv(o,c){return rd(4,2,o,c)}function iv(o,c){return rd(4,4,o,c)}function ov(o,c){if(typeof c=="function")return o=o(),c(o),function(){c(null)};if(c!=null)return o=o(),c.current=o,function(){c.current=null}}function lv(o,c,h){return h=h!=null?h.concat([o]):null,rd(4,4,ov.bind(null,c,o),h)}function r0(){}function cv(o,c){var h=ta();c=c===void 0?null:c;var g=h.memoizedState;return g!==null&&c!==null&&Qf(c,g[1])?g[0]:(h.memoizedState=[o,c],o)}function uv(o,c){var h=ta();c=c===void 0?null:c;var g=h.memoizedState;return g!==null&&c!==null&&Qf(c,g[1])?g[0]:(o=o(),h.memoizedState=[o,c],o)}function dv(o,c,h){return(Ti&21)===0?(o.baseState&&(o.baseState=!1,Nr=!0),o.memoizedState=h):(va(h,c)||(h=zg(),sn.lanes|=h,bi|=h,o.baseState=!0),c)}function IN(o,c){var h=Pt;Pt=h!==0&&4>h?h:4,o(!0);var g=Xf.transition;Xf.transition={};try{o(!1),c()}finally{Pt=h,Xf.transition=g}}function hv(){return ta().memoizedState}function PN(o,c,h){var g=Vs(o);if(h={lane:g,action:h,hasEagerState:!1,eagerState:null,next:null},fv(o))mv(c,h);else if(h=Gx(o,c,h,g),h!==null){var w=vr();_a(h,o,g,w),pv(h,c,g)}}function DN(o,c,h){var g=Vs(o),w={lane:g,action:h,hasEagerState:!1,eagerState:null,next:null};if(fv(o))mv(c,w);else{var _=o.alternate;if(o.lanes===0&&(_===null||_.lanes===0)&&(_=c.lastRenderedReducer,_!==null))try{var B=c.lastRenderedState,le=_(B,h);if(w.hasEagerState=!0,w.eagerState=le,va(le,B)){var pe=c.interleaved;pe===null?(w.next=w,Gf(c)):(w.next=pe.next,pe.next=w),c.interleaved=w;return}}catch{}finally{}h=Gx(o,c,w,g),h!==null&&(w=vr(),_a(h,o,g,w),pv(h,c,g))}}function fv(o){var c=o.alternate;return o===sn||c!==null&&c===sn}function mv(o,c){ql=td=!0;var h=o.pending;h===null?c.next=c:(c.next=h.next,h.next=c),o.pending=c}function pv(o,c,h){if((h&4194240)!==0){var g=c.lanes;g&=o.pendingLanes,h|=g,c.lanes=h,af(o,h)}}var ad={readContext:ea,useCallback:rr,useContext:rr,useEffect:rr,useImperativeHandle:rr,useInsertionEffect:rr,useLayoutEffect:rr,useMemo:rr,useReducer:rr,useRef:rr,useState:rr,useDebugValue:rr,useDeferredValue:rr,useTransition:rr,useMutableSource:rr,useSyncExternalStore:rr,useId:rr,unstable_isNewReconciler:!1},ON={readContext:ea,useCallback:function(o,c){return Ua().memoizedState=[o,c===void 0?null:c],o},useContext:ea,useEffect:av,useImperativeHandle:function(o,c,h){return h=h!=null?h.concat([o]):null,nd(4194308,4,ov.bind(null,c,o),h)},useLayoutEffect:function(o,c){return nd(4194308,4,o,c)},useInsertionEffect:function(o,c){return nd(4,2,o,c)},useMemo:function(o,c){var h=Ua();return c=c===void 0?null:c,o=o(),h.memoizedState=[o,c],o},useReducer:function(o,c,h){var g=Ua();return c=h!==void 0?h(c):c,g.memoizedState=g.baseState=c,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:c},g.queue=o,o=o.dispatch=PN.bind(null,sn,o),[g.memoizedState,o]},useRef:function(o){var c=Ua();return o={current:o},c.memoizedState=o},useState:nv,useDebugValue:r0,useDeferredValue:function(o){return Ua().memoizedState=o},useTransition:function(){var o=nv(!1),c=o[0];return o=IN.bind(null,o[1]),Ua().memoizedState=o,[c,o]},useMutableSource:function(){},useSyncExternalStore:function(o,c,h){var g=sn,w=Ua();if(tn){if(h===void 0)throw Error(n(407));h=h()}else{if(h=c(),Bn===null)throw Error(n(349));(Ti&30)!==0||Qx(g,c,h)}w.memoizedState=h;var _={value:h,getSnapshot:c};return w.queue=_,av(Zx.bind(null,g,_,o),[o]),g.flags|=2048,Xl(9,Jx.bind(null,g,_,h,c),void 0,null),h},useId:function(){var o=Ua(),c=Bn.identifierPrefix;if(tn){var h=ts,g=es;h=(g&~(1<<32-xn(g)-1)).toString(32)+h,c=":"+c+"R"+h,h=Kl++,0<h&&(c+="H"+h.toString(32)),c+=":"}else h=RN++,c=":"+c+"r"+h.toString(32)+":";return o.memoizedState=c},unstable_isNewReconciler:!1},LN={readContext:ea,useCallback:cv,useContext:ea,useEffect:n0,useImperativeHandle:lv,useInsertionEffect:sv,useLayoutEffect:iv,useMemo:uv,useReducer:e0,useRef:rv,useState:function(){return e0(Yl)},useDebugValue:r0,useDeferredValue:function(o){var c=ta();return dv(c,An.memoizedState,o)},useTransition:function(){var o=e0(Yl)[0],c=ta().memoizedState;return[o,c]},useMutableSource:Yx,useSyncExternalStore:Xx,useId:hv,unstable_isNewReconciler:!1},FN={readContext:ea,useCallback:cv,useContext:ea,useEffect:n0,useImperativeHandle:lv,useInsertionEffect:sv,useLayoutEffect:iv,useMemo:uv,useReducer:t0,useRef:rv,useState:function(){return t0(Yl)},useDebugValue:r0,useDeferredValue:function(o){var c=ta();return An===null?c.memoizedState=o:dv(c,An.memoizedState,o)},useTransition:function(){var o=t0(Yl)[0],c=ta().memoizedState;return[o,c]},useMutableSource:Yx,useSyncExternalStore:Xx,useId:hv,unstable_isNewReconciler:!1};function ka(o,c){if(o&&o.defaultProps){c=F({},c),o=o.defaultProps;for(var h in o)c[h]===void 0&&(c[h]=o[h]);return c}return c}function a0(o,c,h,g){c=o.memoizedState,h=h(g,c),h=h==null?c:F({},c,h),o.memoizedState=h,o.lanes===0&&(o.updateQueue.baseState=h)}var sd={isMounted:function(o){return(o=o._reactInternals)?ie(o)===o:!1},enqueueSetState:function(o,c,h){o=o._reactInternals;var g=vr(),w=Vs(o),_=rs(g,w);_.payload=c,h!=null&&(_.callback=h),c=Ws(o,_,w),c!==null&&(_a(c,o,w,g),Qu(c,o,w))},enqueueReplaceState:function(o,c,h){o=o._reactInternals;var g=vr(),w=Vs(o),_=rs(g,w);_.tag=1,_.payload=c,h!=null&&(_.callback=h),c=Ws(o,_,w),c!==null&&(_a(c,o,w,g),Qu(c,o,w))},enqueueForceUpdate:function(o,c){o=o._reactInternals;var h=vr(),g=Vs(o),w=rs(h,g);w.tag=2,c!=null&&(w.callback=c),c=Ws(o,w,g),c!==null&&(_a(c,o,g,h),Qu(c,o,g))}};function gv(o,c,h,g,w,_,B){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(g,_,B):c.prototype&&c.prototype.isPureReactComponent?!Ll(h,g)||!Ll(w,_):!0}function xv(o,c,h){var g=!1,w=Bs,_=c.contextType;return typeof _=="object"&&_!==null?_=ea(_):(w=Cr(c)?Si:nr.current,g=c.contextTypes,_=(g=g!=null)?So(o,w):Bs),c=new c(h,_),o.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=sd,o.stateNode=c,c._reactInternals=o,g&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=w,o.__reactInternalMemoizedMaskedChildContext=_),c}function vv(o,c,h,g){o=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(h,g),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(h,g),c.state!==o&&sd.enqueueReplaceState(c,c.state,null)}function s0(o,c,h,g){var w=o.stateNode;w.props=h,w.state=o.memoizedState,w.refs={},$f(o);var _=c.contextType;typeof _=="object"&&_!==null?w.context=ea(_):(_=Cr(c)?Si:nr.current,w.context=So(o,_)),w.state=o.memoizedState,_=c.getDerivedStateFromProps,typeof _=="function"&&(a0(o,c,_,h),w.state=o.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(c=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),c!==w.state&&sd.enqueueReplaceState(w,w.state,null),Ju(o,h,w,g),w.state=o.memoizedState),typeof w.componentDidMount=="function"&&(o.flags|=4194308)}function jo(o,c){try{var h="",g=c;do h+=P(g),g=g.return;while(g);var w=h}catch(_){w=`
Error generating stack: `+_.message+`
`+_.stack}return{value:o,source:c,stack:w,digest:null}}function i0(o,c,h){return{value:o,source:null,stack:h??null,digest:c??null}}function o0(o,c){try{console.error(c.value)}catch(h){setTimeout(function(){throw h})}}var MN=typeof WeakMap=="function"?WeakMap:Map;function yv(o,c,h){h=rs(-1,h),h.tag=3,h.payload={element:null};var g=c.value;return h.callback=function(){hd||(hd=!0,S0=g),o0(o,c)},h}function kv(o,c,h){h=rs(-1,h),h.tag=3;var g=o.type.getDerivedStateFromError;if(typeof g=="function"){var w=c.value;h.payload=function(){return g(w)},h.callback=function(){o0(o,c)}}var _=o.stateNode;return _!==null&&typeof _.componentDidCatch=="function"&&(h.callback=function(){o0(o,c),typeof g!="function"&&(Gs===null?Gs=new Set([this]):Gs.add(this));var B=c.stack;this.componentDidCatch(c.value,{componentStack:B!==null?B:""})}),h}function wv(o,c,h){var g=o.pingCache;if(g===null){g=o.pingCache=new MN;var w=new Set;g.set(c,w)}else w=g.get(c),w===void 0&&(w=new Set,g.set(c,w));w.has(h)||(w.add(h),o=JN.bind(null,o,c,h),c.then(o,o))}function Sv(o){do{var c;if((c=o.tag===13)&&(c=o.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return o;o=o.return}while(o!==null);return null}function _v(o,c,h,g,w){return(o.mode&1)===0?(o===c?o.flags|=65536:(o.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(c=rs(-1,1),c.tag=2,Ws(h,c,1))),h.lanes|=1),o):(o.flags|=65536,o.lanes=w,o)}var BN=b.ReactCurrentOwner,Nr=!1;function xr(o,c,h,g){c.child=o===null?Hx(c,null,h,g):Eo(c,o.child,h,g)}function Cv(o,c,h,g,w){h=h.render;var _=c.ref;return bo(c,w),g=Jf(o,c,h,g,_,w),h=Zf(),o!==null&&!Nr?(c.updateQueue=o.updateQueue,c.flags&=-2053,o.lanes&=~w,as(o,c,w)):(tn&&h&&Of(c),c.flags|=1,xr(o,c,g,w),c.child)}function Nv(o,c,h,g,w){if(o===null){var _=h.type;return typeof _=="function"&&!A0(_)&&_.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(c.tag=15,c.type=_,Ev(o,c,_,g,w)):(o=vd(h.type,null,g,c,c.mode,w),o.ref=c.ref,o.return=c,c.child=o)}if(_=o.child,(o.lanes&w)===0){var B=_.memoizedProps;if(h=h.compare,h=h!==null?h:Ll,h(B,g)&&o.ref===c.ref)return as(o,c,w)}return c.flags|=1,o=Ks(_,g),o.ref=c.ref,o.return=c,c.child=o}function Ev(o,c,h,g,w){if(o!==null){var _=o.memoizedProps;if(Ll(_,g)&&o.ref===c.ref)if(Nr=!1,c.pendingProps=g=_,(o.lanes&w)!==0)(o.flags&131072)!==0&&(Nr=!0);else return c.lanes=o.lanes,as(o,c,w)}return l0(o,c,h,g,w)}function Tv(o,c,h){var g=c.pendingProps,w=g.children,_=o!==null?o.memoizedState:null;if(g.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},Gt(Io,zr),zr|=h;else{if((h&1073741824)===0)return o=_!==null?_.baseLanes|h:h,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:o,cachePool:null,transitions:null},c.updateQueue=null,Gt(Io,zr),zr|=o,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=_!==null?_.baseLanes:h,Gt(Io,zr),zr|=g}else _!==null?(g=_.baseLanes|h,c.memoizedState=null):g=h,Gt(Io,zr),zr|=g;return xr(o,c,w,h),c.child}function bv(o,c){var h=c.ref;(o===null&&h!==null||o!==null&&o.ref!==h)&&(c.flags|=512,c.flags|=2097152)}function l0(o,c,h,g,w){var _=Cr(h)?Si:nr.current;return _=So(c,_),bo(c,w),h=Jf(o,c,h,g,_,w),g=Zf(),o!==null&&!Nr?(c.updateQueue=o.updateQueue,c.flags&=-2053,o.lanes&=~w,as(o,c,w)):(tn&&g&&Of(c),c.flags|=1,xr(o,c,h,w),c.child)}function Av(o,c,h,g,w){if(Cr(h)){var _=!0;Hu(c)}else _=!1;if(bo(c,w),c.stateNode===null)od(o,c),xv(c,h,g),s0(c,h,g,w),g=!0;else if(o===null){var B=c.stateNode,le=c.memoizedProps;B.props=le;var pe=B.context,be=h.contextType;typeof be=="object"&&be!==null?be=ea(be):(be=Cr(h)?Si:nr.current,be=So(c,be));var Oe=h.getDerivedStateFromProps,Be=typeof Oe=="function"||typeof B.getSnapshotBeforeUpdate=="function";Be||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(le!==g||pe!==be)&&vv(c,B,g,be),zs=!1;var De=c.memoizedState;B.state=De,Ju(c,g,B,w),pe=c.memoizedState,le!==g||De!==pe||_r.current||zs?(typeof Oe=="function"&&(a0(c,h,Oe,g),pe=c.memoizedState),(le=zs||gv(c,h,le,g,De,pe,be))?(Be||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount()),typeof B.componentDidMount=="function"&&(c.flags|=4194308)):(typeof B.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=g,c.memoizedState=pe),B.props=g,B.state=pe,B.context=be,g=le):(typeof B.componentDidMount=="function"&&(c.flags|=4194308),g=!1)}else{B=c.stateNode,$x(o,c),le=c.memoizedProps,be=c.type===c.elementType?le:ka(c.type,le),B.props=be,Be=c.pendingProps,De=B.context,pe=h.contextType,typeof pe=="object"&&pe!==null?pe=ea(pe):(pe=Cr(h)?Si:nr.current,pe=So(c,pe));var Ke=h.getDerivedStateFromProps;(Oe=typeof Ke=="function"||typeof B.getSnapshotBeforeUpdate=="function")||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(le!==Be||De!==pe)&&vv(c,B,g,pe),zs=!1,De=c.memoizedState,B.state=De,Ju(c,g,B,w);var Qe=c.memoizedState;le!==Be||De!==Qe||_r.current||zs?(typeof Ke=="function"&&(a0(c,h,Ke,g),Qe=c.memoizedState),(be=zs||gv(c,h,be,g,De,Qe,pe)||!1)?(Oe||typeof B.UNSAFE_componentWillUpdate!="function"&&typeof B.componentWillUpdate!="function"||(typeof B.componentWillUpdate=="function"&&B.componentWillUpdate(g,Qe,pe),typeof B.UNSAFE_componentWillUpdate=="function"&&B.UNSAFE_componentWillUpdate(g,Qe,pe)),typeof B.componentDidUpdate=="function"&&(c.flags|=4),typeof B.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof B.componentDidUpdate!="function"||le===o.memoizedProps&&De===o.memoizedState||(c.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||le===o.memoizedProps&&De===o.memoizedState||(c.flags|=1024),c.memoizedProps=g,c.memoizedState=Qe),B.props=g,B.state=Qe,B.context=pe,g=be):(typeof B.componentDidUpdate!="function"||le===o.memoizedProps&&De===o.memoizedState||(c.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||le===o.memoizedProps&&De===o.memoizedState||(c.flags|=1024),g=!1)}return c0(o,c,h,g,_,w)}function c0(o,c,h,g,w,_){bv(o,c);var B=(c.flags&128)!==0;if(!g&&!B)return w&&Dx(c,h,!1),as(o,c,_);g=c.stateNode,BN.current=c;var le=B&&typeof h.getDerivedStateFromError!="function"?null:g.render();return c.flags|=1,o!==null&&B?(c.child=Eo(c,o.child,null,_),c.child=Eo(c,null,le,_)):xr(o,c,le,_),c.memoizedState=g.state,w&&Dx(c,h,!0),c.child}function jv(o){var c=o.stateNode;c.pendingContext?Ix(o,c.pendingContext,c.pendingContext!==c.context):c.context&&Ix(o,c.context,!1),Vf(o,c.containerInfo)}function Rv(o,c,h,g,w){return No(),Bf(w),c.flags|=256,xr(o,c,h,g),c.child}var u0={dehydrated:null,treeContext:null,retryLane:0};function d0(o){return{baseLanes:o,cachePool:null,transitions:null}}function Iv(o,c,h){var g=c.pendingProps,w=an.current,_=!1,B=(c.flags&128)!==0,le;if((le=B)||(le=o!==null&&o.memoizedState===null?!1:(w&2)!==0),le?(_=!0,c.flags&=-129):(o===null||o.memoizedState!==null)&&(w|=1),Gt(an,w&1),o===null)return Mf(c),o=c.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?((c.mode&1)===0?c.lanes=1:o.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(B=g.children,o=g.fallback,_?(g=c.mode,_=c.child,B={mode:"hidden",children:B},(g&1)===0&&_!==null?(_.childLanes=0,_.pendingProps=B):_=yd(B,g,0,null),o=Ii(o,g,h,null),_.return=c,o.return=c,_.sibling=o,c.child=_,c.child.memoizedState=d0(h),c.memoizedState=u0,o):h0(c,B));if(w=o.memoizedState,w!==null&&(le=w.dehydrated,le!==null))return UN(o,c,B,g,le,w,h);if(_){_=g.fallback,B=c.mode,w=o.child,le=w.sibling;var pe={mode:"hidden",children:g.children};return(B&1)===0&&c.child!==w?(g=c.child,g.childLanes=0,g.pendingProps=pe,c.deletions=null):(g=Ks(w,pe),g.subtreeFlags=w.subtreeFlags&14680064),le!==null?_=Ks(le,_):(_=Ii(_,B,h,null),_.flags|=2),_.return=c,g.return=c,g.sibling=_,c.child=g,g=_,_=c.child,B=o.child.memoizedState,B=B===null?d0(h):{baseLanes:B.baseLanes|h,cachePool:null,transitions:B.transitions},_.memoizedState=B,_.childLanes=o.childLanes&~h,c.memoizedState=u0,g}return _=o.child,o=_.sibling,g=Ks(_,{mode:"visible",children:g.children}),(c.mode&1)===0&&(g.lanes=h),g.return=c,g.sibling=null,o!==null&&(h=c.deletions,h===null?(c.deletions=[o],c.flags|=16):h.push(o)),c.child=g,c.memoizedState=null,g}function h0(o,c){return c=yd({mode:"visible",children:c},o.mode,0,null),c.return=o,o.child=c}function id(o,c,h,g){return g!==null&&Bf(g),Eo(c,o.child,null,h),o=h0(c,c.pendingProps.children),o.flags|=2,c.memoizedState=null,o}function UN(o,c,h,g,w,_,B){if(h)return c.flags&256?(c.flags&=-257,g=i0(Error(n(422))),id(o,c,B,g)):c.memoizedState!==null?(c.child=o.child,c.flags|=128,null):(_=g.fallback,w=c.mode,g=yd({mode:"visible",children:g.children},w,0,null),_=Ii(_,w,B,null),_.flags|=2,g.return=c,_.return=c,g.sibling=_,c.child=g,(c.mode&1)!==0&&Eo(c,o.child,null,B),c.child.memoizedState=d0(B),c.memoizedState=u0,_);if((c.mode&1)===0)return id(o,c,B,null);if(w.data==="$!"){if(g=w.nextSibling&&w.nextSibling.dataset,g)var le=g.dgst;return g=le,_=Error(n(419)),g=i0(_,g,void 0),id(o,c,B,g)}if(le=(B&o.childLanes)!==0,Nr||le){if(g=Bn,g!==null){switch(B&-B){case 4:w=2;break;case 16:w=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:w=32;break;case 536870912:w=268435456;break;default:w=0}w=(w&(g.suspendedLanes|B))!==0?0:w,w!==0&&w!==_.retryLane&&(_.retryLane=w,ns(o,w),_a(g,o,w,-1))}return b0(),g=i0(Error(n(421))),id(o,c,B,g)}return w.data==="$?"?(c.flags|=128,c.child=o.child,c=ZN.bind(null,o),w._reactRetry=c,null):(o=_.treeContext,Ur=Fs(w.nextSibling),Br=c,tn=!0,ya=null,o!==null&&(Jr[Zr++]=es,Jr[Zr++]=ts,Jr[Zr++]=_i,es=o.id,ts=o.overflow,_i=c),c=h0(c,g.children),c.flags|=4096,c)}function Pv(o,c,h){o.lanes|=c;var g=o.alternate;g!==null&&(g.lanes|=c),Hf(o.return,c,h)}function f0(o,c,h,g,w){var _=o.memoizedState;_===null?o.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:g,tail:h,tailMode:w}:(_.isBackwards=c,_.rendering=null,_.renderingStartTime=0,_.last=g,_.tail=h,_.tailMode=w)}function Dv(o,c,h){var g=c.pendingProps,w=g.revealOrder,_=g.tail;if(xr(o,c,g.children,h),g=an.current,(g&2)!==0)g=g&1|2,c.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=c.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&Pv(o,h,c);else if(o.tag===19)Pv(o,h,c);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===c)break e;for(;o.sibling===null;){if(o.return===null||o.return===c)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}g&=1}if(Gt(an,g),(c.mode&1)===0)c.memoizedState=null;else switch(w){case"forwards":for(h=c.child,w=null;h!==null;)o=h.alternate,o!==null&&Zu(o)===null&&(w=h),h=h.sibling;h=w,h===null?(w=c.child,c.child=null):(w=h.sibling,h.sibling=null),f0(c,!1,w,h,_);break;case"backwards":for(h=null,w=c.child,c.child=null;w!==null;){if(o=w.alternate,o!==null&&Zu(o)===null){c.child=w;break}o=w.sibling,w.sibling=h,h=w,w=o}f0(c,!0,h,null,_);break;case"together":f0(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function od(o,c){(c.mode&1)===0&&o!==null&&(o.alternate=null,c.alternate=null,c.flags|=2)}function as(o,c,h){if(o!==null&&(c.dependencies=o.dependencies),bi|=c.lanes,(h&c.childLanes)===0)return null;if(o!==null&&c.child!==o.child)throw Error(n(153));if(c.child!==null){for(o=c.child,h=Ks(o,o.pendingProps),c.child=h,h.return=c;o.sibling!==null;)o=o.sibling,h=h.sibling=Ks(o,o.pendingProps),h.return=c;h.sibling=null}return c.child}function zN(o,c,h){switch(c.tag){case 3:jv(c),No();break;case 5:Kx(c);break;case 1:Cr(c.type)&&Hu(c);break;case 4:Vf(c,c.stateNode.containerInfo);break;case 10:var g=c.type._context,w=c.memoizedProps.value;Gt(Yu,g._currentValue),g._currentValue=w;break;case 13:if(g=c.memoizedState,g!==null)return g.dehydrated!==null?(Gt(an,an.current&1),c.flags|=128,null):(h&c.child.childLanes)!==0?Iv(o,c,h):(Gt(an,an.current&1),o=as(o,c,h),o!==null?o.sibling:null);Gt(an,an.current&1);break;case 19:if(g=(h&c.childLanes)!==0,(o.flags&128)!==0){if(g)return Dv(o,c,h);c.flags|=128}if(w=c.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),Gt(an,an.current),g)break;return null;case 22:case 23:return c.lanes=0,Tv(o,c,h)}return as(o,c,h)}var Ov,m0,Lv,Fv;Ov=function(o,c){for(var h=c.child;h!==null;){if(h.tag===5||h.tag===6)o.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},m0=function(){},Lv=function(o,c,h,g){var w=o.memoizedProps;if(w!==g){o=c.stateNode,Ei(Ba.current);var _=null;switch(h){case"input":w=oe(o,w),g=oe(o,g),_=[];break;case"select":w=F({},w,{value:void 0}),g=F({},g,{value:void 0}),_=[];break;case"textarea":w=Fe(o,w),g=Fe(o,g),_=[];break;default:typeof w.onClick!="function"&&typeof g.onClick=="function"&&(o.onclick=Uu)}Rt(h,g);var B;h=null;for(be in w)if(!g.hasOwnProperty(be)&&w.hasOwnProperty(be)&&w[be]!=null)if(be==="style"){var le=w[be];for(B in le)le.hasOwnProperty(B)&&(h||(h={}),h[B]="")}else be!=="dangerouslySetInnerHTML"&&be!=="children"&&be!=="suppressContentEditableWarning"&&be!=="suppressHydrationWarning"&&be!=="autoFocus"&&(s.hasOwnProperty(be)?_||(_=[]):(_=_||[]).push(be,null));for(be in g){var pe=g[be];if(le=w!=null?w[be]:void 0,g.hasOwnProperty(be)&&pe!==le&&(pe!=null||le!=null))if(be==="style")if(le){for(B in le)!le.hasOwnProperty(B)||pe&&pe.hasOwnProperty(B)||(h||(h={}),h[B]="");for(B in pe)pe.hasOwnProperty(B)&&le[B]!==pe[B]&&(h||(h={}),h[B]=pe[B])}else h||(_||(_=[]),_.push(be,h)),h=pe;else be==="dangerouslySetInnerHTML"?(pe=pe?pe.__html:void 0,le=le?le.__html:void 0,pe!=null&&le!==pe&&(_=_||[]).push(be,pe)):be==="children"?typeof pe!="string"&&typeof pe!="number"||(_=_||[]).push(be,""+pe):be!=="suppressContentEditableWarning"&&be!=="suppressHydrationWarning"&&(s.hasOwnProperty(be)?(pe!=null&&be==="onScroll"&&Kt("scroll",o),_||le===pe||(_=[])):(_=_||[]).push(be,pe))}h&&(_=_||[]).push("style",h);var be=_;(c.updateQueue=be)&&(c.flags|=4)}},Fv=function(o,c,h,g){h!==g&&(c.flags|=4)};function Ql(o,c){if(!tn)switch(o.tailMode){case"hidden":c=o.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?o.tail=null:h.sibling=null;break;case"collapsed":h=o.tail;for(var g=null;h!==null;)h.alternate!==null&&(g=h),h=h.sibling;g===null?c||o.tail===null?o.tail=null:o.tail.sibling=null:g.sibling=null}}function ar(o){var c=o.alternate!==null&&o.alternate.child===o.child,h=0,g=0;if(c)for(var w=o.child;w!==null;)h|=w.lanes|w.childLanes,g|=w.subtreeFlags&14680064,g|=w.flags&14680064,w.return=o,w=w.sibling;else for(w=o.child;w!==null;)h|=w.lanes|w.childLanes,g|=w.subtreeFlags,g|=w.flags,w.return=o,w=w.sibling;return o.subtreeFlags|=g,o.childLanes=h,c}function WN(o,c,h){var g=c.pendingProps;switch(Lf(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ar(c),null;case 1:return Cr(c.type)&&Wu(),ar(c),null;case 3:return g=c.stateNode,Ao(),Yt(_r),Yt(nr),Yf(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(o===null||o.child===null)&&(qu(c)?c.flags|=4:o===null||o.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,ya!==null&&(N0(ya),ya=null))),m0(o,c),ar(c),null;case 5:qf(c);var w=Ei(Vl.current);if(h=c.type,o!==null&&c.stateNode!=null)Lv(o,c,h,g,w),o.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!g){if(c.stateNode===null)throw Error(n(166));return ar(c),null}if(o=Ei(Ba.current),qu(c)){g=c.stateNode,h=c.type;var _=c.memoizedProps;switch(g[Ma]=c,g[zl]=_,o=(c.mode&1)!==0,h){case"dialog":Kt("cancel",g),Kt("close",g);break;case"iframe":case"object":case"embed":Kt("load",g);break;case"video":case"audio":for(w=0;w<Ml.length;w++)Kt(Ml[w],g);break;case"source":Kt("error",g);break;case"img":case"image":case"link":Kt("error",g),Kt("load",g);break;case"details":Kt("toggle",g);break;case"input":Te(g,_),Kt("invalid",g);break;case"select":g._wrapperState={wasMultiple:!!_.multiple},Kt("invalid",g);break;case"textarea":et(g,_),Kt("invalid",g)}Rt(h,_),w=null;for(var B in _)if(_.hasOwnProperty(B)){var le=_[B];B==="children"?typeof le=="string"?g.textContent!==le&&(_.suppressHydrationWarning!==!0&&Bu(g.textContent,le,o),w=["children",le]):typeof le=="number"&&g.textContent!==""+le&&(_.suppressHydrationWarning!==!0&&Bu(g.textContent,le,o),w=["children",""+le]):s.hasOwnProperty(B)&&le!=null&&B==="onScroll"&&Kt("scroll",g)}switch(h){case"input":he(g),fe(g,_,!0);break;case"textarea":he(g),jt(g);break;case"select":case"option":break;default:typeof _.onClick=="function"&&(g.onclick=Uu)}g=w,c.updateQueue=g,g!==null&&(c.flags|=4)}else{B=w.nodeType===9?w:w.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=un(h)),o==="http://www.w3.org/1999/xhtml"?h==="script"?(o=B.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof g.is=="string"?o=B.createElement(h,{is:g.is}):(o=B.createElement(h),h==="select"&&(B=o,g.multiple?B.multiple=!0:g.size&&(B.size=g.size))):o=B.createElementNS(o,h),o[Ma]=c,o[zl]=g,Ov(o,c,!1,!1),c.stateNode=o;e:{switch(B=xa(h,g),h){case"dialog":Kt("cancel",o),Kt("close",o),w=g;break;case"iframe":case"object":case"embed":Kt("load",o),w=g;break;case"video":case"audio":for(w=0;w<Ml.length;w++)Kt(Ml[w],o);w=g;break;case"source":Kt("error",o),w=g;break;case"img":case"image":case"link":Kt("error",o),Kt("load",o),w=g;break;case"details":Kt("toggle",o),w=g;break;case"input":Te(o,g),w=oe(o,g),Kt("invalid",o);break;case"option":w=g;break;case"select":o._wrapperState={wasMultiple:!!g.multiple},w=F({},g,{value:void 0}),Kt("invalid",o);break;case"textarea":et(o,g),w=Fe(o,g),Kt("invalid",o);break;default:w=g}Rt(h,w),le=w;for(_ in le)if(le.hasOwnProperty(_)){var pe=le[_];_==="style"?rn(o,pe):_==="dangerouslySetInnerHTML"?(pe=pe?pe.__html:void 0,pe!=null&&Je(o,pe)):_==="children"?typeof pe=="string"?(h!=="textarea"||pe!=="")&&qe(o,pe):typeof pe=="number"&&qe(o,""+pe):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(s.hasOwnProperty(_)?pe!=null&&_==="onScroll"&&Kt("scroll",o):pe!=null&&N(o,_,pe,B))}switch(h){case"input":he(o),fe(o,g,!1);break;case"textarea":he(o),jt(o);break;case"option":g.value!=null&&o.setAttribute("value",""+de(g.value));break;case"select":o.multiple=!!g.multiple,_=g.value,_!=null?Pe(o,!!g.multiple,_,!1):g.defaultValue!=null&&Pe(o,!!g.multiple,g.defaultValue,!0);break;default:typeof w.onClick=="function"&&(o.onclick=Uu)}switch(h){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}}g&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return ar(c),null;case 6:if(o&&c.stateNode!=null)Fv(o,c,o.memoizedProps,g);else{if(typeof g!="string"&&c.stateNode===null)throw Error(n(166));if(h=Ei(Vl.current),Ei(Ba.current),qu(c)){if(g=c.stateNode,h=c.memoizedProps,g[Ma]=c,(_=g.nodeValue!==h)&&(o=Br,o!==null))switch(o.tag){case 3:Bu(g.nodeValue,h,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&Bu(g.nodeValue,h,(o.mode&1)!==0)}_&&(c.flags|=4)}else g=(h.nodeType===9?h:h.ownerDocument).createTextNode(g),g[Ma]=c,c.stateNode=g}return ar(c),null;case 13:if(Yt(an),g=c.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(tn&&Ur!==null&&(c.mode&1)!==0&&(c.flags&128)===0)Ux(),No(),c.flags|=98560,_=!1;else if(_=qu(c),g!==null&&g.dehydrated!==null){if(o===null){if(!_)throw Error(n(318));if(_=c.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(n(317));_[Ma]=c}else No(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;ar(c),_=!1}else ya!==null&&(N0(ya),ya=null),_=!0;if(!_)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=h,c):(g=g!==null,g!==(o!==null&&o.memoizedState!==null)&&g&&(c.child.flags|=8192,(c.mode&1)!==0&&(o===null||(an.current&1)!==0?jn===0&&(jn=3):b0())),c.updateQueue!==null&&(c.flags|=4),ar(c),null);case 4:return Ao(),m0(o,c),o===null&&Bl(c.stateNode.containerInfo),ar(c),null;case 10:return Wf(c.type._context),ar(c),null;case 17:return Cr(c.type)&&Wu(),ar(c),null;case 19:if(Yt(an),_=c.memoizedState,_===null)return ar(c),null;if(g=(c.flags&128)!==0,B=_.rendering,B===null)if(g)Ql(_,!1);else{if(jn!==0||o!==null&&(o.flags&128)!==0)for(o=c.child;o!==null;){if(B=Zu(o),B!==null){for(c.flags|=128,Ql(_,!1),g=B.updateQueue,g!==null&&(c.updateQueue=g,c.flags|=4),c.subtreeFlags=0,g=h,h=c.child;h!==null;)_=h,o=g,_.flags&=14680066,B=_.alternate,B===null?(_.childLanes=0,_.lanes=o,_.child=null,_.subtreeFlags=0,_.memoizedProps=null,_.memoizedState=null,_.updateQueue=null,_.dependencies=null,_.stateNode=null):(_.childLanes=B.childLanes,_.lanes=B.lanes,_.child=B.child,_.subtreeFlags=0,_.deletions=null,_.memoizedProps=B.memoizedProps,_.memoizedState=B.memoizedState,_.updateQueue=B.updateQueue,_.type=B.type,o=B.dependencies,_.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),h=h.sibling;return Gt(an,an.current&1|2),c.child}o=o.sibling}_.tail!==null&&Ue()>Po&&(c.flags|=128,g=!0,Ql(_,!1),c.lanes=4194304)}else{if(!g)if(o=Zu(B),o!==null){if(c.flags|=128,g=!0,h=o.updateQueue,h!==null&&(c.updateQueue=h,c.flags|=4),Ql(_,!0),_.tail===null&&_.tailMode==="hidden"&&!B.alternate&&!tn)return ar(c),null}else 2*Ue()-_.renderingStartTime>Po&&h!==1073741824&&(c.flags|=128,g=!0,Ql(_,!1),c.lanes=4194304);_.isBackwards?(B.sibling=c.child,c.child=B):(h=_.last,h!==null?h.sibling=B:c.child=B,_.last=B)}return _.tail!==null?(c=_.tail,_.rendering=c,_.tail=c.sibling,_.renderingStartTime=Ue(),c.sibling=null,h=an.current,Gt(an,g?h&1|2:h&1),c):(ar(c),null);case 22:case 23:return T0(),g=c.memoizedState!==null,o!==null&&o.memoizedState!==null!==g&&(c.flags|=8192),g&&(c.mode&1)!==0?(zr&1073741824)!==0&&(ar(c),c.subtreeFlags&6&&(c.flags|=8192)):ar(c),null;case 24:return null;case 25:return null}throw Error(n(156,c.tag))}function HN(o,c){switch(Lf(c),c.tag){case 1:return Cr(c.type)&&Wu(),o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 3:return Ao(),Yt(_r),Yt(nr),Yf(),o=c.flags,(o&65536)!==0&&(o&128)===0?(c.flags=o&-65537|128,c):null;case 5:return qf(c),null;case 13:if(Yt(an),o=c.memoizedState,o!==null&&o.dehydrated!==null){if(c.alternate===null)throw Error(n(340));No()}return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 19:return Yt(an),null;case 4:return Ao(),null;case 10:return Wf(c.type._context),null;case 22:case 23:return T0(),null;case 24:return null;default:return null}}var ld=!1,sr=!1,GN=typeof WeakSet=="function"?WeakSet:Set,Xe=null;function Ro(o,c){var h=o.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(g){dn(o,c,g)}else h.current=null}function p0(o,c,h){try{h()}catch(g){dn(o,c,g)}}var Mv=!1;function $N(o,c){if(Tf=bu,o=gx(),yf(o)){if("selectionStart"in o)var h={start:o.selectionStart,end:o.selectionEnd};else e:{h=(h=o.ownerDocument)&&h.defaultView||window;var g=h.getSelection&&h.getSelection();if(g&&g.rangeCount!==0){h=g.anchorNode;var w=g.anchorOffset,_=g.focusNode;g=g.focusOffset;try{h.nodeType,_.nodeType}catch{h=null;break e}var B=0,le=-1,pe=-1,be=0,Oe=0,Be=o,De=null;t:for(;;){for(var Ke;Be!==h||w!==0&&Be.nodeType!==3||(le=B+w),Be!==_||g!==0&&Be.nodeType!==3||(pe=B+g),Be.nodeType===3&&(B+=Be.nodeValue.length),(Ke=Be.firstChild)!==null;)De=Be,Be=Ke;for(;;){if(Be===o)break t;if(De===h&&++be===w&&(le=B),De===_&&++Oe===g&&(pe=B),(Ke=Be.nextSibling)!==null)break;Be=De,De=Be.parentNode}Be=Ke}h=le===-1||pe===-1?null:{start:le,end:pe}}else h=null}h=h||{start:0,end:0}}else h=null;for(bf={focusedElem:o,selectionRange:h},bu=!1,Xe=c;Xe!==null;)if(c=Xe,o=c.child,(c.subtreeFlags&1028)!==0&&o!==null)o.return=c,Xe=o;else for(;Xe!==null;){c=Xe;try{var Qe=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(Qe!==null){var Ze=Qe.memoizedProps,vn=Qe.memoizedState,ke=c.stateNode,ve=ke.getSnapshotBeforeUpdate(c.elementType===c.type?Ze:ka(c.type,Ze),vn);ke.__reactInternalSnapshotBeforeUpdate=ve}break;case 3:var Se=c.stateNode.containerInfo;Se.nodeType===1?Se.textContent="":Se.nodeType===9&&Se.documentElement&&Se.removeChild(Se.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(We){dn(c,c.return,We)}if(o=c.sibling,o!==null){o.return=c.return,Xe=o;break}Xe=c.return}return Qe=Mv,Mv=!1,Qe}function Jl(o,c,h){var g=c.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var w=g=g.next;do{if((w.tag&o)===o){var _=w.destroy;w.destroy=void 0,_!==void 0&&p0(c,h,_)}w=w.next}while(w!==g)}}function cd(o,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var h=c=c.next;do{if((h.tag&o)===o){var g=h.create;h.destroy=g()}h=h.next}while(h!==c)}}function g0(o){var c=o.ref;if(c!==null){var h=o.stateNode;switch(o.tag){case 5:o=h;break;default:o=h}typeof c=="function"?c(o):c.current=o}}function Bv(o){var c=o.alternate;c!==null&&(o.alternate=null,Bv(c)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(c=o.stateNode,c!==null&&(delete c[Ma],delete c[zl],delete c[If],delete c[TN],delete c[bN])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function Uv(o){return o.tag===5||o.tag===3||o.tag===4}function zv(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||Uv(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function x0(o,c,h){var g=o.tag;if(g===5||g===6)o=o.stateNode,c?h.nodeType===8?h.parentNode.insertBefore(o,c):h.insertBefore(o,c):(h.nodeType===8?(c=h.parentNode,c.insertBefore(o,h)):(c=h,c.appendChild(o)),h=h._reactRootContainer,h!=null||c.onclick!==null||(c.onclick=Uu));else if(g!==4&&(o=o.child,o!==null))for(x0(o,c,h),o=o.sibling;o!==null;)x0(o,c,h),o=o.sibling}function v0(o,c,h){var g=o.tag;if(g===5||g===6)o=o.stateNode,c?h.insertBefore(o,c):h.appendChild(o);else if(g!==4&&(o=o.child,o!==null))for(v0(o,c,h),o=o.sibling;o!==null;)v0(o,c,h),o=o.sibling}var Kn=null,wa=!1;function Hs(o,c,h){for(h=h.child;h!==null;)Wv(o,c,h),h=h.sibling}function Wv(o,c,h){if(Fn&&typeof Fn.onCommitFiberUnmount=="function")try{Fn.onCommitFiberUnmount(Fa,h)}catch{}switch(h.tag){case 5:sr||Ro(h,c);case 6:var g=Kn,w=wa;Kn=null,Hs(o,c,h),Kn=g,wa=w,Kn!==null&&(wa?(o=Kn,h=h.stateNode,o.nodeType===8?o.parentNode.removeChild(h):o.removeChild(h)):Kn.removeChild(h.stateNode));break;case 18:Kn!==null&&(wa?(o=Kn,h=h.stateNode,o.nodeType===8?Rf(o.parentNode,h):o.nodeType===1&&Rf(o,h),jl(o)):Rf(Kn,h.stateNode));break;case 4:g=Kn,w=wa,Kn=h.stateNode.containerInfo,wa=!0,Hs(o,c,h),Kn=g,wa=w;break;case 0:case 11:case 14:case 15:if(!sr&&(g=h.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){w=g=g.next;do{var _=w,B=_.destroy;_=_.tag,B!==void 0&&((_&2)!==0||(_&4)!==0)&&p0(h,c,B),w=w.next}while(w!==g)}Hs(o,c,h);break;case 1:if(!sr&&(Ro(h,c),g=h.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=h.memoizedProps,g.state=h.memoizedState,g.componentWillUnmount()}catch(le){dn(h,c,le)}Hs(o,c,h);break;case 21:Hs(o,c,h);break;case 22:h.mode&1?(sr=(g=sr)||h.memoizedState!==null,Hs(o,c,h),sr=g):Hs(o,c,h);break;default:Hs(o,c,h)}}function Hv(o){var c=o.updateQueue;if(c!==null){o.updateQueue=null;var h=o.stateNode;h===null&&(h=o.stateNode=new GN),c.forEach(function(g){var w=eE.bind(null,o,g);h.has(g)||(h.add(g),g.then(w,w))})}}function Sa(o,c){var h=c.deletions;if(h!==null)for(var g=0;g<h.length;g++){var w=h[g];try{var _=o,B=c,le=B;e:for(;le!==null;){switch(le.tag){case 5:Kn=le.stateNode,wa=!1;break e;case 3:Kn=le.stateNode.containerInfo,wa=!0;break e;case 4:Kn=le.stateNode.containerInfo,wa=!0;break e}le=le.return}if(Kn===null)throw Error(n(160));Wv(_,B,w),Kn=null,wa=!1;var pe=w.alternate;pe!==null&&(pe.return=null),w.return=null}catch(be){dn(w,c,be)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)Gv(c,o),c=c.sibling}function Gv(o,c){var h=o.alternate,g=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(Sa(c,o),za(o),g&4){try{Jl(3,o,o.return),cd(3,o)}catch(Ze){dn(o,o.return,Ze)}try{Jl(5,o,o.return)}catch(Ze){dn(o,o.return,Ze)}}break;case 1:Sa(c,o),za(o),g&512&&h!==null&&Ro(h,h.return);break;case 5:if(Sa(c,o),za(o),g&512&&h!==null&&Ro(h,h.return),o.flags&32){var w=o.stateNode;try{qe(w,"")}catch(Ze){dn(o,o.return,Ze)}}if(g&4&&(w=o.stateNode,w!=null)){var _=o.memoizedProps,B=h!==null?h.memoizedProps:_,le=o.type,pe=o.updateQueue;if(o.updateQueue=null,pe!==null)try{le==="input"&&_.type==="radio"&&_.name!=null&&xe(w,_),xa(le,B);var be=xa(le,_);for(B=0;B<pe.length;B+=2){var Oe=pe[B],Be=pe[B+1];Oe==="style"?rn(w,Be):Oe==="dangerouslySetInnerHTML"?Je(w,Be):Oe==="children"?qe(w,Be):N(w,Oe,Be,be)}switch(le){case"input":we(w,_);break;case"textarea":dt(w,_);break;case"select":var De=w._wrapperState.wasMultiple;w._wrapperState.wasMultiple=!!_.multiple;var Ke=_.value;Ke!=null?Pe(w,!!_.multiple,Ke,!1):De!==!!_.multiple&&(_.defaultValue!=null?Pe(w,!!_.multiple,_.defaultValue,!0):Pe(w,!!_.multiple,_.multiple?[]:"",!1))}w[zl]=_}catch(Ze){dn(o,o.return,Ze)}}break;case 6:if(Sa(c,o),za(o),g&4){if(o.stateNode===null)throw Error(n(162));w=o.stateNode,_=o.memoizedProps;try{w.nodeValue=_}catch(Ze){dn(o,o.return,Ze)}}break;case 3:if(Sa(c,o),za(o),g&4&&h!==null&&h.memoizedState.isDehydrated)try{jl(c.containerInfo)}catch(Ze){dn(o,o.return,Ze)}break;case 4:Sa(c,o),za(o);break;case 13:Sa(c,o),za(o),w=o.child,w.flags&8192&&(_=w.memoizedState!==null,w.stateNode.isHidden=_,!_||w.alternate!==null&&w.alternate.memoizedState!==null||(w0=Ue())),g&4&&Hv(o);break;case 22:if(Oe=h!==null&&h.memoizedState!==null,o.mode&1?(sr=(be=sr)||Oe,Sa(c,o),sr=be):Sa(c,o),za(o),g&8192){if(be=o.memoizedState!==null,(o.stateNode.isHidden=be)&&!Oe&&(o.mode&1)!==0)for(Xe=o,Oe=o.child;Oe!==null;){for(Be=Xe=Oe;Xe!==null;){switch(De=Xe,Ke=De.child,De.tag){case 0:case 11:case 14:case 15:Jl(4,De,De.return);break;case 1:Ro(De,De.return);var Qe=De.stateNode;if(typeof Qe.componentWillUnmount=="function"){g=De,h=De.return;try{c=g,Qe.props=c.memoizedProps,Qe.state=c.memoizedState,Qe.componentWillUnmount()}catch(Ze){dn(g,h,Ze)}}break;case 5:Ro(De,De.return);break;case 22:if(De.memoizedState!==null){qv(Be);continue}}Ke!==null?(Ke.return=De,Xe=Ke):qv(Be)}Oe=Oe.sibling}e:for(Oe=null,Be=o;;){if(Be.tag===5){if(Oe===null){Oe=Be;try{w=Be.stateNode,be?(_=w.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none"):(le=Be.stateNode,pe=Be.memoizedProps.style,B=pe!=null&&pe.hasOwnProperty("display")?pe.display:null,le.style.display=Ct("display",B))}catch(Ze){dn(o,o.return,Ze)}}}else if(Be.tag===6){if(Oe===null)try{Be.stateNode.nodeValue=be?"":Be.memoizedProps}catch(Ze){dn(o,o.return,Ze)}}else if((Be.tag!==22&&Be.tag!==23||Be.memoizedState===null||Be===o)&&Be.child!==null){Be.child.return=Be,Be=Be.child;continue}if(Be===o)break e;for(;Be.sibling===null;){if(Be.return===null||Be.return===o)break e;Oe===Be&&(Oe=null),Be=Be.return}Oe===Be&&(Oe=null),Be.sibling.return=Be.return,Be=Be.sibling}}break;case 19:Sa(c,o),za(o),g&4&&Hv(o);break;case 21:break;default:Sa(c,o),za(o)}}function za(o){var c=o.flags;if(c&2){try{e:{for(var h=o.return;h!==null;){if(Uv(h)){var g=h;break e}h=h.return}throw Error(n(160))}switch(g.tag){case 5:var w=g.stateNode;g.flags&32&&(qe(w,""),g.flags&=-33);var _=zv(o);v0(o,_,w);break;case 3:case 4:var B=g.stateNode.containerInfo,le=zv(o);x0(o,le,B);break;default:throw Error(n(161))}}catch(pe){dn(o,o.return,pe)}o.flags&=-3}c&4096&&(o.flags&=-4097)}function VN(o,c,h){Xe=o,$v(o)}function $v(o,c,h){for(var g=(o.mode&1)!==0;Xe!==null;){var w=Xe,_=w.child;if(w.tag===22&&g){var B=w.memoizedState!==null||ld;if(!B){var le=w.alternate,pe=le!==null&&le.memoizedState!==null||sr;le=ld;var be=sr;if(ld=B,(sr=pe)&&!be)for(Xe=w;Xe!==null;)B=Xe,pe=B.child,B.tag===22&&B.memoizedState!==null?Kv(w):pe!==null?(pe.return=B,Xe=pe):Kv(w);for(;_!==null;)Xe=_,$v(_),_=_.sibling;Xe=w,ld=le,sr=be}Vv(o)}else(w.subtreeFlags&8772)!==0&&_!==null?(_.return=w,Xe=_):Vv(o)}}function Vv(o){for(;Xe!==null;){var c=Xe;if((c.flags&8772)!==0){var h=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:sr||cd(5,c);break;case 1:var g=c.stateNode;if(c.flags&4&&!sr)if(h===null)g.componentDidMount();else{var w=c.elementType===c.type?h.memoizedProps:ka(c.type,h.memoizedProps);g.componentDidUpdate(w,h.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var _=c.updateQueue;_!==null&&qx(c,_,g);break;case 3:var B=c.updateQueue;if(B!==null){if(h=null,c.child!==null)switch(c.child.tag){case 5:h=c.child.stateNode;break;case 1:h=c.child.stateNode}qx(c,B,h)}break;case 5:var le=c.stateNode;if(h===null&&c.flags&4){h=le;var pe=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":pe.autoFocus&&h.focus();break;case"img":pe.src&&(h.src=pe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var be=c.alternate;if(be!==null){var Oe=be.memoizedState;if(Oe!==null){var Be=Oe.dehydrated;Be!==null&&jl(Be)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}sr||c.flags&512&&g0(c)}catch(De){dn(c,c.return,De)}}if(c===o){Xe=null;break}if(h=c.sibling,h!==null){h.return=c.return,Xe=h;break}Xe=c.return}}function qv(o){for(;Xe!==null;){var c=Xe;if(c===o){Xe=null;break}var h=c.sibling;if(h!==null){h.return=c.return,Xe=h;break}Xe=c.return}}function Kv(o){for(;Xe!==null;){var c=Xe;try{switch(c.tag){case 0:case 11:case 15:var h=c.return;try{cd(4,c)}catch(pe){dn(c,h,pe)}break;case 1:var g=c.stateNode;if(typeof g.componentDidMount=="function"){var w=c.return;try{g.componentDidMount()}catch(pe){dn(c,w,pe)}}var _=c.return;try{g0(c)}catch(pe){dn(c,_,pe)}break;case 5:var B=c.return;try{g0(c)}catch(pe){dn(c,B,pe)}}}catch(pe){dn(c,c.return,pe)}if(c===o){Xe=null;break}var le=c.sibling;if(le!==null){le.return=c.return,Xe=le;break}Xe=c.return}}var qN=Math.ceil,ud=b.ReactCurrentDispatcher,y0=b.ReactCurrentOwner,na=b.ReactCurrentBatchConfig,Nt=0,Bn=null,Cn=null,Yn=0,zr=0,Io=Ms(0),jn=0,Zl=null,bi=0,dd=0,k0=0,ec=null,Er=null,w0=0,Po=1/0,ss=null,hd=!1,S0=null,Gs=null,fd=!1,$s=null,md=0,tc=0,_0=null,pd=-1,gd=0;function vr(){return(Nt&6)!==0?Ue():pd!==-1?pd:pd=Ue()}function Vs(o){return(o.mode&1)===0?1:(Nt&2)!==0&&Yn!==0?Yn&-Yn:jN.transition!==null?(gd===0&&(gd=zg()),gd):(o=Pt,o!==0||(o=window.event,o=o===void 0?16:Xg(o.type)),o)}function _a(o,c,h,g){if(50<tc)throw tc=0,_0=null,Error(n(185));Nl(o,h,g),((Nt&2)===0||o!==Bn)&&(o===Bn&&((Nt&2)===0&&(dd|=h),jn===4&&qs(o,Yn)),Tr(o,g),h===1&&Nt===0&&(c.mode&1)===0&&(Po=Ue()+500,Gu&&Us()))}function Tr(o,c){var h=o.callbackNode;j2(o,c);var g=Nu(o,o===Bn?Yn:0);if(g===0)h!==null&&Ve(h),o.callbackNode=null,o.callbackPriority=0;else if(c=g&-g,o.callbackPriority!==c){if(h!=null&&Ve(h),c===1)o.tag===0?AN(Xv.bind(null,o)):Ox(Xv.bind(null,o)),NN(function(){(Nt&6)===0&&Us()}),h=null;else{switch(Wg(g)){case 1:h=Ut;break;case 4:h=Ht;break;case 16:h=gn;break;case 536870912:h=js;break;default:h=gn}h=a1(h,Yv.bind(null,o))}o.callbackPriority=c,o.callbackNode=h}}function Yv(o,c){if(pd=-1,gd=0,(Nt&6)!==0)throw Error(n(327));var h=o.callbackNode;if(Do()&&o.callbackNode!==h)return null;var g=Nu(o,o===Bn?Yn:0);if(g===0)return null;if((g&30)!==0||(g&o.expiredLanes)!==0||c)c=xd(o,g);else{c=g;var w=Nt;Nt|=2;var _=Jv();(Bn!==o||Yn!==c)&&(ss=null,Po=Ue()+500,ji(o,c));do try{XN();break}catch(le){Qv(o,le)}while(!0);zf(),ud.current=_,Nt=w,Cn!==null?c=0:(Bn=null,Yn=0,c=jn)}if(c!==0){if(c===2&&(w=nf(o),w!==0&&(g=w,c=C0(o,w))),c===1)throw h=Zl,ji(o,0),qs(o,g),Tr(o,Ue()),h;if(c===6)qs(o,g);else{if(w=o.current.alternate,(g&30)===0&&!KN(w)&&(c=xd(o,g),c===2&&(_=nf(o),_!==0&&(g=_,c=C0(o,_))),c===1))throw h=Zl,ji(o,0),qs(o,g),Tr(o,Ue()),h;switch(o.finishedWork=w,o.finishedLanes=g,c){case 0:case 1:throw Error(n(345));case 2:Ri(o,Er,ss);break;case 3:if(qs(o,g),(g&130023424)===g&&(c=w0+500-Ue(),10<c)){if(Nu(o,0)!==0)break;if(w=o.suspendedLanes,(w&g)!==g){vr(),o.pingedLanes|=o.suspendedLanes&w;break}o.timeoutHandle=jf(Ri.bind(null,o,Er,ss),c);break}Ri(o,Er,ss);break;case 4:if(qs(o,g),(g&4194240)===g)break;for(c=o.eventTimes,w=-1;0<g;){var B=31-xn(g);_=1<<B,B=c[B],B>w&&(w=B),g&=~_}if(g=w,g=Ue()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*qN(g/1960))-g,10<g){o.timeoutHandle=jf(Ri.bind(null,o,Er,ss),g);break}Ri(o,Er,ss);break;case 5:Ri(o,Er,ss);break;default:throw Error(n(329))}}}return Tr(o,Ue()),o.callbackNode===h?Yv.bind(null,o):null}function C0(o,c){var h=ec;return o.current.memoizedState.isDehydrated&&(ji(o,c).flags|=256),o=xd(o,c),o!==2&&(c=Er,Er=h,c!==null&&N0(c)),o}function N0(o){Er===null?Er=o:Er.push.apply(Er,o)}function KN(o){for(var c=o;;){if(c.flags&16384){var h=c.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var g=0;g<h.length;g++){var w=h[g],_=w.getSnapshot;w=w.value;try{if(!va(_(),w))return!1}catch{return!1}}}if(h=c.child,c.subtreeFlags&16384&&h!==null)h.return=c,c=h;else{if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function qs(o,c){for(c&=~k0,c&=~dd,o.suspendedLanes|=c,o.pingedLanes&=~c,o=o.expirationTimes;0<c;){var h=31-xn(c),g=1<<h;o[h]=-1,c&=~g}}function Xv(o){if((Nt&6)!==0)throw Error(n(327));Do();var c=Nu(o,0);if((c&1)===0)return Tr(o,Ue()),null;var h=xd(o,c);if(o.tag!==0&&h===2){var g=nf(o);g!==0&&(c=g,h=C0(o,g))}if(h===1)throw h=Zl,ji(o,0),qs(o,c),Tr(o,Ue()),h;if(h===6)throw Error(n(345));return o.finishedWork=o.current.alternate,o.finishedLanes=c,Ri(o,Er,ss),Tr(o,Ue()),null}function E0(o,c){var h=Nt;Nt|=1;try{return o(c)}finally{Nt=h,Nt===0&&(Po=Ue()+500,Gu&&Us())}}function Ai(o){$s!==null&&$s.tag===0&&(Nt&6)===0&&Do();var c=Nt;Nt|=1;var h=na.transition,g=Pt;try{if(na.transition=null,Pt=1,o)return o()}finally{Pt=g,na.transition=h,Nt=c,(Nt&6)===0&&Us()}}function T0(){zr=Io.current,Yt(Io)}function ji(o,c){o.finishedWork=null,o.finishedLanes=0;var h=o.timeoutHandle;if(h!==-1&&(o.timeoutHandle=-1,CN(h)),Cn!==null)for(h=Cn.return;h!==null;){var g=h;switch(Lf(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&Wu();break;case 3:Ao(),Yt(_r),Yt(nr),Yf();break;case 5:qf(g);break;case 4:Ao();break;case 13:Yt(an);break;case 19:Yt(an);break;case 10:Wf(g.type._context);break;case 22:case 23:T0()}h=h.return}if(Bn=o,Cn=o=Ks(o.current,null),Yn=zr=c,jn=0,Zl=null,k0=dd=bi=0,Er=ec=null,Ni!==null){for(c=0;c<Ni.length;c++)if(h=Ni[c],g=h.interleaved,g!==null){h.interleaved=null;var w=g.next,_=h.pending;if(_!==null){var B=_.next;_.next=w,g.next=B}h.pending=g}Ni=null}return o}function Qv(o,c){do{var h=Cn;try{if(zf(),ed.current=ad,td){for(var g=sn.memoizedState;g!==null;){var w=g.queue;w!==null&&(w.pending=null),g=g.next}td=!1}if(Ti=0,Mn=An=sn=null,ql=!1,Kl=0,y0.current=null,h===null||h.return===null){jn=1,Zl=c,Cn=null;break}e:{var _=o,B=h.return,le=h,pe=c;if(c=Yn,le.flags|=32768,pe!==null&&typeof pe=="object"&&typeof pe.then=="function"){var be=pe,Oe=le,Be=Oe.tag;if((Oe.mode&1)===0&&(Be===0||Be===11||Be===15)){var De=Oe.alternate;De?(Oe.updateQueue=De.updateQueue,Oe.memoizedState=De.memoizedState,Oe.lanes=De.lanes):(Oe.updateQueue=null,Oe.memoizedState=null)}var Ke=Sv(B);if(Ke!==null){Ke.flags&=-257,_v(Ke,B,le,_,c),Ke.mode&1&&wv(_,be,c),c=Ke,pe=be;var Qe=c.updateQueue;if(Qe===null){var Ze=new Set;Ze.add(pe),c.updateQueue=Ze}else Qe.add(pe);break e}else{if((c&1)===0){wv(_,be,c),b0();break e}pe=Error(n(426))}}else if(tn&&le.mode&1){var vn=Sv(B);if(vn!==null){(vn.flags&65536)===0&&(vn.flags|=256),_v(vn,B,le,_,c),Bf(jo(pe,le));break e}}_=pe=jo(pe,le),jn!==4&&(jn=2),ec===null?ec=[_]:ec.push(_),_=B;do{switch(_.tag){case 3:_.flags|=65536,c&=-c,_.lanes|=c;var ke=yv(_,pe,c);Vx(_,ke);break e;case 1:le=pe;var ve=_.type,Se=_.stateNode;if((_.flags&128)===0&&(typeof ve.getDerivedStateFromError=="function"||Se!==null&&typeof Se.componentDidCatch=="function"&&(Gs===null||!Gs.has(Se)))){_.flags|=65536,c&=-c,_.lanes|=c;var We=kv(_,le,c);Vx(_,We);break e}}_=_.return}while(_!==null)}e1(h)}catch(tt){c=tt,Cn===h&&h!==null&&(Cn=h=h.return);continue}break}while(!0)}function Jv(){var o=ud.current;return ud.current=ad,o===null?ad:o}function b0(){(jn===0||jn===3||jn===2)&&(jn=4),Bn===null||(bi&268435455)===0&&(dd&268435455)===0||qs(Bn,Yn)}function xd(o,c){var h=Nt;Nt|=2;var g=Jv();(Bn!==o||Yn!==c)&&(ss=null,ji(o,c));do try{YN();break}catch(w){Qv(o,w)}while(!0);if(zf(),Nt=h,ud.current=g,Cn!==null)throw Error(n(261));return Bn=null,Yn=0,jn}function YN(){for(;Cn!==null;)Zv(Cn)}function XN(){for(;Cn!==null&&!Ye();)Zv(Cn)}function Zv(o){var c=r1(o.alternate,o,zr);o.memoizedProps=o.pendingProps,c===null?e1(o):Cn=c,y0.current=null}function e1(o){var c=o;do{var h=c.alternate;if(o=c.return,(c.flags&32768)===0){if(h=WN(h,c,zr),h!==null){Cn=h;return}}else{if(h=HN(h,c),h!==null){h.flags&=32767,Cn=h;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{jn=6,Cn=null;return}}if(c=c.sibling,c!==null){Cn=c;return}Cn=c=o}while(c!==null);jn===0&&(jn=5)}function Ri(o,c,h){var g=Pt,w=na.transition;try{na.transition=null,Pt=1,QN(o,c,h,g)}finally{na.transition=w,Pt=g}return null}function QN(o,c,h,g){do Do();while($s!==null);if((Nt&6)!==0)throw Error(n(327));h=o.finishedWork;var w=o.finishedLanes;if(h===null)return null;if(o.finishedWork=null,o.finishedLanes=0,h===o.current)throw Error(n(177));o.callbackNode=null,o.callbackPriority=0;var _=h.lanes|h.childLanes;if(R2(o,_),o===Bn&&(Cn=Bn=null,Yn=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||fd||(fd=!0,a1(gn,function(){return Do(),null})),_=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||_){_=na.transition,na.transition=null;var B=Pt;Pt=1;var le=Nt;Nt|=4,y0.current=null,$N(o,h),Gv(h,o),xN(bf),bu=!!Tf,bf=Tf=null,o.current=h,VN(h),ze(),Nt=le,Pt=B,na.transition=_}else o.current=h;if(fd&&(fd=!1,$s=o,md=w),_=o.pendingLanes,_===0&&(Gs=null),_l(h.stateNode),Tr(o,Ue()),c!==null)for(g=o.onRecoverableError,h=0;h<c.length;h++)w=c[h],g(w.value,{componentStack:w.stack,digest:w.digest});if(hd)throw hd=!1,o=S0,S0=null,o;return(md&1)!==0&&o.tag!==0&&Do(),_=o.pendingLanes,(_&1)!==0?o===_0?tc++:(tc=0,_0=o):tc=0,Us(),null}function Do(){if($s!==null){var o=Wg(md),c=na.transition,h=Pt;try{if(na.transition=null,Pt=16>o?16:o,$s===null)var g=!1;else{if(o=$s,$s=null,md=0,(Nt&6)!==0)throw Error(n(331));var w=Nt;for(Nt|=4,Xe=o.current;Xe!==null;){var _=Xe,B=_.child;if((Xe.flags&16)!==0){var le=_.deletions;if(le!==null){for(var pe=0;pe<le.length;pe++){var be=le[pe];for(Xe=be;Xe!==null;){var Oe=Xe;switch(Oe.tag){case 0:case 11:case 15:Jl(8,Oe,_)}var Be=Oe.child;if(Be!==null)Be.return=Oe,Xe=Be;else for(;Xe!==null;){Oe=Xe;var De=Oe.sibling,Ke=Oe.return;if(Bv(Oe),Oe===be){Xe=null;break}if(De!==null){De.return=Ke,Xe=De;break}Xe=Ke}}}var Qe=_.alternate;if(Qe!==null){var Ze=Qe.child;if(Ze!==null){Qe.child=null;do{var vn=Ze.sibling;Ze.sibling=null,Ze=vn}while(Ze!==null)}}Xe=_}}if((_.subtreeFlags&2064)!==0&&B!==null)B.return=_,Xe=B;else e:for(;Xe!==null;){if(_=Xe,(_.flags&2048)!==0)switch(_.tag){case 0:case 11:case 15:Jl(9,_,_.return)}var ke=_.sibling;if(ke!==null){ke.return=_.return,Xe=ke;break e}Xe=_.return}}var ve=o.current;for(Xe=ve;Xe!==null;){B=Xe;var Se=B.child;if((B.subtreeFlags&2064)!==0&&Se!==null)Se.return=B,Xe=Se;else e:for(B=ve;Xe!==null;){if(le=Xe,(le.flags&2048)!==0)try{switch(le.tag){case 0:case 11:case 15:cd(9,le)}}catch(tt){dn(le,le.return,tt)}if(le===B){Xe=null;break e}var We=le.sibling;if(We!==null){We.return=le.return,Xe=We;break e}Xe=le.return}}if(Nt=w,Us(),Fn&&typeof Fn.onPostCommitFiberRoot=="function")try{Fn.onPostCommitFiberRoot(Fa,o)}catch{}g=!0}return g}finally{Pt=h,na.transition=c}}return!1}function t1(o,c,h){c=jo(h,c),c=yv(o,c,1),o=Ws(o,c,1),c=vr(),o!==null&&(Nl(o,1,c),Tr(o,c))}function dn(o,c,h){if(o.tag===3)t1(o,o,h);else for(;c!==null;){if(c.tag===3){t1(c,o,h);break}else if(c.tag===1){var g=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(Gs===null||!Gs.has(g))){o=jo(h,o),o=kv(c,o,1),c=Ws(c,o,1),o=vr(),c!==null&&(Nl(c,1,o),Tr(c,o));break}}c=c.return}}function JN(o,c,h){var g=o.pingCache;g!==null&&g.delete(c),c=vr(),o.pingedLanes|=o.suspendedLanes&h,Bn===o&&(Yn&h)===h&&(jn===4||jn===3&&(Yn&130023424)===Yn&&500>Ue()-w0?ji(o,0):k0|=h),Tr(o,c)}function n1(o,c){c===0&&((o.mode&1)===0?c=1:(c=Cu,Cu<<=1,(Cu&130023424)===0&&(Cu=4194304)));var h=vr();o=ns(o,c),o!==null&&(Nl(o,c,h),Tr(o,h))}function ZN(o){var c=o.memoizedState,h=0;c!==null&&(h=c.retryLane),n1(o,h)}function eE(o,c){var h=0;switch(o.tag){case 13:var g=o.stateNode,w=o.memoizedState;w!==null&&(h=w.retryLane);break;case 19:g=o.stateNode;break;default:throw Error(n(314))}g!==null&&g.delete(c),n1(o,h)}var r1;r1=function(o,c,h){if(o!==null)if(o.memoizedProps!==c.pendingProps||_r.current)Nr=!0;else{if((o.lanes&h)===0&&(c.flags&128)===0)return Nr=!1,zN(o,c,h);Nr=(o.flags&131072)!==0}else Nr=!1,tn&&(c.flags&1048576)!==0&&Lx(c,Vu,c.index);switch(c.lanes=0,c.tag){case 2:var g=c.type;od(o,c),o=c.pendingProps;var w=So(c,nr.current);bo(c,h),w=Jf(null,c,g,o,w,h);var _=Zf();return c.flags|=1,typeof w=="object"&&w!==null&&typeof w.render=="function"&&w.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,Cr(g)?(_=!0,Hu(c)):_=!1,c.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,$f(c),w.updater=sd,c.stateNode=w,w._reactInternals=c,s0(c,g,o,h),c=c0(null,c,g,!0,_,h)):(c.tag=0,tn&&_&&Of(c),xr(null,c,w,h),c=c.child),c;case 16:g=c.elementType;e:{switch(od(o,c),o=c.pendingProps,w=g._init,g=w(g._payload),c.type=g,w=c.tag=nE(g),o=ka(g,o),w){case 0:c=l0(null,c,g,o,h);break e;case 1:c=Av(null,c,g,o,h);break e;case 11:c=Cv(null,c,g,o,h);break e;case 14:c=Nv(null,c,g,ka(g.type,o),h);break e}throw Error(n(306,g,""))}return c;case 0:return g=c.type,w=c.pendingProps,w=c.elementType===g?w:ka(g,w),l0(o,c,g,w,h);case 1:return g=c.type,w=c.pendingProps,w=c.elementType===g?w:ka(g,w),Av(o,c,g,w,h);case 3:e:{if(jv(c),o===null)throw Error(n(387));g=c.pendingProps,_=c.memoizedState,w=_.element,$x(o,c),Ju(c,g,null,h);var B=c.memoizedState;if(g=B.element,_.isDehydrated)if(_={element:g,isDehydrated:!1,cache:B.cache,pendingSuspenseBoundaries:B.pendingSuspenseBoundaries,transitions:B.transitions},c.updateQueue.baseState=_,c.memoizedState=_,c.flags&256){w=jo(Error(n(423)),c),c=Rv(o,c,g,h,w);break e}else if(g!==w){w=jo(Error(n(424)),c),c=Rv(o,c,g,h,w);break e}else for(Ur=Fs(c.stateNode.containerInfo.firstChild),Br=c,tn=!0,ya=null,h=Hx(c,null,g,h),c.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(No(),g===w){c=as(o,c,h);break e}xr(o,c,g,h)}c=c.child}return c;case 5:return Kx(c),o===null&&Mf(c),g=c.type,w=c.pendingProps,_=o!==null?o.memoizedProps:null,B=w.children,Af(g,w)?B=null:_!==null&&Af(g,_)&&(c.flags|=32),bv(o,c),xr(o,c,B,h),c.child;case 6:return o===null&&Mf(c),null;case 13:return Iv(o,c,h);case 4:return Vf(c,c.stateNode.containerInfo),g=c.pendingProps,o===null?c.child=Eo(c,null,g,h):xr(o,c,g,h),c.child;case 11:return g=c.type,w=c.pendingProps,w=c.elementType===g?w:ka(g,w),Cv(o,c,g,w,h);case 7:return xr(o,c,c.pendingProps,h),c.child;case 8:return xr(o,c,c.pendingProps.children,h),c.child;case 12:return xr(o,c,c.pendingProps.children,h),c.child;case 10:e:{if(g=c.type._context,w=c.pendingProps,_=c.memoizedProps,B=w.value,Gt(Yu,g._currentValue),g._currentValue=B,_!==null)if(va(_.value,B)){if(_.children===w.children&&!_r.current){c=as(o,c,h);break e}}else for(_=c.child,_!==null&&(_.return=c);_!==null;){var le=_.dependencies;if(le!==null){B=_.child;for(var pe=le.firstContext;pe!==null;){if(pe.context===g){if(_.tag===1){pe=rs(-1,h&-h),pe.tag=2;var be=_.updateQueue;if(be!==null){be=be.shared;var Oe=be.pending;Oe===null?pe.next=pe:(pe.next=Oe.next,Oe.next=pe),be.pending=pe}}_.lanes|=h,pe=_.alternate,pe!==null&&(pe.lanes|=h),Hf(_.return,h,c),le.lanes|=h;break}pe=pe.next}}else if(_.tag===10)B=_.type===c.type?null:_.child;else if(_.tag===18){if(B=_.return,B===null)throw Error(n(341));B.lanes|=h,le=B.alternate,le!==null&&(le.lanes|=h),Hf(B,h,c),B=_.sibling}else B=_.child;if(B!==null)B.return=_;else for(B=_;B!==null;){if(B===c){B=null;break}if(_=B.sibling,_!==null){_.return=B.return,B=_;break}B=B.return}_=B}xr(o,c,w.children,h),c=c.child}return c;case 9:return w=c.type,g=c.pendingProps.children,bo(c,h),w=ea(w),g=g(w),c.flags|=1,xr(o,c,g,h),c.child;case 14:return g=c.type,w=ka(g,c.pendingProps),w=ka(g.type,w),Nv(o,c,g,w,h);case 15:return Ev(o,c,c.type,c.pendingProps,h);case 17:return g=c.type,w=c.pendingProps,w=c.elementType===g?w:ka(g,w),od(o,c),c.tag=1,Cr(g)?(o=!0,Hu(c)):o=!1,bo(c,h),xv(c,g,w),s0(c,g,w,h),c0(null,c,g,!0,o,h);case 19:return Dv(o,c,h);case 22:return Tv(o,c,h)}throw Error(n(156,c.tag))};function a1(o,c){return Me(o,c)}function tE(o,c,h,g){this.tag=o,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ra(o,c,h,g){return new tE(o,c,h,g)}function A0(o){return o=o.prototype,!(!o||!o.isReactComponent)}function nE(o){if(typeof o=="function")return A0(o)?1:0;if(o!=null){if(o=o.$$typeof,o===M)return 11;if(o===ce)return 14}return 2}function Ks(o,c){var h=o.alternate;return h===null?(h=ra(o.tag,c,o.key,o.mode),h.elementType=o.elementType,h.type=o.type,h.stateNode=o.stateNode,h.alternate=o,o.alternate=h):(h.pendingProps=c,h.type=o.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=o.flags&14680064,h.childLanes=o.childLanes,h.lanes=o.lanes,h.child=o.child,h.memoizedProps=o.memoizedProps,h.memoizedState=o.memoizedState,h.updateQueue=o.updateQueue,c=o.dependencies,h.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},h.sibling=o.sibling,h.index=o.index,h.ref=o.ref,h}function vd(o,c,h,g,w,_){var B=2;if(g=o,typeof o=="function")A0(o)&&(B=1);else if(typeof o=="string")B=5;else e:switch(o){case R:return Ii(h.children,w,_,c);case q:B=8,w|=8;break;case O:return o=ra(12,h,c,w|2),o.elementType=O,o.lanes=_,o;case me:return o=ra(13,h,c,w),o.elementType=me,o.lanes=_,o;case ae:return o=ra(19,h,c,w),o.elementType=ae,o.lanes=_,o;case K:return yd(h,w,_,c);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case V:B=10;break e;case X:B=9;break e;case M:B=11;break e;case ce:B=14;break e;case ue:B=16,g=null;break e}throw Error(n(130,o==null?o:typeof o,""))}return c=ra(B,h,c,w),c.elementType=o,c.type=g,c.lanes=_,c}function Ii(o,c,h,g){return o=ra(7,o,g,c),o.lanes=h,o}function yd(o,c,h,g){return o=ra(22,o,g,c),o.elementType=K,o.lanes=h,o.stateNode={isHidden:!1},o}function j0(o,c,h){return o=ra(6,o,null,c),o.lanes=h,o}function R0(o,c,h){return c=ra(4,o.children!==null?o.children:[],o.key,c),c.lanes=h,c.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},c}function rE(o,c,h,g,w){this.tag=c,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=rf(0),this.expirationTimes=rf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rf(0),this.identifierPrefix=g,this.onRecoverableError=w,this.mutableSourceEagerHydrationData=null}function I0(o,c,h,g,w,_,B,le,pe){return o=new rE(o,c,h,le,pe),c===1?(c=1,_===!0&&(c|=8)):c=0,_=ra(3,null,null,c),o.current=_,_.stateNode=o,_.memoizedState={element:g,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},$f(_),o}function aE(o,c,h){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:L,key:g==null?null:""+g,children:o,containerInfo:c,implementation:h}}function s1(o){if(!o)return Bs;o=o._reactInternals;e:{if(ie(o)!==o||o.tag!==1)throw Error(n(170));var c=o;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(Cr(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(n(171))}if(o.tag===1){var h=o.type;if(Cr(h))return Px(o,h,c)}return c}function i1(o,c,h,g,w,_,B,le,pe){return o=I0(h,g,!0,o,w,_,B,le,pe),o.context=s1(null),h=o.current,g=vr(),w=Vs(h),_=rs(g,w),_.callback=c??null,Ws(h,_,w),o.current.lanes=w,Nl(o,w,g),Tr(o,g),o}function kd(o,c,h,g){var w=c.current,_=vr(),B=Vs(w);return h=s1(h),c.context===null?c.context=h:c.pendingContext=h,c=rs(_,B),c.payload={element:o},g=g===void 0?null:g,g!==null&&(c.callback=g),o=Ws(w,c,B),o!==null&&(_a(o,w,B,_),Qu(o,w,B)),B}function wd(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return o.child.stateNode;default:return o.child.stateNode}}function o1(o,c){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var h=o.retryLane;o.retryLane=h!==0&&h<c?h:c}}function P0(o,c){o1(o,c),(o=o.alternate)&&o1(o,c)}function sE(){return null}var l1=typeof reportError=="function"?reportError:function(o){console.error(o)};function D0(o){this._internalRoot=o}Sd.prototype.render=D0.prototype.render=function(o){var c=this._internalRoot;if(c===null)throw Error(n(409));kd(o,c,null,null)},Sd.prototype.unmount=D0.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var c=o.containerInfo;Ai(function(){kd(null,o,null,null)}),c[Ja]=null}};function Sd(o){this._internalRoot=o}Sd.prototype.unstable_scheduleHydration=function(o){if(o){var c=$g();o={blockedOn:null,target:o,priority:c};for(var h=0;h<Ds.length&&c!==0&&c<Ds[h].priority;h++);Ds.splice(h,0,o),h===0&&Kg(o)}};function O0(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function _d(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function c1(){}function iE(o,c,h,g,w){if(w){if(typeof g=="function"){var _=g;g=function(){var be=wd(B);_.call(be)}}var B=i1(c,g,o,0,null,!1,!1,"",c1);return o._reactRootContainer=B,o[Ja]=B.current,Bl(o.nodeType===8?o.parentNode:o),Ai(),B}for(;w=o.lastChild;)o.removeChild(w);if(typeof g=="function"){var le=g;g=function(){var be=wd(pe);le.call(be)}}var pe=I0(o,0,!1,null,null,!1,!1,"",c1);return o._reactRootContainer=pe,o[Ja]=pe.current,Bl(o.nodeType===8?o.parentNode:o),Ai(function(){kd(c,pe,h,g)}),pe}function Cd(o,c,h,g,w){var _=h._reactRootContainer;if(_){var B=_;if(typeof w=="function"){var le=w;w=function(){var pe=wd(B);le.call(pe)}}kd(c,B,o,w)}else B=iE(h,c,o,w,g);return wd(B)}Hg=function(o){switch(o.tag){case 3:var c=o.stateNode;if(c.current.memoizedState.isDehydrated){var h=Cl(c.pendingLanes);h!==0&&(af(c,h|1),Tr(c,Ue()),(Nt&6)===0&&(Po=Ue()+500,Us()))}break;case 13:Ai(function(){var g=ns(o,1);if(g!==null){var w=vr();_a(g,o,1,w)}}),P0(o,1)}},sf=function(o){if(o.tag===13){var c=ns(o,134217728);if(c!==null){var h=vr();_a(c,o,134217728,h)}P0(o,134217728)}},Gg=function(o){if(o.tag===13){var c=Vs(o),h=ns(o,c);if(h!==null){var g=vr();_a(h,o,c,g)}P0(o,c)}},$g=function(){return Pt},Vg=function(o,c){var h=Pt;try{return Pt=o,c()}finally{Pt=h}},Ts=function(o,c,h){switch(c){case"input":if(we(o,h),c=h.name,h.type==="radio"&&c!=null){for(h=o;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<h.length;c++){var g=h[c];if(g!==o&&g.form===o.form){var w=zu(g);if(!w)throw Error(n(90));G(g),we(g,w)}}}break;case"textarea":dt(o,h);break;case"select":c=h.value,c!=null&&Pe(o,!!h.multiple,c,!1)}},ku=E0,wu=Ai;var oE={usingClientEntryPoint:!1,Events:[Wl,ko,zu,vu,yu,E0]},nc={findFiberByHostInstance:wi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},lE={bundleType:nc.bundleType,version:nc.version,rendererPackageName:nc.rendererPackageName,rendererConfig:nc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=Ne(o),o===null?null:o.stateNode},findFiberByHostInstance:nc.findFiberByHostInstance||sE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Nd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Nd.isDisabled&&Nd.supportsFiber)try{Fa=Nd.inject(lE),Fn=Nd}catch{}}return br.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oE,br.createPortal=function(o,c){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!O0(c))throw Error(n(200));return aE(o,c,null,h)},br.createRoot=function(o,c){if(!O0(o))throw Error(n(299));var h=!1,g="",w=l1;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(g=c.identifierPrefix),c.onRecoverableError!==void 0&&(w=c.onRecoverableError)),c=I0(o,1,!1,null,null,h,!1,g,w),o[Ja]=c.current,Bl(o.nodeType===8?o.parentNode:o),new D0(c)},br.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var c=o._reactInternals;if(c===void 0)throw typeof o.render=="function"?Error(n(188)):(o=Object.keys(o).join(","),Error(n(268,o)));return o=Ne(c),o=o===null?null:o.stateNode,o},br.flushSync=function(o){return Ai(o)},br.hydrate=function(o,c,h){if(!_d(c))throw Error(n(200));return Cd(null,o,c,!0,h)},br.hydrateRoot=function(o,c,h){if(!O0(o))throw Error(n(405));var g=h!=null&&h.hydratedSources||null,w=!1,_="",B=l1;if(h!=null&&(h.unstable_strictMode===!0&&(w=!0),h.identifierPrefix!==void 0&&(_=h.identifierPrefix),h.onRecoverableError!==void 0&&(B=h.onRecoverableError)),c=i1(c,null,o,1,h??null,w,!1,_,B),o[Ja]=c.current,Bl(o),g)for(o=0;o<g.length;o++)h=g[o],w=h._getVersion,w=w(h._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[h,w]:c.mutableSourceEagerHydrationData.push(h,w);return new Sd(c)},br.render=function(o,c,h){if(!_d(c))throw Error(n(200));return Cd(null,o,c,!1,h)},br.unmountComponentAtNode=function(o){if(!_d(o))throw Error(n(40));return o._reactRootContainer?(Ai(function(){Cd(null,null,o,!1,function(){o._reactRootContainer=null,o[Ja]=null})}),!0):!1},br.unstable_batchedUpdates=E0,br.unstable_renderSubtreeIntoContainer=function(o,c,h,g){if(!_d(h))throw Error(n(200));if(o==null||o._reactInternals===void 0)throw Error(n(38));return Cd(o,c,h,!1,g)},br.version="18.3.1-next-f1338f8080-20240426",br}var x1;function gE(){if(x1)return M0.exports;x1=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),M0.exports=pE(),M0.exports}var v1;function xE(){if(v1)return Ed;v1=1;var e=gE();return Ed.createRoot=e.createRoot,Ed.hydrateRoot=e.hydrateRoot,Ed}var vE=xE();/**
 * react-router v7.10.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var y1="popstate";function yE(e={}){function t(r,s){let{pathname:i,search:l,hash:u}=r.location;return ym("",{pathname:i,search:l,hash:u},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Ac(s)}return wE(t,n,null,e)}function nn(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Yr(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function kE(){return Math.random().toString(36).substring(2,10)}function k1(e,t){return{usr:e.state,key:e.key,idx:t}}function ym(e,t,n=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?ul(t):t,state:n,key:t&&t.key||r||kE()}}function Ac({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function ul(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function wE(e,t,n,r={}){let{window:s=document.defaultView,v5Compat:i=!1}=r,l=s.history,u="POP",d=null,f=m();f==null&&(f=0,l.replaceState({...l.state,idx:f},""));function m(){return(l.state||{idx:null}).idx}function p(){u="POP";let S=m(),C=S==null?null:S-f;f=S,d&&d({action:u,location:y.location,delta:C})}function x(S,C){u="PUSH";let D=ym(y.location,S,C);f=m()+1;let N=k1(D,f),b=y.createHref(D);try{l.pushState(N,"",b)}catch(H){if(H instanceof DOMException&&H.name==="DataCloneError")throw H;s.location.assign(b)}i&&d&&d({action:u,location:y.location,delta:1})}function v(S,C){u="REPLACE";let D=ym(y.location,S,C);f=m();let N=k1(D,f),b=y.createHref(D);l.replaceState(N,"",b),i&&d&&d({action:u,location:y.location,delta:0})}function k(S){return SE(S)}let y={get action(){return u},get location(){return e(s,l)},listen(S){if(d)throw new Error("A history only accepts one active listener");return s.addEventListener(y1,p),d=S,()=>{s.removeEventListener(y1,p),d=null}},createHref(S){return t(s,S)},createURL:k,encodeLocation(S){let C=k(S);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:x,replace:v,go(S){return l.go(S)}};return y}function SE(e,t=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),nn(n,"No window.location.(origin|href) available to create URL");let r=typeof e=="string"?e:Ac(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function iw(e,t,n="/"){return _E(e,t,n,!1)}function _E(e,t,n,r){let s=typeof t=="string"?ul(t):t,i=gs(s.pathname||"/",n);if(i==null)return null;let l=ow(e);CE(l);let u=null;for(let d=0;u==null&&d<l.length;++d){let f=OE(i);u=PE(l[d],f,r)}return u}function ow(e,t=[],n=[],r="",s=!1){let i=(l,u,d=s,f)=>{let m={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:u,route:l};if(m.relativePath.startsWith("/")){if(!m.relativePath.startsWith(r)&&d)return;nn(m.relativePath.startsWith(r),`Absolute route path "${m.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),m.relativePath=m.relativePath.slice(r.length)}let p=us([r,m.relativePath]),x=n.concat(m);l.children&&l.children.length>0&&(nn(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),ow(l.children,t,x,p,d)),!(l.path==null&&!l.index)&&t.push({path:p,score:RE(p,l.index),routesMeta:x})};return e.forEach((l,u)=>{var d;if(l.path===""||!((d=l.path)!=null&&d.includes("?")))i(l,u);else for(let f of lw(l.path))i(l,u,!0,f)}),t}function lw(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let l=lw(r.join("/")),u=[];return u.push(...l.map(d=>d===""?i:[i,d].join("/"))),s&&u.push(...l),u.map(d=>e.startsWith("/")&&d===""?"/":d)}function CE(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:IE(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var NE=/^:[\w-]+$/,EE=3,TE=2,bE=1,AE=10,jE=-2,w1=e=>e==="*";function RE(e,t){let n=e.split("/"),r=n.length;return n.some(w1)&&(r+=jE),t&&(r+=TE),n.filter(s=>!w1(s)).reduce((s,i)=>s+(NE.test(i)?EE:i===""?bE:AE),r)}function IE(e,t){return e.length===t.length&&e.slice(0,-1).every((r,s)=>r===t[s])?e[e.length-1]-t[t.length-1]:0}function PE(e,t,n=!1){let{routesMeta:r}=e,s={},i="/",l=[];for(let u=0;u<r.length;++u){let d=r[u],f=u===r.length-1,m=i==="/"?t:t.slice(i.length)||"/",p=Yd({path:d.relativePath,caseSensitive:d.caseSensitive,end:f},m),x=d.route;if(!p&&f&&n&&!r[r.length-1].route.index&&(p=Yd({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},m)),!p)return null;Object.assign(s,p.params),l.push({params:s,pathname:us([i,p.pathname]),pathnameBase:UE(us([i,p.pathnameBase])),route:x}),p.pathnameBase!=="/"&&(i=us([i,p.pathnameBase]))}return l}function Yd(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=DE(e.path,e.caseSensitive,e.end),s=t.match(n);if(!s)return null;let i=s[0],l=i.replace(/(.)\/+$/,"$1"),u=s.slice(1);return{params:r.reduce((f,{paramName:m,isOptional:p},x)=>{if(m==="*"){let k=u[x]||"";l=i.slice(0,i.length-k.length).replace(/(.)\/+$/,"$1")}const v=u[x];return p&&!v?f[m]=void 0:f[m]=(v||"").replace(/%2F/g,"/"),f},{}),pathname:i,pathnameBase:l,pattern:e}}function DE(e,t=!1,n=!0){Yr(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,u,d)=>(r.push({paramName:u,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(r.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),r]}function OE(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Yr(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function gs(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}var LE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,FE=e=>LE.test(e);function ME(e,t="/"){let{pathname:n,search:r="",hash:s=""}=typeof e=="string"?ul(e):e,i;if(n)if(FE(n))i=n;else{if(n.includes("//")){let l=n;n=n.replace(/\/\/+/g,"/"),Yr(!1,`Pathnames cannot have embedded double slashes - normalizing ${l} -> ${n}`)}n.startsWith("/")?i=S1(n.substring(1),"/"):i=S1(n,t)}else i=t;return{pathname:i,search:zE(r),hash:WE(s)}}function S1(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function z0(e,t,n,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function BE(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function ip(e){let t=BE(e);return t.map((n,r)=>r===t.length-1?n.pathname:n.pathnameBase)}function op(e,t,n,r=!1){let s;typeof e=="string"?s=ul(e):(s={...e},nn(!s.pathname||!s.pathname.includes("?"),z0("?","pathname","search",s)),nn(!s.pathname||!s.pathname.includes("#"),z0("#","pathname","hash",s)),nn(!s.search||!s.search.includes("#"),z0("#","search","hash",s)));let i=e===""||s.pathname==="",l=i?"/":s.pathname,u;if(l==null)u=n;else{let p=t.length-1;if(!r&&l.startsWith("..")){let x=l.split("/");for(;x[0]==="..";)x.shift(),p-=1;s.pathname=x.join("/")}u=p>=0?t[p]:"/"}let d=ME(s,u),f=l&&l!=="/"&&l.endsWith("/"),m=(i||l===".")&&n.endsWith("/");return!d.pathname.endsWith("/")&&(f||m)&&(d.pathname+="/"),d}var us=e=>e.join("/").replace(/\/\/+/g,"/"),UE=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),zE=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,WE=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function HE(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}function GE(e){return e.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var cw=["POST","PUT","PATCH","DELETE"];new Set(cw);var $E=["GET",...cw];new Set($E);var dl=T.createContext(null);dl.displayName="DataRouter";var Ih=T.createContext(null);Ih.displayName="DataRouterState";T.createContext(!1);var uw=T.createContext({isTransitioning:!1});uw.displayName="ViewTransition";var VE=T.createContext(new Map);VE.displayName="Fetchers";var qE=T.createContext(null);qE.displayName="Await";var ha=T.createContext(null);ha.displayName="Navigation";var eu=T.createContext(null);eu.displayName="Location";var fa=T.createContext({outlet:null,matches:[],isDataRoute:!1});fa.displayName="Route";var lp=T.createContext(null);lp.displayName="RouteError";function KE(e,{relative:t}={}){nn(hl(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=T.useContext(ha),{hash:s,pathname:i,search:l}=tu(e,{relative:t}),u=i;return n!=="/"&&(u=i==="/"?n:us([n,i])),r.createHref({pathname:u,search:l,hash:s})}function hl(){return T.useContext(eu)!=null}function ma(){return nn(hl(),"useLocation() may be used only in the context of a <Router> component."),T.useContext(eu).location}var dw="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function hw(e){T.useContext(ha).static||T.useLayoutEffect(e)}function cn(){let{isDataRoute:e}=T.useContext(fa);return e?cT():YE()}function YE(){nn(hl(),"useNavigate() may be used only in the context of a <Router> component.");let e=T.useContext(dl),{basename:t,navigator:n}=T.useContext(ha),{matches:r}=T.useContext(fa),{pathname:s}=ma(),i=JSON.stringify(ip(r)),l=T.useRef(!1);return hw(()=>{l.current=!0}),T.useCallback((d,f={})=>{if(Yr(l.current,dw),!l.current)return;if(typeof d=="number"){n.go(d);return}let m=op(d,JSON.parse(i),s,f.relative==="path");e==null&&t!=="/"&&(m.pathname=m.pathname==="/"?t:us([t,m.pathname])),(f.replace?n.replace:n.push)(m,f.state,f)},[t,n,i,s,e])}var XE=T.createContext(null);function QE(e){let t=T.useContext(fa).outlet;return T.useMemo(()=>t&&T.createElement(XE.Provider,{value:e},t),[t,e])}function ws(){let{matches:e}=T.useContext(fa),t=e[e.length-1];return t?t.params:{}}function tu(e,{relative:t}={}){let{matches:n}=T.useContext(fa),{pathname:r}=ma(),s=JSON.stringify(ip(n));return T.useMemo(()=>op(e,JSON.parse(s),r,t==="path"),[e,s,r,t])}function JE(e,t){return fw(e,t)}function fw(e,t,n,r,s){var D;nn(hl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=T.useContext(ha),{matches:l}=T.useContext(fa),u=l[l.length-1],d=u?u.params:{},f=u?u.pathname:"/",m=u?u.pathnameBase:"/",p=u&&u.route;{let N=p&&p.path||"";mw(f,!p||N.endsWith("*")||N.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${N}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${N}"> to <Route path="${N==="/"?"*":`${N}/*`}">.`)}let x=ma(),v;if(t){let N=typeof t=="string"?ul(t):t;nn(m==="/"||((D=N.pathname)==null?void 0:D.startsWith(m)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${m}" but pathname "${N.pathname}" was given in the \`location\` prop.`),v=N}else v=x;let k=v.pathname||"/",y=k;if(m!=="/"){let N=m.replace(/^\//,"").split("/");y="/"+k.replace(/^\//,"").split("/").slice(N.length).join("/")}let S=iw(e,{pathname:y});Yr(p||S!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),Yr(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let C=rT(S&&S.map(N=>Object.assign({},N,{params:Object.assign({},d,N.params),pathname:us([m,i.encodeLocation?i.encodeLocation(N.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?m:us([m,i.encodeLocation?i.encodeLocation(N.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:N.pathnameBase])})),l,n,r,s);return t&&C?T.createElement(eu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},C):C}function ZE(){let e=lT(),t=HE(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},l=null;return console.error("Error handled by React Router default ErrorBoundary:",e),l=T.createElement(T.Fragment,null,T.createElement("p",null," Hey developer "),T.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",T.createElement("code",{style:i},"ErrorBoundary")," or"," ",T.createElement("code",{style:i},"errorElement")," prop on your route.")),T.createElement(T.Fragment,null,T.createElement("h2",null,"Unexpected Application Error!"),T.createElement("h3",{style:{fontStyle:"italic"}},t),n?T.createElement("pre",{style:s},n):null,l)}var eT=T.createElement(ZE,null),tT=class extends T.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError?this.props.onError(e,t):console.error("React Router caught the following error during render",e)}render(){return this.state.error!==void 0?T.createElement(fa.Provider,{value:this.props.routeContext},T.createElement(lp.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function nT({routeContext:e,match:t,children:n}){let r=T.useContext(dl);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),T.createElement(fa.Provider,{value:e},n)}function rT(e,t=[],n=null,r=null,s=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let i=e,l=n==null?void 0:n.errors;if(l!=null){let m=i.findIndex(p=>p.route.id&&(l==null?void 0:l[p.route.id])!==void 0);nn(m>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),i=i.slice(0,Math.min(i.length,m+1))}let u=!1,d=-1;if(n)for(let m=0;m<i.length;m++){let p=i[m];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(d=m),p.route.id){let{loaderData:x,errors:v}=n,k=p.route.loader&&!x.hasOwnProperty(p.route.id)&&(!v||v[p.route.id]===void 0);if(p.route.lazy||k){u=!0,d>=0?i=i.slice(0,d+1):i=[i[0]];break}}}let f=n&&r?(m,p)=>{var x,v;r(m,{location:n.location,params:((v=(x=n.matches)==null?void 0:x[0])==null?void 0:v.params)??{},unstable_pattern:GE(n.matches),errorInfo:p})}:void 0;return i.reduceRight((m,p,x)=>{let v,k=!1,y=null,S=null;n&&(v=l&&p.route.id?l[p.route.id]:void 0,y=p.route.errorElement||eT,u&&(d<0&&x===0?(mw("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),k=!0,S=null):d===x&&(k=!0,S=p.route.hydrateFallbackElement||null)));let C=t.concat(i.slice(0,x+1)),D=()=>{let N;return v?N=y:k?N=S:p.route.Component?N=T.createElement(p.route.Component,null):p.route.element?N=p.route.element:N=m,T.createElement(nT,{match:p,routeContext:{outlet:m,matches:C,isDataRoute:n!=null},children:N})};return n&&(p.route.ErrorBoundary||p.route.errorElement||x===0)?T.createElement(tT,{location:n.location,revalidation:n.revalidation,component:y,error:v,children:D(),routeContext:{outlet:null,matches:C,isDataRoute:!0},onError:f}):D()},null)}function cp(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function aT(e){let t=T.useContext(dl);return nn(t,cp(e)),t}function sT(e){let t=T.useContext(Ih);return nn(t,cp(e)),t}function iT(e){let t=T.useContext(fa);return nn(t,cp(e)),t}function up(e){let t=iT(e),n=t.matches[t.matches.length-1];return nn(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function oT(){return up("useRouteId")}function lT(){var r;let e=T.useContext(lp),t=sT("useRouteError"),n=up("useRouteError");return e!==void 0?e:(r=t.errors)==null?void 0:r[n]}function cT(){let{router:e}=aT("useNavigate"),t=up("useNavigate"),n=T.useRef(!1);return hw(()=>{n.current=!0}),T.useCallback(async(s,i={})=>{Yr(n.current,dw),n.current&&(typeof s=="number"?await e.navigate(s):await e.navigate(s,{fromRouteId:t,...i}))},[e,t])}var _1={};function mw(e,t,n){!t&&!_1[e]&&(_1[e]=!0,Yr(!1,n))}T.memo(uT);function uT({routes:e,future:t,state:n,unstable_onError:r}){return fw(e,void 0,n,r,t)}function pw({to:e,replace:t,state:n,relative:r}){nn(hl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=T.useContext(ha);Yr(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=T.useContext(fa),{pathname:l}=ma(),u=cn(),d=op(e,ip(i),l,r==="path"),f=JSON.stringify(d);return T.useEffect(()=>{u(JSON.parse(f),{replace:t,state:n,relative:r})},[u,f,r,t,n]),null}function dT(e){return QE(e.context)}function _t(e){nn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function hT({basename:e="/",children:t=null,location:n,navigationType:r="POP",navigator:s,static:i=!1,unstable_useTransitions:l}){nn(!hl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=e.replace(/^\/*/,"/"),d=T.useMemo(()=>({basename:u,navigator:s,static:i,unstable_useTransitions:l,future:{}}),[u,s,i,l]);typeof n=="string"&&(n=ul(n));let{pathname:f="/",search:m="",hash:p="",state:x=null,key:v="default"}=n,k=T.useMemo(()=>{let y=gs(f,u);return y==null?null:{location:{pathname:y,search:m,hash:p,state:x,key:v},navigationType:r}},[u,f,m,p,x,v,r]);return Yr(k!=null,`<Router basename="${u}"> is not able to match the URL "${f}${m}${p}" because it does not start with the basename, so the <Router> won't render anything.`),k==null?null:T.createElement(ha.Provider,{value:d},T.createElement(eu.Provider,{children:t,value:k}))}function fT({children:e,location:t}){return JE(km(e),t)}function km(e,t=[]){let n=[];return T.Children.forEach(e,(r,s)=>{if(!T.isValidElement(r))return;let i=[...t,s];if(r.type===T.Fragment){n.push.apply(n,km(r.props.children,i));return}nn(r.type===_t,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),nn(!r.props.index||!r.props.children,"An index route cannot have child routes.");let l={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=km(r.props.children,i)),n.push(l)}),n}var $d="get",Vd="application/x-www-form-urlencoded";function Ph(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement}function mT(e){return Ph(e)&&e.tagName.toLowerCase()==="button"}function pT(e){return Ph(e)&&e.tagName.toLowerCase()==="form"}function gT(e){return Ph(e)&&e.tagName.toLowerCase()==="input"}function xT(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function vT(e,t){return e.button===0&&(!t||t==="_self")&&!xT(e)}function wm(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function yT(e,t){let n=wm(e);return t&&t.forEach((r,s)=>{n.has(s)||t.getAll(s).forEach(i=>{n.append(s,i)})}),n}var Td=null;function kT(){if(Td===null)try{new FormData(document.createElement("form"),0),Td=!1}catch{Td=!0}return Td}var wT=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function W0(e){return e!=null&&!wT.has(e)?(Yr(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Vd}"`),null):e}function ST(e,t){let n,r,s,i,l;if(pT(e)){let u=e.getAttribute("action");r=u?gs(u,t):null,n=e.getAttribute("method")||$d,s=W0(e.getAttribute("enctype"))||Vd,i=new FormData(e)}else if(mT(e)||gT(e)&&(e.type==="submit"||e.type==="image")){let u=e.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=e.getAttribute("formaction")||u.getAttribute("action");if(r=d?gs(d,t):null,n=e.getAttribute("formmethod")||u.getAttribute("method")||$d,s=W0(e.getAttribute("formenctype"))||W0(u.getAttribute("enctype"))||Vd,i=new FormData(u,e),!kT()){let{name:f,type:m,value:p}=e;if(m==="image"){let x=f?`${f}.`:"";i.append(`${x}x`,"0"),i.append(`${x}y`,"0")}else f&&i.append(f,p)}}else{if(Ph(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=$d,r=null,s=Vd,l=e}return i&&s==="text/plain"&&(l=i,i=void 0),{action:r,method:n.toLowerCase(),encType:s,formData:i,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function dp(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function _T(e,t,n){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r.pathname==="/"?r.pathname=`_root.${n}`:t&&gs(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function CT(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function NT(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function ET(e,t,n){let r=await Promise.all(e.map(async s=>{let i=t.routes[s.route.id];if(i){let l=await CT(i,n);return l.links?l.links():[]}return[]}));return jT(r.flat(1).filter(NT).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function C1(e,t,n,r,s,i){let l=(d,f)=>n[f]?d.route.id!==n[f].route.id:!0,u=(d,f)=>{var m;return n[f].pathname!==d.pathname||((m=n[f].route.path)==null?void 0:m.endsWith("*"))&&n[f].params["*"]!==d.params["*"]};return i==="assets"?t.filter((d,f)=>l(d,f)||u(d,f)):i==="data"?t.filter((d,f)=>{var p;let m=r.routes[d.route.id];if(!m||!m.hasLoader)return!1;if(l(d,f)||u(d,f))return!0;if(d.route.shouldRevalidate){let x=d.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((p=n[0])==null?void 0:p.params)||{},nextUrl:new URL(e,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function TT(e,t,{includeHydrateFallback:n}={}){return bT(e.map(r=>{let s=t.routes[r.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),n&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function bT(e){return[...new Set(e)]}function AT(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}function jT(e,t){let n=new Set;return new Set(t),e.reduce((r,s)=>{let i=JSON.stringify(AT(s));return n.has(i)||(n.add(i),r.push({key:i,link:s})),r},[])}function gw(){let e=T.useContext(dl);return dp(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function RT(){let e=T.useContext(Ih);return dp(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var hp=T.createContext(void 0);hp.displayName="FrameworkContext";function xw(){let e=T.useContext(hp);return dp(e,"You must render this element inside a <HydratedRouter> element"),e}function IT(e,t){let n=T.useContext(hp),[r,s]=T.useState(!1),[i,l]=T.useState(!1),{onFocus:u,onBlur:d,onMouseEnter:f,onMouseLeave:m,onTouchStart:p}=t,x=T.useRef(null);T.useEffect(()=>{if(e==="render"&&l(!0),e==="viewport"){let y=C=>{C.forEach(D=>{l(D.isIntersecting)})},S=new IntersectionObserver(y,{threshold:.5});return x.current&&S.observe(x.current),()=>{S.disconnect()}}},[e]),T.useEffect(()=>{if(r){let y=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(y)}}},[r]);let v=()=>{s(!0)},k=()=>{s(!1),l(!1)};return n?e!=="intent"?[i,x,{}]:[i,x,{onFocus:ac(u,v),onBlur:ac(d,k),onMouseEnter:ac(f,v),onMouseLeave:ac(m,k),onTouchStart:ac(p,v)}]:[!1,x,{}]}function ac(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function PT({page:e,...t}){let{router:n}=gw(),r=T.useMemo(()=>iw(n.routes,e,n.basename),[n.routes,e,n.basename]);return r?T.createElement(OT,{page:e,matches:r,...t}):null}function DT(e){let{manifest:t,routeModules:n}=xw(),[r,s]=T.useState([]);return T.useEffect(()=>{let i=!1;return ET(e,t,n).then(l=>{i||s(l)}),()=>{i=!0}},[e,t,n]),r}function OT({page:e,matches:t,...n}){let r=ma(),{manifest:s,routeModules:i}=xw(),{basename:l}=gw(),{loaderData:u,matches:d}=RT(),f=T.useMemo(()=>C1(e,t,d,s,r,"data"),[e,t,d,s,r]),m=T.useMemo(()=>C1(e,t,d,s,r,"assets"),[e,t,d,s,r]),p=T.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let k=new Set,y=!1;if(t.forEach(C=>{var N;let D=s.routes[C.route.id];!D||!D.hasLoader||(!f.some(b=>b.route.id===C.route.id)&&C.route.id in u&&((N=i[C.route.id])!=null&&N.shouldRevalidate)||D.hasClientLoader?y=!0:k.add(C.route.id))}),k.size===0)return[];let S=_T(e,l,"data");return y&&k.size>0&&S.searchParams.set("_routes",t.filter(C=>k.has(C.route.id)).map(C=>C.route.id).join(",")),[S.pathname+S.search]},[l,u,r,s,f,t,e,i]),x=T.useMemo(()=>TT(m,s),[m,s]),v=DT(m);return T.createElement(T.Fragment,null,p.map(k=>T.createElement("link",{key:k,rel:"prefetch",as:"fetch",href:k,...n})),x.map(k=>T.createElement("link",{key:k,rel:"modulepreload",href:k,...n})),v.map(({key:k,link:y})=>T.createElement("link",{key:k,nonce:n.nonce,...y})))}function LT(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var vw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{vw&&(window.__reactRouterVersion="7.10.0")}catch{}function FT({basename:e,children:t,unstable_useTransitions:n,window:r}){let s=T.useRef();s.current==null&&(s.current=yE({window:r,v5Compat:!0}));let i=s.current,[l,u]=T.useState({action:i.action,location:i.location}),d=T.useCallback(f=>{n===!1?u(f):T.startTransition(()=>u(f))},[n]);return T.useLayoutEffect(()=>i.listen(d),[i,d]),T.createElement(hT,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:i,unstable_useTransitions:n===!0})}var yw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,vt=T.forwardRef(function({onClick:t,discover:n="render",prefetch:r="none",relative:s,reloadDocument:i,replace:l,state:u,target:d,to:f,preventScrollReset:m,viewTransition:p,...x},v){let{basename:k,unstable_useTransitions:y}=T.useContext(ha),S=typeof f=="string"&&yw.test(f),C,D=!1;if(typeof f=="string"&&S&&(C=f,vw))try{let V=new URL(window.location.href),X=f.startsWith("//")?new URL(V.protocol+f):new URL(f),M=gs(X.pathname,k);X.origin===V.origin&&M!=null?f=M+X.search+X.hash:D=!0}catch{Yr(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let N=KE(f,{relative:s}),[b,H,L]=IT(r,x),R=UT(f,{replace:l,state:u,target:d,preventScrollReset:m,relative:s,viewTransition:p,unstable_useTransitions:y});function q(V){t&&t(V),V.defaultPrevented||R(V)}let O=T.createElement("a",{...x,...L,href:C||N,onClick:D||i?t:q,ref:LT(v,H),target:d,"data-discover":!S&&n==="render"?"true":void 0});return b&&!S?T.createElement(T.Fragment,null,O,T.createElement(PT,{page:N})):O});vt.displayName="Link";var kw=T.forwardRef(function({"aria-current":t="page",caseSensitive:n=!1,className:r="",end:s=!1,style:i,to:l,viewTransition:u,children:d,...f},m){let p=tu(l,{relative:f.relative}),x=ma(),v=T.useContext(Ih),{navigator:k,basename:y}=T.useContext(ha),S=v!=null&&$T(p)&&u===!0,C=k.encodeLocation?k.encodeLocation(p).pathname:p.pathname,D=x.pathname,N=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;n||(D=D.toLowerCase(),N=N?N.toLowerCase():null,C=C.toLowerCase()),N&&y&&(N=gs(N,y)||N);const b=C!=="/"&&C.endsWith("/")?C.length-1:C.length;let H=D===C||!s&&D.startsWith(C)&&D.charAt(b)==="/",L=N!=null&&(N===C||!s&&N.startsWith(C)&&N.charAt(C.length)==="/"),R={isActive:H,isPending:L,isTransitioning:S},q=H?t:void 0,O;typeof r=="function"?O=r(R):O=[r,H?"active":null,L?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let V=typeof i=="function"?i(R):i;return T.createElement(vt,{...f,"aria-current":q,className:O,ref:m,style:V,to:l,viewTransition:u},typeof d=="function"?d(R):d)});kw.displayName="NavLink";var MT=T.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:r,replace:s,state:i,method:l=$d,action:u,onSubmit:d,relative:f,preventScrollReset:m,viewTransition:p,...x},v)=>{let{unstable_useTransitions:k}=T.useContext(ha),y=HT(),S=GT(u,{relative:f}),C=l.toLowerCase()==="get"?"get":"post",D=typeof u=="string"&&yw.test(u),N=b=>{if(d&&d(b),b.defaultPrevented)return;b.preventDefault();let H=b.nativeEvent.submitter,L=(H==null?void 0:H.getAttribute("formmethod"))||l,R=()=>y(H||b.currentTarget,{fetcherKey:t,method:L,navigate:n,replace:s,state:i,relative:f,preventScrollReset:m,viewTransition:p});k&&n!==!1?T.startTransition(()=>R()):R()};return T.createElement("form",{ref:v,method:C,action:S,onSubmit:r?d:N,...x,"data-discover":!D&&e==="render"?"true":void 0})});MT.displayName="Form";function BT(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ww(e){let t=T.useContext(dl);return nn(t,BT(e)),t}function UT(e,{target:t,replace:n,state:r,preventScrollReset:s,relative:i,viewTransition:l,unstable_useTransitions:u}={}){let d=cn(),f=ma(),m=tu(e,{relative:i});return T.useCallback(p=>{if(vT(p,t)){p.preventDefault();let x=n!==void 0?n:Ac(f)===Ac(m),v=()=>d(e,{replace:x,state:r,preventScrollReset:s,relative:i,viewTransition:l});u?T.startTransition(()=>v()):v()}},[f,d,m,n,r,t,e,s,i,l,u])}function hi(e){Yr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=T.useRef(wm(e)),n=T.useRef(!1),r=ma(),s=T.useMemo(()=>yT(r.search,n.current?null:t.current),[r.search]),i=cn(),l=T.useCallback((u,d)=>{const f=wm(typeof u=="function"?u(new URLSearchParams(s)):u);n.current=!0,i("?"+f,d)},[i,s]);return[s,l]}var zT=0,WT=()=>`__${String(++zT)}__`;function HT(){let{router:e}=ww("useSubmit"),{basename:t}=T.useContext(ha),n=oT(),r=e.fetch,s=e.navigate;return T.useCallback(async(i,l={})=>{let{action:u,method:d,encType:f,formData:m,body:p}=ST(i,t);if(l.navigate===!1){let x=l.fetcherKey||WT();await r(x,n,l.action||u,{preventScrollReset:l.preventScrollReset,formData:m,body:p,formMethod:l.method||d,formEncType:l.encType||f,flushSync:l.flushSync})}else await s(l.action||u,{preventScrollReset:l.preventScrollReset,formData:m,body:p,formMethod:l.method||d,formEncType:l.encType||f,replace:l.replace,state:l.state,fromRouteId:n,flushSync:l.flushSync,viewTransition:l.viewTransition})},[r,s,t,n])}function GT(e,{relative:t}={}){let{basename:n}=T.useContext(ha),r=T.useContext(fa);nn(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),i={...tu(e||".",{relative:t})},l=ma();if(e==null){i.search=l.search;let u=new URLSearchParams(i.search),d=u.getAll("index");if(d.some(m=>m==="")){u.delete("index"),d.filter(p=>p).forEach(p=>u.append("index",p));let m=u.toString();i.search=m?`?${m}`:""}}return(!e||e===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:us([n,i.pathname])),Ac(i)}function $T(e,{relative:t}={}){let n=T.useContext(uw);nn(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=ww("useViewTransitionState"),s=tu(e,{relative:t});if(!n.isTransitioning)return!1;let i=gs(n.currentLocation.pathname,r)||n.currentLocation.pathname,l=gs(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Yd(s.pathname,l)!=null||Yd(s.pathname,i)!=null}const Sw=T.createContext(null),Sm=[{id:"dashboard",name:"Dashboard",path:"/",group:"core"},{id:"container_list",name:"All Containers",path:"/containers",group:"container"},{id:"container_register",name:"Register Container",path:"/containers/register",group:"container"},{id:"container_ar",name:"AR Containers",path:"/containers/ar",group:"container"},{id:"survey_new",name:"New Survey",path:"/survey/new",group:"survey"},{id:"survey_list",name:"Survey List",path:"/surveys",group:"survey"},{id:"eor_list",name:"EOR List",path:"/eor",group:"eor"},{id:"eor_new",name:"Create EOR",path:"/eor/new",group:"eor"},{id:"eor_detail",name:"EOR Detail",path:"/eor/:id",group:"eor"},{id:"repair_list",name:"Repair Orders",path:"/repair-orders",group:"repair"},{id:"shunting",name:"Shunting",path:"/shunting",group:"operations"},{id:"inspection",name:"Pre-Inspection",path:"/pre-inspection",group:"operations"},{id:"washing",name:"Washing Station",path:"/washing",group:"operations"},{id:"stacking",name:"Stacking & Release",path:"/stacking",group:"operations"},{id:"job_monitoring",name:"Job Monitoring",path:"/monitoring/jobs",group:"monitoring"},{id:"config_codes",name:"Master Codes",path:"/admin/codes",group:"admin"},{id:"config_groups",name:"Permission Groups",path:"/admin/groups",group:"admin"},{id:"config_users",name:"User Management",path:"/admin/users",group:"admin"},{id:"config_settings",name:"System Settings",path:"/admin/settings",group:"admin"},{id:"config_homepage",name:"Home Page Management",path:"/admin/homepage",group:"admin"},{id:"config_chats",name:"Chat Management",path:"/admin/chats",group:"admin"}],N1=[{id:"admin",name:"Administrator",description:"Full system access",screens:Sm.map(e=>e.id),functions:["create","read","update","delete","approve","export","delete_job"]},{id:"surveyor",name:"Surveyor",description:"Survey and container inspection",screens:["dashboard","container_list","survey_new","survey_list"],functions:["create","read","update"]},{id:"estimator",name:"Estimator",description:"EOR creation and management",screens:["dashboard","container_list","survey_list","eor_list","eor_new","eor_detail"],functions:["create","read","update"]},{id:"operator",name:"Operator",description:"Repair and operations",screens:["dashboard","repair_list","shunting","inspection","washing","stacking"],functions:["create","read","update"]},{id:"viewer",name:"Viewer",description:"Read-only access",screens:["dashboard","container_list","survey_list","eor_list","repair_list"],functions:["read"]}],E1={LINERS:[{code:"MSC",name:"Mediterranean Shipping Company",address:"12-14 Chemin Rieu, Geneva, Switzerland",email:"mnr@msc.com",active:!0},{code:"MSK",name:"Maersk Line",address:"Esplanaden 50, Copenhagen, Denmark",email:"mnr@maersk.com",active:!0},{code:"CMA",name:"CMA CGM",address:"4 Quai d'Arenc, Marseille, France",email:"mnr@cma-cgm.com",active:!0},{code:"CSL",name:"COSCO Shipping",address:"628 Minsheng Road, Shanghai, China",email:"mnr@cosco.com",active:!0},{code:"HPL",name:"Hapag-Lloyd",address:"Ballindamm 25, Hamburg, Germany",email:"mnr@hapag-lloyd.com",active:!0},{code:"ONE",name:"Ocean Network Express",address:"Ocean Gate, Singapore",email:"mnr@one-line.com",active:!0},{code:"EVG",name:"Evergreen Marine",address:"No. 166, Sec. 2, Minzu E. Rd., Taipei, Taiwan",email:"mnr@evergreen.com",active:!0},{code:"YML",name:"Yang Ming Line",address:"No. 271, Ming De 1st Rd., Keelung, Taiwan",email:"mnr@yangming.com",active:!0},{code:"PIL",name:"Pacific International Lines",address:"140 Cecil Street, Singapore",email:"mnr@pilship.com",active:!0},{code:"ZIM",name:"ZIM Integrated Shipping",address:"9 Andrei Sakharov St., Haifa, Israel",email:"mnr@zim.com",active:!0}],CONTAINER_SIZES:[{code:"20",name:"20 Feet",active:!0},{code:"40",name:"40 Feet",active:!0},{code:"45",name:"45 Feet",active:!0}],CONTAINER_TYPES:[{code:"DRY",name:"Dry Container",active:!0},{code:"REEFER",name:"Refrigerated",active:!0},{code:"TANK",name:"Tank Container",active:!0},{code:"FLAT",name:"Flat Rack",active:!0},{code:"OPEN",name:"Open Top",active:!0}],DAMAGE_LOCATIONS:[{code:"FR",name:"Front",active:!0},{code:"FL",name:"Front Left",active:!0},{code:"FRR",name:"Front Right",active:!0},{code:"L",name:"Left",active:!0},{code:"R",name:"Right",active:!0},{code:"B",name:"Bottom",active:!0},{code:"T",name:"Top",active:!0},{code:"RR",name:"Rear",active:!0},{code:"RL",name:"Rear Left",active:!0},{code:"RRR",name:"Rear Right",active:!0},{code:"I",name:"Interior",active:!0}],DAMAGE_TYPES:[{code:"D",name:"Dent",active:!0},{code:"H",name:"Hole",active:!0},{code:"C",name:"Cut",active:!0},{code:"B",name:"Bent",active:!0},{code:"R",name:"Rust",active:!0},{code:"CR",name:"Crack",active:!0},{code:"BR",name:"Broken",active:!0},{code:"MS",name:"Missing",active:!0},{code:"WR",name:"Worn",active:!0}],COMPONENTS:[{code:"P",name:"Panel",active:!0},{code:"DR",name:"Door",active:!0},{code:"FL",name:"Floor",active:!0},{code:"RF",name:"Roof",active:!0},{code:"CR",name:"Corner Post",active:!0},{code:"BR",name:"Bottom Rail",active:!0},{code:"TR",name:"Top Rail",active:!0},{code:"SR",name:"Side Rail",active:!0},{code:"CS",name:"Cross Member",active:!0},{code:"LK",name:"Lock",active:!0},{code:"HL",name:"Handle",active:!0},{code:"HG",name:"Hinge",active:!0},{code:"GS",name:"Gasket",active:!0}],REPAIR_METHODS:[{code:"WLD",name:"Welding",unitPrice:25,active:!0},{code:"REP",name:"Replace",unitPrice:100,active:!0},{code:"STR",name:"Straighten",unitPrice:30,active:!0},{code:"PNT",name:"Paint",unitPrice:15,active:!0},{code:"CLN",name:"Clean",unitPrice:10,active:!0},{code:"PTH",name:"Patch",unitPrice:50,active:!0}],SEVERITY_LEVELS:[{code:"L",name:"Light",multiplier:1,active:!0},{code:"M",name:"Medium",multiplier:1.5,active:!0},{code:"H",name:"Heavy",multiplier:2,active:!0},{code:"S",name:"Severe",multiplier:3,active:!0}],SURVEY_TYPES:[{code:"INBOUND",name:"Inbound Survey",active:!0},{code:"OUTBOUND",name:"Outbound Survey",active:!0},{code:"PERIODIC",name:"Periodic Inspection",active:!0},{code:"DAMAGE",name:"Damage Survey",active:!0}],CONTAINER_STATUSES:[{code:"STACKING",name:"Stacking",color:"#8c8c8c",active:!0},{code:"PENDING_WASH",name:"Pending Wash",color:"#13c2c2",active:!0},{code:"WASHING",name:"Washing",color:"#1677ff",active:!0},{code:"DM",name:"Damaged",color:"#ff4d4f",active:!0},{code:"AR",name:"Awaiting Repair",color:"#faad14",active:!0},{code:"RP",name:"In Repair",color:"#1677ff",active:!0},{code:"QC",name:"Quality Check",color:"#722ed1",active:!0},{code:"AV",name:"Available",color:"#52c41a",active:!0},{code:"GO",name:"Gate Out",color:"#8c8c8c",active:!0}],INITIAL_CONDITIONS:[{code:"DAMAGED",name:"Damaged (C h hng)",active:!0},{code:"NO_DAMAGE",name:"No Damage (Khng h hng)",active:!0}],ANNOUNCEMENTS:[{id:"ann_1",title:"Implementation of new Safety And Security System",content:"The new Safety and Security System (SNS) will be implemented by 1st December 2025. All users are advised to complete safety training.",createdAt:"2025-12-01T00:00:00Z",createdBy:"ADMIN",active:!0},{id:"ann_2",title:"Introduction of new Dangerous Cargo declaration system",content:"A new Dangerous Cargo declaration system has been introduced. Please refer to the updated guidelines for compliance.",createdAt:"2025-11-15T00:00:00Z",createdBy:"ADMIN",active:!0}],LINKS:[{id:"link_1",title:"Lembaga Pelabuhan Johor",url:"https://www.lpj.gov.my",description:"Johor Port Authority",createdAt:"2025-01-01T00:00:00Z",createdBy:"ADMIN",active:!0},{id:"link_2",title:"Kastam Diraja Malaysia",url:"https://www.customs.gov.my",description:"Royal Malaysian Customs",createdAt:"2025-01-01T00:00:00Z",createdBy:"ADMIN",active:!0},{id:"link_3",title:"MAQIS",url:"https://www.maqis.gov.my",description:"Malaysian Quarantine and Inspection Services",createdAt:"2025-01-01T00:00:00Z",createdBy:"ADMIN",active:!0},{id:"link_4",title:"Kementerian Kesihatan Malaysia",url:"https://www.moh.gov.my",description:"Ministry of Health Malaysia",createdAt:"2025-01-01T00:00:00Z",createdBy:"ADMIN",active:!0}],BENEFITS:[{id:"ben_1",roleType:"Shipping Agent",content:"Johor Port Portal will help Shipping Agent in carrying their day-to-day business transaction in simple way and effortlessly",createdAt:"2025-01-01T00:00:00Z",createdBy:"ADMIN",active:!0},{id:"ben_2",roleType:"Forwarding Agent",content:"Streamline your forwarding operations with real-time cargo tracking and automated documentation processing",createdAt:"2025-01-01T00:00:00Z",createdBy:"ADMIN",active:!0},{id:"ben_3",roleType:"Shipper/Consignee",content:"Access your shipment information anytime, anywhere with comprehensive visibility and control",createdAt:"2025-01-01T00:00:00Z",createdBy:"ADMIN",active:!0}],WELCOME_TEXT:[{id:"welcome_1",titleLine:"SINGLE ACCESS FOR SHIPPING AGENTS, FORWARDING AGENTS AND SHIPPERS / CONSIGNEES.",subtitleLine:"Manage container operations, track cargo and access Johor Port services from a unified, secure interface.",createdAt:"2025-01-01T00:00:00Z",createdBy:"ADMIN",active:!0}],INSPECTION_CHECKLIST:[{id:"structural",code:"STRUCTURAL",label:"Structural Integrity",description:"No dents, holes, or deformation",active:!0},{id:"doors",code:"DOORS",label:"Door Operation",description:"Doors open/close properly, seals intact",active:!0},{id:"floor",code:"FLOOR",label:"Floor Condition",description:"Floor boards secure, no rot or damage",active:!0},{id:"roof",code:"ROOF",label:"Roof Condition",description:"No leaks, patches properly sealed",active:!0},{id:"paint",code:"PAINT",label:"Paint and Finish",description:"Even paint coverage, no rust visible",active:!0},{id:"placards",code:"PLACARDS",label:"Placards and Labels",description:"All required markings present",active:!0},{id:"locking",code:"LOCKING",label:"Locking Mechanism",description:"Lock bars and handles functional",active:!0},{id:"cleanliness",code:"CLEANLINESS",label:"Cleanliness",description:"Interior clean, no debris",active:!0},{id:"post_repair_slag",code:"POST_REPAIR_SLAG",label:"Welding Slag Removed",description:"All welding slag and spatter cleaned",category:"POST_REPAIR_CLEAN",active:!0},{id:"post_repair_debris",code:"POST_REPAIR_DEBRIS",label:"Debris Swept",description:"All repair debris and dust removed",category:"POST_REPAIR_CLEAN",active:!0},{id:"post_repair_grease",code:"POST_REPAIR_GREASE",label:"Oil/Grease Cleaned",description:"No oil, grease, or lubricant residue",category:"POST_REPAIR_CLEAN",active:!0},{id:"post_repair_touchup",code:"POST_REPAIR_TOUCHUP",label:"Touch-up Paint Applied",description:"Touch-up paint applied to repaired areas",category:"POST_REPAIR_CLEAN",active:!0}],CLEANING_PROGRAMS:[{code:"BASIC_WASH",name:"Basic Wash",description:"Standard cleaning for dry containers",containerTypes:["DRY","OPEN_TOP","FLAT_RACK"],estimatedMinutes:30,defaultCost:50,requiresSafetyGear:!1,active:!0},{code:"HIGH_PRESSURE",name:"High-Pressure Wash",description:"Deep cleaning with high-pressure water for stubborn stains",containerTypes:["DRY","OPEN_TOP","FLAT_RACK","REEFER"],estimatedMinutes:45,defaultCost:80,requiresSafetyGear:!1,active:!0},{code:"CHEMICAL_CLEAN",name:"Chemical Clean",description:"Decontamination for hazardous or chemical residues",containerTypes:["DRY","TANK"],estimatedMinutes:90,defaultCost:200,requiresSafetyGear:!0,active:!0},{code:"FOOD_GRADE",name:"Food-Grade Cleaning",description:"Sanitization for food cargo containers",containerTypes:["DRY","REEFER"],estimatedMinutes:60,defaultCost:120,requiresSafetyGear:!1,active:!0},{code:"REEFER_DEEP",name:"Reefer Deep Clean",description:"Complete reefer cleaning including vents, gaskets, drains",containerTypes:["REEFER"],estimatedMinutes:120,defaultCost:250,requiresSafetyGear:!1,active:!0}],CLEANING_CHECKLISTS:{BASIC_WASH:[{id:"sweep_debris",label:"Sweep out debris",category:"INTERIOR",required:!0},{id:"wash_floor",label:"Wash floor",category:"INTERIOR",required:!0},{id:"wash_walls",label:"Wash walls",category:"INTERIOR",required:!0},{id:"wash_ceiling",label:"Wash ceiling",category:"INTERIOR",required:!0},{id:"wash_exterior",label:"Wash exterior",category:"EXTERIOR",required:!0},{id:"dry_interior",label:"Dry interior",category:"FINAL",required:!0}],HIGH_PRESSURE:[{id:"sweep_debris",label:"Sweep out debris",category:"INTERIOR",required:!0},{id:"hp_floor",label:"High-pressure wash floor",category:"INTERIOR",required:!0},{id:"hp_walls",label:"High-pressure wash walls",category:"INTERIOR",required:!0},{id:"hp_ceiling",label:"High-pressure wash ceiling",category:"INTERIOR",required:!0},{id:"scrub_stains",label:"Scrub stubborn stains",category:"INTERIOR",required:!0},{id:"wash_exterior",label:"Wash exterior",category:"EXTERIOR",required:!0},{id:"dry_interior",label:"Dry interior completely",category:"FINAL",required:!0}],CHEMICAL_CLEAN:[{id:"ventilate",label:"Ventilate container",category:"SAFETY",required:!0},{id:"check_residue",label:"Identify residue type",category:"SAFETY",required:!0},{id:"apply_neutralizer",label:"Apply neutralizing agent",category:"CHEMICAL",required:!0},{id:"wait_reaction",label:"Wait for reaction time",category:"CHEMICAL",required:!0},{id:"hp_wash",label:"High-pressure wash all surfaces",category:"INTERIOR",required:!0},{id:"rinse_chemical",label:"Rinse off all chemicals",category:"INTERIOR",required:!0},{id:"test_residue",label:"Test for residue (pH test)",category:"FINAL",required:!0},{id:"dry_interior",label:"Dry interior completely",category:"FINAL",required:!0}],FOOD_GRADE:[{id:"sweep_debris",label:"Sweep out all debris",category:"INTERIOR",required:!0},{id:"hp_wash",label:"High-pressure wash all surfaces",category:"INTERIOR",required:!0},{id:"apply_sanitizer",label:"Apply food-grade sanitizer",category:"SANITIZE",required:!0},{id:"scrub_surfaces",label:"Scrub all surfaces",category:"SANITIZE",required:!0},{id:"rinse_sanitizer",label:"Rinse sanitizer thoroughly",category:"INTERIOR",required:!0},{id:"check_odor",label:"Check for any odors",category:"FINAL",required:!0},{id:"dry_interior",label:"Dry interior completely",category:"FINAL",required:!0},{id:"inspect_cleanliness",label:"Final cleanliness inspection",category:"FINAL",required:!0}],REEFER_DEEP:[{id:"sweep_debris",label:"Sweep out debris",category:"INTERIOR",required:!0},{id:"hp_floor",label:"High-pressure wash floor",category:"INTERIOR",required:!0},{id:"hp_walls",label:"High-pressure wash walls",category:"INTERIOR",required:!0},{id:"clean_gaskets",label:"Clean door gaskets",category:"REEFER",required:!0},{id:"clean_vents",label:"Clean ventilators/grilles",category:"REEFER",required:!0},{id:"clear_drains",label:"Clear drain plugs/holes",category:"REEFER",required:!0},{id:"clean_evaporator",label:"Clean evaporator area",category:"REEFER",required:!0},{id:"clean_tbar",label:"Clean T-bar floor rails",category:"REEFER",required:!0},{id:"sanitize",label:"Apply sanitizer",category:"SANITIZE",required:!0},{id:"neutralize_odor",label:"Neutralize any odors",category:"FINAL",required:!0},{id:"dry_interior",label:"Dry interior completely",category:"FINAL",required:!0}]},WASH_BAYS:[{code:"BAY_1",name:"Wash Bay 1",capacity:1,specialType:null,active:!0},{code:"BAY_2",name:"Wash Bay 2",capacity:1,specialType:null,active:!0},{code:"BAY_3",name:"Wash Bay 3",capacity:1,specialType:null,active:!0},{code:"BAY_CHEM",name:"Chemical Bay",capacity:1,specialType:"CHEMICAL",active:!0},{code:"BAY_REEFER",name:"Reefer Bay",capacity:1,specialType:"REEFER",active:!0}],CONTAMINATION_LEVELS:[{code:"LIGHT",name:"Light Dirt",description:"Minimal dirt/dust",suggestedProgram:"BASIC_WASH",safetyAlert:!1,active:!0},{code:"MODERATE",name:"Moderate Dirt/Stains",description:"Visible stains, oil marks",suggestedProgram:"HIGH_PRESSURE",safetyAlert:!1,active:!0},{code:"HEAVY",name:"Heavy Contamination",description:"Heavy dirt, strong odor",suggestedProgram:"HIGH_PRESSURE",safetyAlert:!1,active:!0},{code:"HAZARDOUS",name:"Hazardous Residue",description:"Chemical spills, toxic materials",suggestedProgram:"CHEMICAL_CLEAN",safetyAlert:!0,active:!0},{code:"FOOD_PREV",name:"Previous Food Cargo",description:"Container used for food",suggestedProgram:"FOOD_GRADE",safetyAlert:!1,active:!0}],WASHING_TEAMS:[{code:"WASH_TEAM_A",name:"Washing Team A",members:3,active:!0},{code:"WASH_TEAM_B",name:"Washing Team B",members:3,active:!0},{code:"WASH_CHEM",name:"Chemical Specialists",members:2,active:!0}],INTERIOR_CONDITIONS:[{code:"DIRT_DEBRIS",name:"Dirt/Debris",description:"Dirt or debris present",active:!0},{code:"OIL_GREASE",name:"Oil/Grease",description:"Oil or grease stains",active:!0},{code:"CHEMICAL_RESIDUE",name:"Chemical Residue",description:"Chemical residue present",active:!0},{code:"ODOR_PRESENT",name:"Odor Present",description:"Unpleasant odor detected",active:!0},{code:"PEST_SIGNS",name:"Pest Signs",description:"Signs of pest activity",active:!0},{code:"MOISTURE",name:"Moisture",description:"Moisture or dampness",active:!0}],EXTERIOR_CONDITIONS:[{code:"DIRTY",name:"Dirty",description:"Exterior is dirty",active:!0},{code:"STAINED",name:"Stained",description:"Visible stains on exterior",active:!0},{code:"GRAFFITI",name:"Graffiti",description:"Graffiti markings",active:!0}],QC_CHECKLIST:[{code:"FLOOR_CLEAN",name:"Floor is clean and free of debris",description:"Check floor cleanliness",required:!0,active:!0},{code:"WALLS_CLEAN",name:"Walls and ceiling are clean",description:"Check wall and ceiling cleanliness",required:!0,active:!0},{code:"NO_ODOR",name:"No unpleasant odors",description:"Verify no bad smells",required:!0,active:!0},{code:"NO_STAINS",name:"No visible stains or residue",description:"Check for stains",required:!0,active:!0},{code:"DOOR_SEALS",name:"Door seals and gaskets clean",description:"Inspect door seals",required:!0,active:!0},{code:"EXTERIOR_CLEAN",name:"Exterior is clean",description:"Check exterior cleanliness",required:!1,active:!0},{code:"INTERIOR_DRY",name:"Interior is completely dry",description:"Verify interior is dry",required:!0,active:!0},{code:"CARGO_READY",name:"Ready for cargo loading",description:"Container is cargo-ready",required:!0,active:!0}],DRIVERS:[{code:"driver_01",name:"Ahmad Bin Hassan",phone:"012-3456789",active:!0},{code:"driver_02",name:"Lee Kok Hong",phone:"012-9876543",active:!0},{code:"driver_03",name:"Raju A/L Muthu",phone:"012-5555666",active:!0},{code:"driver_04",name:"Wong Seng Leong",phone:"012-7778889",active:!0},{code:"driver_05",name:"Mohd Faizal Bin Yusof",phone:"013-2223334",active:!0},{code:"driver_06",name:"Tan Wei Ming",phone:"013-4445556",active:!0},{code:"driver_07",name:"Suresh A/L Krishnan",phone:"014-6667778",active:!0},{code:"driver_08",name:"Lim Ah Kow",phone:"014-8889990",active:!0},{code:"driver_09",name:"Azmi Bin Abdullah",phone:"016-1112223",active:!0},{code:"driver_10",name:"Ng Chee Keong",phone:"016-3334445",active:!0},{code:"driver_11",name:"Kumar A/L Raman",phone:"017-5556667",active:!0},{code:"driver_12",name:"Ong Beng Huat",phone:"017-7778880",active:!0},{code:"driver_13",name:"Ismail Bin Osman",phone:"018-1234567",active:!0},{code:"driver_14",name:"Chong Wai Kit",phone:"018-7654321",active:!0},{code:"driver_15",name:"Ganesh A/L Suppiah",phone:"019-9998887",active:!0}]},T1=[{id:"user_admin",username:"ADMIN",password:"909090",fullName:"Administrator",email:"admin@depot.com",groups:["admin"],userType:"INTERNAL",shippingLineCode:null,active:!0,createdAt:"2024-01-01T00:00:00Z"},{id:"user_surveyor",username:"SURVEYOR",password:"123456",fullName:"Demo Surveyor",email:"surveyor@depot.com",groups:["surveyor"],userType:"INTERNAL",shippingLineCode:null,active:!0,createdAt:"2024-01-01T00:00:00Z"},{id:"user_estimator",username:"ESTIMATOR",password:"123456",fullName:"Demo Estimator",email:"estimator@depot.com",groups:["estimator"],userType:"EXTERNAL",shippingLineCode:"MSC",active:!0,createdAt:"2024-01-01T00:00:00Z"},{id:"user_msc",username:"MSC",password:"909090",fullName:"MSC Company",email:"msc@msc.com",groups:["viewer"],userType:"EXTERNAL",shippingLineCode:"MSC",active:!0,createdAt:"2024-01-01T00:00:00Z"}],H0={autoApprovalThreshold:100,defaultCurrency:"RM",containersPerPage:200};function VT({children:e}){const[t,n]=T.useState(()=>{const oe=localStorage.getItem("mnr_screens");return oe?JSON.parse(oe):Sm}),[r,s]=T.useState(()=>{const oe=localStorage.getItem("mnr_groups");return oe?JSON.parse(oe):N1}),[i,l]=T.useState(()=>{const oe=localStorage.getItem("mnr_codes");return oe?JSON.parse(oe):E1}),[u,d]=T.useState(()=>{const oe=localStorage.getItem("mnr_users");return oe?JSON.parse(oe):T1}),[f,m]=T.useState(()=>{const oe=localStorage.getItem("mnr_settings");return oe?JSON.parse(oe):H0}),[p,x]=T.useState(!1);T.useEffect(()=>{p||(localStorage.setItem("mnr_screens",JSON.stringify(t)),localStorage.setItem("mnr_groups",JSON.stringify(r)),localStorage.setItem("mnr_codes",JSON.stringify(i)),localStorage.setItem("mnr_users",JSON.stringify(u)),localStorage.setItem("mnr_settings",JSON.stringify(f)))},[t,r,i,u,f,p]);const v=T.useCallback(oe=>{const Te=i[oe];return Te?Te.filter(xe=>xe.active):[]},[i]),k=T.useCallback((oe,Te)=>{l(xe=>({...xe,[oe]:Te}))},[]),y=T.useCallback((oe,Te)=>{l(xe=>({...xe,[oe]:[...xe[oe]||[],{...Te,active:!0}]}))},[]),S=T.useCallback((oe,Te,xe)=>{l(we=>({...we,[oe]:we[oe].map(fe=>fe.code===Te?{...fe,...xe}:fe)}))},[]),C=T.useCallback((oe,Te)=>{l(xe=>({...xe,[oe]:xe[oe].map(we=>we.code===Te?{...we,active:!1}:we)}))},[]),D=T.useCallback(oe=>r.find(Te=>Te.id===oe),[r]),N=T.useCallback(oe=>{const Te=`grp_${Date.now()}`,xe={...oe,id:Te};return s(we=>[...we,xe]),xe},[]),b=T.useCallback((oe,Te)=>{s(xe=>xe.map(we=>we.id===oe?{...we,...Te}:we))},[]),H=T.useCallback(oe=>["admin","viewer"].includes(oe)?!1:(s(Te=>Te.filter(xe=>xe.id!==oe)),!0),[]),L=T.useCallback(oe=>f[oe]??H0[oe],[f]),R=T.useCallback((oe,Te)=>{m(xe=>({...xe,[oe]:Te}))},[]),q=T.useCallback(oe=>{m(Te=>({...Te,...oe}))},[]),O=T.useCallback(oe=>u.find(Te=>Te.id===oe),[u]),V=T.useCallback(oe=>u.find(Te=>Te.username.toUpperCase()===oe.toUpperCase()),[u]),X=T.useCallback(oe=>{const Te=`user_${Date.now()}`,xe={...oe,id:Te,active:!0,createdAt:new Date().toISOString()};return d(we=>[...we,xe]),xe},[]),M=T.useCallback((oe,Te)=>{d(xe=>xe.map(we=>we.id===oe?{...we,...Te,updatedAt:new Date().toISOString()}:we))},[]),me=T.useCallback(oe=>{d(Te=>Te.map(xe=>xe.id===oe?{...xe,active:!1}:xe))},[]),ae=T.useCallback((oe,Te,xe)=>{const we=u.find(fe=>fe.id===oe);return we?we.password!==Te?{success:!1,error:"Current password is incorrect"}:xe.length<6?{success:!1,error:"New password must be at least 6 characters"}:(d(fe=>fe.map(ye=>ye.id===oe?{...ye,password:xe,updatedAt:new Date().toISOString()}:ye)),{success:!0}):{success:!1,error:"User not found"}},[u]),ce=T.useCallback(oe=>{const Te=u.find(ye=>ye.id===oe);if(!Te||!Te.active)return{screens:[],functions:[]};const xe=r.filter(ye=>Te.groups.includes(ye.id)),we=new Set,fe=new Set;return xe.forEach(ye=>{ye.screens.forEach(ee=>we.add(ee)),ye.functions.forEach(ee=>fe.add(ee))}),{screens:Array.from(we),functions:Array.from(fe)}},[u,r]),ue=T.useCallback((oe,Te)=>ce(oe).screens.includes(Te),[ce]),K=T.useCallback((oe,Te)=>ce(oe).functions.includes(Te),[ce]),W=T.useCallback((oe,Te)=>{const xe=u.find(we=>we.username.toUpperCase()===oe.toUpperCase()&&we.password===Te&&we.active);return xe?{id:xe.id,username:xe.username,fullName:xe.fullName,email:xe.email,groups:xe.groups,userType:xe.userType,shippingLineCode:xe.shippingLineCode,permissions:ce(xe.id)}:null},[u,ce]),j=T.useCallback(()=>(i.ANNOUNCEMENTS||[]).filter(oe=>oe.active).sort((oe,Te)=>oe.order!==void 0&&Te.order!==void 0?oe.order-Te.order:oe.order!==void 0?-1:Te.order!==void 0?1:new Date(Te.createdAt)-new Date(oe.createdAt)),[i]),F=T.useCallback(oe=>{const Te={...oe,id:`ann_${Date.now()}`,createdAt:new Date().toISOString(),active:!0};return l(xe=>({...xe,ANNOUNCEMENTS:[Te,...xe.ANNOUNCEMENTS||[]]})),Te},[]),U=T.useCallback((oe,Te)=>{l(xe=>({...xe,ANNOUNCEMENTS:(xe.ANNOUNCEMENTS||[]).map(we=>we.id===oe?{...we,...Te,updatedAt:new Date().toISOString()}:we)}))},[]),I=T.useCallback(oe=>{l(Te=>({...Te,ANNOUNCEMENTS:(Te.ANNOUNCEMENTS||[]).map(xe=>xe.id===oe?{...xe,active:!1}:xe)}))},[]),Z=T.useCallback(()=>(i.LINKS||[]).filter(oe=>oe.active).sort((oe,Te)=>oe.order!==void 0&&Te.order!==void 0?oe.order-Te.order:oe.order!==void 0?-1:Te.order!==void 0?1:new Date(Te.createdAt)-new Date(oe.createdAt)),[i]),Y=T.useCallback(oe=>{const Te={...oe,id:`link_${Date.now()}`,createdAt:new Date().toISOString(),active:!0};return l(xe=>({...xe,LINKS:[Te,...xe.LINKS||[]]})),Te},[]),P=T.useCallback((oe,Te)=>{l(xe=>({...xe,LINKS:(xe.LINKS||[]).map(we=>we.id===oe?{...we,...Te,updatedAt:new Date().toISOString()}:we)}))},[]),ne=T.useCallback(oe=>{l(Te=>({...Te,LINKS:(Te.LINKS||[]).map(xe=>xe.id===oe?{...xe,active:!1}:xe)}))},[]),J=T.useCallback(()=>(i.BENEFITS||[]).filter(oe=>oe.active),[i]),de=T.useCallback(oe=>{const Te={...oe,id:`ben_${Date.now()}`,createdAt:new Date().toISOString(),active:!0};return l(xe=>({...xe,BENEFITS:[Te,...xe.BENEFITS||[]]})),Te},[]),E=T.useCallback((oe,Te)=>{l(xe=>({...xe,BENEFITS:(xe.BENEFITS||[]).map(we=>we.id===oe?{...we,...Te,updatedAt:new Date().toISOString()}:we)}))},[]),A=T.useCallback(oe=>{l(Te=>({...Te,BENEFITS:(Te.BENEFITS||[]).map(xe=>xe.id===oe?{...xe,active:!1}:xe)}))},[]),he=T.useCallback(()=>(i.WELCOME_TEXT||[]).find(Te=>Te.active)||{titleLine:"",subtitleLine:""},[i]),G=T.useCallback(oe=>{l(Te=>{const xe=Te.WELCOME_TEXT||[];return xe.length===0?{...Te,WELCOME_TEXT:[{id:"welcome_1",...oe,createdAt:new Date().toISOString(),active:!0}]}:{...Te,WELCOME_TEXT:xe.map((we,fe)=>fe===0?{...we,...oe,updatedAt:new Date().toISOString()}:we)}})},[]),Ie={screens:t,groups:r,codes:i,users:u,settings:f,isLoading:p,getCodeList:v,updateCodeList:k,addCode:y,updateCode:S,deleteCode:C,getGroup:D,createGroup:N,updateGroup:b,deleteGroup:H,getSetting:L,updateSetting:R,updateSettings:q,getUser:O,getUserByUsername:V,createUser:X,updateUser:M,deactivateUser:me,updateUserPassword:ae,getUserPermissions:ce,canAccessScreen:ue,canPerformFunction:K,authenticateUser:W,getAnnouncements:j,addAnnouncement:F,updateAnnouncement:U,deleteAnnouncement:I,getLinks:Z,addLink:Y,updateLink:P,deleteLink:ne,getBenefits:J,addBenefit:de,updateBenefit:E,deleteBenefit:A,getWelcomeText:he,updateWelcomeText:G,DEFAULT_SCREENS:Sm,DEFAULT_GROUPS:N1,DEFAULT_CODES:E1,DEFAULT_USERS:T1,DEFAULT_SETTINGS:H0};return a.jsx(Sw.Provider,{value:Ie,children:e})}function On(){const e=T.useContext(Sw);if(!e)throw new Error("useConfig must be used within a ConfigProvider");return e}const _w=T.createContext(null),Oo={id:"user_admin",username:"ADMIN",password:"909090",fullName:"Administrator",groups:["admin"]};function qT({children:e}){const{authenticateUser:t,getUserPermissions:n,users:r}=On(),[s,i]=T.useState(null),[l,u]=T.useState(!0);T.useEffect(()=>{const k=localStorage.getItem("mnr_user");if(k){const y=JSON.parse(k);if(y.id){const S=n(y.id);i({...y,permissions:S})}else i(y)}u(!1)},[n]);const d=(k,y)=>{let S=t(k,y);if(!S&&k.toUpperCase()===Oo.username&&y===Oo.password&&(console.log("Using fallback authentication"),S={id:Oo.id,username:Oo.username,fullName:Oo.fullName,groups:Oo.groups,permissions:{screens:["dashboard","container_list","container_register","container_ar","survey_new","survey_list","eor_list","eor_new","repair_list","shunting","inspection","stacking","config_codes","config_groups","config_users","job_monitoring"],functions:["create","read","update","delete","approve","export","delete_job"]}}),S){const C={...S,loginTime:new Date().toISOString()};return i(C),localStorage.setItem("mnr_user",JSON.stringify(C)),{success:!0,user:C}}return{success:!1,error:"Invalid username or password"}},f=()=>{i(null),localStorage.removeItem("mnr_user")},m=k=>!s||!s.permissions?!1:s.permissions.screens.includes(k),v={user:s,isLoading:l,isAuthenticated:!!s,login:d,logout:f,canAccess:m,canPerform:k=>!s||!s.permissions?!1:!!(s.permissions.functions&&s.permissions.functions.includes(k)),hasScreenPermission:(k,y)=>{if(!s)return!1;if(s.groups&&s.groups.includes("admin"))return!0;if(s.permissions&&s.permissions.screenPermissions){const S=s.permissions.screenPermissions[k];if(S&&S[y])return!0}return y==="use"||y==="retrieve"?m(k):!1}};return a.jsx(_w.Provider,{value:v,children:e})}function Ft(){const e=T.useContext(_w);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}const yn={STACKING:"STACKING",DM:"DM"},Oi={STACKING:"Stacking",PENDING_WASH:"Pending Wash",WASHING:"Washing",AV:"Available",DM:"Damaged",AR:"Awaiting Repair",REPAIR:"Repair In Progress",COMPLETED:"Completed",GATE_OUT:"Gate Out"},b1={DRAFT:"Draft",COMPLETED:"Completed",REJECTED:"Rejected",AMEND:"Amend"},_m={INBOUND:"Inbound",OUTBOUND:"Outbound",PERIODIC:"Periodic",OTHER:"Other"},Xd={DRAFT:"Draft",SENT:"Sent",PENDING:"Pending Approval",APPROVED:"Approved",APPROVED_AUTO:"Auto-Approved",APPROVED_AMENDED:"Approved with Amendments",REJECTED:"Rejected"},Cm={NEW:"New",PLANNED:"Planned",IN_PROGRESS:"In Progress",COMPLETED:"Completed",CLOSED:"Closed",CANCELLED:"Cancelled"},Gi={AUTO_APPROVAL_THRESHOLD:100,DEFAULT_CURRENCY:"RM",DATE_FORMAT:"DD/MM/YYYY",DATETIME_FORMAT:"DD/MM/YYYY HH:mm",SURVEY_ID_PREFIX:"SRV",EOR_ID_PREFIX:"EOR",RO_ID_PREFIX:"RO",CONTAINERS_PER_PAGE:200},yr={CREATE:"CREATE",UPDATE:"UPDATE",STATUS_CHANGE:"STATUS_CHANGE",APPROVE:"APPROVE",REJECT:"REJECT",SEND:"SEND"},A1=[{id:"c001",containerNumber:"MSCU1234567",sequence:1,size:"40HC",liner:"MSC",status:yn.STACKING,gateInDate:"2024-12-07T08:00:00",yardLocation:{block:"A",row:1,tier:1},booking:null,lastSurveyId:null,lastEorId:null},{id:"c002",containerNumber:"MSKU8765432",sequence:1,size:"20GP",liner:"MSK",status:yn.STACKING,gateInDate:"2024-12-07T08:15:00",yardLocation:{block:"A",row:2,tier:1},booking:null,lastSurveyId:null,lastEorId:null},{id:"c003",containerNumber:"CMAU5551234",sequence:1,size:"40GP",liner:"CMA",status:yn.STACKING,gateInDate:"2024-12-07T08:30:00",yardLocation:{block:"A",row:3,tier:1},booking:null,lastSurveyId:null,lastEorId:null},{id:"c004",containerNumber:"HLCU9871234",sequence:1,size:"40HC",liner:"HPL",status:yn.STACKING,gateInDate:"2024-12-07T08:45:00",yardLocation:{block:"A",row:4,tier:1},booking:null,lastSurveyId:null,lastEorId:null},{id:"c005",containerNumber:"OOLU4567890",sequence:1,size:"20GP",liner:"ONE",status:yn.STACKING,gateInDate:"2024-12-07T09:00:00",yardLocation:{block:"A",row:5,tier:1},booking:null,lastSurveyId:null,lastEorId:null},{id:"c006",containerNumber:"EGHU2223334",sequence:1,size:"40GP",liner:"EVG",status:yn.STACKING,gateInDate:"2024-12-07T09:15:00",yardLocation:{block:"B",row:1,tier:1},booking:null,lastSurveyId:null,lastEorId:null},{id:"c007",containerNumber:"YMLU6667778",sequence:1,size:"45HC",liner:"YML",status:yn.STACKING,gateInDate:"2024-12-07T09:30:00",yardLocation:{block:"B",row:2,tier:1},booking:null,lastSurveyId:null,lastEorId:null},{id:"c008",containerNumber:"PCIU1112223",sequence:1,size:"20RF",liner:"PIL",status:yn.STACKING,gateInDate:"2024-12-07T09:45:00",yardLocation:{block:"B",row:3,tier:1},booking:null,lastSurveyId:null,lastEorId:null},{id:"c009",containerNumber:"ZIMU8889990",sequence:1,size:"40RF",liner:"ZIM",status:yn.STACKING,gateInDate:"2024-12-07T10:00:00",yardLocation:{block:"B",row:4,tier:1},booking:null,lastSurveyId:null,lastEorId:null},{id:"c010",containerNumber:"CSLU3334445",sequence:1,size:"40HC",liner:"CSL",status:yn.STACKING,gateInDate:"2024-12-07T10:15:00",yardLocation:{block:"B",row:5,tier:1},booking:null,lastSurveyId:null,lastEorId:null},{id:"c011",containerNumber:"HMMU4445556",sequence:1,size:"40GP",liner:"HMM",status:yn.STACKING,gateInDate:"2024-12-07T10:30:00",yardLocation:{block:"C",row:1,tier:1},booking:null,lastSurveyId:null,lastEorId:null},{id:"c012",containerNumber:"WHLU5556667",sequence:1,size:"20GP",liner:"WHL",status:yn.STACKING,gateInDate:"2024-12-07T10:45:00",yardLocation:{block:"C",row:2,tier:1},booking:null,lastSurveyId:null,lastEorId:null},{id:"c013",containerNumber:"TSLU6667778",sequence:1,size:"40HC",liner:"TSL",status:yn.STACKING,gateInDate:"2024-12-07T11:00:00",yardLocation:{block:"C",row:3,tier:1},booking:null,lastSurveyId:null,lastEorId:null},{id:"c014",containerNumber:"EMCU7778889",sequence:1,size:"40GP",liner:"EMC",status:yn.STACKING,gateInDate:"2024-12-07T11:15:00",yardLocation:{block:"C",row:4,tier:1},booking:null,lastSurveyId:null,lastEorId:null},{id:"c015",containerNumber:"APLU8889990",sequence:1,size:"45HC",liner:"APL",status:yn.STACKING,gateInDate:"2024-12-07T11:30:00",yardLocation:{block:"C",row:5,tier:1},booking:null,lastSurveyId:null,lastEorId:null},{id:"c016",containerNumber:"HALU9990001",sequence:1,size:"20GP",liner:"HAL",status:yn.STACKING,gateInDate:"2024-12-07T11:45:00",yardLocation:{block:"D",row:1,tier:1},booking:null,lastSurveyId:null,lastEorId:null},{id:"c017",containerNumber:"NKYU1112223",sequence:1,size:"40HC",liner:"NKY",status:yn.STACKING,gateInDate:"2024-12-07T12:00:00",yardLocation:{block:"D",row:2,tier:1},booking:null,lastSurveyId:null,lastEorId:null},{id:"c018",containerNumber:"SUDU2223334",sequence:1,size:"40GP",liner:"SUD",status:yn.STACKING,gateInDate:"2024-12-07T12:15:00",yardLocation:{block:"D",row:3,tier:1},booking:null,lastSurveyId:null,lastEorId:null},{id:"c019",containerNumber:"SAFU3334445",sequence:1,size:"20RF",liner:"SAF",status:yn.STACKING,gateInDate:"2024-12-07T12:30:00",yardLocation:{block:"D",row:4,tier:1},booking:null,lastSurveyId:null,lastEorId:null},{id:"c020",containerNumber:"GCLU4445556",sequence:1,size:"40RF",liner:"GCL",status:yn.STACKING,gateInDate:"2024-12-07T12:45:00",yardLocation:{block:"D",row:5,tier:1},booking:null,lastSurveyId:null,lastEorId:null}],j1=[],R1=[],I1=[],P1=[],Cw=T.createContext(null),D1=e=>{const n=new Date().toISOString().slice(0,10).replace(/-/g,""),r=Math.floor(Math.random()*1e4).toString().padStart(4,"0");return`${e}-${n}-${r}`},sc=e=>{const t=new Date,n=String(t.getFullYear()).slice(-2),r=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),i=String(t.getHours()).padStart(2,"0"),l=String(t.getMinutes()).padStart(2,"0"),u=String(t.getSeconds()).padStart(2,"0");return`${e}-${n}${r}${s}${i}${l}${u}`},O1=()=>{try{return JSON.parse(localStorage.getItem("mnr_settings")||"{}").autoApprovalThreshold??Gi.AUTO_APPROVAL_THRESHOLD}catch{return Gi.AUTO_APPROVAL_THRESHOLD}};function KT({children:e}){const[t,n]=T.useState([]),[r,s]=T.useState([]),[i,l]=T.useState([]),[u,d]=T.useState([]),[f,m]=T.useState([]),[p,x]=T.useState([]),[v,k]=T.useState(!0),y=()=>{const fe=localStorage.getItem("mnr_containers"),ye=localStorage.getItem("mnr_surveys"),ee=localStorage.getItem("mnr_eors"),Pe=localStorage.getItem("mnr_repair_orders"),Fe=localStorage.getItem("mnr_washing_orders"),et=localStorage.getItem("mnr_audit_logs");n(fe?JSON.parse(fe):A1),s(ye?JSON.parse(ye):j1),l(ee?JSON.parse(ee):R1),d(Pe?JSON.parse(Pe):I1),m(Fe?JSON.parse(Fe):[]),x(et?JSON.parse(et):P1),k(!1)};T.useEffect(()=>{y()},[]);const S=()=>{y()};T.useEffect(()=>{if(!v){try{localStorage.setItem("mnr_containers",JSON.stringify(t))}catch(fe){console.warn("Failed to save containers to localStorage:",fe.message)}try{const fe=r.map(ye=>{var ee;return{...ye,images:((ee=ye.images)==null?void 0:ee.slice(0,5).map(Pe=>({...Pe,dataUrl:ye.images.indexOf(Pe)<3?Pe.dataUrl:"[REMOVED DUE TO SIZE]"})))||[]}});localStorage.setItem("mnr_surveys",JSON.stringify(fe))}catch(fe){console.warn("Failed to save surveys to localStorage:",fe.message);try{const ye=r.map(ee=>({...ee,images:[]}));localStorage.setItem("mnr_surveys",JSON.stringify(ye)),console.info("Saved surveys without images due to quota")}catch(ye){console.error("Cannot save surveys at all:",ye.message)}}try{localStorage.setItem("mnr_eors",JSON.stringify(i))}catch(fe){console.warn("Failed to save EORs to localStorage:",fe.message)}try{localStorage.setItem("mnr_repair_orders",JSON.stringify(u))}catch(fe){console.warn("Failed to save repair orders to localStorage:",fe.message)}try{localStorage.setItem("mnr_washing_orders",JSON.stringify(f))}catch(fe){console.warn("Failed to save washing orders to localStorage:",fe.message)}try{const fe=p.slice(0,500);localStorage.setItem("mnr_audit_logs",JSON.stringify(fe))}catch(fe){console.warn("Failed to save audit logs to localStorage:",fe.message)}}},[t,r,i,u,f,p,v]);const C=(fe,ye,ee,Pe,Fe={},et=null,dt=null)=>{const jt={id:`log${Date.now()}`,entityType:fe,entityId:ye,action:ee,userId:Pe,timestamp:new Date().toISOString(),details:Fe,oldValue:et,newValue:dt};return x(un=>[jt,...un]),jt},D=fe=>t.find(ye=>ye.id===fe),N=fe=>t.find(ye=>ye.containerNumber===fe),b=(fe,ye,ee)=>{n(Pe=>Pe.map(Fe=>{if(Fe.id===fe){const et={...Fe,...ye};return ye.status&&ye.status!==Fe.status&&C("CONTAINER",fe,yr.STATUS_CHANGE,ee,{containerNumber:Fe.containerNumber},Fe.status,ye.status),et}return Fe}))},H=fe=>{const ye=fe.toLowerCase();return t.filter(ee=>ee.containerNumber.toLowerCase().includes(ye)||ee.booking&&ee.booking.toLowerCase().includes(ye)||ee.yardLocation&&`${ee.yardLocation.block}${ee.yardLocation.row}`.toLowerCase().includes(ye))},L=(fe,ye)=>{const ee=D1("CTR"),Pe={id:ee,containerNumber:fe.containerNumber,liner:fe.liner,size:fe.size,type:fe.type,status:fe.status||"DM",sequence:1,gateInDate:new Date().toISOString(),yardLocation:{block:"A",row:"01",tier:"1"},createdBy:ye,createdAt:new Date().toISOString()};return n(Fe=>[Pe,...Fe]),C("CONTAINER",ee,yr.CREATE,ye,{containerNumber:fe.containerNumber}),Pe},R=fe=>r.find(ye=>ye.id===fe),q=fe=>r.filter(ye=>ye.containerId===fe),O=(fe,ye)=>{const ee=sc(fe.containerNumber),Pe={...fe,id:ee,status:fe.status||"DRAFT",createdBy:ye,createdAt:new Date().toISOString(),damageItems:fe.damageItems||[],images:fe.images||[],attachments:fe.attachments||[]};return s(Fe=>[Pe,...Fe]),C("SURVEY",ee,yr.CREATE,ye,{containerNumber:fe.containerNumber}),Pe.status==="COMPLETED"&&Pe.containerId&&b(Pe.containerId,{lastSurveyId:ee},ye),Pe},V=(fe,ye,ee)=>{s(Pe=>Pe.map(Fe=>{if(Fe.id===fe){const et={...Fe,...ye,updatedAt:new Date().toISOString(),updatedBy:ee};return ye.status&&ye.status!==Fe.status?C("SURVEY",fe,yr.STATUS_CHANGE,ee,{},Fe.status,ye.status):C("SURVEY",fe,yr.UPDATE,ee,{fields:Object.keys(ye)}),et}return Fe}))},X=(fe,ye)=>{const ee=R(fe);return ee?ee.initialCondition?ee.surveyType?ee.initialCondition==="DAMAGED"&&(!ee.damageItems||ee.damageItems.length===0)?{success:!1,error:'At least one damage item is required when condition is "Damaged"'}:(V(fe,{status:"COMPLETED",completedBy:ye,completedAt:new Date().toISOString()},ye),ee.containerId&&b(ee.containerId,{lastSurveyId:fe},ye),{success:!0}):{success:!1,error:"Survey type is required"}:{success:!1,error:"Initial condition is required"}:{success:!1,error:"Survey not found"}},M=fe=>i.find(ye=>ye.id===fe),me=fe=>i.filter(ye=>ye.containerId===fe),ae=fe=>i.filter(ye=>ye.surveyId===fe),ce=(fe,ye)=>{const ee=sc(fe.containerNumber),Pe=(fe.repairItems||[]).reduce((un,gr)=>un+(gr.lineTotal||0),0),Fe=O1(),et=Pe>Fe,dt=!et,jt={...fe,id:ee,version:1,status:dt?"APPROVED_AUTO":"DRAFT",totalCost:Pe,currency:Gi.DEFAULT_CURRENCY,needApproval:et,autoApproved:dt,createdBy:ye,createdAt:new Date().toISOString(),repairItems:fe.repairItems||[],images:[]};return l(un=>[jt,...un]),C("EOR",ee,yr.CREATE,ye,{totalCost:Pe,autoApproved:dt}),dt?(C("EOR",ee,yr.APPROVE,"SYSTEM",{reason:`Auto-approved: Total ${Pe} RM <= ${Fe} RM threshold`}),fe.containerId&&b(fe.containerId,{status:"AR",arStartTime:new Date().toISOString(),lastEorId:ee},ye)):fe.containerId&&b(fe.containerId,{lastEorId:ee},ye),jt},ue=(fe,ye,ee)=>{l(Pe=>Pe.map(Fe=>{if(Fe.id===fe){let et=Fe.totalCost;ye.repairItems&&(et=ye.repairItems.reduce((gr,ge)=>gr+(ge.lineTotal||0),0));const dt=O1(),jt=et>dt,un={...Fe,...ye,totalCost:et,needApproval:jt,updatedAt:new Date().toISOString(),updatedBy:ee};return C("EOR",fe,yr.UPDATE,ee,{fields:Object.keys(ye)}),un}return Fe}))},K=(fe,ye,ee,Pe)=>M(fe)?(ue(fe,{status:"PENDING",sentAt:new Date().toISOString(),sentBy:Pe,sentTo:ye,sentMethod:ee},Pe),C("EOR",fe,yr.SEND,Pe,{recipient:ye,method:ee}),{success:!0}):{success:!1,error:"EOR not found"},W=(fe,ye,ee)=>{const Pe=M(fe),Fe=ye.status==="REJECTED";return ue(fe,{status:ye.status||"APPROVED",approvedAt:new Date().toISOString(),approvedBy:ye.approvedBy||ee,approvalNotes:ye.notes},ee),Pe&&Pe.containerId&&(Fe?(b(Pe.containerId,{status:"DM",lastEorId:fe,rejectedAt:new Date().toISOString()},ee),C("EOR",fe,yr.REJECT,ee,ye)):(b(Pe.containerId,{status:"AR",arStartTime:new Date().toISOString()},ee),C("EOR",fe,yr.APPROVE,ee,ye))),{success:!0}},j=fe=>u.find(ye=>ye.id===fe),F=fe=>u.filter(ye=>ye.containerId===fe),U=(fe,ye)=>{if(!JSON.parse(localStorage.getItem("mnr_shunting")||"[]").find(jt=>jt.containerId===fe.containerId||jt.containerNumber===fe.containerNumber))return{success:!1,error:`Container ${fe.containerNumber} must have a Shunting request before creating Repair Order`,requiresShunting:!0};const Fe=u.find(jt=>jt.containerId===fe.containerId&&!["COMPLETED","CLOSED","CANCELLED"].includes(jt.status));if(Fe)return{success:!1,error:`Container ${fe.containerNumber} already has an active Repair Order (${Fe.id})`,existingRO:Fe};const et=fe.surveyId||sc(fe.containerNumber),dt={...fe,id:et,surveyId:fe.surveyId,status:"NEW",createdBy:ye,createdAt:new Date().toISOString(),workItems:fe.workItems||[]};return d(jt=>[dt,...jt]),C("REPAIR_ORDER",et,yr.CREATE,ye,{eorId:fe.eorId}),{success:!0,ro:dt}},I=(fe,ye,ee)=>{d(Pe=>Pe.map(Fe=>{if(Fe.id===fe){const et={...Fe,...ye,updatedAt:new Date().toISOString(),updatedBy:ee};return ye.status&&ye.status!==Fe.status&&C("REPAIR_ORDER",fe,yr.STATUS_CHANGE,ee,{},Fe.status,ye.status),et}return Fe}))},Z=fe=>f.find(ye=>ye.id===fe),Y=fe=>f.filter(ye=>ye.containerId===fe),P=(fe,ye)=>{const ee=`WO-${sc(fe.containerNumber)}`,Pe={id:ee,containerId:fe.containerId,containerNumber:fe.containerNumber,containerType:fe.containerType,liner:fe.liner,contaminationLevel:fe.contaminationLevel,interiorCondition:fe.interiorCondition||[],exteriorCondition:fe.exteriorCondition||[],odorPresent:fe.odorPresent||!1,pestPresent:fe.pestPresent||!1,hazardousResidues:fe.hazardousResidues||!1,inspectionNotes:fe.inspectionNotes||"",inspectedBy:ye,inspectedAt:new Date().toISOString(),cleaningProgram:fe.cleaningProgram,assignedBay:fe.assignedBay||null,assignedWorker:fe.assignedWorker||null,assignedTeam:fe.assignedTeam||null,scheduledAt:fe.scheduledAt||null,safetyNotes:fe.safetyNotes||"",safetyRequirements:fe.safetyRequirements||[],status:"PENDING_SCHEDULE",startedAt:null,completedAt:null,checklistResults:{},workerNotes:"",photos:[],damagesFound:[],elapsedMinutes:0,qcInspectedBy:null,qcInspectedAt:null,qcResult:null,qcNotes:"",qcChecklistResults:{},reworkCount:0,certificateNumber:null,certificateIssuedAt:null,cost:fe.cost||0,createdBy:ye,createdAt:new Date().toISOString()};return m(Fe=>[Pe,...Fe]),C("WASHING_ORDER",ee,yr.CREATE,ye,{containerNumber:fe.containerNumber,cleaningProgram:fe.cleaningProgram}),fe.containerId&&b(fe.containerId,{status:"PENDING_CLEAN"},ye),Pe},ne=(fe,ye)=>{Z(fe)&&(de(fe,{status:"PENDING_SCHEDULE",approvedBy:ye,approvedAt:new Date().toISOString()},ye),C("WASHING_ORDER",fe,"APPROVE",ye,{status:"PENDING_APPROVAL"},{status:"PENDING_SCHEDULE"}))},J=(fe,ye,ee)=>{Z(fe)&&(de(fe,{status:"REJECTED",rejectedBy:ye,rejectedAt:new Date().toISOString(),rejectionReason:ee},ye),C("WASHING_ORDER",fe,"REJECT",ye,{status:"PENDING_APPROVAL"},{status:"REJECTED",reason:ee}))},de=(fe,ye,ee)=>{m(Pe=>Pe.map(Fe=>{if(Fe.id===fe){const et={...Fe,...ye,updatedAt:new Date().toISOString(),updatedBy:ee};return ye.status&&ye.status!==Fe.status&&C("WASHING_ORDER",fe,yr.STATUS_CHANGE,ee,{},Fe.status,ye.status),et}return Fe}))},we={containers:t,surveys:r,eors:i,repairOrders:u,washingOrders:f,auditLogs:p,isLoading:v,getContainer:D,getContainerByNumber:N,updateContainer:b,searchContainers:H,registerContainer:L,getSurvey:R,getSurveysByContainer:q,createSurvey:O,updateSurvey:V,completeSurvey:X,getEOR:M,getEORsByContainer:me,getEORsBySurvey:ae,createEOR:ce,updateEOR:ue,sendEOR:K,approveEOR:W,getRepairOrder:j,getROsByContainer:F,createRepairOrder:U,updateRepairOrder:I,getWashingOrder:Z,getWashingOrdersByContainer:Y,createWashingOrder:P,updateWashingOrder:de,approveWashingOrder:ne,rejectWashingOrder:J,scheduleWashingOrder:(fe,ye,ee)=>{de(fe,{status:"SCHEDULED",assignedBay:ye.assignedBay,assignedWorker:ye.assignedWorker,assignedTeam:ye.assignedTeam,scheduledAt:ye.scheduledAt,safetyNotes:ye.safetyNotes,safetyRequirements:ye.safetyRequirements||[]},ee),C("WASHING_ORDER",fe,"SCHEDULE",ee,ye)},startWashingOrder:(fe,ye)=>{const ee=Z(fe);ee&&ee.containerId&&b(ee.containerId,{status:"CLEANING"},ye),de(fe,{status:"IN_PROGRESS",startedAt:new Date().toISOString()},ye)},completeWashingOrder:(fe,ye,ee)=>{de(fe,{status:"PENDING_QC",completedAt:new Date().toISOString(),checklistResults:ye.checklistResults,workerNotes:ye.workerNotes,photos:ye.photos||[],damagesFound:ye.damagesFound||[],elapsedMinutes:ye.elapsedMinutes},ee)},qcWashingOrder:(fe,ye,ee)=>{const Pe=Z(fe);if(ye.result==="PASS"){const et=`CLN-${new Date().getFullYear()}-${String(f.filter(dt=>dt.certificateNumber).length+1).padStart(6,"0")}`;de(fe,{status:"COMPLETED",qcInspectedBy:ee,qcInspectedAt:new Date().toISOString(),qcResult:"PASS",qcNotes:ye.notes,qcChecklistResults:ye.checklistResults,certificateNumber:et,certificateIssuedAt:new Date().toISOString()},ee),Pe&&Pe.containerId&&b(Pe.containerId,{status:"AVAILABLE"},ee),C("WASHING_ORDER",fe,"QC_PASS",ee,{certificateNumber:et})}else de(fe,{status:"REWORK",qcInspectedBy:ee,qcInspectedAt:new Date().toISOString(),qcResult:"FAIL",qcNotes:ye.notes,qcChecklistResults:ye.checklistResults,reworkCount:((Pe==null?void 0:Pe.reworkCount)||0)+1,reworkReasons:ye.reworkReasons||[]},ee),C("WASHING_ORDER",fe,"QC_FAIL",ee,{reasons:ye.reworkReasons})},addAuditLog:C,getContainerStats:()=>{const fe={total:t.length,byStatus:{}};return t.forEach(ye=>{fe.byStatus[ye.status]=(fe.byStatus[ye.status]||0)+1}),fe},getEORStats:()=>{const fe=i.filter(Fe=>Fe.status==="PENDING"||Fe.status==="SENT").length,ye=i.filter(Fe=>Fe.status.includes("APPROVED")).length,ee=i.filter(Fe=>Fe.status==="DRAFT").length,Pe=i.reduce((Fe,et)=>Fe+(et.totalCost||0),0);return{pending:fe,approved:ye,draft:ee,totalValue:Pe,total:i.length}},resetData:()=>{n(A1),s(j1),l(R1),d(I1),m([]),x(P1)},generateId:D1,generateTransactionId:sc,syncApprovedEORsToAR:()=>{const fe=i.filter(ee=>ee.status==="APPROVED"||ee.status==="APPROVED_AUTO"||ee.status==="APPROVED_AMENDED");let ye=0;return fe.forEach(ee=>{const Pe=t.find(Fe=>Fe.id===ee.containerId||Fe.containerNumber===ee.containerNumber);Pe&&Pe.status!=="AR"&&Pe.status!=="REPAIR"&&Pe.status!=="COMPLETED"&&(b(Pe.id,{status:"AR",arStartTime:ee.approvedAt||new Date().toISOString()},"SYSTEM"),ye++)}),ye},reloadFromStorage:S,setSurveys:s,setEORs:l,setRepairOrders:d,setContainers:n,setWashingOrders:m};return a.jsx(Cw.Provider,{value:we,children:e})}function qt(){const e=T.useContext(Cw);if(!e)throw new Error("useData must be used within a DataProvider");return e}const G0={en:{code:"en",name:"English",flag:""},vi:{code:"vi",name:"Ting Vit",flag:""},ms:{code:"ms",name:"Bahasa Melayu",flag:""},ko:{code:"ko",name:"",flag:""},zh:{code:"zh",name:"",flag:""},pt:{code:"pt",name:"Portugus",flag:""}},YT="en",XT={dashboard:"Dashboard",containers:"Containers",surveys:"Surveys",eor:"EOR",repairOrders:"Repair Orders",shunting:"Shunting",preInspection:"Pre-Inspection",stacking:"Stacking & Release",settings:"Settings",logout:"Logout",save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",view:"View",search:"Search",filter:"Filter",export:"Export",import:"Import",back:"Back",next:"Next",submit:"Submit",confirm:"Confirm",close:"Close",yes:"Yes",no:"No",loading:"Loading...",noData:"No data available",required:"Required",optional:"Optional",actions:"Actions",status:"Status",createdAt:"Created At",updatedAt:"Updated At",createdBy:"Created By",add:"Add",remove:"Remove",active:"Active",inactive:"Inactive",allStatuses:"All Statuses",allLiners:"All Liners",allTypes:"All Types",showing:"Showing",of:"of",inProgress:"In Progress",completed:"Completed",from:"From",to:"To",selected:"selected",previous:"Previous",pleaseSelect:"Please Select",viewAll:"View All",pending:"Pending",all:"All",approved:"Approved",rejected:"Rejected",notes:"Notes",container:"Container",selectContainer:"Select Container",clearDates:"Clear Dates",clearSelection:"Clear Selection",content:"Content",create:"Create",description:"Description",more:"more",page:"Page",select:"Select",title:"Title",total:"total",url:"URL",apply:"Apply",featureComingSoon:"Feature coming soon",retrieve:"Retrieve",dataReloaded:"Data reloaded successfully",reloadError:"Failed to reload data",exportCSV:"Export CSV"},QT={goodMorning:"Good Morning",goodAfternoon:"Good Afternoon",goodEvening:"Good Evening"},JT={groupCode:"Group Code",groupName:"Group Name",description:"Description",usage:"Usage",grant:"Grant",groupLevel:"Group Level",screens:"Screens",functions:"Functions",fullName:"Full Name",email:"Email",groups:"Groups",lastLogin:"Last Login",registerUser:"Register User",codeType:"Code Type",code:"Code",name:"Name",addCode:"Add Code",editCode:"Edit Code",permissions:"Permissions",use:"Use",retrieve:"Retrieve",create:"Create",update:"Update",delete:"Delete",download:"Download",preview:"Preview",print:"Print",history:"History",clear:"Clear",username:"Username",password:"Password",assignGroups:"Assign Groups",showInactive:"Show Inactive",userCreated:"User created successfully",userUpdated:"User updated",userDeactivated:"User deactivated",userActivated:"User activated",usernameExists:"Username already exists",requiredFields:"Username, Password, and Full Name are required",groupRequired:"At least one group is required",resetPassword:"Reset Password",deactivate:"Deactivate",activate:"Activate",selectUser:"Select a User",selectUserDesc:"Choose a user from the list to view and edit their details",userManagementDesc:"Register and manage user accounts and group assignments",userType:"User Type",internal:"Internal",external:"External",shippingLine:"Shipping Line",homePageManagement:"Home Page Management",homePageDesc:"Manage announcements and links displayed on the portal",addAnnouncement:"Add Announcement",editAnnouncement:"Edit Announcement",addLink:"Add Link",editLink:"Edit Link",announcementCreated:"Announcement created",announcementUpdated:"Announcement updated",announcementDeleted:"Announcement deleted",linkCreated:"Link created",linkUpdated:"Link updated",linkDeleted:"Link deleted",confirmDelete:"Are you sure you want to delete this?",eorSettings:"EOR Settings",displaySettings:"Display Settings",notifications:"Notifications",localization:"Localization",workflowSettings:"Workflow Settings",autoApprovalThreshold:"Auto-Approval Threshold",autoApprovalDesc:"EORs below this amount will be auto-approved",defaultCurrency:"Default Currency",currencyDesc:"Currency used for all cost calculations",showCostInList:"Show Cost in List",showCostDesc:"Display repair costs in list views",currentSettings:"Current Settings",autoApproval:"Auto-Approval",language:"Language",perPage:"Per Page",timeout:"Timeout",resetDefaults:"Reset Defaults",allGroups:"All Groups",allTypes:"All Types",permissionGroupsDesc:"Manage user groups and their permissions",overview:"Overview",screen:"Screen",save:"Save",masterCodesDesc:"Manage system master data and codes",codeTypes:"Code Types",totalCodes:"Total Codes",searchCodes:"Search codes...",noUsersFound:"No users found",details:"Details",activity:"Activity",security:"Security",createdAt:"Created",never:"Never",justNow:"Just now",applyTemplate:"Apply Template",approve:"Approve",reject:"Reject",selectGroup:"Select a Group",selectGroupDesc:"Select a group from the list to view and edit its permissions",groupSaved:"Group saved successfully",groupCreated:"Group created successfully",groupDuplicated:"Group duplicated successfully",groupDeleted:"Group deleted successfully",deleteGroup:"Delete Group",deleteGroupConfirm:"Are you sure you want to delete the group",deleteGroupWarning:"This action cannot be undone. Users assigned to this group will lose these permissions.",activeScreens:"Active Screens",completion:"Completion",hideGroups:"Hide Groups",showGroups:"Show Groups",accountStatus:"Account Status",activated:"Activated",autoLogoutDesc:"Automatically log out after period of inactivity",cannotDeleteCore:"Cannot delete core groups",codeAdded:"Code added successfully",codeDeactivated:"Code deactivated",codeExists:"Code already exists",codeNameRequired:"Code and name are required",codeRequired:"Code is required",codeUpdated:"Code updated successfully",confirmDeactivate:"Are you sure you want to deactivate this?",containersDesc:"Number of containers shown per page",containersPerPage:"Containers Per Page",copied:"Copied!",copyCode:"Copy Code",dateFormat:"Date Format",dateFormatDesc:"Format used for displaying dates",deactivated:"Deactivated",defaultSurveyType:"Default Survey Type",duplicate:"Duplicate",enableAutoLogout:"Enable Auto Logout",enableNotifications:"Enable Notifications",enableQuickActions:"Enable Quick Actions",exportSuccess:"Export successful",importCodes:"Import Codes",importInstructions:"Paste JSON data to import codes",imported:"imported",invalidFormat:"Invalid format",invalidJSON:"Invalid JSON format",jsonData:"JSON Data",languageDesc:"Default language for the application",legacyFunctions:"Legacy function-based permissions (for compatibility)",nameRequired:"Name is required",newGroup:"New Permission Group",noActivityYet:"No activity yet",noCodesFound:"No codes found",notificationsDesc:"Show system notifications",quickActionsDesc:"Show quick action buttons on dashboard",quickTemplates:"Quick Start Templates",recentActivity:"Recent Activity",requirePhoto:"Require Photo",requirePhotoDesc:"Require photo upload for surveys",sessionDesc:"How long until session expires",sessionInfo:"Session Info",sessionTimeout:"Session Timeout",settingsReset:"Settings reset to defaults",settingsSaved:"Settings saved successfully",skipped:"skipped",surveyTypeDesc:"Default type for new surveys",timeFormat:"Time Format",timeFormatDesc:"Format used for displaying time",moveUp:"Move Up",moveDown:"Move Down",itemMoved:"Item moved"},ZT={login:"Login",username:"Username",password:"Password",loginButton:"Sign In",loginTitle:"M&R Container System",loginSubtitle:"Maintenance & Repair Management",loginError:"Invalid username or password",selectLanguage:"Select Language",changePassword:"Change Password",currentPassword:"Current Password",newPassword:"New Password",confirmPassword:"Confirm Password",passwordMismatch:"Passwords do not match",passwordTooShort:"Password must be at least 6 characters",passwordChanged:"Password changed successfully!",currentPasswordWrong:"Current password is incorrect",passwordRequired:"Password is required",portalTitle:"M&R Portal",userLogin:"User Login",signingIn:"Signing in...",loginSuccess:"Login Successful",loginSuccessMessage:"You have logged in successfully.",pleaseLoginFirst:"Please login first to access the system.",enterCredentials:"Enter your credentials to access the system",enterUsername:"Enter username",enterPassword:"Enter password"},eb={johorPort:"Johor Port",containerPortal:"Container Portal",welcomeTo:"Welcome to Johor Port Portal",home:"Home",about:"About",services:"Services",contactUs:"Contact Us",generalEnquiry:"General Enquiry",registration:"Registration",helpDesk:"Help Desk",containerOperations:"Container Operations",qualityAssurance:"Quality Assurance",support247:"24/7 Support",shippingAgent:"Shipping Agent",forwardingAgent:"Forwarding Agent",shipperConsignee:"Shipper/Consignee",accessSystem:"Access System",benefit:"Benefit",announcement:"Announcement",links:"Links",networkInfrastructure:"Network Infrastructure",onlineMarketplace:"Online Marketplace",faq:"FAQ"},tb={selectScreen:"Please select a screen from the menu to get started.",menuHint:"Use the navigation menu on the left to open screens"},nb={title:"Containers",register:"Register Container",allContainers:"All Containers",arContainers:"AR Containers",containerNumber:"Container Number",liner:"Liner",size:"Size",type:"Type",initialStatus:"Initial Status",registerSuccess:"Container registered successfully!",alreadyExists:"Container already exists",invalidFormat:"Invalid format (e.g., MSCU1234567)",manualEntry:"Manual Entry",excelUpload:"Excel Upload",downloadTemplate:"Download Template",dragDropExcel:"Drag & drop Excel file here",orClickBrowse:"or click to browse",previewContainers:"Preview",importValid:"Import Valid Containers",clear:"Clear",formatHint:"Format: 4 letters + 7 digits",damaged:"Damaged",available:"Available",awaitingRepair:"Awaiting Repair",repairInProgress:"Repair In Progress",completed:"Completed",gateOut:"Gate Out",adjustFilters:"Adjust your filters to see more results",batchStatusUpdate:"Batch Status Update",batchUpdate:"Batch Update",batchUpdateConfirm:"Are you sure you want to update these containers?",containerTimeline:"Container Timeline",newStatus:"New Status",noContainersFound:"No containers found",noTimelineEvents:"No timeline events",toDM:"To DM",updateContainers:"Update Containers",viewDetails:"View Details",viewTimeline:"View Timeline",workflowStage:"Workflow Stage"},rb={title:"Surveys",newSurvey:"New Survey",surveyList:"Survey List",searchContainer:"Search Container",surveyType:"Survey Type",initialCondition:"Initial Condition",notes:"Notes",damageItems:"Damage Items",addItem:"Add Item",location:"Location",damageType:"Damage Type",component:"Component",severity:"Severity",quantity:"Quantity",repairMethod:"Repair Method",estimatedCost:"Est. Cost (RM)",totalCost:"Total Estimated Cost",saveDraft:"Save Draft",completeSurvey:"Complete Survey",createEOR:"Create EOR",manual:"Manual",inbound:"Inbound",outbound:"Outbound",periodic:"Periodic",other:"Other",hasDamage:"Has Damage",noDamage:"No Damage",noSurveysFound:"No surveys found",createNewSurvey:"Click to create a new survey",allTypes:"All Types",damage:"Damage",damaged:"Damaged"},ab={title:"Estimate of Repair",eorList:"EOR List",createEOR:"Create EOR",editEOR:"Edit EOR",repairItems:"Repair Items",unitPrice:"Unit Price",laborHours:"Labor Hours",lineCost:"Line Cost",totalCost:"Total Cost",autoApproved:"Auto-Approved",pendingApproval:"Pending Approval",sendToLiner:"Send to Liner",approve:"Approve",reject:"Reject",approveSelected:"Approve Selected",rejectSelected:"Reject Selected",createRepairOrder:"Create Repair Order",timeline:"Timeline",autoApprovalNote:"EOR  100 RM will be auto-approved",totalValue:"Total Value",pendingAmount:"Pending Amount",approvedAmount:"Approved Amount",avgValue:"Avg Value",syncToAR:"Sync to AR",draft:"Draft",pending:"Pending",approved:"Approved",noEORsFound:"No EORs found",createFromSurvey:"Create an EOR from a completed survey",approvalNotes:"Approval Notes",bulkApprove:"Bulk Approve",bulkApproveConfirm:"Are you sure you want to approve these EORs?",bulkReject:"Bulk Reject",bulkRejectConfirm:"Are you sure you want to reject these EORs?",enterNotes:"Enter notes...",rejected:"Rejected"},sb={title:"Repair Orders",roList:"Repair Order List",assignTeam:"Assign Team",startRepair:"Start Repair",completeRepair:"Complete Repair",workLog:"Work Log",addWorkLog:"Add Work Log",repairTasks:"Repair Tasks",elapsedTime:"Elapsed Time",allTeams:"All Teams",noRepairOrders:"No Repair Orders",noRepairOrdersDesc:"There are no repair orders at this time",assign:"Assign",assignTeamDesc:"Select a team to assign this repair order",complete:"Complete",selectTeam:"Select Team",selectTeamPlaceholder:"Choose a team...",start:"Start"},ib={title:"Shunting",newRequest:"New Shunting Request",newShuntingRequest:"New Shunting Request",fromBlock:"From Block",toBlock:"To Block",priority:"Priority",high:"High",medium:"Medium",low:"Low",normal:"Normal",pending:"Pending",inProgress:"In Progress",completed:"Completed",chooseContainer:"Choose Container",selectContainer:"Select Container",destinationBlock:"Destination Block",selectBlock:"Select Block",assignDriver:"Assign Driver",assignLater:"Assign Later",createRequest:"Create Request",activeTasks:"active tasks",allPriorities:"All Priorities",assign:"Assign",complete:"Complete",dispatch:"Dispatch",dispatchToDriver:"Dispatch to Driver",dispatched:"Dispatched",driverWorkload:"Driver Workload",moveContainers:"Move containers to repair bays",new:"New",noRequests:"No shunting requests",repairBay:"Repair Bay",selectDriver:"Select Driver",shuntingRequests:"Shunting Requests",start:"Start",tasks:"tasks",totalRequests:"Total Requests",urgent:"Urgent"},ob={title:"Pre-Inspection",schedule:"Schedule Inspection",total:"Total Inspections",today:"Today's",accepted:"Accepted",reworkRequired:"Rework Required",multipleReworks:"Multiple Reworks",reworkAnalysis:"Rework Analysis by Category",allInspections:"All Inspections",planned:"Planned",completed:"Completed",allResults:"All Results",rework:"Rework",noInspectionsFound:"No inspections scheduled",scheduleInspection:"Schedule a pre-inspection for completed repairs",scheduledDate:"Scheduled Date",reworkCount:"Rework #",startWithChecklist:"Start Full Inspection",inspect:"Inspect",quickAccept:"Quick Accept",quickRework:"Quick Rework",itemsFailed:"items failed",inspectionChecklist:"QC Inspection",postRepairCleaning:"Post-Repair Cleaning",damageVerification:"Damage Items Verification",damageVerificationDesc:"Verify that each damage item from the survey has been properly repaired.",repaired:"Repaired",notRepaired:"Not Fixed",generalChecklist:"General Inspection Checklist",pass:"Pass",fail:"Fail",inspectorNotes:"Inspector Notes",notesPlaceholder:"Add any observations or comments...",repairsVerified:"Repairs Verified",passed:"Passed",failed:"Failed",remaining:"Remaining",completeInspection:"Complete Inspection",recordRework:"Record Rework Required",reworkDetails:"Rework Details",describeIssues:"Describe issues found and required rework...",requireRework:"Require Rework",accept:"Accept",allTypes:"All Types",inspectionStatus:"Inspection Status",result:"Result",todayInspections:"Today's Inspections"},lb={title:"Stacking & Release",newRequest:"New Stacking Request",readyToStack:"Ready for Stacking",readyForStacking:"Ready for Stacking",targetLocation:"Target Location",block:"Block",row:"Row",tier:"Tier",completeRelease:"Complete & Release",releaseContainer:"Release Container",releaseOptions:"Release Options",generateGatePass:"Generate Gate Pass",notifyAndRelease:"Notify & Release",stockReport:"Stock Report",searchLocation:"Search by location",readyToStackLabel:"Ready to Stack",releaseReady:"Release Ready",stackNow:"Stack Now",released:"Released",stackingRequests:"Stacking Requests",byBlock:"By Block",byLiner:"By Liner",createRequest:"Create Request",createRequests:"Create Requests",new:"New",newStackingRequest:"New Stacking Request",noLocation:"No location",noStackingRequests:"No stacking requests",repairBay:"Repair Bay",selectContainer:"Select Container",stockByLiner:"Available Stock by Liner",stockByBlock:"Available Stock by Yard Block",totalAvailable:"Total Available",reportExported:"Stock report exported"},cb={title:"Dashboard",welcome:"Welcome back",quickActions:"Quick Actions",eorOverview:"EOR Overview",recentSurveys:"Recent Surveys",recentEORs:"Recent EORs",totalContainers:"Total Containers",pendingEORs:"Pending EORs",inRepair:"In Repair",completedToday:"Completed Today",searchContainers:"Search containers",damaged:"Damaged",awaitingRepair:"Awaiting Repair",available:"Available",workflowTracker:"Workflow Tracker",pendingActions:"Pending Actions",recentActivity:"Recent Activity",noPendingActions:"No pending actions",totalValue:"Total Value",noEORsYet:"No EORs yet",noRecentActivity:"No recent activity",noSurveysYet:"No surveys yet"},ub={washingStation:"Washing Station",dashboard:"Dashboard",containerManagement:"Container Management",registerContainer:"Register Container",allContainers:"All Containers",arContainers:"AR Containers",surveyDamage:"Survey & Damage",newSurvey:"New Survey",surveyList:"Survey List",repairManagement:"Repair Management",eorList:"EOR List",repairOrders:"Repair Orders",yardOperations:"Yard Operations",shunting:"Shunting",preInspection:"Pre-Inspection",stackingRelease:"Stacking & Release",administration:"Administration",masterCodes:"Master Codes",permissionGroups:"Permission Groups",userManagement:"User Management",systemSettings:"System Settings",monitoring:"Monitoring",jobMonitoring:"Job Monitoring",homePageManagement:"Home Page",chatManagement:"Live Chat"},db={management:"Chat Management",activeChats:"Active Chats",selectChat:"Select a chat",noActiveChats:"No active chats",typeMessage:"Type a message...",typeReply:"Type your reply...",send:"Send",close:"Close",closeChat:"Close Chat",yourName:"Your Name",email:"Email Address",startChat:"Start Chat",askUs:"Ask Us",online:"Online",offline:"Offline",justNow:"Just now",unread:"unread",greeting:"How can we help you today?"},hb={title:"Washing Station",subtitle:"Container cleaning and sanitization management",newWashingOrder:"New Washing Order",pendingApproval:"Pending Approval",pendingSchedule:"Pending Schedule",scheduled:"Scheduled",inProgress:"In Progress",pendingQC:"Pending QC",rework:"Rework",completedToday:"Completed Today",searchPlaceholder:"Search container, liner...",allBays:"All Bays",allPrograms:"All Programs",program:"Program",bay:"Bay",scheduledAt:"Scheduled",noOrders:"No washing orders found",readyForWashing:"Containers Ready for Washing",createOrder:"Create Order",cleaningStarted:"Cleaning started",orderApproved:"Washing order approved",orderRejected:"Washing order rejected",enterRejectionReason:"Enter rejection reason:",approve:"Approve",reject:"Reject",startCleaning:"Start Cleaning",completeCleaning:"Complete & Submit for QC",cleaningCompleted:"Cleaning completed, pending QC",completeAllRequired:"Please complete all required items",orderNotFound:"Washing order not found",safetyNotes:"Safety Notes",cleaningChecklist:"Cleaning Checklist",workerNotes:"Worker Notes",notesPlaceholder:"Any observations or issues...",allRequiredMustPass:"All required items must pass",qcPassed:"QC Passed! Certificate generated.",selectReworkReasons:"Please select at least one rework reason",qcFailed:"QC Failed. Order sent for rework.",qcInspection:"QC Inspection",cleaningProgram:"Cleaning Program",elapsedTime:"Elapsed Time",reworkAttempt:"Rework Attempt",previousReworkReasons:"Previous issues",qcChecklist:"QC Checklist",pass:"Pass",fail:"Fail",reworkReasons:"Rework Reasons",qcNotes:"QC Notes",qcNotesPlaceholder:"Inspection observations...",failAndRework:"Fail & Rework",passAndCertify:"Pass & Generate Certificate",selectContainerFirst:"Please select a container first",orderCreated:"Washing order created",assignedBay:"Assigned Bay",assignedTeam:"Assigned Team",selectBay:"Select Bay",selectTeam:"Select Team",initialInspection:"Initial Inspection",contaminationLevel:"Contamination Level",interiorCondition:"Interior Condition",exteriorCondition:"Exterior Condition",odorPresent:"Odor Present",pestPresent:"Pest Signs Present",hazardousResidues:"Hazardous Residues",inspectionNotes:"Inspection Notes",safetyWarning:"Safety Warning",hazardousWarning:"This container requires special safety measures. Ensure proper PPE and ventilation before cleaning.",suggestedProgram:"Suggested",selectProgram:"Select Program",schedule:"Schedule",assignBay:"Assign Bay",assignTeam:"Assign Team",safetyRequirements:"Safety Requirements",requiresMask:"Requires Mask",requiresGloves:"Requires Gloves",chemicalHandling:"Chemical Handling",ventilationRequired:"Ventilation Required",twoPersonJob:"2-Person Job",safetyNotesPlaceholder:"Additional safety instructions for worker...",certificateOfCleanliness:"Certificate of Cleanliness",certificateNo:"Certificate No",cleanedDate:"Cleaning Date",issueDate:"Issue Date",certificateStatement:"This is to certify that the above-mentioned container has been cleaned and inspected in accordance with international standards and industry best practices. The container is free from contamination, debris, and odors, and is suitable for cargo loading.",qcInspector:"QC Inspector",authorizedSignatory:"Authorized Signatory",printCertificate:"Print",downloadPDF:"Download PDF",emailToLiner:"Email to Liner",noCertificate:"No certificate available. QC must pass first."},fb={announcements:"Announcements",links:"Links",noAnnouncements:"No announcements",noLinks:"No links"},mb={title:"Title",content:"Content",url:"URL",description:"Description",select:"Select..."},pb={transactionId:"Transaction ID",containerNumber:"Container Number",sequence:"Sequence",liner:"Liner",size:"Size",type:"Type",location:"Location",yardLocation:"Yard Location",gateInDate:"Gate In Date",createdAt:"Created At",createdBy:"Created By",updatedAt:"Updated At",completedAt:"Completed At",completedBy:"Completed By",actions:"Actions",notes:"Notes",result:"Result",assignedTeam:"Assigned Team",startTime:"Start Time",endTime:"End Time",totalCost:"Total Cost",version:"Version",requestedAt:"Requested At",requestedBy:"Requested By",source:"Source",destination:"Destination",priority:"Priority",inspectedAt:"Inspected At",inspectedBy:"Inspected By",targetLocation:"Target Location",containerStatus:"Container Status",surveyStatus:"Survey Status",eorStatus:"EOR Status",roStatus:"RO Status",shuntingStatus:"Shunting Status",inspectionStatus:"Inspection Status",stackingStatus:"Stacking Status",surveyType:"Survey Type",initialCondition:"Initial Condition",damageCount:"Damage Count",approval:"Approval",autoApproved:"Auto-Approved",repairOrderStatus:"Repair Order Status",progress:"Progress",driver:"Driver",route:"Route",waitTime:"Wait Time",gatePass:"Gate Pass",reworkCount:"Rework #"},gb={stacking:"Stacking",survey:"Survey",eor:"EOR",approval:"Approval",repair:"Repair",shunting:"Shunting",qc:"QC",release:"Release",washing:"Washing"},xb={title:"Pending Actions",surveysPending:"Surveys Pending",eorPendingApproval:"EORs Pending Approval",repairsPending:"Repairs Pending",inspectionsDue:"Inspections Due"},vb={title:"Recent Activity",newSurvey:"New survey created for",eorStatusChange:"EOR status changed to",repairStarted:"Repair started for",noRecentActivity:"No recent activity"},yb={selected:"selected",approveSelected:"Approve Selected",rejectSelected:"Reject Selected",clearSelection:"Clear Selection",bulkApprove:"Bulk Approve",bulkReject:"Bulk Reject",confirmApprove:"Are you sure you want to approve these EORs?",confirmReject:"Are you sure you want to reject these EORs?"},kb={workload:"Driver Workload",activeTasks:"active tasks",assign:"Assign",dispatch:"Dispatch",selectDriver:"Select Driver",dispatchToDriver:"Dispatch to Driver"},wb={structural:"Structural Integrity",doors:"Door Operation",floor:"Floor Condition",roof:"Roof Condition",paint:"Paint and Finish",placards:"Placards and Labels",locking:"Locking Mechanism",cleanliness:"Cleanliness",pass:"Pass",fail:"Fail",passed:"Passed",failed:"Failed",remaining:"Remaining",completeInspection:"Complete Inspection",reworkAnalysis:"Rework Analysis",multipleReworks:"Multiple Reworks"},Sb={title:"Stock Report",byLiner:"Available Containers by Liner",byBlock:"Available Containers by Block"},_b={generateGatePass:"Generate Gate Pass",notifyAndRelease:"Notify Liner & Release",releaseOptions:"Choose how you want to release this container:",gatePassGenerated:"Gate pass generated"},Cb={approvalsNeeded:"Approvals Needed",inspectionsPending:"Inspections Pending",repairsInProgress:"Repairs In Progress",surveysToComplete:"Surveys to Complete"},Nb={PENDING_WASH:"Pending Wash",WASHING:"Washing"},Eb={common:XT,greetings:QT,admin:JT,auth:ZT,portal:eb,workspace:tb,container:nb,survey:rb,eor:ab,repairOrder:sb,shunting:ib,inspection:ob,stacking:lb,dashboard:cb,nav:ub,chat:db,washing:hb,homepage:fb,common2:mb,columns:pb,workflow:gb,pendingActions:xb,recentActivity:vb,bulkActions:yb,driver:kb,inspectionChecklist:wb,stockReport:Sb,release:_b,pending:Cb,containerStatus:Nb},Tb={dashboard:"Bng iu khin",containers:"Container",surveys:"Kho st",eor:"EOR",repairOrders:"Lnh sa cha",shunting:"Vn chuyn",preInspection:"Kim tra trc",stacking:"Xp & Xut",settings:"Ci t",logout:"ng xut",save:"Lu",cancel:"Hy",delete:"Xa",edit:"Sa",view:"Xem",search:"Tm kim",filter:"Lc",export:"Xut",import:"Nhp",back:"Quay li",next:"Tip theo",submit:"Gi",confirm:"Xc nhn",close:"ng",yes:"C",no:"Khng",loading:"ang ti...",noData:"Khng c d liu",required:"Bt buc",optional:"Ty chn",actions:"Thao tc",status:"Trng thi",createdAt:"Ngy to",updatedAt:"Ngy cp nht",createdBy:"Ngi to",add:"Thm",remove:"Xa",active:"Hot ng",inactive:"Khng hot ng",allStatuses:"Tt c trng thi",allLiners:"Tt c hng tu",allTypes:"Tt c loi",showing:"ang hin th",of:"trong",inProgress:"ang x l",completed:"Hon thnh",from:"T ngy",to:"n ngy",selected:" chn",previous:"Trc",pleaseSelect:"Vui lng chn",viewAll:"Xem tt c",pending:"ang ch",all:"Tt c",approved:" duyt",rejected:"T chi",notes:"Ghi ch",container:"Container",selectContainer:"Chn container",clearDates:"Xa ngy",clearSelection:"Xa la chn",content:"Ni dung",create:"To",description:"M t",more:"thm",page:"Trang",select:"Chn",title:"Tiu ",total:"tng",url:"URL",apply:"p dng",featureComingSoon:"Tnh nng sp ra mt",retrieve:"Ly li d liu",dataReloaded:"D liu  c ti li thnh cng",reloadError:"Khng th ti li d liu",exportCSV:"Xut CSV"},bb={groupCode:"M nhm",groupName:"Tn nhm",description:"M t",usage:"S dng",grant:"Cp quyn",groupLevel:"Cp  nhm",screens:"Mn hnh",functions:"Chc nng",fullName:"H tn",email:"Email",groups:"Nhm",lastLogin:"ng nhp cui",registerUser:"ng k ngi dng",codeType:"Loi m",code:"M",name:"Tn",addCode:"Thm m",editCode:"Sa m",permissions:"Quyn hn",use:"S dng",retrieve:"Xem",create:"To",update:"Cp nht",delete:"Xa",download:"Ti xung",preview:"Xem trc",print:"In",history:"Lch s",clear:"Xa",internal:"Ni b",external:"Bn ngoi",eorSettings:"Ci t EOR",displaySettings:"Ci t hin th",notifications:"Thng bo",localization:"Ngn ng",workflowSettings:"Ci t quy trnh",autoApprovalThreshold:"Ngng t ng duyt",autoApprovalDesc:"EOR di s tin ny s c t ng duyt",defaultCurrency:"Tin t mc nh",currencyDesc:"n v tin t cho tt c chi ph",showCostInList:"Hin th chi ph",showCostDesc:"Hin th chi ph sa cha trong danh sch",currentSettings:"Ci t hin ti",autoApproval:"T ng duyt",language:"Ngn ng",perPage:"Mi trang",timeout:"Thi gian ch",resetDefaults:"Khi phc mc nh",allGroups:"Tt c nhm",allTypes:"Tt c loi",permissionGroupsDesc:"Qun l nhm ngi dng v quyn hn",overview:"Tng quan",screen:"Mn hnh",save:"Lu",masterCodesDesc:"Qun l d liu v m h thng",codeTypes:"Loi m",totalCodes:"Tng s m",searchCodes:"Tm kim m...",username:"Tn ng nhp",password:"Mt khu",userType:"Loi ngi dng",shippingLine:"Hng tu",assignGroups:"Phn nhm",userManagementDesc:"ng k v qun l ti khon ngi dng",showInactive:"Hin khng hot ng",noUsersFound:"Khng tm thy ngi dng",requiredFields:"Yu cu nhp tn, mt khu v h tn",usernameExists:"Tn ng nhp  tn ti",groupRequired:"Cn chn t nht mt nhm",userCreated:"To ngi dng thnh cng",userUpdated:"Cp nht ngi dng thnh cng",userDeactivated:" v hiu ha ngi dng",userActivated:" kch hot ngi dng",deactivate:"V hiu ha",activate:"Kch hot",details:"Chi tit",activity:"Hot ng",security:"Bo mt",createdAt:"Ngy to",never:"Cha bao gi",justNow:"Va xong",selectUser:"Chn ngi dng",selectUserDesc:"Chn ngi dng t danh sch  xem v sa",activeScreens:"Mn hnh ang hot ng",completion:"Hon thnh",hideGroups:"n nhm",showGroups:"Hin nhm",resetPassword:"t li mt khu",homePageManagement:"Qun l trang ch",homePageDesc:"Qun l thng bo v lin kt hin th trn cng",addAnnouncement:"Thm thng bo",editAnnouncement:"Sa thng bo",addLink:"Thm lin kt",editLink:"Sa lin kt",announcementCreated:" to thng bo",announcementUpdated:" cp nht thng bo",announcementDeleted:" xa thng bo",linkCreated:" to lin kt",linkUpdated:" cp nht lin kt",linkDeleted:" xa lin kt",confirmDelete:"Bn c chc chn mun xa khng?",applyTemplate:"p dng mu",approve:"Duyt",reject:"T chi",selectGroup:"Chn nhm",selectGroupDesc:"Chn nhm t danh sch  xem v sa quyn",groupSaved:" lu nhm thnh cng",groupCreated:" to nhm thnh cng",groupDuplicated:" sao chp nhm thnh cng",groupDeleted:" xa nhm thnh cng",deleteGroup:"Xa nhm",deleteGroupConfirm:"Bn c chc chn mun xa nhm",deleteGroupWarning:"Thao tc ny khng th hon tc. Ngi dng thuc nhm ny s mt quyn.",accountStatus:"Trng thi ti khon",activated:" kch hot",autoLogoutDesc:"T ng ng xut sau thi gian khng hot ng",cannotDeleteCore:"Khng th xa nhm mc nh",codeAdded:" thm m thnh cng",codeDeactivated:" v hiu ha m",codeExists:"M  tn ti",codeNameRequired:"M v tn l bt buc",codeRequired:"M l bt buc",codeUpdated:" cp nht m thnh cng",confirmDeactivate:"Bn c chc chn mun v hiu ha khng?",containersDesc:"S container hin th mi trang",containersPerPage:"Container mi trang",copied:" sao chp!",copyCode:"Sao chp m",dateFormat:"nh dng ngy",dateFormatDesc:"nh dng hin th ngy",deactivated:" v hiu ha",defaultSurveyType:"Loi kho st mc nh",duplicate:"Sao chp",enableAutoLogout:"Bt t ng ng xut",enableNotifications:"Bt thng bo",enableQuickActions:"Bt thao tc nhanh",exportSuccess:"Xut thnh cng",importCodes:"Nhp m",importInstructions:"Dn d liu JSON  nhp m",imported:" nhp",invalidFormat:"nh dng khng hp l",invalidJSON:"nh dng JSON khng hp l",jsonData:"D liu JSON",languageDesc:"Ngn ng mc nh cho ng dng",legacyFunctions:"Quyn da trn chc nng c ( tng thch)",nameRequired:"Tn l bt buc",newGroup:"Nhm quyn mi",noActivityYet:"Cha c hot ng",noCodesFound:"Khng tm thy m",notificationsDesc:"Hin th thng bo h thng",quickActionsDesc:"Hin th nt thao tc nhanh trn bng iu khin",quickTemplates:"Mu nhanh",recentActivity:"Hot ng gn y",requirePhoto:"Yu cu nh",requirePhotoDesc:"Yu cu ti nh ln cho kho st",sessionDesc:"Thi gian phin ht hn",sessionInfo:"Thng tin phin",sessionTimeout:"Thi gian ch phin",settingsReset:" khi phc ci t mc nh",settingsSaved:" lu ci t thnh cng",skipped:" b qua",surveyTypeDesc:"Loi mc nh cho kho st mi",timeFormat:"nh dng gi",timeFormatDesc:"nh dng hin th gi",moveUp:"Di chuyn ln",moveDown:"Di chuyn xung",itemMoved:" di chuyn mc"},Ab={login:"ng nhp",username:"Tn ng nhp",password:"Mt khu",loginButton:"ng nhp",loginTitle:"H thng M&R Container",loginSubtitle:"Qun l Bo tr & Sa cha",loginError:"Tn ng nhp hoc mt khu khng ng",selectLanguage:"Chn ngn ng",changePassword:"i mt khu",currentPassword:"Mt khu hin ti",newPassword:"Mt khu mi",confirmPassword:"Xc nhn mt khu",passwordMismatch:"Mt khu khng khp",passwordTooShort:"Mt khu phi c t nht 6 k t",passwordChanged:"i mt khu thnh cng!",currentPasswordWrong:"Mt khu hin ti khng ng",userLogin:"ng nhp ngi dng",signingIn:"ang ng nhp...",loginSuccess:"ng nhp thnh cng",loginSuccessMessage:"Bn  ng nhp thnh cng.",pleaseLoginFirst:"Vui lng ng nhp  truy cp h thng.",passwordRequired:"Mt khu l bt buc",portalTitle:"Cng M&R",enterCredentials:"Nhp thng tin ng nhp  truy cp h thng",enterUsername:"Nhp tn ng nhp",enterPassword:"Nhp mt khu"},jb={goodMorning:"Cho bui sng",goodAfternoon:"Cho bui chiu",goodEvening:"Cho bui ti"},Rb={johorPort:"Cng Johor",containerPortal:"Cng Container",welcomeTo:"Cho mng n Cng Cng Johor",home:"Trang ch",about:"Gii thiu",services:"Dch v",contactUs:"Lin h",generalEnquiry:"Hi p chung",registration:"ng k",helpDesk:"H tr",containerOperations:"Vn hnh Container",qualityAssurance:"m bo cht lng",support247:"H tr 24/7",shippingAgent:"i l vn chuyn",forwardingAgent:"i l giao nhn",shipperConsignee:"Ngi gi/Ngi nhn",accessSystem:"Truy cp h thng",benefit:"Li ch",announcement:"Thng bo",links:"Lin kt",networkInfrastructure:"H tng mng",onlineMarketplace:"Ch trc tuyn",faq:"Cu hi thng gp"},Ib={selectScreen:"Vui lng chn mt mn hnh t menu  bt u.",menuHint:"S dng menu iu hng bn tri  m cc mn hnh"},Pb={title:"Container",register:"ng k Container",allContainers:"Tt c Container",arContainers:"Container ch sa",containerNumber:"S Container",liner:"Hng tu",size:"Kch thc",type:"Loi",initialStatus:"Trng thi ban u",registerSuccess:"ng k container thnh cng!",alreadyExists:"Container  tn ti",invalidFormat:"nh dng khng hp l (VD: MSCU1234567)",manualEntry:"Nhp th cng",excelUpload:"Ti ln Excel",downloadTemplate:"Ti mu",dragDropExcel:"Ko th file Excel vo y",orClickBrowse:"hoc click  chn file",previewContainers:"Xem trc",importValid:"Nhp Container hp l",clear:"Xa",formatHint:"nh dng: 4 ch + 7 s",damaged:"H hng",available:"Sn sng",awaitingRepair:"Ch sa cha",repairInProgress:"ang sa cha",completed:"Hon thnh",gateOut:"Xut cng",adjustFilters:"iu chnh b lc  xem thm kt qu",batchStatusUpdate:"Cp nht trng thi hng lot",batchUpdate:"Cp nht hng lot",batchUpdateConfirm:"Bn c chc chn mun cp nht cc container ny?",containerTimeline:"Dng thi gian container",newStatus:"Trng thi mi",noContainersFound:"Khng tm thy container",noTimelineEvents:"Khng c s kin",toDM:"Sang DM",updateContainers:"Cp nht container",viewDetails:"Xem chi tit",viewTimeline:"Xem dng thi gian",workflowStage:"Giai on quy trnh"},Db={title:"Kho st",newSurvey:"Kho st mi",surveyList:"Danh sch kho st",searchContainer:"Tm Container",surveyType:"Loi kho st",initialCondition:"Tnh trng ban u",notes:"Ghi ch",damageItems:"Hng mc h hng",addItem:"Thm hng mc",location:"V tr",damageType:"Loi h hng",component:"B phn",severity:"Mc ",quantity:"S lng",repairMethod:"Phng php sa",estimatedCost:"Chi ph d kin (RM)",totalCost:"Tng chi ph d kin",saveDraft:"Lu nhp",completeSurvey:"Hon thnh kho st",createEOR:"To EOR",manual:"Th cng",inbound:"Nhp",outbound:"Xut",periodic:"nh k",other:"Khc",hasDamage:"C h hng",noDamage:"Khng h hng",noSurveysFound:"Khng tm thy kho st",createNewSurvey:"Nhn  to kho st mi",allTypes:"Tt c loi",damage:"H hng",damaged:"B h hng"},Ob={title:"Bo gi sa cha",eorList:"Danh sch EOR",createEOR:"To EOR",editEOR:"Sa EOR",repairItems:"Hng mc sa cha",unitPrice:"n gi",laborHours:"Gi cng",lineCost:"Thnh tin",totalCost:"Tng tin",autoApproved:"T ng duyt",pendingApproval:"Ch duyt",sendToLiner:"Gi hng tu",approve:"Duyt",reject:"T chi",createRepairOrder:"To lnh sa",timeline:"Tin ",autoApprovalNote:"EOR  100 RM s c t ng duyt",totalValue:"Tng gi tr",pendingAmount:"S tin ch duyt",approvedAmount:"S tin  duyt",avgValue:"Gi tr TB",syncToAR:"ng b AR",draft:"Nhp",pending:"Ch duyt",approved:" duyt",noEORsFound:"Khng tm thy EOR",createFromSurvey:"To EOR t kho st  hon thnh",approveSelected:"Duyt  chn",rejectSelected:"T chi  chn",approvalNotes:"Ghi ch ph duyt",bulkApprove:"Duyt hng lot",bulkApproveConfirm:"Bn c chc mun duyt cc EOR ny?",bulkReject:"T chi hng lot",bulkRejectConfirm:"Bn c chc mun t chi cc EOR ny?",enterNotes:"Nhp ghi ch...",rejected:" t chi"},Lb={title:"Lnh sa cha",roList:"Danh sch lnh sa",assignTeam:"Phn cng i",startRepair:"Bt u sa",completeRepair:"Hon thnh sa",workLog:"Nht k cng vic",addWorkLog:"Thm ghi nhn",repairTasks:"Cng vic sa cha",elapsedTime:"Thi gian  lm",allTeams:"Tt c i",noRepairOrders:"Khng c lnh sa cha",noRepairOrdersDesc:"Hin khng c lnh sa cha no",assign:"Phn cng",assignTeamDesc:"Chn i  phn cng lnh sa cha ny",complete:"Hon thnh",selectTeam:"Chn i",selectTeamPlaceholder:"Chn mt i...",start:"Bt u"},Fb={title:"Vn chuyn",newRequest:"Yu cu vn chuyn mi",newShuntingRequest:"Yu cu vn chuyn mi",fromBlock:"T Block",toBlock:"n Block",priority:"u tin",high:"Cao",medium:"Trung bnh",low:"Thp",normal:"Bnh thng",pending:"Ch x l",inProgress:"ang thc hin",completed:"Hon thnh",chooseContainer:"Chn container",selectContainer:"Chn container",destinationBlock:"Block ch",selectBlock:"Chn block",assignDriver:"Ch nh ti x",assignLater:"Ch nh sau",createRequest:"To yu cu",activeTasks:"cng vic ang lm",allPriorities:"Tt c mc u tin",assign:"Phn cng",complete:"Hon thnh",dispatch:"iu phi",dispatchToDriver:"iu phi cho ti x",dispatched:" iu phi",driverWorkload:"Khi lng cng vic ti x",moveContainers:"Di chuyn container n khu sa cha",new:"Mi",noRequests:"Khng c yu cu vn chuyn",repairBay:"Khu sa cha",selectDriver:"Chn ti x",shuntingRequests:"Yu cu vn chuyn",start:"Bt u",tasks:"cng vic",totalRequests:"Tng yu cu",urgent:"Khn cp"},Mb={title:"Kim tra trc",schedule:"Ln lch kim tra",scheduleInspection:"Ln lch kim tra",scheduledDate:"Ngy kim tra",result:"Kt qu",accept:"t",accepted:" t",rework:"Cn sa li",reworkRequired:"Cn sa li",reworkDetails:"Chi tit sa li",todayInspections:"Kim tra hm nay",allInspections:"Tt c kim tra",allTypes:"Tt c loi",multipleReworks:"Sa nhiu ln",reworkCount:"Ln sa",inspect:"Kim tra",inspectionStatus:"Trng thi kim tra",total:"Tng kim tra",today:"Hm nay",allResults:"Tt c kt qu",completeInspection:"Hon thnh kim tra",completed:" hon thnh",describeIssues:"M t cc vn  tm thy...",fail:"Khng t",failed:"Khng t",inspectionChecklist:"Checklist kim tra",inspectorNotes:"Ghi ch kim tra vin",itemsFailed:"mc khng t",noInspectionsFound:"Khng tm thy kim tra",notesPlaceholder:"Thm ghi ch...",pass:"t",passed:" t",planned:" ln lch",quickAccept:"Chp nhn nhanh",quickRework:"Sa li nhanh",recordRework:"Ghi nhn sa li",remaining:"Cn li",requireRework:"Yu cu sa li",reworkAnalysis:"Phn tch sa li",startWithChecklist:"Bt u vi checklist",damageVerification:"Xc Nhn Hng Mc H Hng",damageVerificationDesc:"Xc nhn rng mi hng mc h hng t kho st  c sa cha ng cch.",generalChecklist:"Danh Sch Kim Tra Tng Qut",repaired:" Sa",notRepaired:"Cha Sa",repairsVerified:"Sa Cha  Xc Nhn",postRepairCleaning:"V Sinh Sau Sa Cha"},Bb={title:"Xp & Xut",newRequest:"Yu cu xp mi",readyToStack:"Sn sng xp",readyForStacking:"Sn sng xp",targetLocation:"V tr ch",block:"Block",row:"Hng",tier:"Tng",completeRelease:"Hon thnh & Xut",releaseContainer:"Xut container",releaseOptions:"Ty chn xut",generateGatePass:"To phiu ra cng",notifyAndRelease:"Thng bo & Xut",stockReport:"Bo co kho",searchLocation:"Tm theo v tr",readyToStackLabel:"Sn sng xp",releaseReady:"Sn sng xut",stackNow:"Xp ngay",released:" xut",stackingRequests:"Yu cu xp",byBlock:"Theo block",byLiner:"Theo hng tu",createRequest:"To yu cu",createRequests:"To yu cu",new:"Mi",newStackingRequest:"Yu cu xp mi",noLocation:"Khng c v tr",noStackingRequests:"Khng c yu cu xp",repairBay:"Khu sa cha",selectContainer:"Chn container",stockByLiner:"Tn kho theo Hng tu",stockByBlock:"Tn kho theo Block",totalAvailable:"Tng sn c",reportExported:" xut bo co tn kho"},Ub={title:"Bng iu khin",welcome:"Cho mng tr li",quickActions:"Thao tc nhanh",eorOverview:"Tng quan EOR",recentSurveys:"Kho st gn y",recentEORs:"EOR gn y",totalContainers:"Tng Container",pendingEORs:"EOR ch duyt",inRepair:"ang sa cha",completedToday:"Hon thnh hm nay",searchContainers:"Tm kim container",damaged:"H hng",awaitingRepair:"Ch sa",available:"Sn sng",workflowTracker:"Theo di quy trnh",pendingActions:"Ch x l",recentActivity:"Hot ng gn y",noPendingActions:"Khng c hnh ng ch x l",totalValue:"Tng gi tr",noEORsYet:"Cha c EOR",noRecentActivity:"Khng c hot ng gn y",noSurveysYet:"Cha c kho st"},zb={dashboard:"Bng iu khin",containerManagement:"Qun l Container",registerContainer:"ng k Container",allContainers:"Tt c Container",arContainers:"Container ch sa",surveyDamage:"Kho st & H hng",newSurvey:"Kho st mi",surveyList:"Danh sch kho st",repairManagement:"Qun l sa cha",eorList:"Danh sch EOR",repairOrders:"Lnh sa cha",yardOperations:"Vn hnh bi",shunting:"Vn chuyn",preInspection:"Kim tra trc",stackingRelease:"Xp & Xut",administration:"Qun tr h thng",masterCodes:"M danh mc",permissionGroups:"Nhm quyn",userManagement:"Qun l ngi dng",systemSettings:"Ci t h thng",monitoring:"Gim st",jobMonitoring:"Gim st cng vic",homePageManagement:"Trang ch",washingStation:"Trm Ra Container"},Wb={containerNumber:"S Container",sequence:"Ln",liner:"Hng tu",size:"Kch thc",type:"Loi",location:"V tr",yardLocation:"V tr bi",gateInDate:"Ngy vo cng",createdAt:"Ngy to",createdBy:"Ngi to",updatedAt:"Ngy cp nht",completedAt:"Ngy hon thnh",completedBy:"Ngi hon thnh",actions:"Thao tc",notes:"Ghi ch",result:"Kt qu",assignedTeam:"i c giao",startTime:"Thi gian bt u",endTime:"Thi gian kt thc",totalCost:"Tng chi ph",version:"Phin bn",requestedAt:"Ngy yu cu",requestedBy:"Ngi yu cu",source:"Ngun",destination:"ch",priority:"u tin",inspectedAt:"Ngy kim tra",inspectedBy:"Ngi kim tra",targetLocation:"V tr ch",containerStatus:"Trng thi Container",surveyStatus:"Trng thi Survey",eorStatus:"Trng thi EOR",roStatus:"Trng thi RO",shuntingStatus:"Trng thi Di chuyn",inspectionStatus:"Trng thi Kim tra",stackingStatus:"Trng thi Xp chng",surveyType:"Loi Survey",initialCondition:"Tnh trng ban u",damageCount:"S h hng",approval:"Ph duyt",autoApproved:"T ng duyt",repairOrderStatus:"Trng thi Lnh sa cha",transactionId:"M giao dch",progress:"Tin ",driver:"Ti x",route:"Tuyn ng",waitTime:"Thi gian ch",gatePass:"Phiu ra cng",reworkCount:"Ln sa li"},Hb={announcements:"Thng bo",links:"Lin kt",noAnnouncements:"Khng c thng bo",noLinks:"Khng c lin kt"},Gb={title:"Tiu ",content:"Ni dung",url:"URL",description:"M t",select:"Chn..."},$b={stacking:"Xp chng",survey:"Kho st",eor:"EOR",approval:"Ph duyt",repair:"Sa cha",shunting:"Vn chuyn",qc:"QC",release:"Xut",washing:"Ra Container"},Vb={title:"Hnh ng ch x l",surveysPending:"Kho st ch x l",eorPendingApproval:"EOR ch ph duyt",repairsPending:"Sa cha ch x l",inspectionsDue:"Kim tra n hn"},qb={title:"Hot ng gn y",newSurvey:"Kho st mi c to cho",eorStatusChange:"Trng thi EOR  thay i thnh",repairStarted:"Bt u sa cha cho",noRecentActivity:"Khng c hot ng gn y"},Kb={selected:" chn",approveSelected:"Duyt  chn",rejectSelected:"T chi  chn",clearSelection:"Xa la chn",bulkApprove:"Duyt hng lot",bulkReject:"T chi hng lot",confirmApprove:"Bn c chc chn mun duyt cc EOR ny?",confirmReject:"Bn c chc chn mun t chi cc EOR ny?"},Yb={workload:"Khi lng cng vic ti x",activeTasks:"cng vic ang thc hin",assign:"Phn cng",dispatch:"iu phi",selectDriver:"Chn ti x",dispatchToDriver:"iu phi cho ti x"},Xb={structural:" chc chn kt cu",doors:"Hot ng ca",floor:"Tnh trng sn",roof:"Tnh trng mi",paint:"Sn v hon thin",placards:"Bin hiu v nhn",locking:"C ch kha",cleanliness:" sch s",pass:"t",fail:"Khng t",passed:" t",failed:"Khng t",remaining:"Cn li",completeInspection:"Hon thnh kim tra",reworkAnalysis:"Phn tch sa li",multipleReworks:"Sa nhiu ln"},Qb={title:"Bo co kho",byLiner:"Container sn c theo hng tu",byBlock:"Container sn c theo block"},Jb={generateGatePass:"To phiu ra cng",notifyAndRelease:"Thng bo hng tu & Xut",releaseOptions:"Chn cch bn mun xut container ny:",gatePassGenerated:" to phiu ra cng"},Zb={approvalsNeeded:"Cn ph duyt",inspectionsPending:"Kim tra ang ch",repairsInProgress:"Sa cha ang tin hnh",surveysToComplete:"Kho st cn hon thnh"},eA={title:"Trm Ra Container",subtitle:"Qun l v sinh v kh trng container",newWashingOrder:"To Lnh Ra Mi",pendingApproval:"Ch Ph Duyt",pendingSchedule:"Ch Ln Lch",scheduled:" Ln Lch",inProgress:"ang Thc Hin",pendingQC:"Ch QC",rework:"Cn Lm Li",completedToday:"Hon Thnh Hm Nay",searchPlaceholder:"Tm container, hng tu...",allBays:"Tt C Bi",allPrograms:"Tt C Chng Trnh",program:"Chng Trnh",bay:"Bi",scheduledAt:"Lch Hn",noOrders:"Khng tm thy lnh ra",readyForWashing:"Container Sn Sng Ra",createOrder:"To Lnh",cleaningStarted:"Bt u ra",orderApproved:"Lnh ra  c ph duyt",orderRejected:"Lnh ra  b t chi",enterRejectionReason:"Nhp l do t chi:",approve:"Ph Duyt",reject:"T Chi",startCleaning:"Bt u Ra",completeCleaning:"Hon Thnh & Gi QC",cleaningCompleted:"Hon thnh ra, ch QC",completeAllRequired:"Vui lng hon thnh tt c mc bt buc",orderNotFound:"Khng tm thy lnh ra",safetyNotes:"Lu  An Ton",cleaningChecklist:"Danh Sch Kim Tra Ra",workerNotes:"Ghi Ch Cng Nhn",notesPlaceholder:"Bt k quan st hoc vn  no...",allRequiredMustPass:"Tt c mc bt buc phi t",qcPassed:"QC t!  to chng nhn.",selectReworkReasons:"Vui lng chn t nht mt l do lm li",qcFailed:"QC Khng t.  gi  lm li.",qcInspection:"Kim Tra QC",cleaningProgram:"Chng Trnh Ra",elapsedTime:"Thi Gian",reworkAttempt:"Ln Lm Li",previousReworkReasons:"Vn  trc ",qcChecklist:"Danh Sch Kim Tra QC",pass:"t",fail:"Khng t",reworkReasons:"L Do Lm Li",qcNotes:"Ghi Ch QC",qcNotesPlaceholder:"Quan st kim tra...",failAndRework:"Khng t & Lm Li",passAndCertify:"t & To Chng Nhn",selectContainerFirst:"Vui lng chn container trc",orderCreated:" to lnh ra",assignedBay:"Bi c Giao",assignedTeam:"Nhm c Giao",selectBay:"Chn Bi",selectTeam:"Chn Nhm",initialInspection:"Kim Tra Ban u",contaminationLevel:"Mc  Nhim Bn",interiorCondition:"Tnh Trng Bn Trong",exteriorCondition:"Tnh Trng Bn Ngoi",odorPresent:"C Mi",pestPresent:"C Du Hiu Cn Trng",hazardousResidues:"Cn c Hi",inspectionNotes:"Ghi Ch Kim Tra",safetyWarning:"Cnh Bo An Ton",hazardousWarning:"Container ny yu cu bin php an ton c bit. m bo PPE v thng gi ph hp trc khi ra.",suggestedProgram:" Xut",selectProgram:"Chn Chng Trnh",schedule:"Ln Lch",assignBay:"Chn Bi",assignTeam:"Chn Nhm",safetyRequirements:"Yu Cu An Ton",requiresMask:"Yu Cu Khu Trang",requiresGloves:"Yu Cu Gng Tay",chemicalHandling:"X L Ha Cht",ventilationRequired:"Cn Thng Gi",twoPersonJob:"Cng Vic 2 Ngi",safetyNotesPlaceholder:"Hng dn an ton b sung cho cng nhn...",certificateOfCleanliness:"Giy Chng Nhn Sch S",certificateNo:"S Chng Nhn",cleanedDate:"Ngy Ra",issueDate:"Ngy Cp",certificateStatement:"Chng nhn rng container nu trn  c ra sch v kim tra theo tiu chun quc t. Container khng c nhim bn, mnh vn, mi v ph hp  xp hng.",qcInspector:"Kim Tra Vin QC",authorizedSignatory:"Ngi K C Thm Quyn",printCertificate:"In",downloadPDF:"Ti PDF",emailToLiner:"Gi Email cho Hng Tu",noCertificate:"Cha c chng nhn. QC phi t trc."},tA={PENDING_WASH:"Ch Ra",WASHING:"ang Ra"},nA={common:Tb,admin:bb,auth:Ab,greetings:jb,portal:Rb,workspace:Ib,container:Pb,survey:Db,eor:Ob,repairOrder:Lb,shunting:Fb,inspection:Mb,stacking:Bb,dashboard:Ub,nav:zb,columns:Wb,homepage:Hb,common2:Gb,workflow:$b,pendingActions:Vb,recentActivity:qb,bulkActions:Kb,driver:Yb,inspectionChecklist:Xb,stockReport:Qb,release:Jb,pending:Zb,washing:eA,containerStatus:tA},rA={dashboard:"Papan Pemuka",containers:"Kontena",surveys:"Tinjauan",eor:"EOR",repairOrders:"Pesanan Pembaikan",shunting:"Pemindahan",preInspection:"Pra-Pemeriksaan",stacking:"Penimbunan & Pelepasan",settings:"Tetapan",logout:"Log Keluar",save:"Simpan",cancel:"Batal",delete:"Padam",edit:"Edit",view:"Lihat",search:"Cari",filter:"Tapis",export:"Eksport",import:"Import",back:"Kembali",next:"Seterusnya",submit:"Hantar",confirm:"Sahkan",close:"Tutup",yes:"Ya",no:"Tidak",loading:"Memuatkan...",noData:"Tiada data",required:"Diperlukan",optional:"Pilihan",actions:"Tindakan",status:"Status",createdAt:"Tarikh Cipta",updatedAt:"Tarikh Kemaskini",createdBy:"Dicipta Oleh",add:"Tambah",remove:"Buang",active:"Aktif",inactive:"Tidak Aktif",allStatuses:"Semua Status",allLiners:"Semua Syarikat Perkapalan",allTypes:"Semua Jenis",showing:"Menunjukkan",of:"daripada",inProgress:"Dalam Proses",completed:"Selesai",from:"Dari",to:"Ke",selected:"dipilih",previous:"Sebelumnya",pleaseSelect:"Sila Pilih",viewAll:"Lihat Semua",pending:"Belum Selesai",all:"Semua",approved:"Diluluskan",rejected:"Ditolak",clearDates:"Kosongkan Tarikh",notes:"Nota",container:"Kontena",selectContainer:"Pilih Kontena",clearSelection:"Kosongkan Pilihan",content:"Kandungan",create:"Cipta",description:"Penerangan",more:"lagi",page:"Halaman",select:"Pilih",title:"Tajuk",total:"jumlah",url:"URL",apply:"Terapkan",featureComingSoon:"Ciri akan datang",retrieve:"Muat Semula",dataReloaded:"Data berjaya dimuat semula",reloadError:"Gagal memuatkan semula data",exportCSV:"Eksport CSV"},aA={groupCode:"Kod Kumpulan",groupName:"Nama Kumpulan",description:"Penerangan",usage:"Penggunaan",grant:"Pemberian",groupLevel:"Tahap Kumpulan",screens:"Skrin",functions:"Fungsi",fullName:"Nama Penuh",email:"Emel",groups:"Kumpulan",lastLogin:"Log Masuk Terakhir",registerUser:"Daftar Pengguna",codeType:"Jenis Kod",code:"Kod",name:"Nama",addCode:"Tambah Kod",editCode:"Edit Kod",permissions:"Kebenaran",use:"Guna",retrieve:"Dapatkan",create:"Cipta",update:"Kemaskini",delete:"Padam",download:"Muat Turun",preview:"Pratonton",print:"Cetak",history:"Sejarah",clear:"Kosongkan",internal:"Dalaman",external:"Luaran",eorSettings:"Tetapan EOR",displaySettings:"Tetapan Paparan",notifications:"Pemberitahuan",localization:"Lokalisasi",workflowSettings:"Tetapan Aliran Kerja",autoApprovalThreshold:"Had Auto-Kelulusan",autoApprovalDesc:"EOR di bawah jumlah ini akan diluluskan secara automatik",defaultCurrency:"Mata Wang Lalai",currencyDesc:"Mata wang untuk semua pengiraan kos",showCostInList:"Papar Kos dalam Senarai",showCostDesc:"Paparkan kos pembaikan dalam senarai",currentSettings:"Tetapan Semasa",autoApproval:"Auto-Kelulusan",language:"Bahasa",perPage:"Setiap Halaman",timeout:"Tamat Masa",resetDefaults:"Set Semula Lalai",allGroups:"Semua Kumpulan",allTypes:"Semua Jenis",permissionGroupsDesc:"Urus kumpulan pengguna dan kebenaran",overview:"Gambaran Keseluruhan",screen:"Skrin",save:"Simpan",masterCodesDesc:"Urus data induk dan kod sistem",codeTypes:"Jenis Kod",totalCodes:"Jumlah Kod",searchCodes:"Cari kod...",username:"Nama Pengguna",password:"Kata Laluan",userType:"Jenis Pengguna",shippingLine:"Syarikat Perkapalan",assignGroups:"Tugaskan Kumpulan",userManagementDesc:"Daftar dan urus akaun pengguna",showInactive:"Tunjuk Tidak Aktif",noUsersFound:"Tiada pengguna ditemui",requiredFields:"Nama pengguna, kata laluan dan nama penuh diperlukan",usernameExists:"Nama pengguna sudah wujud",groupRequired:"Sekurang-kurangnya satu kumpulan diperlukan",userCreated:"Pengguna berjaya dicipta",userUpdated:"Pengguna dikemaskini",userDeactivated:"Pengguna dinyahaktifkan",userActivated:"Pengguna diaktifkan",deactivate:"Nyahaktif",activate:"Aktifkan",details:"Butiran",activity:"Aktiviti",security:"Keselamatan",createdAt:"Dicipta",never:"Tidak pernah",justNow:"Baru sahaja",selectUser:"Pilih Pengguna",selectUserDesc:"Pilih pengguna dari senarai untuk lihat dan edit",activeScreens:"Skrin Aktif",completion:"Penyiapan",hideGroups:"Sembunyikan Kumpulan",showGroups:"Tunjukkan Kumpulan",resetPassword:"Set Semula Kata Laluan",homePageManagement:"Pengurusan Halaman Utama",homePageDesc:"Urus pengumuman dan pautan pada portal",addAnnouncement:"Tambah Pengumuman",editAnnouncement:"Edit Pengumuman",addLink:"Tambah Pautan",editLink:"Edit Pautan",announcementCreated:"Pengumuman dicipta",announcementUpdated:"Pengumuman dikemaskini",announcementDeleted:"Pengumuman dipadam",linkCreated:"Pautan dicipta",linkUpdated:"Pautan dikemaskini",linkDeleted:"Pautan dipadam",confirmDelete:"Adakah anda pasti mahu memadam ini?",applyTemplate:"Gunakan Templat",approve:"Luluskan",reject:"Tolak",selectGroup:"Pilih Kumpulan",selectGroupDesc:"Pilih kumpulan dari senarai untuk lihat dan edit kebenaran",groupSaved:"Kumpulan berjaya disimpan",groupCreated:"Kumpulan berjaya dicipta",groupDuplicated:"Kumpulan berjaya disalin",groupDeleted:"Kumpulan berjaya dipadam",deleteGroup:"Padam Kumpulan",deleteGroupConfirm:"Adakah anda pasti mahu memadam kumpulan",deleteGroupWarning:"Tindakan ini tidak boleh dibatalkan. Pengguna dalam kumpulan ini akan kehilangan kebenaran.",accountStatus:"Status Akaun",activated:"Diaktifkan",autoLogoutDesc:"Log keluar secara automatik selepas tempoh tidak aktif",cannotDeleteCore:"Tidak boleh memadam kumpulan teras",codeAdded:"Kod berjaya ditambah",codeDeactivated:"Kod dinyahaktifkan",codeExists:"Kod sudah wujud",codeNameRequired:"Kod dan nama diperlukan",codeRequired:"Kod diperlukan",codeUpdated:"Kod berjaya dikemaskini",confirmDeactivate:"Adakah anda pasti mahu menyahaktifkan ini?",containersDesc:"Bilangan kontena dipaparkan setiap halaman",containersPerPage:"Kontena Setiap Halaman",copied:"Disalin!",copyCode:"Salin Kod",dateFormat:"Format Tarikh",dateFormatDesc:"Format untuk memaparkan tarikh",deactivated:"Dinyahaktifkan",defaultSurveyType:"Jenis Tinjauan Lalai",duplicate:"Salin",enableAutoLogout:"Dayakan Log Keluar Auto",enableNotifications:"Dayakan Pemberitahuan",enableQuickActions:"Dayakan Tindakan Pantas",exportSuccess:"Eksport berjaya",importCodes:"Import Kod",importInstructions:"Tampal data JSON untuk import kod",imported:"diimport",invalidFormat:"Format tidak sah",invalidJSON:"Format JSON tidak sah",jsonData:"Data JSON",languageDesc:"Bahasa lalai untuk aplikasi",legacyFunctions:"Kebenaran berasaskan fungsi lama (untuk keserasian)",nameRequired:"Nama diperlukan",newGroup:"Kumpulan Kebenaran Baru",noActivityYet:"Tiada aktiviti lagi",noCodesFound:"Tiada kod dijumpai",notificationsDesc:"Papar pemberitahuan sistem",quickActionsDesc:"Papar butang tindakan pantas pada papan pemuka",quickTemplates:"Templat Pantas",recentActivity:"Aktiviti Terkini",requirePhoto:"Memerlukan Foto",requirePhotoDesc:"Memerlukan muat naik foto untuk tinjauan",sessionDesc:"Berapa lama sesi tamat tempoh",sessionInfo:"Info Sesi",sessionTimeout:"Tamat Masa Sesi",settingsReset:"Tetapan ditetapkan semula kepada lalai",settingsSaved:"Tetapan berjaya disimpan",skipped:"dilangkau",surveyTypeDesc:"Jenis lalai untuk tinjauan baru",timeFormat:"Format Masa",timeFormatDesc:"Format untuk memaparkan masa",moveUp:"Alih Ke Atas",moveDown:"Alih Ke Bawah",itemMoved:"Item dialihkan"},sA={login:"Log Masuk",username:"Nama Pengguna",password:"Kata Laluan",loginButton:"Log Masuk",loginTitle:"Sistem M&R Kontena",loginSubtitle:"Pengurusan Penyelenggaraan & Pembaikan",loginError:"Nama pengguna atau kata laluan tidak sah",selectLanguage:"Pilih Bahasa",changePassword:"Tukar Kata Laluan",currentPassword:"Kata Laluan Semasa",newPassword:"Kata Laluan Baru",confirmPassword:"Sahkan Kata Laluan",passwordMismatch:"Kata laluan tidak sepadan",passwordTooShort:"Kata laluan mesti sekurang-kurangnya 6 aksara",passwordChanged:"Kata laluan berjaya ditukar!",currentPasswordWrong:"Kata laluan semasa tidak betul",userLogin:"Log Masuk Pengguna",signingIn:"Sedang log masuk...",loginSuccess:"Log Masuk Berjaya",loginSuccessMessage:"Anda telah berjaya log masuk.",pleaseLoginFirst:"Sila log masuk dahulu untuk mengakses sistem.",passwordRequired:"Kata laluan diperlukan",portalTitle:"Portal M&R",enterCredentials:"Masukkan kelayakan anda untuk mengakses sistem",enterUsername:"Masukkan nama pengguna",enterPassword:"Masukkan kata laluan"},iA={goodMorning:"Selamat Pagi",goodAfternoon:"Selamat Tengahari",goodEvening:"Selamat Petang"},oA={johorPort:"Pelabuhan Johor",containerPortal:"Portal Kontena",welcomeTo:"Selamat Datang ke Portal Pelabuhan Johor",home:"Utama",about:"Tentang",services:"Perkhidmatan",contactUs:"Hubungi Kami",generalEnquiry:"Pertanyaan Umum",registration:"Pendaftaran",helpDesk:"Meja Bantuan",containerOperations:"Operasi Kontena",qualityAssurance:"Jaminan Kualiti",support247:"Sokongan 24/7",shippingAgent:"Ejen Perkapalan",forwardingAgent:"Ejen Penghantaran",shipperConsignee:"Penghantar/Penerima",accessSystem:"Akses Sistem",benefit:"Faedah",announcement:"Pengumuman",links:"Pautan",networkInfrastructure:"Infrastruktur Rangkaian",onlineMarketplace:"Pasaran Online",faq:"Soalan Lazim"},lA={selectScreen:"Sila pilih skrin dari menu untuk bermula.",menuHint:"Gunakan menu navigasi di sebelah kiri untuk membuka skrin"},cA={title:"Kontena",register:"Daftar Kontena",allContainers:"Semua Kontena",arContainers:"Kontena Menunggu Pembaikan",containerNumber:"Nombor Kontena",liner:"Syarikat Pelayaran",size:"Saiz",type:"Jenis",initialStatus:"Status Awal",registerSuccess:"Kontena berjaya didaftarkan!",alreadyExists:"Kontena sudah wujud",invalidFormat:"Format tidak sah (cth: MSCU1234567)",manualEntry:"Kemasukan Manual",excelUpload:"Muat Naik Excel",downloadTemplate:"Muat Turun Templat",dragDropExcel:"Seret & lepas fail Excel di sini",orClickBrowse:"atau klik untuk melayari",previewContainers:"Pratonton",importValid:"Import Kontena Sah",clear:"Kosongkan",formatHint:"Format: 4 huruf + 7 digit",damaged:"Rosak",available:"Tersedia",awaitingRepair:"Menunggu Pembaikan",repairInProgress:"Sedang Dibaiki",completed:"Selesai",gateOut:"Keluar Pintu",adjustFilters:"Laraskan penapis untuk lihat lebih hasil",batchStatusUpdate:"Kemaskini Status Pukal",batchUpdate:"Kemaskini Pukal",batchUpdateConfirm:"Adakah anda pasti mahu kemaskini kontena ini?",containerTimeline:"Garis Masa Kontena",newStatus:"Status Baru",noContainersFound:"Tiada kontena dijumpai",noTimelineEvents:"Tiada peristiwa",toDM:"Ke DM",updateContainers:"Kemaskini Kontena",viewDetails:"Lihat Butiran",viewTimeline:"Lihat Garis Masa",workflowStage:"Peringkat Aliran Kerja"},uA={title:"Tinjauan",newSurvey:"Tinjauan Baru",surveyList:"Senarai Tinjauan",searchContainer:"Cari Kontena",surveyType:"Jenis Tinjauan",initialCondition:"Keadaan Asal",notes:"Nota",damageItems:"Item Kerosakan",addItem:"Tambah Item",location:"Lokasi",damageType:"Jenis Kerosakan",component:"Komponen",severity:"Keterukan",quantity:"Kuantiti",repairMethod:"Kaedah Pembaikan",estimatedCost:"Anggaran Kos (RM)",totalCost:"Jumlah Anggaran Kos",saveDraft:"Simpan Draf",completeSurvey:"Selesaikan Tinjauan",createEOR:"Cipta EOR",manual:"Manual",inbound:"Masuk",outbound:"Keluar",periodic:"Berkala",other:"Lain-lain",hasDamage:"Ada Kerosakan",noDamage:"Tiada Kerosakan",noSurveysFound:"Tiada tinjauan ditemui",createNewSurvey:"Klik untuk mencipta tinjauan baru",allTypes:"Semua Jenis",damage:"Kerosakan",damaged:"Rosak"},dA={title:"Anggaran Pembaikan",eorList:"Senarai EOR",createEOR:"Cipta EOR",editEOR:"Edit EOR",repairItems:"Item Pembaikan",unitPrice:"Harga Seunit",laborHours:"Jam Buruh",lineCost:"Kos Baris",totalCost:"Jumlah Kos",autoApproved:"Diluluskan Auto",pendingApproval:"Menunggu Kelulusan",sendToLiner:"Hantar ke Syarikat",approve:"Luluskan",reject:"Tolak",createRepairOrder:"Cipta Pesanan Pembaikan",timeline:"Garis Masa",autoApprovalNote:"EOR  100 RM akan diluluskan secara automatik",totalValue:"Jumlah Nilai",pendingAmount:"Jumlah Menunggu",approvedAmount:"Jumlah Diluluskan",avgValue:"Nilai Purata",syncToAR:"Segerak ke AR",draft:"Draf",pending:"Menunggu",approved:"Diluluskan",noEORsFound:"Tiada EOR dijumpai",createFromSurvey:"Buat EOR daripada tinjauan lengkap",approveSelected:"Luluskan Terpilih",rejectSelected:"Tolak Terpilih",approvalNotes:"Nota Kelulusan",bulkApprove:"Luluskan Pukal",bulkApproveConfirm:"Adakah anda pasti mahu meluluskan EOR ini?",bulkReject:"Tolak Pukal",bulkRejectConfirm:"Adakah anda pasti mahu menolak EOR ini?",enterNotes:"Masukkan nota...",rejected:"Ditolak"},hA={title:"Pesanan Pembaikan",roList:"Senarai Pesanan",assignTeam:"Tugaskan Pasukan",startRepair:"Mula Pembaikan",completeRepair:"Selesaikan Pembaikan",workLog:"Log Kerja",addWorkLog:"Tambah Log",repairTasks:"Tugasan Pembaikan",elapsedTime:"Masa Berlalu",allTeams:"Semua Pasukan",noRepairOrders:"Tiada Pesanan Pembaikan",noRepairOrdersDesc:"Tiada pesanan pembaikan pada masa ini",assign:"Tugaskan",assignTeamDesc:"Pilih pasukan untuk tugaskan pesanan ini",complete:"Selesai",selectTeam:"Pilih Pasukan",selectTeamPlaceholder:"Pilih pasukan...",start:"Mula"},fA={title:"Pemindahan",newRequest:"Permintaan Pemindahan Baru",fromBlock:"Dari Blok",toBlock:"Ke Blok",priority:"Keutamaan",high:"Tinggi",medium:"Sederhana",low:"Rendah",pending:"Menunggu",inProgress:"Sedang Berjalan",completed:"Selesai",newShuntingRequest:"Permintaan Pemindahan Baru",normal:"Biasa",chooseContainer:"Pilih Kontena",selectContainer:"Pilih Kontena",destinationBlock:"Blok Destinasi",selectBlock:"Pilih Blok",assignDriver:"Tugaskan Pemandu",assignLater:"Tugaskan Kemudian",createRequest:"Cipta Permintaan",activeTasks:"tugas aktif",allPriorities:"Semua Keutamaan",assign:"Tugaskan",complete:"Selesai",dispatch:"Hantar",dispatchToDriver:"Hantar kepada Pemandu",dispatched:"Dihantar",driverWorkload:"Beban Kerja Pemandu",moveContainers:"Pindahkan kontena ke kawasan pembaikan",new:"Baru",noRequests:"Tiada permintaan pemindahan",repairBay:"Kawasan Pembaikan",selectDriver:"Pilih Pemandu",shuntingRequests:"Permintaan Pemindahan",start:"Mula",tasks:"tugas",totalRequests:"Jumlah Permintaan",urgent:"Segera"},mA={title:"Pra-Pemeriksaan",schedule:"Jadualkan Pemeriksaan",scheduledDate:"Tarikh Dijadualkan",result:"Keputusan",accept:"Terima",rework:"Perlu Kerja Semula",reworkDetails:"Butiran Kerja Semula",todayInspections:"Pemeriksaan Hari Ini",scheduleInspection:"Jadual Pemeriksaan",accepted:"Diterima",reworkRequired:"Perlu Kerja Semula",allInspections:"Semua Pemeriksaan",allTypes:"Semua Jenis",multipleReworks:"Kerja Semula Berbilang",reworkCount:"Kerja Semula #",inspect:"Periksa",inspectionStatus:"Status Pemeriksaan",total:"Jumlah Pemeriksaan",today:"Hari Ini",allResults:"Semua Keputusan",completeInspection:"Selesaikan Pemeriksaan",completed:"Selesai",describeIssues:"Terangkan isu yang dijumpai...",fail:"Gagal",failed:"Gagal",inspectionChecklist:"Senarai Semak Pemeriksaan",inspectorNotes:"Nota Pemeriksa",itemsFailed:"item gagal",noInspectionsFound:"Tiada pemeriksaan dijumpai",notesPlaceholder:"Tambah nota...",pass:"Lulus",passed:"Lulus",planned:"Dirancang",quickAccept:"Terima Pantas",quickRework:"Kerja Semula Pantas",recordRework:"Rekod Kerja Semula",remaining:"Berbaki",requireRework:"Memerlukan Kerja Semula",reworkAnalysis:"Analisis Kerja Semula",startWithChecklist:"Mula dengan senarai semak",postRepairCleaning:"Pembersihan Selepas Pembaikan",damageVerification:"Pengesahan Item Kerosakan",damageVerificationDesc:"Sahkan bahawa setiap item kerosakan dari tinjauan telah dibaiki dengan betul.",repaired:"Dibaiki",notRepaired:"Tidak Dibaiki",generalChecklist:"Senarai Semak Pemeriksaan Am",repairsVerified:"Pembaikan Disahkan"},pA={title:"Penimbunan & Pelepasan",newRequest:"Permintaan Penimbunan Baru",readyToStack:"Sedia Untuk Ditimbun",targetLocation:"Lokasi Sasaran",block:"Blok",row:"Baris",tier:"Tingkat",completeRelease:"Selesai & Lepaskan",readyForStacking:"Sedia untuk Penimbunan",releaseContainer:"Lepaskan Kontena",releaseOptions:"Pilihan Pelepasan",generateGatePass:"Jana Pas Pintu",notifyAndRelease:"Maklum & Lepaskan",stockReport:"Laporan Stok",searchLocation:"Cari mengikut lokasi",readyToStackLabel:"Sedia Ditimbun",releaseReady:"Sedia Dilepaskan",stackNow:"Timbun Sekarang",released:"Dilepaskan",stackingRequests:"Permintaan Penimbunan",byBlock:"Mengikut Blok",byLiner:"Mengikut Syarikat",createRequest:"Cipta Permintaan",createRequests:"Cipta Permintaan",new:"Baru",newStackingRequest:"Permintaan Penimbunan Baru",noLocation:"Tiada lokasi",noStackingRequests:"Tiada permintaan penimbunan",repairBay:"Kawasan Pembaikan",selectContainer:"Pilih Kontena",stockByLiner:"Stok Mengikut Syarikat Perkapalan",stockByBlock:"Stok Mengikut Blok",totalAvailable:"Jumlah Tersedia",reportExported:"Laporan stok dieksport"},gA={title:"Papan Pemuka",welcome:"Selamat Kembali",quickActions:"Tindakan Pantas",eorOverview:"Gambaran EOR",recentSurveys:"Tinjauan Terkini",recentEORs:"EOR Terkini",totalContainers:"Jumlah Kontena",pendingEORs:"EOR Menunggu",inRepair:"Sedang Dibaiki",completedToday:"Selesai Hari Ini",searchContainers:"Cari kontena",damaged:"Rosak",awaitingRepair:"Menunggu Pembaikan",available:"Tersedia",workflowTracker:"Penjejak Aliran Kerja",pendingActions:"Tindakan Tertangguh",recentActivity:"Aktiviti Terkini",noPendingActions:"Tiada tindakan tertangguh",totalValue:"Jumlah Nilai",noEORsYet:"Tiada EOR lagi",noRecentActivity:"Tiada aktiviti terkini",noSurveysYet:"Tiada tinjauan lagi"},xA={dashboard:"Papan Pemuka",containerManagement:"Pengurusan Kontena",registerContainer:"Daftar Kontena",allContainers:"Semua Kontena",arContainers:"Kontena Menunggu Pembaikan",surveyDamage:"Tinjauan & Kerosakan",newSurvey:"Tinjauan Baru",surveyList:"Senarai Tinjauan",repairManagement:"Pengurusan Pembaikan",eorList:"Senarai EOR",repairOrders:"Pesanan Pembaikan",yardOperations:"Operasi Halaman",shunting:"Pemindahan",preInspection:"Pra-Pemeriksaan",stackingRelease:"Penimbunan & Pelepasan",administration:"Pentadbiran",masterCodes:"Kod Induk",permissionGroups:"Kumpulan Kebenaran",userManagement:"Pengurusan Pengguna",systemSettings:"Tetapan Sistem",monitoring:"Pemantauan",jobMonitoring:"Pemantauan Kerja",homePageManagement:"Halaman Utama",washingStation:"Stesen Cucian"},vA={containerNumber:"Nombor Kontena",sequence:"Urutan",liner:"Syarikat Pelayaran",size:"Saiz",type:"Jenis",location:"Lokasi",yardLocation:"Lokasi Halaman",gateInDate:"Tarikh Masuk",createdAt:"Tarikh Cipta",createdBy:"Dicipta Oleh",updatedAt:"Tarikh Kemaskini",completedAt:"Tarikh Selesai",completedBy:"Diselesaikan Oleh",actions:"Tindakan",notes:"Nota",result:"Keputusan",assignedTeam:"Pasukan Ditugaskan",startTime:"Masa Mula",endTime:"Masa Tamat",totalCost:"Jumlah Kos",version:"Versi",requestedAt:"Tarikh Permintaan",requestedBy:"Diminta Oleh",source:"Sumber",destination:"Destinasi",priority:"Keutamaan",inspectedAt:"Tarikh Pemeriksaan",inspectedBy:"Diperiksa Oleh",targetLocation:"Lokasi Sasaran",containerStatus:"Status Kontena",surveyStatus:"Status Tinjauan",eorStatus:"Status EOR",roStatus:"Status RO",shuntingStatus:"Status Pemindahan",inspectionStatus:"Status Pemeriksaan",stackingStatus:"Status Penimbunan",surveyType:"Jenis Tinjauan",initialCondition:"Keadaan Asal",damageCount:"Bilangan Kerosakan",approval:"Kelulusan",autoApproved:"Diluluskan Auto",repairOrderStatus:"Status Pesanan Pembaikan",transactionId:"ID Transaksi",progress:"Kemajuan",driver:"Pemandu",route:"Laluan",waitTime:"Masa Menunggu",gatePass:"Pas Pintu",reworkCount:"Kerja Semula #"},yA={announcements:"Pengumuman",links:"Pautan",noAnnouncements:"Tiada pengumuman",noLinks:"Tiada pautan"},kA={title:"Tajuk",content:"Kandungan",url:"URL",description:"Penerangan",select:"Pilih..."},wA={stacking:"Penimbunan",survey:"Tinjauan",eor:"EOR",approval:"Kelulusan",repair:"Pembaikan",shunting:"Pemindahan",qc:"QC",release:"Pelepasan",washing:"Mencuci"},SA={title:"Tindakan Tertangguh",surveysPending:"Tinjauan Tertangguh",eorPendingApproval:"EOR Menunggu Kelulusan",repairsPending:"Pembaikan Tertangguh",inspectionsDue:"Pemeriksaan Perlu Dilakukan"},_A={title:"Aktiviti Terkini",newSurvey:"Tinjauan baru dicipta untuk",eorStatusChange:"Status EOR berubah kepada",repairStarted:"Pembaikan bermula untuk",noRecentActivity:"Tiada aktiviti terkini"},CA={selected:"dipilih",approveSelected:"Luluskan Terpilih",rejectSelected:"Tolak Terpilih",clearSelection:"Kosongkan Pilihan",bulkApprove:"Luluskan Pukal",bulkReject:"Tolak Pukal",confirmApprove:"Adakah anda pasti mahu meluluskan EOR ini?",confirmReject:"Adakah anda pasti mahu menolak EOR ini?"},NA={workload:"Beban Kerja Pemandu",activeTasks:"tugas aktif",assign:"Tugaskan",dispatch:"Hantar",selectDriver:"Pilih Pemandu",dispatchToDriver:"Hantar kepada Pemandu"},EA={structural:"Keutuhan Struktur",doors:"Operasi Pintu",floor:"Keadaan Lantai",roof:"Keadaan Bumbung",paint:"Cat dan Kemasan",placards:"Plakad dan Label",locking:"Mekanisme Kunci",cleanliness:"Kebersihan",pass:"Lulus",fail:"Gagal",passed:"Lulus",failed:"Gagal",remaining:"Berbaki",completeInspection:"Selesai Pemeriksaan",reworkAnalysis:"Analisis Kerja Semula",multipleReworks:"Kerja Semula Berbilang"},TA={title:"Laporan Stok",byLiner:"Kontena Tersedia mengikut Syarikat",byBlock:"Kontena Tersedia mengikut Blok"},bA={generateGatePass:"Jana Pas Pintu",notifyAndRelease:"Maklum Syarikat & Lepaskan",releaseOptions:"Pilih cara anda mahu melepaskan kontena ini:",gatePassGenerated:"Pas pintu dijana"},AA={approvalsNeeded:"Kelulusan Diperlukan",inspectionsPending:"Pemeriksaan Tertangguh",repairsInProgress:"Pembaikan Sedang Berjalan",surveysToComplete:"Tinjauan Perlu Diselesaikan"},jA={title:"Stesen Cucian",subtitle:"Pengurusan pembersihan dan sanitasi kontena",newWashingOrder:"Pesanan Cucian Baru",pendingApproval:"Menunggu Kelulusan",pendingSchedule:"Menunggu Jadual",scheduled:"Dijadualkan",inProgress:"Sedang Dijalankan",pendingQC:"Menunggu QC",rework:"Kerja Semula",completedToday:"Siap Hari Ini",searchPlaceholder:"Cari kontena, liner...",allBays:"Semua Bay",allPrograms:"Semua Program",program:"Program",bay:"Bay",scheduledAt:"Dijadualkan",noOrders:"Tiada pesanan cucian ditemui",readyForWashing:"Kontena Sedia Untuk Cucian",createOrder:"Cipta Pesanan",cleaningStarted:"Pembersihan dimulakan",orderApproved:"Pesanan cucian diluluskan",orderRejected:"Pesanan cucian ditolak",enterRejectionReason:"Masukkan sebab penolakan:",approve:"Luluskan",reject:"Tolak",startCleaning:"Mulakan Cucian",completeCleaning:"Selesai & Hantar ke QC",cleaningCompleted:"Pembersihan selesai, menunggu QC",completeAllRequired:"Sila lengkapkan semua item yang diperlukan",orderNotFound:"Pesanan cucian tidak ditemui",safetyNotes:"Nota Keselamatan",cleaningChecklist:"Senarai Semak Pembersihan",workerNotes:"Nota Pekerja",notesPlaceholder:"Sebarang pemerhatian atau isu...",allRequiredMustPass:"Semua item yang diperlukan mesti lulus",qcPassed:"QC Lulus! Sijil dijana.",selectReworkReasons:"Sila pilih sekurang-kurangnya satu sebab kerja semula",qcFailed:"QC Gagal. Pesanan dihantar untuk kerja semula.",qcInspection:"Pemeriksaan QC",cleaningProgram:"Program Cucian",elapsedTime:"Masa Berlalu",reworkAttempt:"Percubaan Kerja Semula",previousReworkReasons:"Isu sebelumnya",qcChecklist:"Senarai Semak QC",pass:"Lulus",fail:"Gagal",reworkReasons:"Sebab Kerja Semula",qcNotes:"Nota QC",qcNotesPlaceholder:"Pemerhatian pemeriksaan...",failAndRework:"Gagal & Kerja Semula",passAndCertify:"Lulus & Jana Sijil",selectContainerFirst:"Sila pilih kontena dahulu",orderCreated:"Pesanan cucian dicipta",assignedBay:"Bay Ditugaskan",assignedTeam:"Pasukan Ditugaskan",selectBay:"Pilih Bay",selectTeam:"Pilih Pasukan",initialInspection:"Pemeriksaan Awal",contaminationLevel:"Tahap Pencemaran",interiorCondition:"Keadaan Dalaman",exteriorCondition:"Keadaan Luaran",odorPresent:"Ada Bau",pestPresent:"Ada Serangga",hazardousResidues:"Sisa Berbahaya",inspectionNotes:"Nota Pemeriksaan",safetyWarning:"Amaran Keselamatan",hazardousWarning:"Kontena ini memerlukan langkah keselamatan khas",suggestedProgram:"Program Dicadangkan",selectProgram:"Pilih Program",schedule:"Jadual",assignBay:"Tetapkan Bey",assignTeam:"Tetapkan Pasukan",safetyRequirements:"Keperluan Keselamatan",requiresMask:"Perlu Topeng",requiresGloves:"Perlu Sarung Tangan",chemicalHandling:"Pengendalian Kimia",ventilationRequired:"Pengudaraan Diperlukan",twoPersonJob:"Kerja 2 Orang",safetyNotesPlaceholder:"Arahan keselamatan tambahan untuk pekerja...",certificateOfCleanliness:"Sijil Kebersihan",certificateNo:"No Sijil",cleanedDate:"Tarikh Dicuci",issueDate:"Tarikh Dikeluarkan",certificateStatement:"Mengesahkan bahawa kontena di atas telah dicuci dan diperiksa mengikut piawaian antarabangsa",qcInspector:"Pemeriksa QC",authorizedSignatory:"Penandatangan Dibenarkan",printCertificate:"Cetak",downloadPDF:"Muat turun PDF",emailToLiner:"E-mel kepada Syarikat Perkapalan",noCertificate:"Tiada sijil lagi. QC mesti lulus dahulu."},RA={PENDING_WASH:"Menunggu Cucian",WASHING:"Sedang Dicuci"},IA={common:rA,admin:aA,auth:sA,greetings:iA,portal:oA,workspace:lA,container:cA,survey:uA,eor:dA,repairOrder:hA,shunting:fA,inspection:mA,stacking:pA,dashboard:gA,nav:xA,columns:vA,homepage:yA,common2:kA,workflow:wA,pendingActions:SA,recentActivity:_A,bulkActions:CA,driver:NA,inspectionChecklist:EA,stockReport:TA,release:bA,pending:AA,washing:jA,containerStatus:RA},PA={dashboard:"",containers:"",surveys:"",eor:"",repairOrders:"",shunting:"",preInspection:"",stacking:"  ",settings:"",logout:"",save:"",cancel:"",delete:"",edit:"",view:"",search:"",filter:"",export:"",import:"",back:"",next:"",submit:"",confirm:"",close:"",yes:"",no:"",loading:" ...",noData:" ",required:"",optional:"",actions:"",status:"",createdAt:"",updatedAt:"",createdBy:"",add:"",remove:"",active:"",inactive:"",allStatuses:" ",allLiners:" ",allTypes:" ",showing:" ",of:"",inProgress:" ",completed:"",from:"",to:"",selected:"",previous:"",pleaseSelect:"",viewAll:" ",pending:" ",all:"",approved:"",rejected:"",clearDates:" ",notes:"",container:"",selectContainer:" ",clearSelection:" ",content:"",create:"",description:"",more:" ",page:"",select:"",title:"",total:"",url:"URL",apply:"",featureComingSoon:"  ",retrieve:" ",dataReloaded:"   ",reloadError:"   ",exportCSV:"CSV "},DA={groupCode:" ",groupName:"",description:"",usage:"",grant:" ",groupLevel:" ",screens:"",functions:"",fullName:"",email:"",groups:"",lastLogin:" ",registerUser:" ",codeType:" ",code:"",name:"",addCode:" ",editCode:" ",permissions:"",use:"",retrieve:"",create:"",update:"",delete:"",download:"",preview:"",print:"",history:"",internal:"",external:"",eorSettings:"EOR ",displaySettings:" ",notifications:"",localization:"",workflowSettings:" ",autoApprovalThreshold:"  ",autoApprovalDesc:"   EOR  ",defaultCurrency:" ",currencyDesc:"    ",showCostInList:"  ",showCostDesc:"   ",currentSettings:" ",autoApproval:" ",language:"",perPage:"",timeout:" ",resetDefaults:" ",allGroups:" ",allTypes:" ",permissionGroupsDesc:"    ",overview:"",screen:"",save:"",masterCodesDesc:"     ",codeTypes:" ",totalCodes:"  ",searchCodes:" ...",username:"",password:"",userType:" ",shippingLine:"",assignGroups:" ",userManagementDesc:"    ",showInactive:" ",noUsersFound:"   ",requiredFields:", ,  ",usernameExists:"  ",groupRequired:"   ",userCreated:" ",userUpdated:" ",userDeactivated:" ",userActivated:" ",deactivate:"",activate:"",details:"",activity:"",security:"",createdAt:"",never:"",justNow:"",selectUser:" ",selectUserDesc:"    ",activeScreens:" ",completion:"",hideGroups:" ",showGroups:" ",clear:"",resetPassword:" ",homePageManagement:" ",homePageDesc:"     ",addAnnouncement:" ",editAnnouncement:" ",addLink:" ",editLink:" ",announcementCreated:" ",announcementUpdated:" ",announcementDeleted:" ",linkCreated:" ",linkUpdated:" ",linkDeleted:" ",confirmDelete:" ?",applyTemplate:" ",approve:"",reject:"",selectGroup:" ",selectGroupDesc:"     ",groupSaved:" ",groupCreated:" ",groupDuplicated:" ",groupDeleted:" ",deleteGroup:" ",deleteGroupConfirm:"  ",deleteGroupWarning:"    .       .",accountStatus:" ",activated:"",autoLogoutDesc:"    ",cannotDeleteCore:"    ",codeAdded:" ",codeDeactivated:" ",codeExists:"  ",codeNameRequired:"  ",codeRequired:" ",codeUpdated:" ",confirmDeactivate:" ?",containersDesc:"   ",containersPerPage:" ",copied:"!",copyCode:" ",dateFormat:" ",dateFormatDesc:"  ",deactivated:"",defaultSurveyType:"  ",duplicate:"",enableAutoLogout:"  ",enableNotifications:" ",enableQuickActions:"  ",exportSuccess:" ",importCodes:" ",importInstructions:"JSON    ",imported:"",invalidFormat:" ",invalidJSON:" JSON ",jsonData:"JSON ",languageDesc:"  ",legacyFunctions:"    ()",nameRequired:" ",newGroup:"  ",noActivityYet:"  ",noCodesFound:"   ",notificationsDesc:"  ",quickActionsDesc:"    ",quickTemplates:"  ",recentActivity:" ",requirePhoto:" ",requirePhotoDesc:"   ",sessionDesc:"  ",sessionInfo:" ",sessionTimeout:"  ",settingsReset:"  ",settingsSaved:" ",skipped:"",surveyTypeDesc:"   ",timeFormat:" ",timeFormatDesc:"  ",moveUp:" ",moveDown:" ",itemMoved:" "},OA={login:"",username:"",password:"",loginButton:"",loginTitle:"M&R  ",loginSubtitle:" &  ",loginError:"    ",selectLanguage:" ",changePassword:" ",currentPassword:" ",newPassword:" ",confirmPassword:" ",passwordMismatch:"  ",passwordTooShort:" 6  ",passwordChanged:" !",currentPasswordWrong:"   ",userLogin:" ",signingIn:" ...",loginSuccess:" ",loginSuccessMessage:" .",pleaseLoginFirst:"   .",passwordRequired:" ",portalTitle:"M&R ",enterCredentials:"    ",enterUsername:" ",enterPassword:" "},LA={goodMorning:" ",goodAfternoon:" ",goodEvening:" "},FA={johorPort:" ",containerPortal:" ",welcomeTo:"     ",home:"",about:"",services:"",contactUs:"",generalEnquiry:" ",registration:"",helpDesk:"",containerOperations:" ",qualityAssurance:" ",support247:"24 ",shippingAgent:" ",forwardingAgent:" ",shipperConsignee:"/",accessSystem:" ",benefit:"",announcement:"",links:"",networkInfrastructure:" ",onlineMarketplace:" ",faq:"  "},MA={selectScreen:"   .",menuHint:"       "},BA={title:"",register:" ",allContainers:" ",arContainers:" ",containerNumber:" ",liner:"",size:"",type:"",initialStatus:" ",registerSuccess:" !",alreadyExists:"  ",invalidFormat:"  (: MSCU1234567)",manualEntry:" ",excelUpload:"Excel ",downloadTemplate:" ",dragDropExcel:"Excel   ",orClickBrowse:"  ",previewContainers:"",importValid:"  ",clear:"",formatHint:":  4 +  7",damaged:"",available:"",awaitingRepair:"",repairInProgress:"",completed:"",gateOut:"",adjustFilters:"     ",batchStatusUpdate:"  ",batchUpdate:" ",batchUpdateConfirm:"  ?",containerTimeline:" ",newStatus:" ",noContainersFound:"   ",noTimelineEvents:"  ",toDM:"DM",updateContainers:" ",viewDetails:" ",viewTimeline:" ",workflowStage:" "},UA={title:"",newSurvey:" ",surveyList:" ",searchContainer:" ",surveyType:" ",initialCondition:" ",notes:"",damageItems:" ",addItem:" ",location:"",damageType:" ",component:"",severity:"",quantity:"",repairMethod:" ",estimatedCost:"  (RM)",totalCost:"  ",saveDraft:" ",completeSurvey:" ",createEOR:"EOR ",manual:"",inbound:"",outbound:"",periodic:"",other:"",hasDamage:" ",noDamage:" ",noSurveysFound:"  ",createNewSurvey:"   ",allTypes:" ",damage:"",damaged:""},zA={title:"",eorList:"EOR ",createEOR:"EOR ",editEOR:"EOR ",repairItems:" ",unitPrice:"",laborHours:"",lineCost:" ",totalCost:" ",autoApproved:" ",pendingApproval:" ",sendToLiner:" ",approve:"",reject:"",createRepairOrder:" ",timeline:"",autoApprovalNote:"EOR  100 RM  ",totalValue:" ",pendingAmount:" ",approvedAmount:" ",avgValue:" ",syncToAR:"AR ",draft:"",pending:" ",approved:"",noEORsFound:"EOR ",createFromSurvey:"  EOR ",approveSelected:"  ",rejectSelected:"  ",approvalNotes:" ",bulkApprove:" ",bulkApproveConfirm:" EOR ?",bulkReject:" ",bulkRejectConfirm:" EOR ?",enterNotes:" ...",rejected:""},WA={title:"",roList:" ",assignTeam:" ",startRepair:" ",completeRepair:" ",workLog:" ",addWorkLog:" ",repairTasks:" ",elapsedTime:" ",allTeams:" ",noRepairOrders:"  ",noRepairOrdersDesc:"   ",assign:"",assignTeamDesc:"     ",complete:"",selectTeam:" ",selectTeamPlaceholder:" ...",start:""},HA={title:"",newRequest:"  ",fromBlock:" ",toBlock:" ",priority:"",high:"",medium:"",low:"",pending:"",inProgress:"",completed:"",newShuntingRequest:"  ",normal:"",chooseContainer:" ",selectContainer:" ",destinationBlock:" ",selectBlock:" ",assignDriver:" ",assignLater:" ",createRequest:" ",activeTasks:" ",allPriorities:" ",assign:"",complete:"",dispatch:"",dispatchToDriver:" ",dispatched:"",driverWorkload:" ",moveContainers:"   ",new:"",noRequests:"  ",repairBay:" ",selectDriver:" ",shuntingRequests:" ",start:"",tasks:"",totalRequests:" ",urgent:""},GA={title:"",schedule:" ",scheduledDate:"",result:"",accept:"",rework:" ",reworkDetails:" ",todayInspections:" ",scheduleInspection:" ",accepted:"",reworkRequired:" ",allInspections:" ",allTypes:" ",multipleReworks:" ",reworkCount:" #",inspect:"",inspectionStatus:" ",total:" ",today:"",allResults:" ",completeInspection:" ",completed:"",describeIssues:"  ...",fail:"",failed:"",inspectionChecklist:" ",inspectorNotes:" ",itemsFailed:" ",noInspectionsFound:"   ",notesPlaceholder:" ...",pass:"",passed:"",planned:"",quickAccept:" ",quickRework:" ",recordRework:" ",remaining:"",requireRework:" ",reworkAnalysis:" ",startWithChecklist:" ",postRepairCleaning:"  ",damageVerification:"  ",damageVerificationDesc:"      .",repaired:"",notRepaired:"",generalChecklist:"  ",repairsVerified:" "},$A={title:"  ",newRequest:"  ",readyToStack:" ",targetLocation:" ",block:"",row:"",tier:"",completeRelease:"  ",readyForStacking:" ",releaseContainer:" ",releaseOptions:" ",generateGatePass:" ",notifyAndRelease:"  ",stockReport:" ",searchLocation:" ",readyToStackLabel:" ",releaseReady:" ",stackNow:" ",released:"",stackingRequests:" ",byBlock:"",byLiner:"",createRequest:" ",createRequests:" ",new:"",newStackingRequest:"  ",noLocation:" ",noStackingRequests:"  ",repairBay:" ",selectContainer:" ",stockByLiner:" ",stockByBlock:" ",totalAvailable:"  ",reportExported:"   "},VA={title:"",welcome:"",quickActions:" ",eorOverview:"EOR ",recentSurveys:" ",recentEORs:" EOR",totalContainers:" ",pendingEORs:" EOR",inRepair:"",completedToday:" ",searchContainers:" ",damaged:"",awaitingRepair:" ",available:" ",workflowTracker:" ",pendingActions:"  ",recentActivity:" ",noPendingActions:"   ",totalValue:" ",noEORsYet:" EOR ",noRecentActivity:"  ",noSurveysYet:"  "},qA={dashboard:"",containerManagement:" ",registerContainer:" ",allContainers:" ",arContainers:" ",surveyDamage:" & ",newSurvey:" ",surveyList:" ",repairManagement:" ",eorList:"EOR ",repairOrders:"",yardOperations:" ",shunting:"",preInspection:"",stackingRelease:"  ",administration:" ",masterCodes:" ",permissionGroups:" ",userManagement:" ",systemSettings:" ",monitoring:"",jobMonitoring:" ",homePageManagement:"",washingStation:" "},KA={containerNumber:" ",sequence:"",liner:"",size:"",type:"",location:"",yardLocation:" ",gateInDate:"",createdAt:"",createdBy:"",updatedAt:"",completedAt:"",completedBy:"",actions:"",notes:"",result:"",assignedTeam:" ",startTime:" ",endTime:" ",totalCost:" ",version:"",requestedAt:"",requestedBy:"",source:"",destination:"",priority:"",inspectedAt:"",inspectedBy:"",targetLocation:" ",containerStatus:" ",surveyStatus:" ",eorStatus:"EOR ",roStatus:"RO ",shuntingStatus:" ",inspectionStatus:" ",stackingStatus:" ",surveyType:" ",initialCondition:" ",damageCount:" ",approval:"",autoApproved:" ",repairOrderStatus:" ",transactionId:" ID",progress:"",driver:"",route:"",waitTime:" ",gatePass:"",reworkCount:" #"},YA={announcements:"",links:"",noAnnouncements:" ",noLinks:" "},XA={title:"",content:"",url:"URL",description:"",select:"..."},QA={stacking:"",survey:"",eor:"EOR",approval:"",repair:"",shunting:"",qc:"QC",release:"",washing:""},JA={title:"  ",surveysPending:"  ",eorPendingApproval:"  EOR",repairsPending:"  ",inspectionsDue:" "},ZA={title:" ",newSurvey:"  :",eorStatusChange:"EOR   :",repairStarted:" :",noRecentActivity:"  "},ej={selected:"",approveSelected:"  ",rejectSelected:"  ",clearSelection:" ",bulkApprove:" ",bulkReject:" ",confirmApprove:" EOR ?",confirmReject:" EOR ?"},tj={workload:" ",activeTasks:" ",assign:"",dispatch:"",selectDriver:" ",dispatchToDriver:" "},nj={structural:" ",doors:" ",floor:" ",roof:" ",paint:"  ",placards:"  ",locking:" ",cleanliness:"",pass:"",fail:"",passed:"",failed:"",remaining:"",completeInspection:" ",reworkAnalysis:" ",multipleReworks:" "},rj={title:" ",byLiner:"   ",byBlock:"   "},aj={generateGatePass:" ",notifyAndRelease:"   ",releaseOptions:"    :",gatePassGenerated:" "},sj={approvalsNeeded:" ",inspectionsPending:"  ",repairsInProgress:"  ",surveysToComplete:" "},ij={title:" ",subtitle:"    ",newWashingOrder:"  ",pendingApproval:" ",pendingSchedule:" ",scheduled:"",inProgress:" ",pendingQC:"QC ",rework:"",completedToday:" ",searchPlaceholder:",  ...",allBays:" ",allPrograms:" ",program:"",bay:"",scheduledAt:"",noOrders:"  ",readyForWashing:"  ",createOrder:" ",cleaningStarted:" ",orderApproved:"  ",orderRejected:"  ",enterRejectionReason:"  :",approve:"",reject:"",startCleaning:" ",completeCleaning:"  QC ",cleaningCompleted:" , QC ",completeAllRequired:"   ",orderNotFound:"    ",safetyNotes:" ",cleaningChecklist:" ",workerNotes:" ",notesPlaceholder:"   ...",allRequiredMustPass:"    ",qcPassed:"QC !  .",selectReworkReasons:"    ",qcFailed:"QC .  .",qcInspection:"QC ",cleaningProgram:" ",elapsedTime:" ",reworkAttempt:" ",previousReworkReasons:" ",qcChecklist:"QC ",pass:"",fail:"",reworkReasons:" ",qcNotes:"QC ",qcNotesPlaceholder:" ...",failAndRework:"  ",passAndCertify:"   ",selectContainerFirst:"  ",orderCreated:"  ",assignedBay:" ",assignedTeam:" ",selectBay:" ",selectTeam:" ",initialInspection:" ",contaminationLevel:"",interiorCondition:" ",exteriorCondition:" ",odorPresent:" ",pestPresent:" ",hazardousResidues:" ",inspectionNotes:" ",safetyWarning:" ",hazardousWarning:"     ",suggestedProgram:" ",selectProgram:" ",schedule:"",assignBay:" ",assignTeam:" ",safetyRequirements:" ",requiresMask:" ",requiresGloves:" ",chemicalHandling:" ",ventilationRequired:" ",twoPersonJob:"2 ",safetyNotesPlaceholder:"    ...",certificateOfCleanliness:" ",certificateNo:" ",cleanedDate:" ",issueDate:" ",certificateStatement:"        ",qcInspector:"QC ",authorizedSignatory:" ",printCertificate:"",downloadPDF:"PDF ",emailToLiner:" ",noCertificate:" . QC   ."},oj={PENDING_WASH:" ",WASHING:" "},lj={common:PA,admin:DA,auth:OA,greetings:LA,portal:FA,workspace:MA,container:BA,survey:UA,eor:zA,repairOrder:WA,shunting:HA,inspection:GA,stacking:$A,dashboard:VA,nav:qA,columns:KA,homepage:YA,common2:XA,workflow:QA,pendingActions:JA,recentActivity:ZA,bulkActions:ej,driver:tj,inspectionChecklist:nj,stockReport:rj,release:aj,pending:sj,washing:ij,containerStatus:oj},cj={dashboard:"",containers:"",surveys:"",eor:"",repairOrders:"",shunting:"",preInspection:"",stacking:"",settings:"",logout:"",save:"",cancel:"",delete:"",edit:"",view:"",search:"",filter:"",export:"",import:"",back:"",next:"",submit:"",confirm:"",close:"",yes:"",no:"",loading:"...",noData:"",required:"",optional:"",actions:"",status:"",createdAt:"",updatedAt:"",createdBy:"",add:"",remove:"",active:"",inactive:"",allStatuses:"",allLiners:"",allTypes:"",showing:"",of:"",inProgress:"",completed:"",from:"",to:"",selected:"",previous:"",pleaseSelect:"",viewAll:"",pending:"",all:"",approved:"",rejected:"",clearDates:"",clearSelection:"",notes:"",container:"",selectContainer:"",content:"",create:"",description:"",more:"",page:"",select:"",title:"",total:"",url:"URL",apply:"",featureComingSoon:"",retrieve:"",dataReloaded:"",reloadError:"",exportCSV:"CSV"},uj={groupCode:"",groupName:"",description:"",usage:"",grant:"",groupLevel:"",screens:"",functions:"",fullName:"",email:"",groups:"",lastLogin:"",registerUser:"",codeType:"",code:"",name:"",addCode:"",editCode:"",permissions:"",use:"",retrieve:"",create:"",update:"",delete:"",download:"",preview:"",print:"",history:"",clear:"",internal:"",external:"",eorSettings:"EOR",displaySettings:"",notifications:"",localization:"",workflowSettings:"",autoApprovalThreshold:"",autoApprovalDesc:"EOR",defaultCurrency:"",currencyDesc:"",showCostInList:"",showCostDesc:"",currentSettings:"",autoApproval:"",language:"",perPage:"",timeout:"",resetDefaults:"",allGroups:"",allTypes:"",permissionGroupsDesc:"",overview:"",screen:"",save:"",masterCodesDesc:"",codeTypes:"",totalCodes:"",searchCodes:"...",username:"",password:"",userType:"",shippingLine:"",assignGroups:"",userManagementDesc:"",showInactive:"",noUsersFound:"",requiredFields:"",usernameExists:"",groupRequired:"",userCreated:"",userUpdated:"",userDeactivated:"",userActivated:"",deactivate:"",activate:"",details:"",activity:"",security:"",createdAt:"",never:"",justNow:"",selectUser:"",selectUserDesc:"",applyTemplate:"",approve:"",reject:"",selectGroup:"",selectGroupDesc:"",groupSaved:"",groupCreated:"",groupDuplicated:"",groupDeleted:"",deleteGroup:"",deleteGroupConfirm:"",deleteGroupWarning:"",activeScreens:"",completion:"",hideGroups:"",showGroups:"",resetPassword:"",homePageManagement:"",homePageDesc:"",addAnnouncement:"",editAnnouncement:"",addLink:"",editLink:"",announcementCreated:"",announcementUpdated:"",announcementDeleted:"",linkCreated:"",linkUpdated:"",linkDeleted:"",confirmDelete:"",accountStatus:"",activated:"",autoLogoutDesc:"",cannotDeleteCore:"",codeAdded:"",codeDeactivated:"",codeExists:"",codeNameRequired:"",codeRequired:"",codeUpdated:"",confirmDeactivate:"",containersDesc:"",containersPerPage:"",copied:"",copyCode:"",dateFormat:"",dateFormatDesc:"",deactivated:"",defaultSurveyType:"",duplicate:"",enableAutoLogout:"",enableNotifications:"",enableQuickActions:"",exportSuccess:"",importCodes:"",importInstructions:"JSON",imported:"",invalidFormat:"",invalidJSON:"JSON",jsonData:"JSON",languageDesc:"",legacyFunctions:"",nameRequired:"",newGroup:"",noActivityYet:"",noCodesFound:"",notificationsDesc:"",quickActionsDesc:"",quickTemplates:"",recentActivity:"",requirePhoto:"",requirePhotoDesc:"",sessionDesc:"",sessionInfo:"",sessionTimeout:"",settingsReset:"",settingsSaved:"",skipped:"",surveyTypeDesc:"",timeFormat:"",timeFormatDesc:"",moveUp:"",moveDown:"",itemMoved:""},dj={login:"",username:"",password:"",loginButton:"",loginTitle:"M&R ",loginSubtitle:"",loginError:"",selectLanguage:"",changePassword:"",currentPassword:"",newPassword:"",confirmPassword:"",passwordMismatch:"",passwordTooShort:"6",passwordChanged:"",currentPasswordWrong:"",userLogin:"",signingIn:"...",loginSuccess:"",loginSuccessMessage:"",pleaseLoginFirst:"",passwordRequired:"",portalTitle:"M&R",enterCredentials:"",enterUsername:"",enterPassword:""},hj={goodMorning:"",goodAfternoon:"",goodEvening:""},fj={johorPort:"",containerPortal:"",welcomeTo:"",home:"",about:"",services:"",contactUs:"",generalEnquiry:"",registration:"",helpDesk:"",containerOperations:"",qualityAssurance:"",support247:"",shippingAgent:"",forwardingAgent:"",shipperConsignee:"/",accessSystem:"",benefit:"",announcement:"",links:"",networkInfrastructure:"",onlineMarketplace:"",faq:""},mj={selectScreen:"",menuHint:""},pj={title:"",register:"",allContainers:"",arContainers:"",containerNumber:"",liner:"",size:"",type:"",initialStatus:"",registerSuccess:"",alreadyExists:"",invalidFormat:" (: MSCU1234567)",manualEntry:"",excelUpload:"Excel",downloadTemplate:"",dragDropExcel:"Excel",orClickBrowse:"",previewContainers:"",importValid:"",clear:"",formatHint:": 4 + 7",damaged:"",available:"",awaitingRepair:"",repairInProgress:"",completed:"",gateOut:"",adjustFilters:"",batchStatusUpdate:"",batchUpdate:"",batchUpdateConfirm:"",containerTimeline:"",newStatus:"",noContainersFound:"",noTimelineEvents:"",toDM:"DM",updateContainers:"",viewDetails:"",viewTimeline:"",workflowStage:""},gj={title:"",newSurvey:"",surveyList:"",searchContainer:"",surveyType:"",initialCondition:"",notes:"",damageItems:"",addItem:"",location:"",damageType:"",component:"",severity:"",quantity:"",repairMethod:"",estimatedCost:" (RM)",totalCost:"",saveDraft:"",completeSurvey:"",createEOR:"",manual:"",inbound:"",outbound:"",periodic:"",other:"",hasDamage:"",noDamage:"",noSurveysFound:"",createNewSurvey:"",allTypes:"",damage:"",damaged:""},xj={title:"",eorList:"",createEOR:"",editEOR:"",repairItems:"",unitPrice:"",laborHours:"",lineCost:"",totalCost:"",autoApproved:"",pendingApproval:"",sendToLiner:"",approve:"",reject:"",approveSelected:"",rejectSelected:"",createRepairOrder:"",timeline:"",autoApprovalNote:"EOR  100 RM ",totalValue:"",pendingAmount:"",approvedAmount:"",avgValue:"",syncToAR:"AR",draft:"",pending:"",approved:"",noEORsFound:"EOR",createFromSurvey:"EOR",approvalNotes:"",bulkApprove:"",bulkApproveConfirm:"EOR",bulkReject:"",bulkRejectConfirm:"EOR",enterNotes:"...",rejected:""},vj={title:"",roList:"",assignTeam:"",startRepair:"",completeRepair:"",workLog:"",addWorkLog:"",repairTasks:"",elapsedTime:"",allTeams:"",noRepairOrders:"",noRepairOrdersDesc:"",assign:"",assignTeamDesc:"",complete:"",selectTeam:"",selectTeamPlaceholder:"...",start:""},yj={title:"",newRequest:"",fromBlock:"",toBlock:"",priority:"",high:"",medium:"",low:"",pending:"",inProgress:"",completed:"",newShuntingRequest:"",normal:"",chooseContainer:"",selectContainer:"",destinationBlock:"",selectBlock:"",assignDriver:"",assignLater:"",createRequest:"",activeTasks:"",allPriorities:"",assign:"",complete:"",dispatch:"",dispatchToDriver:"",dispatched:"",driverWorkload:"",moveContainers:"",new:"",noRequests:"",repairBay:"",selectDriver:"",shuntingRequests:"",start:"",tasks:"",totalRequests:"",urgent:""},kj={title:"",schedule:"",scheduledDate:"",result:"",accept:"",rework:"",reworkDetails:"",todayInspections:"",scheduleInspection:"",accepted:"",reworkRequired:"",allInspections:"",allTypes:"",multipleReworks:"",reworkCount:"",inspect:"",inspectionStatus:"",total:"",today:"",allResults:"",completeInspection:"",completed:"",describeIssues:"...",fail:"",failed:"",inspectionChecklist:"",inspectorNotes:"",itemsFailed:"",noInspectionsFound:"",notesPlaceholder:"...",pass:"",passed:"",planned:"",quickAccept:"",quickRework:"",recordRework:"",remaining:"",requireRework:"",reworkAnalysis:"",startWithChecklist:"",postRepairCleaning:"",damageVerification:"",damageVerificationDesc:"",repaired:"",notRepaired:"",generalChecklist:"",repairsVerified:""},wj={title:"",newRequest:"",readyToStack:"",targetLocation:"",block:"",row:"",tier:"",completeRelease:"",readyForStacking:"",releaseContainer:"",releaseOptions:"",generateGatePass:"",notifyAndRelease:"",stockReport:"",searchLocation:"",readyToStackLabel:"",releaseReady:"",stackNow:"",released:"",stackingRequests:"",byBlock:"",byLiner:"",createRequest:"",createRequests:"",new:"",newStackingRequest:"",noLocation:"",noStackingRequests:"",repairBay:"",selectContainer:"",stockByLiner:"",stockByBlock:"",totalAvailable:"",reportExported:""},Sj={title:"",welcome:"",quickActions:"",eorOverview:"",recentSurveys:"",recentEORs:"",totalContainers:"",pendingEORs:"",inRepair:"",completedToday:"",searchContainers:"",damaged:"",awaitingRepair:"",available:"",workflowTracker:"",pendingActions:"",recentActivity:"",noPendingActions:"",totalValue:"",noEORsYet:"EOR",noRecentActivity:"",noSurveysYet:""},_j={dashboard:"",containerManagement:"",registerContainer:"",allContainers:"",arContainers:"",surveyDamage:" & ",newSurvey:"",surveyList:"",repairManagement:"",eorList:"",repairOrders:"",yardOperations:"",shunting:"",preInspection:"",stackingRelease:"",administration:"",masterCodes:"",permissionGroups:"",userManagement:"",systemSettings:"",monitoring:"",jobMonitoring:"",homePageManagement:"",washingStation:""},Cj={containerNumber:"",sequence:"",liner:"",size:"",type:"",location:"",yardLocation:"",gateInDate:"",createdAt:"",createdBy:"",updatedAt:"",completedAt:"",completedBy:"",actions:"",notes:"",result:"",assignedTeam:"",startTime:"",endTime:"",totalCost:"",version:"",requestedAt:"",requestedBy:"",source:"",destination:"",priority:"",inspectedAt:"",inspectedBy:"",targetLocation:"",containerStatus:"",surveyStatus:"",eorStatus:"EOR",roStatus:"RO",shuntingStatus:"",inspectionStatus:"",stackingStatus:"",surveyType:"",initialCondition:"",damageCount:"",approval:"",autoApproved:"",repairOrderStatus:"",transactionId:"ID",progress:"",driver:"",route:"",waitTime:"",gatePass:"",reworkCount:""},Nj={announcements:"",links:"",noAnnouncements:"",noLinks:""},Ej={title:"",content:"",url:"URL",description:"",select:"..."},Tj={stacking:"",survey:"",eor:"EOR",approval:"",repair:"",shunting:"",qc:"",release:"",washing:""},bj={title:"",surveysPending:"",eorPendingApproval:"EOR",repairsPending:"",inspectionsDue:""},Aj={title:"",newSurvey:"",eorStatusChange:"EOR",repairStarted:"",noRecentActivity:""},jj={selected:"",approveSelected:"",rejectSelected:"",clearSelection:"",bulkApprove:"",bulkReject:"",confirmApprove:"EOR",confirmReject:"EOR"},Rj={workload:"",activeTasks:"",assign:"",dispatch:"",selectDriver:"",dispatchToDriver:""},Ij={structural:"",doors:"",floor:"",roof:"",paint:"",placards:"",locking:"",cleanliness:"",pass:"",fail:"",passed:"",failed:"",remaining:"",completeInspection:"",reworkAnalysis:"",multipleReworks:""},Pj={title:"",byLiner:"",byBlock:""},Dj={generateGatePass:"",notifyAndRelease:"",releaseOptions:"",gatePassGenerated:""},Oj={approvalsNeeded:"",inspectionsPending:"",repairsInProgress:"",surveysToComplete:""},Lj={title:"",subtitle:"",newWashingOrder:"",pendingApproval:"",pendingSchedule:"",scheduled:"",inProgress:"",pendingQC:"",rework:"",completedToday:"",searchPlaceholder:"...",allBays:"",allPrograms:"",program:"",bay:"",scheduledAt:"",noOrders:"",readyForWashing:"",createOrder:"",cleaningStarted:"",orderApproved:"",orderRejected:"",enterRejectionReason:"",approve:"",reject:"",startCleaning:"",completeCleaning:"",cleaningCompleted:"",completeAllRequired:"",orderNotFound:"",safetyNotes:"",cleaningChecklist:"",workerNotes:"",notesPlaceholder:"...",allRequiredMustPass:"",qcPassed:"",selectReworkReasons:"",qcFailed:"",qcInspection:"",cleaningProgram:"",elapsedTime:"",reworkAttempt:"",previousReworkReasons:"",qcChecklist:"",pass:"",fail:"",reworkReasons:"",qcNotes:"",qcNotesPlaceholder:"...",failAndRework:"",passAndCertify:"",selectContainerFirst:"",orderCreated:"",assignedBay:"",assignedTeam:"",selectBay:"",selectTeam:"",initialInspection:"",contaminationLevel:"",interiorCondition:"",exteriorCondition:"",odorPresent:"",pestPresent:"",hazardousResidues:"",inspectionNotes:"",safetyWarning:"",hazardousWarning:"",suggestedProgram:"",selectProgram:"",schedule:"",assignBay:"",assignTeam:"",safetyRequirements:"",requiresMask:"",requiresGloves:"",chemicalHandling:"",ventilationRequired:"",twoPersonJob:"",safetyNotesPlaceholder:"...",certificateOfCleanliness:"",certificateNo:"",cleanedDate:"",issueDate:"",certificateStatement:"",qcInspector:"QC",authorizedSignatory:"",printCertificate:"",downloadPDF:"PDF",emailToLiner:"",noCertificate:"QC"},Fj={PENDING_WASH:"",WASHING:""},Mj={common:cj,admin:uj,auth:dj,greetings:hj,portal:fj,workspace:mj,container:pj,survey:gj,eor:xj,repairOrder:vj,shunting:yj,inspection:kj,stacking:wj,dashboard:Sj,nav:_j,columns:Cj,homepage:Nj,common2:Ej,workflow:Tj,pendingActions:bj,recentActivity:Aj,bulkActions:jj,driver:Rj,inspectionChecklist:Ij,stockReport:Pj,release:Dj,pending:Oj,washing:Lj,containerStatus:Fj},Bj={dashboard:"Painel",containers:"Contentores",surveys:"Vistorias",eor:"EOR",repairOrders:"Ordens de Reparao",shunting:"Movimentao",preInspection:"Pr-Inspeo",stacking:"Empilhamento e Liberao",settings:"Configuraes",logout:"Sair",save:"Salvar",cancel:"Cancelar",delete:"Excluir",edit:"Editar",view:"Ver",search:"Pesquisar",filter:"Filtrar",export:"Exportar",import:"Importar",back:"Voltar",next:"Prximo",submit:"Enviar",confirm:"Confirmar",close:"Fechar",yes:"Sim",no:"No",loading:"Carregando...",noData:"Sem dados",required:"Obrigatrio",optional:"Opcional",actions:"Aes",status:"Status",createdAt:"Criado em",updatedAt:"Atualizado em",createdBy:"Criado por",add:"Adicionar",remove:"Remover",active:"Ativo",inactive:"Inativo",allStatuses:"Todos os Status",allLiners:"Todas as Linhas",allTypes:"Todos os Tipos",showing:"Mostrando",of:"de",inProgress:"Em Andamento",completed:"Concludo",from:"De",to:"At",selected:"selecionado(s)",previous:"Anterior",pleaseSelect:"Por favor selecione",viewAll:"Ver Todos",pending:"Pendente",all:"Todos",approved:"Aprovado",rejected:"Rejeitado",clearDates:"Limpar Datas",notes:"Notas",container:"Contentor",selectContainer:"Selecionar Contentor",clearSelection:"Limpar Seleo",content:"Contedo",create:"Criar",description:"Descrio",more:"mais",page:"Pgina",select:"Selecionar",title:"Ttulo",total:"total",url:"URL",apply:"Aplicar",featureComingSoon:"Em breve",retrieve:"Recuperar",dataReloaded:"Dados recarregados com sucesso",reloadError:"Falha ao recarregar dados",exportCSV:"Exportar CSV"},Uj={groupCode:"Cdigo do Grupo",groupName:"Nome do Grupo",description:"Descrio",usage:"Uso",grant:"Concesso",groupLevel:"Nvel do Grupo",screens:"Telas",functions:"Funes",fullName:"Nome Completo",email:"Email",groups:"Grupos",lastLogin:"ltimo Login",registerUser:"Registrar Usurio",codeType:"Tipo de Cdigo",code:"Cdigo",name:"Nome",addCode:"Adicionar Cdigo",editCode:"Editar Cdigo",permissions:"Permisses",use:"Usar",retrieve:"Consultar",create:"Criar",update:"Atualizar",delete:"Excluir",download:"Baixar",preview:"Visualizar",print:"Imprimir",history:"Histrico",clear:"Limpar",internal:"Interno",external:"Externo",eorSettings:"Configuraes EOR",displaySettings:"Configuraes de Exibio",notifications:"Notificaes",localization:"Localizao",workflowSettings:"Configuraes de Fluxo",autoApprovalThreshold:"Limite de Auto-Aprovao",autoApprovalDesc:"EORs abaixo deste valor sero auto-aprovados",defaultCurrency:"Moeda Padro",currencyDesc:"Moeda para todos os clculos de custo",showCostInList:"Mostrar Custo na Lista",showCostDesc:"Exibir custos de reparo nas listas",currentSettings:"Configuraes Atuais",autoApproval:"Auto-Aprovao",language:"Idioma",perPage:"Por Pgina",timeout:"Tempo Limite",resetDefaults:"Restaurar Padres",allGroups:"Todos os Grupos",allTypes:"Todos os Tipos",permissionGroupsDesc:"Gerenciar grupos e permisses",overview:"Viso Geral",screen:"Tela",save:"Salvar",masterCodesDesc:"Gerenciar dados mestres e cdigos",codeTypes:"Tipos de Cdigo",totalCodes:"Total de Cdigos",searchCodes:"Buscar cdigos...",username:"Nome de Usurio",password:"Senha",userType:"Tipo de Usurio",shippingLine:"Linha de Navegao",assignGroups:"Atribuir Grupos",userManagementDesc:"Registrar e gerenciar contas de usurio",showInactive:"Mostrar Inativos",noUsersFound:"Nenhum usurio encontrado",requiredFields:"Nome de usurio, senha e nome completo so obrigatrios",usernameExists:"Nome de usurio j existe",groupRequired:" necessrio pelo menos um grupo",userCreated:"Usurio criado com sucesso",userUpdated:"Usurio atualizado",userDeactivated:"Usurio desativado",userActivated:"Usurio ativado",deactivate:"Desativar",activate:"Ativar",details:"Detalhes",activity:"Atividade",security:"Segurana",createdAt:"Criado em",never:"Nunca",justNow:"Agora mesmo",selectUser:"Selecionar Usurio",selectUserDesc:"Escolha um usurio da lista para ver e editar",activeScreens:"Telas Ativas",completion:"Concluso",hideGroups:"Ocultar Grupos",showGroups:"Mostrar Grupos",resetPassword:"Redefinir Senha",homePageManagement:"Gesto da Pgina Inicial",homePageDesc:"Gerenciar anncios e links exibidos no portal",addAnnouncement:"Adicionar Anncio",editAnnouncement:"Editar Anncio",addLink:"Adicionar Link",editLink:"Editar Link",announcementCreated:"Anncio criado",announcementUpdated:"Anncio atualizado",announcementDeleted:"Anncio excludo",linkCreated:"Link criado",linkUpdated:"Link atualizado",linkDeleted:"Link excludo",confirmDelete:"Tem certeza de que deseja excluir?",applyTemplate:"Aplicar Modelo",approve:"Aprovar",reject:"Rejeitar",selectGroup:"Selecionar Grupo",selectGroupDesc:"Selecione um grupo da lista para ver e editar suas permisses",groupSaved:"Grupo salvo com sucesso",groupCreated:"Grupo criado com sucesso",groupDuplicated:"Grupo duplicado com sucesso",groupDeleted:"Grupo excludo com sucesso",deleteGroup:"Excluir Grupo",deleteGroupConfirm:"Tem certeza de que deseja excluir o grupo",deleteGroupWarning:"Esta ao no pode ser desfeita. Usurios neste grupo perdero suas permisses.",accountStatus:"Status da Conta",activated:"Ativado",autoLogoutDesc:"Desconectar automaticamente aps perodo de inatividade",cannotDeleteCore:"No  possvel excluir grupos principais",codeAdded:"Cdigo adicionado com sucesso",codeDeactivated:"Cdigo desativado",codeExists:"Cdigo j existe",codeNameRequired:"Cdigo e nome so obrigatrios",codeRequired:"Cdigo  obrigatrio",codeUpdated:"Cdigo atualizado com sucesso",confirmDeactivate:"Tem certeza de que deseja desativar?",containersDesc:"Nmero de contentores exibidos por pgina",containersPerPage:"Contentores por Pgina",copied:"Copiado!",copyCode:"Copiar Cdigo",dateFormat:"Formato de Data",dateFormatDesc:"Formato para exibio de datas",deactivated:"Desativado",defaultSurveyType:"Tipo de Vistoria Padro",duplicate:"Duplicar",enableAutoLogout:"Ativar Logout Automtico",enableNotifications:"Ativar Notificaes",enableQuickActions:"Ativar Aes Rpidas",exportSuccess:"Exportao bem-sucedida",importCodes:"Importar Cdigos",importInstructions:"Cole dados JSON para importar cdigos",imported:"importado",invalidFormat:"Formato invlido",invalidJSON:"Formato JSON invlido",jsonData:"Dados JSON",languageDesc:"Idioma padro do aplicativo",legacyFunctions:"Permisses baseadas em funes legadas (para compatibilidade)",nameRequired:"Nome  obrigatrio",newGroup:"Novo Grupo de Permisso",noActivityYet:"Nenhuma atividade ainda",noCodesFound:"Nenhum cdigo encontrado",notificationsDesc:"Exibir notificaes do sistema",quickActionsDesc:"Exibir botes de ao rpida no painel",quickTemplates:"Modelos de Incio Rpido",recentActivity:"Atividade Recente",requirePhoto:"Exigir Foto",requirePhotoDesc:"Exigir upload de foto para vistorias",sessionDesc:"Tempo at a sesso expirar",sessionInfo:"Info da Sesso",sessionTimeout:"Tempo Limite da Sesso",settingsReset:"Configuraes restauradas para padro",settingsSaved:"Configuraes salvas com sucesso",skipped:"ignorado",surveyTypeDesc:"Tipo padro para novas vistorias",timeFormat:"Formato de Hora",timeFormatDesc:"Formato para exibio de hora",moveUp:"Mover para cima",moveDown:"Mover para baixo",itemMoved:"Item movido"},zj={login:"Entrar",username:"Usurio",password:"Senha",loginButton:"Entrar",loginTitle:"Sistema M&R de Contentores",loginSubtitle:"Gesto de Manuteno e Reparao",loginError:"Usurio ou senha invlidos",selectLanguage:"Selecionar Idioma",changePassword:"Alterar Senha",currentPassword:"Senha Atual",newPassword:"Nova Senha",confirmPassword:"Confirmar Senha",passwordMismatch:"As senhas no correspondem",passwordTooShort:"A senha deve ter pelo menos 6 caracteres",passwordChanged:"Senha alterada com sucesso!",currentPasswordWrong:"Senha atual incorreta",userLogin:"Login do Usurio",signingIn:"Entrando...",loginSuccess:"Login Bem-sucedido",loginSuccessMessage:"Voc fez login com sucesso.",pleaseLoginFirst:"Por favor, faa login primeiro para acessar o sistema.",passwordRequired:"Senha  obrigatria",portalTitle:"Portal M&R",enterCredentials:"Digite suas credenciais para acessar o sistema",enterUsername:"Digite o usurio",enterPassword:"Digite a senha"},Wj={goodMorning:"Bom Dia",goodAfternoon:"Boa Tarde",goodEvening:"Boa Noite"},Hj={johorPort:"Porto de Johor",containerPortal:"Portal de Contentores",welcomeTo:"Bem-vindo ao Portal do Porto de Johor",home:"Incio",about:"Sobre",services:"Servios",contactUs:"Contato",generalEnquiry:"Consulta Geral",registration:"Registro",helpDesk:"Suporte",containerOperations:"Operaes de Contentores",qualityAssurance:"Garantia de Qualidade",support247:"Suporte 24/7",shippingAgent:"Agente de Navegao",forwardingAgent:"Agente de Carga",shipperConsignee:"Embarcador/Consignatrio",accessSystem:"Acessar Sistema",benefit:"Benefcio",announcement:"Anncio",links:"Links",networkInfrastructure:"Infraestrutura de Rede",onlineMarketplace:"Mercado Online",faq:"Perguntas Frequentes"},Gj={selectScreen:"Por favor, selecione uma tela do menu para comear.",menuHint:"Use o menu de navegao  esquerda para abrir telas"},$j={title:"Contentores",register:"Registrar Contentor",allContainers:"Todos os Contentores",arContainers:"Contentores Aguardando Reparao",containerNumber:"Nmero do Contentor",liner:"Armador",size:"Tamanho",type:"Tipo",initialStatus:"Status Inicial",registerSuccess:"Contentor registrado com sucesso!",alreadyExists:"Contentor j existe",invalidFormat:"Formato invlido (ex: MSCU1234567)",manualEntry:"Entrada Manual",excelUpload:"Upload Excel",downloadTemplate:"Baixar Modelo",dragDropExcel:"Arraste e solte arquivo Excel aqui",orClickBrowse:"ou clique para selecionar",previewContainers:"Visualizar",importValid:"Importar Contentores Vlidos",clear:"Limpar",formatHint:"Formato: 4 letras + 7 dgitos",damaged:"Danificado",available:"Disponvel",awaitingRepair:"Aguardando Reparao",repairInProgress:"Em Reparao",completed:"Concludo",gateOut:"Sada",adjustFilters:"Ajuste os filtros para ver mais resultados",batchStatusUpdate:"Atualizao de Status em Lote",batchUpdate:"Atualizao em Lote",batchUpdateConfirm:"Tem certeza de que deseja atualizar estes contentores?",containerTimeline:"Linha do Tempo do Contentor",newStatus:"Novo Status",noContainersFound:"Nenhum contentor encontrado",noTimelineEvents:"Sem eventos na linha do tempo",toDM:"Para DM",updateContainers:"Atualizar Contentores",viewDetails:"Ver Detalhes",viewTimeline:"Ver Linha do Tempo",workflowStage:"Etapa do Fluxo"},Vj={title:"Vistorias",newSurvey:"Nova Vistoria",surveyList:"Lista de Vistorias",searchContainer:"Pesquisar Contentor",surveyType:"Tipo de Vistoria",initialCondition:"Condio Inicial",notes:"Observaes",damageItems:"Itens Danificados",addItem:"Adicionar Item",location:"Localizao",damageType:"Tipo de Dano",component:"Componente",severity:"Gravidade",quantity:"Quantidade",repairMethod:"Mtodo de Reparao",estimatedCost:"Custo Estimado (RM)",totalCost:"Custo Total Estimado",saveDraft:"Salvar Rascunho",completeSurvey:"Concluir Vistoria",createEOR:"Criar EOR",manual:"Manual",inbound:"Entrada",outbound:"Sada",periodic:"Peridica",other:"Outro",hasDamage:"Com Danos",noDamage:"Sem Danos",noSurveysFound:"Nenhuma vistoria encontrada",createNewSurvey:"Clique para criar uma nova vistoria",allTypes:"Todos os Tipos",damage:"Dano",damaged:"Danificado"},qj={title:"Estimativa de Reparao",eorList:"Lista de EOR",createEOR:"Criar EOR",editEOR:"Editar EOR",repairItems:"Itens de Reparao",unitPrice:"Preo Unitrio",laborHours:"Horas de Trabalho",lineCost:"Custo da Linha",totalCost:"Custo Total",autoApproved:"Aprovado Auto",pendingApproval:"Aguardando Aprovao",sendToLiner:"Enviar para Armador",approve:"Aprovar",reject:"Rejeitar",createRepairOrder:"Criar Ordem de Reparao",timeline:"Linha do Tempo",autoApprovalNote:"EOR  100 RM ser aprovado automaticamente",totalValue:"Valor Total",pendingAmount:"Valor Pendente",approvedAmount:"Valor Aprovado",avgValue:"Valor Mdio",syncToAR:"Sincronizar AR",draft:"Rascunho",pending:"Pendente",approved:"Aprovado",noEORsFound:"Nenhum EOR encontrado",createFromSurvey:"Criar EOR a partir de pesquisa concluda",approveSelected:"Aprovar Selecionados",rejectSelected:"Rejeitar Selecionados",approvalNotes:"Notas de Aprovao",bulkApprove:"Aprovar em Lote",bulkApproveConfirm:"Tem certeza de que deseja aprovar estes EORs?",bulkReject:"Rejeitar em Lote",bulkRejectConfirm:"Tem certeza de que deseja rejeitar estes EORs?",enterNotes:"Digite notas...",rejected:"Rejeitado"},Kj={title:"Ordens de Reparao",roList:"Lista de Ordens",assignTeam:"Atribuir Equipe",startRepair:"Iniciar Reparao",completeRepair:"Concluir Reparao",workLog:"Registro de Trabalho",addWorkLog:"Adicionar Registro",repairTasks:"Tarefas de Reparao",elapsedTime:"Tempo Decorrido",allTeams:"Todas as Equipes",noRepairOrders:"Sem Ordens de Reparao",noRepairOrdersDesc:"No h ordens de reparao no momento",assign:"Atribuir",assignTeamDesc:"Selecione uma equipe para atribuir esta ordem",complete:"Concluir",selectTeam:"Selecionar Equipe",selectTeamPlaceholder:"Escolha uma equipe...",start:"Iniciar"},Yj={title:"Movimentao",newRequest:"Nova Solicitao",fromBlock:"Do Bloco",toBlock:"Para Bloco",priority:"Prioridade",high:"Alta",medium:"Mdia",low:"Baixa",pending:"Pendente",inProgress:"Em Andamento",completed:"Concludo",newShuntingRequest:"Nova Solicitao de Movimentao",normal:"Normal",chooseContainer:"Escolher Contentor",selectContainer:"Selecionar Contentor",destinationBlock:"Bloco de Destino",selectBlock:"Selecionar Bloco",assignDriver:"Atribuir Motorista",assignLater:"Atribuir Depois",createRequest:"Criar Solicitao",activeTasks:"tarefas ativas",allPriorities:"Todas as Prioridades",assign:"Atribuir",complete:"Concluir",dispatch:"Despachar",dispatchToDriver:"Despachar para Motorista",dispatched:"Despachado",driverWorkload:"Carga do Motorista",moveContainers:"Mover contentores para rea de reparao",new:"Novo",noRequests:"Sem solicitaes de movimentao",repairBay:"rea de Reparao",selectDriver:"Selecionar Motorista",shuntingRequests:"Solicitaes de Movimentao",start:"Iniciar",tasks:"tarefas",totalRequests:"Total de Solicitaes",urgent:"Urgente"},Xj={title:"Pr-Inspeo",schedule:"Agendar Inspeo",scheduledDate:"Data Agendada",result:"Resultado",accept:"Aceitar",rework:"Retrabalho Necessrio",reworkDetails:"Detalhes do Retrabalho",todayInspections:"Inspees de Hoje",scheduleInspection:"Agendar Inspeo",accepted:"Aceito",reworkRequired:"Retrabalho Necessrio",allInspections:"Todas as Inspees",allTypes:"Todos os Tipos",multipleReworks:"Mltiplos Retrabalhos",reworkCount:"Retrabalho #",inspect:"Inspecionar",inspectionStatus:"Status da Inspeo",total:"Total de Inspees",today:"Hoje",allResults:"Todos os Resultados",completeInspection:"Concluir Inspeo",completed:"Concludo",describeIssues:"Descreva os problemas encontrados...",fail:"Reprovado",failed:"Reprovado",inspectionChecklist:"Lista de Verificao",inspectorNotes:"Notas do Inspetor",itemsFailed:"itens reprovados",noInspectionsFound:"Nenhuma inspeo encontrada",notesPlaceholder:"Adicionar notas...",pass:"Aprovado",passed:"Aprovado",planned:"Planejado",quickAccept:"Aceitar Rpido",quickRework:"Retrabalho Rpido",recordRework:"Registrar Retrabalho",remaining:"Restante",requireRework:"Requer Retrabalho",reworkAnalysis:"Anlise de Retrabalho",startWithChecklist:"Comear com lista",postRepairCleaning:"Limpeza Ps-Reparao",damageVerification:"Verificao de Itens Danificados",damageVerificationDesc:"Verifique se cada item de dano na pesquisa foi reparado corretamente.",repaired:"Reparado",notRepaired:"No Reparado",generalChecklist:"Lista de Verificao de Inspeo Geral",repairsVerified:"Reparaes Verificadas"},Qj={title:"Empilhamento e Liberao",newRequest:"Nova Solicitao",readyToStack:"Pronto para Empilhar",targetLocation:"Local de Destino",block:"Bloco",row:"Linha",tier:"Nvel",completeRelease:"Concluir e Liberar",readyForStacking:"Pronto para Empilhamento",releaseContainer:"Liberar Contentor",releaseOptions:"Opes de Liberao",generateGatePass:"Gerar Passe de Sada",notifyAndRelease:"Notificar e Liberar",stockReport:"Relatrio de Estoque",searchLocation:"Pesquisar por localizao",readyToStackLabel:"Pronto para Empilhar",releaseReady:"Pronto para Liberao",stackNow:"Empilhar Agora",released:"Liberado",stackingRequests:"Solicitaes de Empilhamento",byBlock:"Por Bloco",byLiner:"Por Armador",createRequest:"Criar Solicitao",createRequests:"Criar Solicitaes",new:"Novo",newStackingRequest:"Nova Solicitao de Empilhamento",noLocation:"Sem localizao",noStackingRequests:"Sem solicitaes de empilhamento",repairBay:"rea de Reparao",selectContainer:"Selecionar Contentor",stockByLiner:"Estoque por Armador",stockByBlock:"Estoque por Bloco",totalAvailable:"Total Disponvel",reportExported:"Relatrio de estoque exportado"},Jj={title:"Painel",welcome:"Bem-vindo de volta",quickActions:"Aes Rpidas",eorOverview:"Viso Geral EOR",recentSurveys:"Vistorias Recentes",recentEORs:"EORs Recentes",totalContainers:"Total de Contentores",pendingEORs:"EORs Pendentes",inRepair:"Em Reparao",completedToday:"Concludos Hoje",searchContainers:"Pesquisar contentores",damaged:"Danificado",awaitingRepair:"Aguardando Reparao",available:"Disponvel",workflowTracker:"Rastreador de Fluxo",pendingActions:"Aes Pendentes",recentActivity:"Atividade Recente",noPendingActions:"Sem aes pendentes",totalValue:"Valor Total",noEORsYet:"Nenhum EOR ainda",noRecentActivity:"Nenhuma atividade recente",noSurveysYet:"Nenhuma vistoria ainda"},Zj={dashboard:"Painel",containerManagement:"Gesto de Contentores",registerContainer:"Registrar Contentor",allContainers:"Todos os Contentores",arContainers:"Contentores Aguardando Reparao",surveyDamage:"Vistoria & Danos",newSurvey:"Nova Vistoria",surveyList:"Lista de Vistorias",repairManagement:"Gesto de Reparao",eorList:"Lista de EOR",repairOrders:"Ordens de Reparao",yardOperations:"Operaes do Ptio",shunting:"Movimentao",preInspection:"Pr-Inspeo",stackingRelease:"Empilhamento e Liberao",administration:"Administrao",masterCodes:"Cdigos Mestre",permissionGroups:"Grupos de Permisso",userManagement:"Gesto de Usurios",systemSettings:"Configuraes do Sistema",monitoring:"Monitoramento",jobMonitoring:"Monitoramento de Trabalho",homePageManagement:"Pgina Inicial",washingStation:"Estao de Lavagem"},eR={containerNumber:"Nmero do Contentor",sequence:"Sequncia",liner:"Armador",size:"Tamanho",type:"Tipo",location:"Localizao",yardLocation:"Localizao no Ptio",gateInDate:"Data de Entrada",createdAt:"Criado em",createdBy:"Criado por",updatedAt:"Atualizado em",completedAt:"Concludo em",completedBy:"Concludo por",actions:"Aes",notes:"Observaes",result:"Resultado",assignedTeam:"Equipe Atribuda",startTime:"Hora de Incio",endTime:"Hora de Trmino",totalCost:"Custo Total",version:"Verso",requestedAt:"Solicitado em",requestedBy:"Solicitado por",source:"Origem",destination:"Destino",priority:"Prioridade",inspectedAt:"Inspecionado em",inspectedBy:"Inspecionado por",targetLocation:"Local de Destino",containerStatus:"Status do Contentor",surveyStatus:"Status da Vistoria",eorStatus:"Status do EOR",roStatus:"Status da OR",shuntingStatus:"Status da Movimentao",inspectionStatus:"Status da Inspeo",stackingStatus:"Status do Empilhamento",surveyType:"Tipo de Vistoria",initialCondition:"Condio Inicial",damageCount:"Quantidade de Danos",approval:"Aprovao",autoApproved:"Aprovado Auto",repairOrderStatus:"Status da Ordem de Reparao",transactionId:"ID da Transao",progress:"Progresso",driver:"Motorista",route:"Rota",waitTime:"Tempo de Espera",gatePass:"Passe de Sada",reworkCount:"Retrabalho #"},tR={announcements:"Anncios",links:"Links",noAnnouncements:"Sem anncios",noLinks:"Sem links"},nR={title:"Ttulo",content:"Contedo",url:"URL",description:"Descrio",select:"Selecionar..."},rR={stacking:"Empilhamento",survey:"Vistoria",eor:"EOR",approval:"Aprovao",repair:"Reparao",shunting:"Movimentao",qc:"CQ",release:"Liberao",washing:"Lavagem"},aR={title:"Aes Pendentes",surveysPending:"Vistorias Pendentes",eorPendingApproval:"EORs Aguardando Aprovao",repairsPending:"Reparaes Pendentes",inspectionsDue:"Inspees Previstas"},sR={title:"Atividade Recente",newSurvey:"Nova vistoria criada para",eorStatusChange:"Status do EOR alterado para",repairStarted:"Reparao iniciada para",noRecentActivity:"Sem atividade recente"},iR={selected:"selecionado(s)",approveSelected:"Aprovar Selecionados",rejectSelected:"Rejeitar Selecionados",clearSelection:"Limpar Seleo",bulkApprove:"Aprovar em Lote",bulkReject:"Rejeitar em Lote",confirmApprove:"Tem certeza de que deseja aprovar estes EORs?",confirmReject:"Tem certeza de que deseja rejeitar estes EORs?"},oR={workload:"Carga de Trabalho do Motorista",activeTasks:"tarefas ativas",assign:"Atribuir",dispatch:"Despachar",selectDriver:"Selecionar Motorista",dispatchToDriver:"Despachar para Motorista"},lR={structural:"Integridade Estrutural",doors:"Operao das Portas",floor:"Condio do Piso",roof:"Condio do Teto",paint:"Pintura e Acabamento",placards:"Placas e Etiquetas",locking:"Mecanismo de Travamento",cleanliness:"Limpeza",pass:"Aprovado",fail:"Reprovado",passed:"Aprovado",failed:"Reprovado",remaining:"Restante",completeInspection:"Concluir Inspeo",reworkAnalysis:"Anlise de Retrabalho",multipleReworks:"Mltiplos Retrabalhos"},cR={title:"Relatrio de Estoque",byLiner:"Contentores Disponveis por Armador",byBlock:"Contentores Disponveis por Bloco"},uR={generateGatePass:"Gerar Passe de Sada",notifyAndRelease:"Notificar Armador e Liberar",releaseOptions:"Escolha como deseja liberar este contentor:",gatePassGenerated:"Passe de sada gerado"},dR={approvalsNeeded:"Aprovaes Necessrias",inspectionsPending:"Inspees Pendentes",repairsInProgress:"Reparaes em Andamento",surveysToComplete:"Vistorias a Concluir"},hR={title:"Estao de Lavagem",subtitle:"Gesto de limpeza e higienizao de contentores",newWashingOrder:"Nova Ordem de Lavagem",pendingApproval:"Aguardando Aprovao",pendingSchedule:"Aguardando Agendamento",scheduled:"Agendado",inProgress:"Em Progresso",pendingQC:"Aguardando QC",rework:"Retrabalho",completedToday:"Concludo Hoje",searchPlaceholder:"Pesquisar contentor, armador...",allBays:"Todas as Baas",allPrograms:"Todos os Programas",program:"Programa",bay:"Baa",scheduledAt:"Agendado",noOrders:"Nenhuma ordem de lavagem encontrada",readyForWashing:"Contentores Prontos para Lavagem",createOrder:"Criar Ordem",cleaningStarted:"Limpeza iniciada",orderApproved:"Ordem de lavagem aprovada",orderRejected:"Ordem de lavagem rejeitada",enterRejectionReason:"Insira o motivo da rejeio:",approve:"Aprovar",reject:"Rejeitar",startCleaning:"Iniciar Limpeza",completeCleaning:"Concluir e Enviar para QC",cleaningCompleted:"Limpeza concluda, aguardando QC",completeAllRequired:"Por favor, complete todos os itens obrigatrios",orderNotFound:"Ordem de lavagem no encontrada",safetyNotes:"Notas de Segurana",cleaningChecklist:"Lista de Verificao de Limpeza",workerNotes:"Notas do Trabalhador",notesPlaceholder:"Quaisquer observaes ou problemas...",allRequiredMustPass:"Todos os itens obrigatrios devem passar",qcPassed:"QC Aprovado! Certificado gerado.",selectReworkReasons:"Por favor, selecione pelo menos um motivo de retrabalho",qcFailed:"QC Reprovado. Ordem enviada para retrabalho.",qcInspection:"Inspeo de QC",cleaningProgram:"Programa de Limpeza",elapsedTime:"Tempo Decorrido",reworkAttempt:"Tentativa de Retrabalho",previousReworkReasons:"Problemas anteriores",qcChecklist:"Lista de Verificao de QC",pass:"Aprovado",fail:"Reprovado",reworkReasons:"Motivos de Retrabalho",qcNotes:"Notas de QC",qcNotesPlaceholder:"Observaes da inspeo...",failAndRework:"Reprovar e Retrabalhar",passAndCertify:"Aprovar e Gerar Certificado",selectContainerFirst:"Por favor, selecione um contentor primeiro",orderCreated:"Ordem de lavagem criada",assignedBay:"Baa Atribuda",assignedTeam:"Equipa Atribuda",selectBay:"Selecionar Baa",selectTeam:"Selecionar Equipa",initialInspection:"Inspeo Inicial",contaminationLevel:"Nvel de Contaminao",interiorCondition:"Condio Interior",exteriorCondition:"Condio Exterior",odorPresent:"Odor Presente",pestPresent:"Presena de Pragas",hazardousResidues:"Resduos Perigosos",inspectionNotes:"Notas de Inspeo",safetyWarning:"Aviso de Segurana",hazardousWarning:"Este container requer medidas de segurana especiais",suggestedProgram:"Programa Sugerido",selectProgram:"Selecionar Programa",schedule:"Agendar",assignBay:"Atribuir Baa",assignTeam:"Atribuir Equipa",safetyRequirements:"Requisitos de Segurana",requiresMask:"Requer Mscara",requiresGloves:"Requer Luvas",chemicalHandling:"Manuseio Qumico",ventilationRequired:"Ventilao Necessria",twoPersonJob:"Trabalho para 2 Pessoas",safetyNotesPlaceholder:"Instrues de segurana adicionais para trabalhadores...",certificateOfCleanliness:"Certificado de Limpeza",certificateNo:"N do Certificado",cleanedDate:"Data de Limpeza",issueDate:"Data de Emisso",certificateStatement:"Certifica que o container acima foi lavado e inspecionado de acordo com padres internacionais",qcInspector:"Inspetor QC",authorizedSignatory:"Signatrio Autorizado",printCertificate:"Imprimir",downloadPDF:"Baixar PDF",emailToLiner:"Enviar Email ao Armador",noCertificate:"Sem certificado ainda. QC deve passar primeiro."},fR={PENDING_WASH:"Aguardando Lavagem",WASHING:"Em Lavagem"},mR={common:Bj,admin:Uj,auth:zj,greetings:Wj,portal:Hj,workspace:Gj,container:$j,survey:Vj,eor:qj,repairOrder:Kj,shunting:Yj,inspection:Xj,stacking:Qj,dashboard:Jj,nav:Zj,columns:eR,homepage:tR,common2:nR,workflow:rR,pendingActions:aR,recentActivity:sR,bulkActions:iR,driver:oR,inspectionChecklist:lR,stockReport:cR,release:uR,pending:dR,washing:hR,containerStatus:fR},bd={en:Eb,vi:nA,ms:IA,ko:lj,zh:Mj,pt:mR},Nw=T.createContext();function pR({children:e}){const[t,n]=T.useState(()=>{const d=localStorage.getItem("mnr_language");return d&&G0[d]?d:YT}),[r,s]=T.useState(bd[t]||bd.en);T.useEffect(()=>{localStorage.setItem("mnr_language",t),s(bd[t]||bd.en),document.documentElement.lang=t},[t]);const i=T.useCallback(d=>{G0[d]&&n(d)},[]),l=T.useCallback((d,f="")=>{const m=d.split(".");let p=r;for(const x of m)if(p&&typeof p=="object"&&x in p)p=p[x];else return f||d;return typeof p=="string"?p:f||d},[r]),u={language:t,languages:G0,changeLanguage:i,t:l,translations:r};return a.jsx(Nw.Provider,{value:u,children:e})}function Wt(){const e=T.useContext(Nw);if(!e)throw new Error("useLanguage must be used within a LanguageProvider");return e}const Ew=T.createContext(null),L1=[{id:"registered",label:"Registered",description:"Container added to system"},{id:"survey_created",label:"Survey Created",description:"Damage survey started"},{id:"survey_completed",label:"Survey Completed",description:"Survey finished with damage items"},{id:"eor_created",label:"EOR Created",description:"Estimate of Repair created"},{id:"eor_approved",label:"EOR Approved",description:"Liner approved the estimate"},{id:"shunted",label:"Shunted to Repair",description:"Moved to repair bay"},{id:"repair_started",label:"Repair Started",description:"Repair work in progress"},{id:"repair_completed",label:"Repair Completed",description:"Repair work finished"},{id:"washing",label:"Washing",description:"Container cleaning and sanitization"},{id:"inspection_passed",label:"Pre-Inspection Passed",description:"Quality check passed"},{id:"released",label:"Released",description:"Container available for use"}];function gR({children:e}){const{containers:t,surveys:n,eors:r}=qt(),[s,i]=T.useState(null),[l,u]=T.useState(!1),[d,f]=T.useState(0),m=T.useMemo(()=>s?t.find(b=>b.id===s):null,[s,t]),p=T.useMemo(()=>m?n.find(b=>b.containerId===m.id||b.containerNumber===m.containerNumber):null,[m,n]),x=T.useMemo(()=>m?r.find(b=>b.containerId===m.id||b.containerNumber===m.containerNumber):null,[m,r]),v=T.useMemo(()=>{var H;if(!m)return-1;const b=m.status;if(b==="AV")return 10;if(b==="COMPLETED")return JSON.parse(localStorage.getItem("mnr_preinspections")||"[]").find(V=>V.containerId===m.id&&V.result==="ACCEPTED")?9:JSON.parse(localStorage.getItem("mnr_washing")||"[]").find(V=>V.containerId===m.id&&V.status==="COMPLETED")?8:7;if(b==="REPAIR")return 6;if(b==="AR")return JSON.parse(localStorage.getItem("mnr_shunting")||"[]").find(q=>(q.containerId===m.id||q.containerNumber===m.containerNumber)&&q.status==="COMPLETED")?5:4;if(x){if((H=x.status)!=null&&H.includes("APPROVED"))return 4;if(x.status==="SENT"||x.status==="PENDING"||x.status==="DRAFT")return 3}if(p){if(p.status==="COMPLETED")return 2;if(p.status==="DRAFT")return 1}return 0},[m,p,x,d]),k=T.useMemo(()=>{const b=JSON.parse(localStorage.getItem("mnr_washing")||"[]"),H=m?b.find(q=>q.containerId===m.id&&q.status==="COMPLETED"):null,L=8;return L1.map((q,O)=>{let V;return O===L?H?V=v>O?"completed":v===O?"current":"pending":v>O?V="skipped":v===O?V="current":V="pending":V=O<v?"completed":O===v?"current":"pending",{...q,index:O,status:V,data:R(O,H)}});function R(q,O){switch(q){case 0:return m?{date:m.gateInDate,detail:`Status: ${m.status}`}:null;case 1:case 2:return p?{id:p.id,detail:p.status}:null;case 3:case 4:return x?{id:x.id,detail:`RM ${x.totalCost} - ${x.status}`}:null;case 8:return O?{id:O.id,detail:O.status}:null;default:return null}}},[v,m,p,x]),y=T.useCallback(()=>{if(!m)return null;switch(v){case 0:return{label:"Create Survey",path:`/surveys/new/${m.id}`,icon:"clipboard"};case 1:return{label:"Complete Survey",path:`/surveys/${p==null?void 0:p.id}`,icon:"check"};case 2:return{label:"Create EOR",path:`/eor/new?containerId=${m.id}`,icon:"file-text"};case 3:return{label:"View EOR",path:`/eor/${x==null?void 0:x.id}`,icon:"eye"};case 4:return{label:"Create Shunting",path:"/shunting",icon:"truck"};case 5:return{label:"Start Repair",path:"/repair-orders",icon:"tool"};case 7:return{label:"Start Washing",path:"/washing",icon:"droplet"};case 8:return{label:"Schedule Inspection",path:"/pre-inspection",icon:"search"};case 9:return{label:"Stack & Release",path:"/stacking",icon:"layers"};default:return null}},[v,m,p,x]),S=T.useCallback(b=>{i(b),f(H=>H+1),u(!0)},[]),C=T.useCallback(()=>{i(null)},[]),D=T.useCallback(()=>{u(b=>!b)},[]),N={selectedContainerId:s,selectedContainer:m,isPanelOpen:l,currentStep:v,workflowSteps:k,containerSurvey:p,containerEOR:x,selectContainer:S,clearSelection:C,togglePanel:D,setIsPanelOpen:u,getNextAction:y,WORKFLOW_STEPS:L1};return a.jsx(Ew.Provider,{value:N,children:e})}function Tw(){const e=T.useContext(Ew);if(!e)throw new Error("useWorkflow must be used within a WorkflowProvider");return e}const bw=T.createContext(null),F1=30,xR=e=>{const t={"/":"Welcome Page","/dashboard":"Dashboard","/containers":"Container List","/containers/register":"Register Container","/containers/ar":"AR Containers","/surveys":"Survey List","/surveys/search":"New Survey","/eor":"EOR List","/repair-orders":"Repair Orders","/shunting":"Shunting","/pre-inspection":"Pre-Inspection","/stacking":"Stacking & Release","/monitoring/jobs":"Job Monitoring","/admin/codes":"Master Codes","/admin/groups":"Permission Groups","/admin/users":"User Management","/admin/settings":"System Settings"};return t[e]?t[e]:e.startsWith("/containers/")&&e!=="/containers/register"&&e!=="/containers/ar"?"Container Detail":e.startsWith("/surveys/")&&e!=="/surveys/search"?e.includes("/new/")?"New Survey":"Survey Detail":e.startsWith("/eor/")?e.includes("/new")?"New EOR":e.includes("/edit")?"Edit EOR":"EOR Detail":e.startsWith("/repair-orders/")?"Repair Order Detail":"Page"};function vR({children:e}){const[t,n]=T.useState([]),[r,s]=T.useState(null),i=cn(),l=T.useRef([]);l.current=t;const u=T.useRef(null);u.current=r;const d=T.useCallback((C,D=null)=>{const N=D||xR(C),b=l.current.find(L=>L.path===C);if(b)return s(b.id),b.id;const H={id:`tab-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,path:C,title:N};return n(L=>L.some(R=>R.path===C)?L:L.length>=F1?[...L.slice(1),H]:[...L,H]),s(H.id),H.id},[]),f=T.useCallback(C=>{n(D=>{const N=D.findIndex(H=>H.id===C);if(N===-1)return D;const b=D.filter(H=>H.id!==C);if(b.length>0){const H=Math.min(N,b.length-1),L=b[H];s(L.id),i(L.path)}else s(null),i("/");return b})},[i]),m=T.useCallback((C=null)=>{const D=C||u.current;n(N=>{const b=N.find(H=>H.id===D);return b?(s(b.id),i(b.path),[b]):(i("/"),[])})},[i]),p=T.useCallback(()=>{n([]),s(null),i("/")},[i]),x=T.useCallback(C=>{const D=l.current.find(N=>N.id===C);D&&(s(C),i(D.path))},[i]),v=T.useCallback(()=>{const C=l.current.findIndex(b=>b.id===u.current);if(C===-1||l.current.length<=1)return;const D=(C+1)%l.current.length,N=l.current[D];s(N.id),i(N.path)},[i]),k=T.useCallback(()=>{const C=l.current.findIndex(b=>b.id===u.current);if(C===-1||l.current.length<=1)return;const D=(C-1+l.current.length)%l.current.length,N=l.current[D];s(N.id),i(N.path)},[i]),y=T.useCallback(()=>{u.current&&f(u.current)},[f]);T.useEffect(()=>{const C=D=>{D.ctrlKey&&D.key==="w"?(D.preventDefault(),y()):D.ctrlKey&&D.key==="Tab"&&!D.shiftKey?(D.preventDefault(),v()):D.ctrlKey&&D.shiftKey&&D.key==="Tab"&&(D.preventDefault(),k())};return window.addEventListener("keydown",C),()=>window.removeEventListener("keydown",C)},[y,v,k]);const S={tabs:t,activeTabId:r,openTab:d,closeTab:f,closeAllOthers:m,closeAllTabs:p,switchTab:x,switchToNextTab:v,switchToPrevTab:k,closeCurrentTab:y,MAX_TABS:F1};return a.jsx(bw.Provider,{value:S,children:e})}function yR(){const e=T.useContext(bw);if(!e)throw new Error("useTabs must be used within a TabProvider");return e}const kR=()=>{};var M1={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aw={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $e=function(e,t){if(!e)throw fl(t)},fl=function(e){return new Error("Firebase Database ("+Aw.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jw=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let s=e.charCodeAt(r);s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=s&63|128):(s&64512)===55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(e.charCodeAt(++r)&1023),t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=s&63|128):(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=s&63|128)}return t},wR=function(e){const t=[];let n=0,r=0;for(;n<e.length;){const s=e[n++];if(s<128)t[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=e[n++];t[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=e[n++],l=e[n++],u=e[n++],d=((s&7)<<18|(i&63)<<12|(l&63)<<6|u&63)-65536;t[r++]=String.fromCharCode(55296+(d>>10)),t[r++]=String.fromCharCode(56320+(d&1023))}else{const i=e[n++],l=e[n++];t[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|l&63)}}return t.join("")},fp={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<e.length;s+=3){const i=e[s],l=s+1<e.length,u=l?e[s+1]:0,d=s+2<e.length,f=d?e[s+2]:0,m=i>>2,p=(i&3)<<4|u>>4;let x=(u&15)<<2|f>>6,v=f&63;d||(v=64,l||(x=64)),r.push(n[m],n[p],n[x],n[v])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(jw(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):wR(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<e.length;){const i=n[e.charAt(s++)],u=s<e.length?n[e.charAt(s)]:0;++s;const f=s<e.length?n[e.charAt(s)]:64;++s;const p=s<e.length?n[e.charAt(s)]:64;if(++s,i==null||u==null||f==null||p==null)throw new SR;const x=i<<2|u>>4;if(r.push(x),f!==64){const v=u<<4&240|f>>2;if(r.push(v),p!==64){const k=f<<6&192|p;r.push(k)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class SR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Rw=function(e){const t=jw(e);return fp.encodeByteArray(t,!0)},Qd=function(e){return Rw(e).replace(/\./g,"")},Nm=function(e){try{return fp.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _R(e){return Iw(void 0,e)}function Iw(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:const n=t;return new Date(n.getTime());case Object:e===void 0&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)!t.hasOwnProperty(n)||!CR(n)||(e[n]=Iw(e[n],t[n]));return e}function CR(e){return e!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ER=()=>NR().__FIREBASE_DEFAULTS__,TR=()=>{if(typeof process>"u"||typeof M1>"u")return;const e=M1.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},bR=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&Nm(e[1]);return t&&JSON.parse(t)},Pw=()=>{try{return kR()||ER()||TR()||bR()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},AR=e=>{var t,n;return(n=(t=Pw())==null?void 0:t.emulatorHosts)==null?void 0:n[e]},jR=e=>{const t=AR(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return t[0]==="["?[t.substring(1,n-1),r]:[t.substring(0,n),r]},Dw=()=>{var e;return(e=Pw())==null?void 0:e.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dh{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(n):t(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mp(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function RR(e){return(await fetch(e,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IR(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=t||"demo-project",s=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...e};return[Qd(JSON.stringify(n)),Qd(JSON.stringify(l)),""].join(".")}const pc={};function PR(){const e={prod:[],emulator:[]};for(const t of Object.keys(pc))pc[t]?e.emulator.push(t):e.prod.push(t);return e}function DR(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}let B1=!1;function OR(e,t){if(typeof window>"u"||typeof document>"u"||!mp(window.location.host)||pc[e]===t||pc[e]||B1)return;pc[e]=t;function n(x){return`__firebase__banner__${x}`}const r="__firebase__banner",i=PR().prod.length>0;function l(){const x=document.getElementById(r);x&&x.remove()}function u(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function d(x,v){x.setAttribute("width","24"),x.setAttribute("id",v),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function f(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{B1=!0,l()},x}function m(x,v){x.setAttribute("id",v),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function p(){const x=DR(r),v=n("text"),k=document.getElementById(v)||document.createElement("span"),y=n("learnmore"),S=document.getElementById(y)||document.createElement("a"),C=n("preprendIcon"),D=document.getElementById(C)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const N=x.element;u(N),m(S,y);const b=f();d(D,C),N.append(D,k,S,b),document.body.appendChild(N)}i?(k.innerText="Preview backend disconnected.",D.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(D.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,k.innerText="Preview backend running in this workspace."),k.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LR(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Ow(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(LR())}function FR(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function MR(){return Aw.NODE_ADMIN===!0}function BR(){try{return typeof indexedDB=="object"}catch{return!1}}function UR(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;t(((i=s.error)==null?void 0:i.message)||"")}}catch(n){t(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zR="FirebaseError";class nu extends Error{constructor(t,n,r){super(n),this.code=t,this.customData=r,this.name=zR,Object.setPrototypeOf(this,nu.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Lw.prototype.create)}}class Lw{constructor(t,n,r){this.service=t,this.serviceName=n,this.errors=r}create(t,...n){const r=n[0]||{},s=`${this.service}/${t}`,i=this.errors[t],l=i?WR(i,r):"Error",u=`${this.serviceName}: ${l} (${s}).`;return new nu(s,u,r)}}function WR(e,t){return e.replace(HR,(n,r)=>{const s=t[r];return s!=null?String(s):`<${r}?>`})}const HR=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jc(e){return JSON.parse(e)}function $n(e){return JSON.stringify(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fw=function(e){let t={},n={},r={},s="";try{const i=e.split(".");t=jc(Nm(i[0])||""),n=jc(Nm(i[1])||""),s=i[2],r=n.d||{},delete n.d}catch{}return{header:t,claims:n,data:r,signature:s}},GR=function(e){const t=Fw(e),n=t.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},$R=function(e){const t=Fw(e).claims;return typeof t=="object"&&t.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ss(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function nl(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]}function U1(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Jd(e,t,n){const r={};for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=t.call(n,e[s],s,e));return r}function Zd(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const s of n){if(!r.includes(s))return!1;const i=e[s],l=t[s];if(z1(i)&&z1(l)){if(!Zd(i,l))return!1}else if(i!==l)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function z1(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VR(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(s=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qR{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,n){n||(n=0);const r=this.W_;if(typeof t=="string")for(let p=0;p<16;p++)r[p]=t.charCodeAt(n)<<24|t.charCodeAt(n+1)<<16|t.charCodeAt(n+2)<<8|t.charCodeAt(n+3),n+=4;else for(let p=0;p<16;p++)r[p]=t[n]<<24|t[n+1]<<16|t[n+2]<<8|t[n+3],n+=4;for(let p=16;p<80;p++){const x=r[p-3]^r[p-8]^r[p-14]^r[p-16];r[p]=(x<<1|x>>>31)&4294967295}let s=this.chain_[0],i=this.chain_[1],l=this.chain_[2],u=this.chain_[3],d=this.chain_[4],f,m;for(let p=0;p<80;p++){p<40?p<20?(f=u^i&(l^u),m=1518500249):(f=i^l^u,m=1859775393):p<60?(f=i&l|u&(i|l),m=2400959708):(f=i^l^u,m=3395469782);const x=(s<<5|s>>>27)+f+d+m+r[p]&4294967295;d=u,u=l,l=(i<<30|i>>>2)&4294967295,i=s,s=x}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+l&4294967295,this.chain_[3]=this.chain_[3]+u&4294967295,this.chain_[4]=this.chain_[4]+d&4294967295}update(t,n){if(t==null)return;n===void 0&&(n=t.length);const r=n-this.blockSize;let s=0;const i=this.buf_;let l=this.inbuf_;for(;s<n;){if(l===0)for(;s<=r;)this.compress_(t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<n;)if(i[l]=t.charCodeAt(s),++l,++s,l===this.blockSize){this.compress_(i),l=0;break}}else for(;s<n;)if(i[l]=t[s],++l,++s,l===this.blockSize){this.compress_(i),l=0;break}}this.inbuf_=l,this.total_+=n}digest(){const t=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let s=0;s<5;s++)for(let i=24;i>=0;i-=8)t[r]=this.chain_[s]>>i&255,++r;return t}}function pp(e,t){return`${e} failed: ${t} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KR=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let s=e.charCodeAt(r);if(s>=55296&&s<=56319){const i=s-55296;r++,$e(r<e.length,"Surrogate pair missing trail surrogate.");const l=e.charCodeAt(r)-56320;s=65536+(i<<10)+l}s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=s&63|128):s<65536?(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=s&63|128):(t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=s&63|128)}return t},Oh=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ru(e){return e&&e._delegate?e._delegate:e}class Rc{constructor(t,n,r){this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YR{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const r=new Dh;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){const n=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),r=(t==null?void 0:t.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(QR(t))try{this.getOrInitializeService({instanceIdentifier:Pi})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(t=Pi){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Pi){return this.instances.has(t)}getOptions(t=Pi){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,l]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(i);r===u&&l.resolve(s)}return s}onInit(t,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(t),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&t(i,r),()=>{s.delete(t)}}invokeOnInitCallbacks(t,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:XR(t),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}return r||null}normalizeInstanceIdentifier(t=Pi){return this.component?this.component.multipleInstances?t:Pi:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function XR(e){return e===Pi?void 0:e}function QR(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JR{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new YR(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $t;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})($t||($t={}));const ZR={debug:$t.DEBUG,verbose:$t.VERBOSE,info:$t.INFO,warn:$t.WARN,error:$t.ERROR,silent:$t.SILENT},e4=$t.INFO,t4={[$t.DEBUG]:"log",[$t.VERBOSE]:"log",[$t.INFO]:"info",[$t.WARN]:"warn",[$t.ERROR]:"error"},n4=(e,t,...n)=>{if(t<e.logLevel)return;const r=new Date().toISOString(),s=t4[t];if(s)console[s](`[${r}]  ${e.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Mw{constructor(t){this.name=t,this._logLevel=e4,this._logHandler=n4,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in $t))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?ZR[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,$t.DEBUG,...t),this._logHandler(this,$t.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,$t.VERBOSE,...t),this._logHandler(this,$t.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,$t.INFO,...t),this._logHandler(this,$t.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,$t.WARN,...t),this._logHandler(this,$t.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,$t.ERROR,...t),this._logHandler(this,$t.ERROR,...t)}}const r4=(e,t)=>t.some(n=>e instanceof n);let W1,H1;function a4(){return W1||(W1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function s4(){return H1||(H1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Bw=new WeakMap,Em=new WeakMap,Uw=new WeakMap,$0=new WeakMap,gp=new WeakMap;function i4(e){const t=new Promise((n,r)=>{const s=()=>{e.removeEventListener("success",i),e.removeEventListener("error",l)},i=()=>{n(ti(e.result)),s()},l=()=>{r(e.error),s()};e.addEventListener("success",i),e.addEventListener("error",l)});return t.then(n=>{n instanceof IDBCursor&&Bw.set(n,e)}).catch(()=>{}),gp.set(t,e),t}function o4(e){if(Em.has(e))return;const t=new Promise((n,r)=>{const s=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",l),e.removeEventListener("abort",l)},i=()=>{n(),s()},l=()=>{r(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",i),e.addEventListener("error",l),e.addEventListener("abort",l)});Em.set(e,t)}let Tm={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return Em.get(e);if(t==="objectStoreNames")return e.objectStoreNames||Uw.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ti(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function l4(e){Tm=e(Tm)}function c4(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const r=e.call(V0(this),t,...n);return Uw.set(r,t.sort?t.sort():[t]),ti(r)}:s4().includes(e)?function(...t){return e.apply(V0(this),t),ti(Bw.get(this))}:function(...t){return ti(e.apply(V0(this),t))}}function u4(e){return typeof e=="function"?c4(e):(e instanceof IDBTransaction&&o4(e),r4(e,a4())?new Proxy(e,Tm):e)}function ti(e){if(e instanceof IDBRequest)return i4(e);if($0.has(e))return $0.get(e);const t=u4(e);return t!==e&&($0.set(e,t),gp.set(t,e)),t}const V0=e=>gp.get(e);function d4(e,t,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const l=indexedDB.open(e,t),u=ti(l);return r&&l.addEventListener("upgradeneeded",d=>{r(ti(l.result),d.oldVersion,d.newVersion,ti(l.transaction),d)}),n&&l.addEventListener("blocked",d=>n(d.oldVersion,d.newVersion,d)),u.then(d=>{i&&d.addEventListener("close",()=>i()),s&&d.addEventListener("versionchange",f=>s(f.oldVersion,f.newVersion,f))}).catch(()=>{}),u}const h4=["get","getKey","getAll","getAllKeys","count"],f4=["put","add","delete","clear"],q0=new Map;function G1(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(q0.get(t))return q0.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,s=f4.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||h4.includes(n)))return;const i=async function(l,...u){const d=this.transaction(l,s?"readwrite":"readonly");let f=d.store;return r&&(f=f.index(u.shift())),(await Promise.all([f[n](...u),s&&d.done]))[0]};return q0.set(t,i),i}l4(e=>({...e,get:(t,n,r)=>G1(t,n)||e.get(t,n,r),has:(t,n)=>!!G1(t,n)||e.has(t,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m4{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(p4(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function p4(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const bm="@firebase/app",$1="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xs=new Mw("@firebase/app"),g4="@firebase/app-compat",x4="@firebase/analytics-compat",v4="@firebase/analytics",y4="@firebase/app-check-compat",k4="@firebase/app-check",w4="@firebase/auth",S4="@firebase/auth-compat",_4="@firebase/database",C4="@firebase/data-connect",N4="@firebase/database-compat",E4="@firebase/functions",T4="@firebase/functions-compat",b4="@firebase/installations",A4="@firebase/installations-compat",j4="@firebase/messaging",R4="@firebase/messaging-compat",I4="@firebase/performance",P4="@firebase/performance-compat",D4="@firebase/remote-config",O4="@firebase/remote-config-compat",L4="@firebase/storage",F4="@firebase/storage-compat",M4="@firebase/firestore",B4="@firebase/ai",U4="@firebase/firestore-compat",z4="firebase",W4="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Am="[DEFAULT]",H4={[bm]:"fire-core",[g4]:"fire-core-compat",[v4]:"fire-analytics",[x4]:"fire-analytics-compat",[k4]:"fire-app-check",[y4]:"fire-app-check-compat",[w4]:"fire-auth",[S4]:"fire-auth-compat",[_4]:"fire-rtdb",[C4]:"fire-data-connect",[N4]:"fire-rtdb-compat",[E4]:"fire-fn",[T4]:"fire-fn-compat",[b4]:"fire-iid",[A4]:"fire-iid-compat",[j4]:"fire-fcm",[R4]:"fire-fcm-compat",[I4]:"fire-perf",[P4]:"fire-perf-compat",[D4]:"fire-rc",[O4]:"fire-rc-compat",[L4]:"fire-gcs",[F4]:"fire-gcs-compat",[M4]:"fire-fst",[U4]:"fire-fst-compat",[B4]:"fire-vertex","fire-js":"fire-js",[z4]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eh=new Map,G4=new Map,jm=new Map;function V1(e,t){try{e.container.addComponent(t)}catch(n){xs.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function th(e){const t=e.name;if(jm.has(t))return xs.debug(`There were multiple attempts to register component ${t}.`),!1;jm.set(t,e);for(const n of eh.values())V1(n,e);for(const n of G4.values())V1(n,e);return!0}function $4(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function V4(e){return e==null?!1:e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q4={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ni=new Lw("app","Firebase",q4);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K4{constructor(t,n,r){this._isDeleted=!1,this._options={...t},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Rc("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw ni.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y4=W4;function zw(e,t={}){let n=e;typeof t!="object"&&(t={name:t});const r={name:Am,automaticDataCollectionEnabled:!0,...t},s=r.name;if(typeof s!="string"||!s)throw ni.create("bad-app-name",{appName:String(s)});if(n||(n=Dw()),!n)throw ni.create("no-options");const i=eh.get(s);if(i){if(Zd(n,i.options)&&Zd(r,i.config))return i;throw ni.create("duplicate-app",{appName:s})}const l=new JR(s);for(const d of jm.values())l.addComponent(d);const u=new K4(n,r,l);return eh.set(s,u),u}function X4(e=Am){const t=eh.get(e);if(!t&&e===Am&&Dw())return zw();if(!t)throw ni.create("no-app",{appName:e});return t}function $o(e,t,n){let r=H4[e]??e;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=t.match(/\s|\//);if(s||i){const l=[`Unable to register library "${r}" with version "${t}":`];s&&l.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&l.push("and"),i&&l.push(`version name "${t}" contains illegal characters (whitespace or "/")`),xs.warn(l.join(" "));return}th(new Rc(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q4="firebase-heartbeat-database",J4=1,Ic="firebase-heartbeat-store";let K0=null;function Ww(){return K0||(K0=d4(Q4,J4,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(Ic)}catch(n){console.warn(n)}}}}).catch(e=>{throw ni.create("idb-open",{originalErrorMessage:e.message})})),K0}async function Z4(e){try{const n=(await Ww()).transaction(Ic),r=await n.objectStore(Ic).get(Hw(e));return await n.done,r}catch(t){if(t instanceof nu)xs.warn(t.message);else{const n=ni.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});xs.warn(n.message)}}}async function q1(e,t){try{const r=(await Ww()).transaction(Ic,"readwrite");await r.objectStore(Ic).put(t,Hw(e)),await r.done}catch(n){if(n instanceof nu)xs.warn(n.message);else{const r=ni.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});xs.warn(r.message)}}}function Hw(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eI=1024,tI=30;class nI{constructor(t){this.container=t,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new aI(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var t,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=K1();if(((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>tI){const l=sI(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){xs.warn(r)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=K1(),{heartbeatsToSend:r,unsentEntries:s}=rI(this._heartbeatsCache.heartbeats),i=Qd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return xs.warn(n),""}}}function K1(){return new Date().toISOString().substring(0,10)}function rI(e,t=eI){const n=[];let r=e.slice();for(const s of e){const i=n.find(l=>l.agent===s.agent);if(i){if(i.dates.push(s.date),Y1(n)>t){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Y1(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class aI{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return BR()?UR().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Z4(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const r=await this.read();return q1(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const r=await this.read();return q1(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...t.heartbeats]})}else return}}function Y1(e){return Qd(JSON.stringify({version:2,heartbeats:e})).length}function sI(e){if(e.length===0)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iI(e){th(new Rc("platform-logger",t=>new m4(t),"PRIVATE")),th(new Rc("heartbeat",t=>new nI(t),"PRIVATE")),$o(bm,$1,e),$o(bm,$1,"esm2020"),$o("fire-js","")}iI("");var oI="firebase",lI="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */$o(oI,lI,"app");var X1={};const Q1="@firebase/database",J1="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gw="";function cI(e){Gw=e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uI{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,n){n==null?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),$n(n))}get(t){const n=this.domStorage_.getItem(this.prefixedName_(t));return n==null?null:jc(n)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dI{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,n){n==null?delete this.cache_[t]:this.cache_[t]=n}get(t){return Ss(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $w=function(e){try{if(typeof window<"u"&&typeof window[e]<"u"){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new uI(t)}}catch{}return new dI},Fi=$w("localStorage"),hI=$w("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vo=new Mw("@firebase/database"),fI=(function(){let e=1;return function(){return e++}})(),Vw=function(e){const t=KR(e),n=new qR;n.update(t);const r=n.digest();return fp.encodeByteArray(r)},au=function(...e){let t="";for(let n=0;n<e.length;n++){const r=e[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?t+=au.apply(null,r):typeof r=="object"?t+=$n(r):t+=r,t+=" "}return t};let gc=null,Z1=!0;const mI=function(e,t){$e(!0,"Can't turn on custom loggers persistently."),Vo.logLevel=$t.VERBOSE,gc=Vo.log.bind(Vo)},cr=function(...e){if(Z1===!0&&(Z1=!1,gc===null&&hI.get("logging_enabled")===!0&&mI()),gc){const t=au.apply(null,e);gc(t)}},su=function(e){return function(...t){cr(e,...t)}},Rm=function(...e){const t="FIREBASE INTERNAL ERROR: "+au(...e);Vo.error(t)},vs=function(...e){const t=`FIREBASE FATAL ERROR: ${au(...e)}`;throw Vo.error(t),new Error(t)},Pr=function(...e){const t="FIREBASE WARNING: "+au(...e);Vo.warn(t)},pI=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Pr("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},qw=function(e){return typeof e=="number"&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},gI=function(e){if(document.readyState==="complete")e();else{let t=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}t||(t=!0,e())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},rl="[MIN_NAME]",$i="[MAX_NAME]",ml=function(e,t){if(e===t)return 0;if(e===rl||t===$i)return-1;if(t===rl||e===$i)return 1;{const n=ey(e),r=ey(t);return n!==null?r!==null?n-r===0?e.length-t.length:n-r:-1:r!==null?1:e<t?-1:1}},xI=function(e,t){return e===t?0:e<t?-1:1},ic=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+$n(t))},xp=function(e){if(typeof e!="object"||e===null)return $n(e);const t=[];for(const r in e)t.push(r);t.sort();let n="{";for(let r=0;r<t.length;r++)r!==0&&(n+=","),n+=$n(t[r]),n+=":",n+=xp(e[t[r]]);return n+="}",n},Kw=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let s=0;s<n;s+=t)s+t>n?r.push(e.substring(s,n)):r.push(e.substring(s,s+t));return r};function Lr(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const Yw=function(e){$e(!qw(e),"Invalid JSON number");const t=11,n=52,r=(1<<t-1)-1;let s,i,l,u,d;e===0?(i=0,l=0,s=1/e===-1/0?1:0):(s=e<0,e=Math.abs(e),e>=Math.pow(2,1-r)?(u=Math.min(Math.floor(Math.log(e)/Math.LN2),r),i=u+r,l=Math.round(e*Math.pow(2,n-u)-Math.pow(2,n))):(i=0,l=Math.round(e/Math.pow(2,1-r-n))));const f=[];for(d=n;d;d-=1)f.push(l%2?1:0),l=Math.floor(l/2);for(d=t;d;d-=1)f.push(i%2?1:0),i=Math.floor(i/2);f.push(s?1:0),f.reverse();const m=f.join("");let p="";for(d=0;d<64;d+=8){let x=parseInt(m.substr(d,8),2).toString(16);x.length===1&&(x="0"+x),p=p+x}return p.toLowerCase()},vI=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},yI=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function kI(e,t){let n="Unknown Error";e==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":e==="permission_denied"?n="Client doesn't have permission to access the desired data.":e==="unavailable"&&(n="The service is unavailable");const r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}const wI=new RegExp("^-?(0*)\\d{1,10}$"),SI=-2147483648,_I=2147483647,ey=function(e){if(wI.test(e)){const t=Number(e);if(t>=SI&&t<=_I)return t}return null},pl=function(e){try{e()}catch(t){setTimeout(()=>{const n=t.stack||"";throw Pr("Exception was thrown by user callback.",n),t},Math.floor(0))}},CI=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},xc=function(e,t){const n=setTimeout(e,t);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NI{constructor(t,n){this.appCheckProvider=n,this.appName=t.name,V4(t)&&t.settings.appCheckToken&&(this.serverAppAppCheckToken=t.settings.appCheckToken),this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(t){if(this.serverAppAppCheckToken){if(t)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(t):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(t).then(n,r):n(null)},0)})}addTokenChangeListener(t){var n;(n=this.appCheckProvider)==null||n.get().then(r=>r.addTokenListener(t))}notifyForInvalidToken(){Pr(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EI{constructor(t,n,r){this.appName_=t,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(s=>this.auth_=s)}getToken(t){return this.auth_?this.auth_.getToken(t).catch(n=>n&&n.code==="auth/token-not-initialized"?(cr("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(t).then(n,r):n(null)},0)})}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(n=>n.addAuthTokenListener(t))}removeTokenChangeListener(t){this.authProvider_.get().then(n=>n.removeAuthTokenListener(t))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Pr(t)}}class qd{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}qd.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vp="5",Xw="v",Qw="s",Jw="r",Zw="f",eS=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,tS="ls",nS="p",Im="ac",rS="websocket",aS="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(t,n,r,s,i=!1,l="",u=!1,d=!1,f=null){this.secure=n,this.namespace=r,this.webSocketOnly=s,this.nodeAdmin=i,this.persistenceKey=l,this.includeNamespaceInQueryParams=u,this.isUsingEmulator=d,this.emulatorOptions=f,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Fi.get("host:"+t)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&Fi.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){const t=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${t}${this.host}/${n}`}}function TI(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams}function iS(e,t,n){$e(typeof t=="string","typeof type must == string"),$e(typeof n=="object","typeof params must == object");let r;if(t===rS)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else if(t===aS)r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+t);TI(e)&&(n.ns=e.namespace);const s=[];return Lr(n,(i,l)=>{s.push(i+"="+l)}),r+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bI{constructor(){this.counters_={}}incrementCounter(t,n=1){Ss(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=n}get(){return _R(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y0={},X0={};function yp(e){const t=e.toString();return Y0[t]||(Y0[t]=new bI),Y0[t]}function AI(e,t){const n=e.toString();return X0[n]||(X0[n]=t()),X0[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jI{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,n){this.closeAfterResponse=t,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,n){for(this.pendingResponses[t]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<r.length;++s)r[s]&&pl(()=>{this.onMessage_(r[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ty="start",RI="close",II="pLPCommand",PI="pRTLPCB",oS="id",lS="pw",cS="ser",DI="cb",OI="seg",LI="ts",FI="d",MI="dframe",uS=1870,dS=30,BI=uS-dS,UI=25e3,zI=3e4;class Wo{constructor(t,n,r,s,i,l,u){this.connId=t,this.repoInfo=n,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.transportSessionId=l,this.lastSessionId=u,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=su(t),this.stats_=yp(n),this.urlFn=d=>(this.appCheckToken&&(d[Im]=this.appCheckToken),iS(n,aS,d))}open(t,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new jI(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(zI)),gI(()=>{if(this.isClosed_)return;this.scriptTagHolder=new kp((...i)=>{const[l,u,d,f,m]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,l===ty)this.id=u,this.password=d;else if(l===RI)u?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(u,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+l)},(...i)=>{const[l,u]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(l,u)},()=>{this.onClosed_()},this.urlFn);const r={};r[ty]="t",r[cS]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[DI]=this.scriptTagHolder.uniqueCallbackIdentifier),r[Xw]=vp,this.transportSessionId&&(r[Qw]=this.transportSessionId),this.lastSessionId&&(r[tS]=this.lastSessionId),this.applicationId&&(r[nS]=this.applicationId),this.appCheckToken&&(r[Im]=this.appCheckToken),typeof location<"u"&&location.hostname&&eS.test(location.hostname)&&(r[Jw]=Zw);const s=this.urlFn(r);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Wo.forceAllow_=!0}static forceDisallow(){Wo.forceDisallow_=!0}static isAvailable(){return Wo.forceAllow_?!0:!Wo.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!vI()&&!yI()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const n=$n(t);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=Rw(n),s=Kw(r,BI);for(let i=0;i<s.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[i]),this.curSegmentNum++}addDisconnectPingFrame(t,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[MI]="t",r[oS]=t,r[lS]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const n=$n(t).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class kp{constructor(t,n,r,s){this.onDisconnect=r,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=fI(),window[II+this.uniqueCallbackIdentifier]=t,window[PI+this.uniqueCallbackIdentifier]=n,this.myIFrame=kp.createIFrame_();let i="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(i='<script>document.domain="'+document.domain+'";<\/script>');const l="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(l),this.myIFrame.doc.close()}catch(u){cr("frame writing exception"),u.stack&&cr(u.stack),cr(u)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",document.body){document.body.appendChild(t);try{t.contentWindow.document||cr("No IE domain setting required")}catch{const r=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,n){for(this.myID=t,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t[oS]=this.myID,t[lS]=this.myPW,t[cS]=this.currentSerial;let n=this.urlFn(t),r="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+dS+r.length<=uS;){const l=this.pendingSegs.shift();r=r+"&"+OI+s+"="+l.seg+"&"+LI+s+"="+l.ts+"&"+FI+s+"="+l.d,s++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(t,n,r){this.pendingSegs.push({seg:t,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(t,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},s=setTimeout(r,Math.floor(UI)),i=()=>{clearTimeout(s),r()};this.addTag(t,i)}addTag(t,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){const s=r.readyState;(!s||s==="loaded"||s==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{cr("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WI=16384,HI=45e3;let nh=null;typeof MozWebSocket<"u"?nh=MozWebSocket:typeof WebSocket<"u"&&(nh=WebSocket);class Na{constructor(t,n,r,s,i,l,u){this.connId=t,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=su(this.connId),this.stats_=yp(n),this.connURL=Na.connectionURL_(n,l,u,s,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(t,n,r,s,i){const l={};return l[Xw]=vp,typeof location<"u"&&location.hostname&&eS.test(location.hostname)&&(l[Jw]=Zw),n&&(l[Qw]=n),r&&(l[tS]=r),s&&(l[Im]=s),i&&(l[nS]=i),iS(t,rS,l)}open(t,n){this.onDisconnect=n,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Fi.set("previous_websocket_failure",!0);try{let r;MR(),this.mySock=new nh(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){Na.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(t=!0)}return!t&&nh!==null&&!Na.forceDisallow_}static previouslyFailed(){return Fi.isInMemoryStorage||Fi.get("previous_websocket_failure")===!0}markConnectionHealthy(){Fi.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=jc(n);this.onMessage(r)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if($e(this.frames===null,"We already have a frame buffer"),t.length<=6){const n=Number(t);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;const n=t.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(t){this.resetKeepAlive();const n=$n(t);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=Kw(n,WI);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(HI))}sendString_(t){try{this.mySock.send(t)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Na.responsesRequiredToBeHealthy=2;Na.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pc{static get ALL_TRANSPORTS(){return[Wo,Na]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(t){this.initTransports_(t)}initTransports_(t){const n=Na&&Na.isAvailable();let r=n&&!Na.previouslyFailed();if(t.webSocketOnly&&(n||Pr("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[Na];else{const s=this.transports_=[];for(const i of Pc.ALL_TRANSPORTS)i&&i.isAvailable()&&s.push(i);Pc.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Pc.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GI=6e4,$I=5e3,VI=10*1024,qI=100*1024,Q0="t",ny="d",KI="s",ry="r",YI="e",ay="o",sy="a",iy="n",oy="p",XI="h";class QI{constructor(t,n,r,s,i,l,u,d,f,m){this.id=t,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=s,this.authToken_=i,this.onMessage_=l,this.onReady_=u,this.onDisconnect_=d,this.onKill_=f,this.lastSessionId=m,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=su("c:"+this.id+":"),this.transportManager_=new Pc(n),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const s=t.healthyTimeout||0;s>0&&(this.healthyTimeout_=xc(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>qI?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>VI?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return n=>{t===this.conn_?this.onConnectionLost_(n):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return n=>{this.state_!==2&&(t===this.rx_?this.onPrimaryMessageReceived_(n):t===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(t){const n={t:"d",d:t};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if(Q0 in t){const n=t[Q0];n===sy?this.upgradeIfSecondaryHealthy_():n===ry?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===ay&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const n=ic("t",t),r=ic("d",t);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:oy,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:sy,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:iy,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const n=ic("t",t),r=ic("d",t);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const n=ic(Q0,t);if(ny in t){const r=t[ny];if(n===XI){const s={...r};this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(n===iy){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===KI?this.onConnectionShutdown_(r):n===ry?this.onReset_(r):n===YI?Rm("Server Error: "+r):n===ay?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Rm("Unknown control packet command: "+n)}}onHandshake_(t){const n=t.ts,r=t.v,s=t.h;this.sessionId=t.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),vp!==r&&Pr("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),xc(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(GI))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,n){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):xc(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor($I))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:oy,d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===t||this.rx_===t)&&this.close()}onConnectionLost_(t){this.conn_=null,!t&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Fi.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(t)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hS{put(t,n,r,s){}merge(t,n,r,s){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,n,r){}onDisconnectMerge(t,n,r){}onDisconnectCancel(t,n){}reportStats(t){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(t){this.allowedEvents_=t,this.listeners_={},$e(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...n){if(Array.isArray(this.listeners_[t])){const r=[...this.listeners_[t]];for(let s=0;s<r.length;s++)r[s].callback.apply(r[s].context,n)}}on(t,n,r){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:n,context:r});const s=this.getInitialEvent(t);s&&n.apply(r,s)}off(t,n,r){this.validateEventType_(t);const s=this.listeners_[t]||[];for(let i=0;i<s.length;i++)if(s[i].callback===n&&(!r||r===s[i].context)){s.splice(i,1);return}}validateEventType_(t){$e(this.allowedEvents_.find(n=>n===t),"Unknown event: "+t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh extends fS{static getInstance(){return new rh}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Ow()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(t){return $e(t==="online","Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ly=32,cy=768;class zt{constructor(t,n){if(n===void 0){this.pieces_=t.split("/");let r=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[r]=this.pieces_[s],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=n}toString(){let t="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(t+="/"+this.pieces_[n]);return t||"/"}}function It(){return new zt("")}function yt(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function ii(e){return e.pieces_.length-e.pieceNum_}function Vt(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new zt(e.pieces_,t)}function mS(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function JI(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)e.pieces_[n]!==""&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}function pS(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function gS(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new zt(t,0)}function Rn(e,t){const n=[];for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof zt)for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);else{const r=t.split("/");for(let s=0;s<r.length;s++)r[s].length>0&&n.push(r[s])}return new zt(n,0)}function wt(e){return e.pieceNum_>=e.pieces_.length}function Rr(e,t){const n=yt(e),r=yt(t);if(n===null)return t;if(n===r)return Rr(Vt(e),Vt(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function wp(e,t){if(ii(e)!==ii(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function Ta(e,t){let n=e.pieceNum_,r=t.pieceNum_;if(ii(e)>ii(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}class ZI{constructor(t,n){this.errorPrefix_=n,this.parts_=pS(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Oh(this.parts_[r]);xS(this)}}function eP(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=Oh(t),xS(e)}function tP(e){const t=e.parts_.pop();e.byteLength_-=Oh(t),e.parts_.length>0&&(e.byteLength_-=1)}function xS(e){if(e.byteLength_>cy)throw new Error(e.errorPrefix_+"has a key path longer than "+cy+" bytes ("+e.byteLength_+").");if(e.parts_.length>ly)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+ly+") or object contains a cycle "+Di(e))}function Di(e){return e.parts_.length===0?"":"in property '"+e.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp extends fS{static getInstance(){return new Sp}constructor(){super(["visible"]);let t,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",t="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",t="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",t="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[t];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(t){return $e(t==="visible","Unknown event type: "+t),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oc=1e3,nP=300*1e3,uy=30*1e3,rP=1.3,aP=3e4,sP="server_kill",dy=3;class ds extends hS{constructor(t,n,r,s,i,l,u,d){if(super(),this.repoInfo_=t,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=i,this.authTokenProvider_=l,this.appCheckTokenProvider_=u,this.authOverride_=d,this.id=ds.nextPersistentConnectionId_++,this.log_=su("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=oc,this.maxReconnectDelay_=nP,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,d)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Sp.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&rh.getInstance().on("online",this.onOnline_,this)}sendRequest(t,n,r){const s=++this.requestNumber_,i={r:s,a:t,b:n};this.log_($n(i)),$e(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),r&&(this.requestCBHash_[s]=r)}get(t){this.initConnection_();const n=new Dh,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:l=>{const u=l.d;l.s==="ok"?n.resolve(u):n.reject(u)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),n.promise}listen(t,n,r,s){this.initConnection_();const i=t._queryIdentifier,l=t._path.toString();this.log_("Listen called for "+l+" "+i),this.listens.has(l)||this.listens.set(l,new Map),$e(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),$e(!this.listens.get(l).has(i),"listen() called twice for same path/queryId.");const u={onComplete:s,hashFn:n,query:t,tag:r};this.listens.get(l).set(i,u),this.connected_&&this.sendListen_(u)}sendGet_(t){const n=this.outstandingGets_[t];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(t){const n=t.query,r=n._path.toString(),s=n._queryIdentifier;this.log_("Listen on "+r+" for "+s);const i={p:r},l="q";t.tag&&(i.q=n._queryObject,i.t=t.tag),i.h=t.hashFn(),this.sendRequest(l,i,u=>{const d=u.d,f=u.s;ds.warnOnListenWarnings_(d,n),(this.listens.get(r)&&this.listens.get(r).get(s))===t&&(this.log_("listen response",u),f!=="ok"&&this.removeListen_(r,s),t.onComplete&&t.onComplete(f,d))})}static warnOnListenWarnings_(t,n){if(t&&typeof t=="object"&&Ss(t,"w")){const r=nl(t,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+n._queryParams.getIndex().toString()+'"',i=n._path.toString();Pr(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||$R(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=uy)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,n=GR(t)?"auth":"gauth",r={cred:t};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,s=>{const i=s.s,l=s.d||"error";this.authToken_===t&&(i==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,l))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const n=t.s,r=t.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(t,n){const r=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),$e(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,t._queryObject,n)}sendUnlisten_(t,n,r,s){this.log_("Unlisten on "+t+" for "+n);const i={p:t},l="n";s&&(i.q=r,i.t=s),this.sendRequest(l,i)}onDisconnectPut(t,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,n,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:n,onComplete:r})}onDisconnectMerge(t,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,n,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:n,onComplete:r})}onDisconnectCancel(t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(t,n,r,s){const i={p:n,d:r};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,l=>{s&&setTimeout(()=>{s(l.s,l.d)},Math.floor(0))})}put(t,n,r,s){this.putInternal("p",t,n,r,s)}merge(t,n,r,s){this.putInternal("m",t,n,r,s)}putInternal(t,n,r,s,i){this.initConnection_();const l={p:n,d:r};i!==void 0&&(l.h=i),this.outstandingPuts_.push({action:t,request:l,onComplete:s}),this.outstandingPutCount_++;const u=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(u):this.log_("Buffering put: "+n)}sendPut_(t){const n=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,r,i=>{this.log_(n+" response",i),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(i.s,i.d)})}reportStats(t){if(this.connected_){const n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const i=r.d;this.log_("reportStats","Error sending stats: "+i)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+$n(t));const n=t.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,n){this.log_("handleServerMessage",t,n),t==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):t==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):t==="c"?this.onListenRevoked_(n.p,n.q):t==="ac"?this.onAuthRevoked_(n.s,n.d):t==="apc"?this.onAppCheckRevoked_(n.s,n.d):t==="sd"?this.onSecurityDebugPacket_(n):Rm("Unrecognized action received from server: "+$n(t)+`
Are you using the latest client?`)}onReady_(t,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){$e(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=oc,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=oc,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>aP&&(this.reconnectDelay_=oc),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const t=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let n=Math.max(0,this.reconnectDelay_-t);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*rP)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+ds.nextConnectionId_++,i=this.lastSessionId;let l=!1,u=null;const d=function(){u?u.close():(l=!0,r())},f=function(p){$e(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(p)};this.realtime_={close:d,sendRequest:f};const m=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[p,x]=await Promise.all([this.authTokenProvider_.getToken(m),this.appCheckTokenProvider_.getToken(m)]);l?cr("getToken() completed but was canceled"):(cr("getToken() completed. Creating connection."),this.authToken_=p&&p.accessToken,this.appCheckToken_=x&&x.token,u=new QI(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,n,r,v=>{Pr(v+" ("+this.repoInfo_.toString()+")"),this.interrupt(sP)},i))}catch(p){this.log_("Failed to get token: "+p),l||(this.repoInfo_.nodeAdmin&&Pr(p),d())}}}interrupt(t){cr("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){cr("Resuming connection for reason: "+t),delete this.interruptReasons_[t],U1(this.interruptReasons_)&&(this.reconnectDelay_=oc,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const n=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const n=this.outstandingPuts_[t];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,n){let r;n?r=n.map(i=>xp(i)).join("$"):r="default";const s=this.removeListen_(t,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,n){const r=new zt(t).toString();let s;if(this.listens.has(r)){const i=this.listens.get(r);s=i.get(n),i.delete(n),i.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(t,n){cr("Auth token revoked: "+t+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=dy&&(this.reconnectDelay_=uy,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,n){cr("App check token revoked: "+t+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=dy&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const n of t.values())this.sendListen_(n);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let n="js";t["sdk."+n+"."+Gw.replace(/\./g,"-")]=1,Ow()?t["framework.cordova"]=1:FR()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=rh.getInstance().currentlyOnline();return U1(this.interruptReasons_)&&t}}ds.nextPersistentConnectionId_=0;ds.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(t,n){this.name=t,this.node=n}static Wrap(t,n){return new kt(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,n){const r=new kt(rl,t),s=new kt(rl,n);return this.compare(r,s)!==0}minPost(){return kt.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ad;class vS extends Lh{static get __EMPTY_NODE(){return Ad}static set __EMPTY_NODE(t){Ad=t}compare(t,n){return ml(t.name,n.name)}isDefinedOn(t){throw fl("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,n){return!1}minPost(){return kt.MIN}maxPost(){return new kt($i,Ad)}makePost(t,n){return $e(typeof t=="string","KeyIndex indexValue must always be a string."),new kt(t,Ad)}toString(){return".key"}}const qo=new vS;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jd{constructor(t,n,r,s,i=null){this.isReverse_=s,this.resultGenerator_=i,this.nodeStack_=[];let l=1;for(;!t.isEmpty();)if(t=t,l=n?r(t.key,n):1,s&&(l*=-1),l<0)this.isReverse_?t=t.left:t=t.right;else if(l===0){this.nodeStack_.push(t);break}else this.nodeStack_.push(t),this.isReverse_?t=t.right:t=t.left}getNext(){if(this.nodeStack_.length===0)return null;let t=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(t.key,t.value):n={key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}class Hn{constructor(t,n,r,s,i){this.key=t,this.value=n,this.color=r??Hn.RED,this.left=s??Ir.EMPTY_NODE,this.right=i??Ir.EMPTY_NODE}copy(t,n,r,s,i){return new Hn(t??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,r){let s=this;const i=r(t,s.key);return i<0?s=s.copy(null,null,null,s.left.insert(t,n,r),null):i===0?s=s.copy(null,n,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,n,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Ir.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,n){let r,s;if(r=this,n(t,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(t,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(t,r.key)===0){if(r.right.isEmpty())return Ir.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(t,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,Hn.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,Hn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}Hn.RED=!0;Hn.BLACK=!1;class iP{copy(t,n,r,s,i){return this}insert(t,n,r){return new Hn(t,n,null)}remove(t,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Ir{constructor(t,n=Ir.EMPTY_NODE){this.comparator_=t,this.root_=n}insert(t,n){return new Ir(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,Hn.BLACK,null,null))}remove(t){return new Ir(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,Hn.BLACK,null,null))}get(t){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(t,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(t){let n,r=this.root_,s=null;for(;!r.isEmpty();)if(n=this.comparator_(t,r.key),n===0){if(r.left.isEmpty())return s?s.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(s=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new jd(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,n){return new jd(this.root_,t,this.comparator_,!1,n)}getReverseIteratorFrom(t,n){return new jd(this.root_,t,this.comparator_,!0,n)}getReverseIterator(t){return new jd(this.root_,null,this.comparator_,!0,t)}}Ir.EMPTY_NODE=new iP;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oP(e,t){return ml(e.name,t.name)}function _p(e,t){return ml(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pm;function lP(e){Pm=e}const yS=function(e){return typeof e=="number"?"number:"+Yw(e):"string:"+e},kS=function(e){if(e.isLeafNode()){const t=e.val();$e(typeof t=="string"||typeof t=="number"||typeof t=="object"&&Ss(t,".sv"),"Priority must be a string or number.")}else $e(e===Pm||e.isEmpty(),"priority of unexpected type.");$e(e===Pm||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hy;class zn{static set __childrenNodeConstructor(t){hy=t}static get __childrenNodeConstructor(){return hy}constructor(t,n=zn.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=n,this.lazyHash_=null,$e(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),kS(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new zn(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:zn.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return wt(t)?this:yt(t)===".priority"?this.priorityNode_:zn.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,n){return null}updateImmediateChild(t,n){return t===".priority"?this.updatePriority(n):n.isEmpty()&&t!==".priority"?this:zn.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)}updateChild(t,n){const r=yt(t);return r===null?n:n.isEmpty()&&r!==".priority"?this:($e(r!==".priority"||ii(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,zn.__childrenNodeConstructor.EMPTY_NODE.updateChild(Vt(t),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,n){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+yS(this.priorityNode_.val())+":");const n=typeof this.value_;t+=n+":",n==="number"?t+=Yw(this.value_):t+=this.value_,this.lazyHash_=Vw(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===zn.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof zn.__childrenNodeConstructor?-1:($e(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const n=typeof t.value_,r=typeof this.value_,s=zn.VALUE_TYPE_ORDER.indexOf(n),i=zn.VALUE_TYPE_ORDER.indexOf(r);return $e(s>=0,"Unknown leaf type: "+n),$e(i>=0,"Unknown leaf type: "+r),s===i?r==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:i-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const n=t;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}zn.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wS,SS;function cP(e){wS=e}function uP(e){SS=e}class dP extends Lh{compare(t,n){const r=t.node.getPriority(),s=n.node.getPriority(),i=r.compareTo(s);return i===0?ml(t.name,n.name):i}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,n){return!t.getPriority().equals(n.getPriority())}minPost(){return kt.MIN}maxPost(){return new kt($i,new zn("[PRIORITY-POST]",SS))}makePost(t,n){const r=wS(t);return new kt(n,new zn("[PRIORITY-POST]",r))}toString(){return".priority"}}const fn=new dP;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hP=Math.log(2);class fP{constructor(t){const n=i=>parseInt(Math.log(i)/hP,10),r=i=>parseInt(Array(i+1).join("1"),2);this.count=n(t+1),this.current_=this.count-1;const s=r(this.count);this.bits_=t+1&s}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const ah=function(e,t,n,r){e.sort(t);const s=function(d,f){const m=f-d;let p,x;if(m===0)return null;if(m===1)return p=e[d],x=n?n(p):p,new Hn(x,p.node,Hn.BLACK,null,null);{const v=parseInt(m/2,10)+d,k=s(d,v),y=s(v+1,f);return p=e[v],x=n?n(p):p,new Hn(x,p.node,Hn.BLACK,k,y)}},i=function(d){let f=null,m=null,p=e.length;const x=function(k,y){const S=p-k,C=p;p-=k;const D=s(S+1,C),N=e[S],b=n?n(N):N;v(new Hn(b,N.node,y,null,D))},v=function(k){f?(f.left=k,f=k):(m=k,f=k)};for(let k=0;k<d.count;++k){const y=d.nextBitIsOne(),S=Math.pow(2,d.count-(k+1));y?x(S,Hn.BLACK):(x(S,Hn.BLACK),x(S,Hn.RED))}return m},l=new fP(e.length),u=i(l);return new Ir(r||t,u)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let J0;const Lo={};class os{static get Default(){return $e(Lo&&fn,"ChildrenNode.ts has not been loaded"),J0=J0||new os({".priority":Lo},{".priority":fn}),J0}constructor(t,n){this.indexes_=t,this.indexSet_=n}get(t){const n=nl(this.indexes_,t);if(!n)throw new Error("No index defined for "+t);return n instanceof Ir?n:null}hasIndex(t){return Ss(this.indexSet_,t.toString())}addIndex(t,n){$e(t!==qo,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let s=!1;const i=n.getIterator(kt.Wrap);let l=i.getNext();for(;l;)s=s||t.isDefinedOn(l.node),r.push(l),l=i.getNext();let u;s?u=ah(r,t.getCompare()):u=Lo;const d=t.toString(),f={...this.indexSet_};f[d]=t;const m={...this.indexes_};return m[d]=u,new os(m,f)}addToIndexes(t,n){const r=Jd(this.indexes_,(s,i)=>{const l=nl(this.indexSet_,i);if($e(l,"Missing index implementation for "+i),s===Lo)if(l.isDefinedOn(t.node)){const u=[],d=n.getIterator(kt.Wrap);let f=d.getNext();for(;f;)f.name!==t.name&&u.push(f),f=d.getNext();return u.push(t),ah(u,l.getCompare())}else return Lo;else{const u=n.get(t.name);let d=s;return u&&(d=d.remove(new kt(t.name,u))),d.insert(t,t.node)}});return new os(r,this.indexSet_)}removeFromIndexes(t,n){const r=Jd(this.indexes_,s=>{if(s===Lo)return s;{const i=n.get(t.name);return i?s.remove(new kt(t.name,i)):s}});return new os(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lc;class ct{static get EMPTY_NODE(){return lc||(lc=new ct(new Ir(_p),null,os.Default))}constructor(t,n,r){this.children_=t,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&kS(this.priorityNode_),this.children_.isEmpty()&&$e(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||lc}updatePriority(t){return this.children_.isEmpty()?this:new ct(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{const n=this.children_.get(t);return n===null?lc:n}}getChild(t){const n=yt(t);return n===null?this:this.getImmediateChild(n).getChild(Vt(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,n){if($e(n,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(n);{const r=new kt(t,n);let s,i;n.isEmpty()?(s=this.children_.remove(t),i=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(t,n),i=this.indexMap_.addToIndexes(r,this.children_));const l=s.isEmpty()?lc:this.priorityNode_;return new ct(s,l,i)}}updateChild(t,n){const r=yt(t);if(r===null)return n;{$e(yt(t)!==".priority"||ii(t)===1,".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild(Vt(t),n);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const n={};let r=0,s=0,i=!0;if(this.forEachChild(fn,(l,u)=>{n[l]=u.val(t),r++,i&&ct.INTEGER_REGEXP_.test(l)?s=Math.max(s,Number(l)):i=!1}),!t&&i&&s<2*r){const l=[];for(const u in n)l[u]=n[u];return l}else return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+yS(this.getPriority().val())+":"),this.forEachChild(fn,(n,r)=>{const s=r.hash();s!==""&&(t+=":"+n+":"+s)}),this.lazyHash_=t===""?"":Vw(t)}return this.lazyHash_}getPredecessorChildName(t,n,r){const s=this.resolveIndex_(r);if(s){const i=s.getPredecessorKey(new kt(t,n));return i?i.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){const n=this.resolveIndex_(t);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(t){const n=this.getFirstChildName(t);return n?new kt(n,this.children_.get(n)):null}getLastChildName(t){const n=this.resolveIndex_(t);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(t){const n=this.getLastChildName(t);return n?new kt(n,this.children_.get(n)):null}forEachChild(t,n){const r=this.resolveIndex_(t);return r?r.inorderTraversal(s=>n(s.name,s.node)):this.children_.inorderTraversal(n)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(t,s=>s);{const s=this.children_.getIteratorFrom(t.name,kt.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,t)<0;)s.getNext(),i=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(t,s=>s);{const s=this.children_.getReverseIteratorFrom(t.name,kt.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,t)>0;)s.getNext(),i=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===iu?-1:0}withIndex(t){if(t===qo||this.indexMap_.hasIndex(t))return this;{const n=this.indexMap_.addIndex(t,this.children_);return new ct(this.children_,this.priorityNode_,n)}}isIndexed(t){return t===qo||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const n=t;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator(fn),s=n.getIterator(fn);let i=r.getNext(),l=s.getNext();for(;i&&l;){if(i.name!==l.name||!i.node.equals(l.node))return!1;i=r.getNext(),l=s.getNext()}return i===null&&l===null}else return!1;else return!1}}resolveIndex_(t){return t===qo?null:this.indexMap_.get(t.toString())}}ct.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class mP extends ct{constructor(){super(new Ir(_p),ct.EMPTY_NODE,os.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return ct.EMPTY_NODE}isEmpty(){return!1}}const iu=new mP;Object.defineProperties(kt,{MIN:{value:new kt(rl,ct.EMPTY_NODE)},MAX:{value:new kt($i,iu)}});vS.__EMPTY_NODE=ct.EMPTY_NODE;zn.__childrenNodeConstructor=ct;lP(iu);uP(iu);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pP=!0;function Jn(e,t=null){if(e===null)return ct.EMPTY_NODE;if(typeof e=="object"&&".priority"in e&&(t=e[".priority"]),$e(t===null||typeof t=="string"||typeof t=="number"||typeof t=="object"&&".sv"in t,"Invalid priority type found: "+typeof t),typeof e=="object"&&".value"in e&&e[".value"]!==null&&(e=e[".value"]),typeof e!="object"||".sv"in e){const n=e;return new zn(n,Jn(t))}if(!(e instanceof Array)&&pP){const n=[];let r=!1;if(Lr(e,(l,u)=>{if(l.substring(0,1)!=="."){const d=Jn(u);d.isEmpty()||(r=r||!d.getPriority().isEmpty(),n.push(new kt(l,d)))}}),n.length===0)return ct.EMPTY_NODE;const i=ah(n,oP,l=>l.name,_p);if(r){const l=ah(n,fn.getCompare());return new ct(i,Jn(t),new os({".priority":l},{".priority":fn}))}else return new ct(i,Jn(t),os.Default)}else{let n=ct.EMPTY_NODE;return Lr(e,(r,s)=>{if(Ss(e,r)&&r.substring(0,1)!=="."){const i=Jn(s);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(r,i))}}),n.updatePriority(Jn(t))}}cP(Jn);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gP extends Lh{constructor(t){super(),this.indexPath_=t,$e(!wt(t)&&yt(t)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,n){const r=this.extractChild(t.node),s=this.extractChild(n.node),i=r.compareTo(s);return i===0?ml(t.name,n.name):i}makePost(t,n){const r=Jn(t),s=ct.EMPTY_NODE.updateChild(this.indexPath_,r);return new kt(n,s)}maxPost(){const t=ct.EMPTY_NODE.updateChild(this.indexPath_,iu);return new kt($i,t)}toString(){return pS(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xP extends Lh{compare(t,n){const r=t.node.compareTo(n.node);return r===0?ml(t.name,n.name):r}isDefinedOn(t){return!0}indexedValueChanged(t,n){return!t.equals(n)}minPost(){return kt.MIN}maxPost(){return kt.MAX}makePost(t,n){const r=Jn(t);return new kt(n,r)}toString(){return".value"}}const vP=new xP;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _S(e){return{type:"value",snapshotNode:e}}function al(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function Dc(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function Oc(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}function yP(e,t){return{type:"child_moved",snapshotNode:t,childName:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cp{constructor(t){this.index_=t}updateChild(t,n,r,s,i,l){$e(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");const u=t.getImmediateChild(n);return u.getChild(s).equals(r.getChild(s))&&u.isEmpty()===r.isEmpty()||(l!=null&&(r.isEmpty()?t.hasChild(n)?l.trackChildChange(Dc(n,u)):$e(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):u.isEmpty()?l.trackChildChange(al(n,r)):l.trackChildChange(Oc(n,r,u))),t.isLeafNode()&&r.isEmpty())?t:t.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(t,n,r){return r!=null&&(t.isLeafNode()||t.forEachChild(fn,(s,i)=>{n.hasChild(s)||r.trackChildChange(Dc(s,i))}),n.isLeafNode()||n.forEachChild(fn,(s,i)=>{if(t.hasChild(s)){const l=t.getImmediateChild(s);l.equals(i)||r.trackChildChange(Oc(s,i,l))}else r.trackChildChange(al(s,i))})),n.withIndex(this.index_)}updatePriority(t,n){return t.isEmpty()?ct.EMPTY_NODE:t.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lc{constructor(t){this.indexedFilter_=new Cp(t.getIndex()),this.index_=t.getIndex(),this.startPost_=Lc.getStartPost_(t),this.endPost_=Lc.getEndPost_(t),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(t){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),t)<=0:this.index_.compare(this.getStartPost(),t)<0,r=this.endIsInclusive_?this.index_.compare(t,this.getEndPost())<=0:this.index_.compare(t,this.getEndPost())<0;return n&&r}updateChild(t,n,r,s,i,l){return this.matches(new kt(n,r))||(r=ct.EMPTY_NODE),this.indexedFilter_.updateChild(t,n,r,s,i,l)}updateFullNode(t,n,r){n.isLeafNode()&&(n=ct.EMPTY_NODE);let s=n.withIndex(this.index_);s=s.updatePriority(ct.EMPTY_NODE);const i=this;return n.forEachChild(fn,(l,u)=>{i.matches(new kt(l,u))||(s=s.updateImmediateChild(l,ct.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,s,r)}updatePriority(t,n){return t}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(t){if(t.hasStart()){const n=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),n)}else return t.getIndex().minPost()}static getEndPost_(t){if(t.hasEnd()){const n=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),n)}else return t.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kP{constructor(t){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Lc(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft(),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}updateChild(t,n,r,s,i,l){return this.rangedFilter_.matches(new kt(n,r))||(r=ct.EMPTY_NODE),t.getImmediateChild(n).equals(r)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,n,r,s,i,l):this.fullLimitUpdateChild_(t,n,r,i,l)}updateFullNode(t,n,r){let s;if(n.isLeafNode()||n.isEmpty())s=ct.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){s=ct.EMPTY_NODE.withIndex(this.index_);let i;this.reverse_?i=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):i=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let l=0;for(;i.hasNext()&&l<this.limit_;){const u=i.getNext();if(this.withinDirectionalStart(u))if(this.withinDirectionalEnd(u))s=s.updateImmediateChild(u.name,u.node),l++;else break;else continue}}else{s=n.withIndex(this.index_),s=s.updatePriority(ct.EMPTY_NODE);let i;this.reverse_?i=s.getReverseIterator(this.index_):i=s.getIterator(this.index_);let l=0;for(;i.hasNext();){const u=i.getNext();l<this.limit_&&this.withinDirectionalStart(u)&&this.withinDirectionalEnd(u)?l++:s=s.updateImmediateChild(u.name,ct.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,s,r)}updatePriority(t,n){return t}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(t,n,r,s,i){let l;if(this.reverse_){const p=this.index_.getCompare();l=(x,v)=>p(v,x)}else l=this.index_.getCompare();const u=t;$e(u.numChildren()===this.limit_,"");const d=new kt(n,r),f=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),m=this.rangedFilter_.matches(d);if(u.hasChild(n)){const p=u.getImmediateChild(n);let x=s.getChildAfterChild(this.index_,f,this.reverse_);for(;x!=null&&(x.name===n||u.hasChild(x.name));)x=s.getChildAfterChild(this.index_,x,this.reverse_);const v=x==null?1:l(x,d);if(m&&!r.isEmpty()&&v>=0)return i!=null&&i.trackChildChange(Oc(n,r,p)),u.updateImmediateChild(n,r);{i!=null&&i.trackChildChange(Dc(n,p));const y=u.updateImmediateChild(n,ct.EMPTY_NODE);return x!=null&&this.rangedFilter_.matches(x)?(i!=null&&i.trackChildChange(al(x.name,x.node)),y.updateImmediateChild(x.name,x.node)):y}}else return r.isEmpty()?t:m&&l(f,d)>=0?(i!=null&&(i.trackChildChange(Dc(f.name,f.node)),i.trackChildChange(al(n,r))),u.updateImmediateChild(n,r).updateImmediateChild(f.name,ct.EMPTY_NODE)):t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Np{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=fn}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return $e(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return $e(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:rl}hasEnd(){return this.endSet_}getIndexEndValue(){return $e(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return $e(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:$i}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return $e(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===fn}copy(){const t=new Np;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function wP(e){return e.loadsAllData()?new Cp(e.getIndex()):e.hasLimit()?new kP(e):new Lc(e)}function fy(e){const t={};if(e.isDefault())return t;let n;if(e.index_===fn?n="$priority":e.index_===vP?n="$value":e.index_===qo?n="$key":($e(e.index_ instanceof gP,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=$n(n),e.startSet_){const r=e.startAfterSet_?"startAfter":"startAt";t[r]=$n(e.indexStartValue_),e.startNameSet_&&(t[r]+=","+$n(e.indexStartName_))}if(e.endSet_){const r=e.endBeforeSet_?"endBefore":"endAt";t[r]=$n(e.indexEndValue_),e.endNameSet_&&(t[r]+=","+$n(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function my(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;n===""&&(e.isViewFromLeft()?n="l":n="r"),t.vf=n}return e.index_!==fn&&(t.i=e.index_.toString()),t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sh extends hS{reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,n){return n!==void 0?"tag$"+n:($e(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}constructor(t,n,r,s){super(),this.repoInfo_=t,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=s,this.log_=su("p:rest:"),this.listens_={}}listen(t,n,r,s){const i=t._path.toString();this.log_("Listen called for "+i+" "+t._queryIdentifier);const l=sh.getListenId_(t,r),u={};this.listens_[l]=u;const d=fy(t._queryParams);this.restRequest_(i+".json",d,(f,m)=>{let p=m;if(f===404&&(p=null,f=null),f===null&&this.onDataUpdate_(i,p,!1,r),nl(this.listens_,l)===u){let x;f?f===401?x="permission_denied":x="rest_error:"+f:x="ok",s(x,null)}})}unlisten(t,n){const r=sh.getListenId_(t,n);delete this.listens_[r]}get(t){const n=fy(t._queryParams),r=t._path.toString(),s=new Dh;return this.restRequest_(r+".json",n,(i,l)=>{let u=l;i===404&&(u=null,i=null),i===null?(this.onDataUpdate_(r,u,!1,null),s.resolve(u)):s.reject(new Error(u))}),s.promise}refreshAuthToken(t){}restRequest_(t,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,i])=>{s&&s.accessToken&&(n.auth=s.accessToken),i&&i.token&&(n.ac=i.token);const l=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+VR(n);this.log_("Sending REST request for "+l);const u=new XMLHttpRequest;u.onreadystatechange=()=>{if(r&&u.readyState===4){this.log_("REST Response for "+l+" received. status:",u.status,"response:",u.responseText);let d=null;if(u.status>=200&&u.status<300){try{d=jc(u.responseText)}catch{Pr("Failed to parse JSON response for "+l+": "+u.responseText)}r(null,d)}else u.status!==401&&u.status!==404&&Pr("Got unsuccessful REST response for "+l+" Status: "+u.status),r(u.status);r=null}},u.open("GET",l,!0),u.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SP{constructor(){this.rootNode_=ct.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,n){this.rootNode_=this.rootNode_.updateChild(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ih(){return{value:null,children:new Map}}function CS(e,t,n){if(wt(t))e.value=n,e.children.clear();else if(e.value!==null)e.value=e.value.updateChild(t,n);else{const r=yt(t);e.children.has(r)||e.children.set(r,ih());const s=e.children.get(r);t=Vt(t),CS(s,t,n)}}function Dm(e,t,n){e.value!==null?n(t,e.value):_P(e,(r,s)=>{const i=new zt(t.toString()+"/"+r);Dm(s,i,n)})}function _P(e,t){e.children.forEach((n,r)=>{t(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CP{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),n={...t};return this.last_&&Lr(this.last_,(r,s)=>{n[r]=n[r]-s}),this.last_=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const py=10*1e3,NP=30*1e3,EP=300*1e3;class TP{constructor(t,n){this.server_=n,this.statsToReport_={},this.statsListener_=new CP(t);const r=py+(NP-py)*Math.random();xc(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const t=this.statsListener_.get(),n={};let r=!1;Lr(t,(s,i)=>{i>0&&Ss(this.statsToReport_,s)&&(n[s]=i,r=!0)}),r&&this.server_.reportStats(n),xc(this.reportStats_.bind(this),Math.floor(Math.random()*2*EP))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ba;(function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(ba||(ba={}));function NS(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Ep(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Tp(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oh{constructor(t,n,r){this.path=t,this.affectedTree=n,this.revert=r,this.type=ba.ACK_USER_WRITE,this.source=NS()}operationForChild(t){if(wt(this.path)){if(this.affectedTree.value!=null)return $e(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new zt(t));return new oh(It(),n,this.revert)}}else return $e(yt(this.path)===t,"operationForChild called for unrelated child."),new oh(Vt(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc{constructor(t,n){this.source=t,this.path=n,this.type=ba.LISTEN_COMPLETE}operationForChild(t){return wt(this.path)?new Fc(this.source,It()):new Fc(this.source,Vt(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(t,n,r){this.source=t,this.path=n,this.snap=r,this.type=ba.OVERWRITE}operationForChild(t){return wt(this.path)?new Vi(this.source,It(),this.snap.getImmediateChild(t)):new Vi(this.source,Vt(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mc{constructor(t,n,r){this.source=t,this.path=n,this.children=r,this.type=ba.MERGE}operationForChild(t){if(wt(this.path)){const n=this.children.subtree(new zt(t));return n.isEmpty()?null:n.value?new Vi(this.source,It(),n.value):new Mc(this.source,It(),n)}else return $e(yt(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new Mc(this.source,Vt(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(t,n,r){this.node_=t,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if(wt(t))return this.isFullyInitialized()&&!this.filtered_;const n=yt(t);return this.isCompleteForChild(n)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bP{constructor(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}function AP(e,t,n,r){const s=[],i=[];return t.forEach(l=>{l.type==="child_changed"&&e.index_.indexedValueChanged(l.oldSnap,l.snapshotNode)&&i.push(yP(l.childName,l.snapshotNode))}),cc(e,s,"child_removed",t,r,n),cc(e,s,"child_added",t,r,n),cc(e,s,"child_moved",i,r,n),cc(e,s,"child_changed",t,r,n),cc(e,s,"value",t,r,n),s}function cc(e,t,n,r,s,i){const l=r.filter(u=>u.type===n);l.sort((u,d)=>RP(e,u,d)),l.forEach(u=>{const d=jP(e,u,i);s.forEach(f=>{f.respondsTo(u.type)&&t.push(f.createEvent(d,e.query_))})})}function jP(e,t,n){return t.type==="value"||t.type==="child_removed"||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}function RP(e,t,n){if(t.childName==null||n.childName==null)throw fl("Should only compare child_ events.");const r=new kt(t.childName,t.snapshotNode),s=new kt(n.childName,n.snapshotNode);return e.index_.compare(r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fh(e,t){return{eventCache:e,serverCache:t}}function vc(e,t,n,r){return Fh(new qi(t,n,r),e.serverCache)}function ES(e,t,n,r){return Fh(e.eventCache,new qi(t,n,r))}function Om(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Ki(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Z0;const IP=()=>(Z0||(Z0=new Ir(xI)),Z0);class Xt{static fromObject(t){let n=new Xt(null);return Lr(t,(r,s)=>{n=n.set(new zt(r),s)}),n}constructor(t,n=IP()){this.value=t,this.children=n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,n){if(this.value!=null&&n(this.value))return{path:It(),value:this.value};if(wt(t))return null;{const r=yt(t),s=this.children.get(r);if(s!==null){const i=s.findRootMostMatchingPathAndValue(Vt(t),n);return i!=null?{path:Rn(new zt(r),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,()=>!0)}subtree(t){if(wt(t))return this;{const n=yt(t),r=this.children.get(n);return r!==null?r.subtree(Vt(t)):new Xt(null)}}set(t,n){if(wt(t))return new Xt(n,this.children);{const r=yt(t),i=(this.children.get(r)||new Xt(null)).set(Vt(t),n),l=this.children.insert(r,i);return new Xt(this.value,l)}}remove(t){if(wt(t))return this.children.isEmpty()?new Xt(null):new Xt(null,this.children);{const n=yt(t),r=this.children.get(n);if(r){const s=r.remove(Vt(t));let i;return s.isEmpty()?i=this.children.remove(n):i=this.children.insert(n,s),this.value===null&&i.isEmpty()?new Xt(null):new Xt(this.value,i)}else return this}}get(t){if(wt(t))return this.value;{const n=yt(t),r=this.children.get(n);return r?r.get(Vt(t)):null}}setTree(t,n){if(wt(t))return n;{const r=yt(t),i=(this.children.get(r)||new Xt(null)).setTree(Vt(t),n);let l;return i.isEmpty()?l=this.children.remove(r):l=this.children.insert(r,i),new Xt(this.value,l)}}fold(t){return this.fold_(It(),t)}fold_(t,n){const r={};return this.children.inorderTraversal((s,i)=>{r[s]=i.fold_(Rn(t,s),n)}),n(t,this.value,r)}findOnPath(t,n){return this.findOnPath_(t,It(),n)}findOnPath_(t,n,r){const s=this.value?r(n,this.value):!1;if(s)return s;if(wt(t))return null;{const i=yt(t),l=this.children.get(i);return l?l.findOnPath_(Vt(t),Rn(n,i),r):null}}foreachOnPath(t,n){return this.foreachOnPath_(t,It(),n)}foreachOnPath_(t,n,r){if(wt(t))return this;{this.value&&r(n,this.value);const s=yt(t),i=this.children.get(s);return i?i.foreachOnPath_(Vt(t),Rn(n,s),r):new Xt(null)}}foreach(t){this.foreach_(It(),t)}foreach_(t,n){this.children.inorderTraversal((r,s)=>{s.foreach_(Rn(t,r),n)}),this.value&&n(t,this.value)}foreachChild(t){this.children.inorderTraversal((n,r)=>{r.value&&t(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia{constructor(t){this.writeTree_=t}static empty(){return new Ia(new Xt(null))}}function yc(e,t,n){if(wt(t))return new Ia(new Xt(n));{const r=e.writeTree_.findRootMostValueAndPath(t);if(r!=null){const s=r.path;let i=r.value;const l=Rr(s,t);return i=i.updateChild(l,n),new Ia(e.writeTree_.set(s,i))}else{const s=new Xt(n),i=e.writeTree_.setTree(t,s);return new Ia(i)}}}function gy(e,t,n){let r=e;return Lr(n,(s,i)=>{r=yc(r,Rn(t,s),i)}),r}function xy(e,t){if(wt(t))return Ia.empty();{const n=e.writeTree_.setTree(t,new Xt(null));return new Ia(n)}}function Lm(e,t){return ro(e,t)!=null}function ro(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return n!=null?e.writeTree_.get(n.path).getChild(Rr(n.path,t)):null}function vy(e){const t=[],n=e.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(fn,(r,s)=>{t.push(new kt(r,s))}):e.writeTree_.children.inorderTraversal((r,s)=>{s.value!=null&&t.push(new kt(r,s.value))}),t}function ri(e,t){if(wt(t))return e;{const n=ro(e,t);return n!=null?new Ia(new Xt(n)):new Ia(e.writeTree_.subtree(t))}}function Fm(e){return e.writeTree_.isEmpty()}function sl(e,t){return TS(It(),e.writeTree_,t)}function TS(e,t,n){if(t.value!=null)return n.updateChild(e,t.value);{let r=null;return t.children.inorderTraversal((s,i)=>{s===".priority"?($e(i.value!==null,"Priority writes must always be leaf nodes"),r=i.value):n=TS(Rn(e,s),i,n)}),!n.getChild(e).isEmpty()&&r!==null&&(n=n.updateChild(Rn(e,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bp(e,t){return RS(t,e)}function PP(e,t,n,r,s){$e(r>e.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:s}),s&&(e.visibleWrites=yc(e.visibleWrites,t,n)),e.lastWriteId=r}function DP(e,t){for(let n=0;n<e.allWrites.length;n++){const r=e.allWrites[n];if(r.writeId===t)return r}return null}function OP(e,t){const n=e.allWrites.findIndex(u=>u.writeId===t);$e(n>=0,"removeWrite called with nonexistent writeId.");const r=e.allWrites[n];e.allWrites.splice(n,1);let s=r.visible,i=!1,l=e.allWrites.length-1;for(;s&&l>=0;){const u=e.allWrites[l];u.visible&&(l>=n&&LP(u,r.path)?s=!1:Ta(r.path,u.path)&&(i=!0)),l--}if(s){if(i)return FP(e),!0;if(r.snap)e.visibleWrites=xy(e.visibleWrites,r.path);else{const u=r.children;Lr(u,d=>{e.visibleWrites=xy(e.visibleWrites,Rn(r.path,d))})}return!0}else return!1}function LP(e,t){if(e.snap)return Ta(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&Ta(Rn(e.path,n),t))return!0;return!1}function FP(e){e.visibleWrites=bS(e.allWrites,MP,It()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}function MP(e){return e.visible}function bS(e,t,n){let r=Ia.empty();for(let s=0;s<e.length;++s){const i=e[s];if(t(i)){const l=i.path;let u;if(i.snap)Ta(n,l)?(u=Rr(n,l),r=yc(r,u,i.snap)):Ta(l,n)&&(u=Rr(l,n),r=yc(r,It(),i.snap.getChild(u)));else if(i.children){if(Ta(n,l))u=Rr(n,l),r=gy(r,u,i.children);else if(Ta(l,n))if(u=Rr(l,n),wt(u))r=gy(r,It(),i.children);else{const d=nl(i.children,yt(u));if(d){const f=d.getChild(Vt(u));r=yc(r,It(),f)}}}else throw fl("WriteRecord should have .snap or .children")}}return r}function AS(e,t,n,r,s){if(!r&&!s){const i=ro(e.visibleWrites,t);if(i!=null)return i;{const l=ri(e.visibleWrites,t);if(Fm(l))return n;if(n==null&&!Lm(l,It()))return null;{const u=n||ct.EMPTY_NODE;return sl(l,u)}}}else{const i=ri(e.visibleWrites,t);if(!s&&Fm(i))return n;if(!s&&n==null&&!Lm(i,It()))return null;{const l=function(f){return(f.visible||s)&&(!r||!~r.indexOf(f.writeId))&&(Ta(f.path,t)||Ta(t,f.path))},u=bS(e.allWrites,l,t),d=n||ct.EMPTY_NODE;return sl(u,d)}}}function BP(e,t,n){let r=ct.EMPTY_NODE;const s=ro(e.visibleWrites,t);if(s)return s.isLeafNode()||s.forEachChild(fn,(i,l)=>{r=r.updateImmediateChild(i,l)}),r;if(n){const i=ri(e.visibleWrites,t);return n.forEachChild(fn,(l,u)=>{const d=sl(ri(i,new zt(l)),u);r=r.updateImmediateChild(l,d)}),vy(i).forEach(l=>{r=r.updateImmediateChild(l.name,l.node)}),r}else{const i=ri(e.visibleWrites,t);return vy(i).forEach(l=>{r=r.updateImmediateChild(l.name,l.node)}),r}}function UP(e,t,n,r,s){$e(r||s,"Either existingEventSnap or existingServerSnap must exist");const i=Rn(t,n);if(Lm(e.visibleWrites,i))return null;{const l=ri(e.visibleWrites,i);return Fm(l)?s.getChild(n):sl(l,s.getChild(n))}}function zP(e,t,n,r){const s=Rn(t,n),i=ro(e.visibleWrites,s);if(i!=null)return i;if(r.isCompleteForChild(n)){const l=ri(e.visibleWrites,s);return sl(l,r.getNode().getImmediateChild(n))}else return null}function WP(e,t){return ro(e.visibleWrites,t)}function HP(e,t,n,r,s,i,l){let u;const d=ri(e.visibleWrites,t),f=ro(d,It());if(f!=null)u=f;else if(n!=null)u=sl(d,n);else return[];if(u=u.withIndex(l),!u.isEmpty()&&!u.isLeafNode()){const m=[],p=l.getCompare(),x=i?u.getReverseIteratorFrom(r,l):u.getIteratorFrom(r,l);let v=x.getNext();for(;v&&m.length<s;)p(v,r)!==0&&m.push(v),v=x.getNext();return m}else return[]}function GP(){return{visibleWrites:Ia.empty(),allWrites:[],lastWriteId:-1}}function lh(e,t,n,r){return AS(e.writeTree,e.treePath,t,n,r)}function Ap(e,t){return BP(e.writeTree,e.treePath,t)}function yy(e,t,n,r){return UP(e.writeTree,e.treePath,t,n,r)}function ch(e,t){return WP(e.writeTree,Rn(e.treePath,t))}function $P(e,t,n,r,s,i){return HP(e.writeTree,e.treePath,t,n,r,s,i)}function jp(e,t,n){return zP(e.writeTree,e.treePath,t,n)}function jS(e,t){return RS(Rn(e.treePath,t),e.writeTree)}function RS(e,t){return{treePath:e,writeTree:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(){this.changeMap=new Map}trackChildChange(t){const n=t.type,r=t.childName;$e(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),$e(r!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(r);if(s){const i=s.type;if(n==="child_added"&&i==="child_removed")this.changeMap.set(r,Oc(r,t.snapshotNode,s.snapshotNode));else if(n==="child_removed"&&i==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&i==="child_changed")this.changeMap.set(r,Dc(r,s.oldSnap));else if(n==="child_changed"&&i==="child_added")this.changeMap.set(r,al(r,t.snapshotNode));else if(n==="child_changed"&&i==="child_changed")this.changeMap.set(r,Oc(r,t.snapshotNode,s.oldSnap));else throw fl("Illegal combination of changes: "+t+" occurred after "+s)}else this.changeMap.set(r,t)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qP{getCompleteChild(t){return null}getChildAfterChild(t,n,r){return null}}const IS=new qP;class Rp{constructor(t,n,r=null){this.writes_=t,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(t){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(t))return n.getNode().getImmediateChild(t);{const r=this.optCompleteServerCache_!=null?new qi(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return jp(this.writes_,t,r)}}getChildAfterChild(t,n,r){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Ki(this.viewCache_),i=$P(this.writes_,s,n,1,r,t);return i.length===0?null:i[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KP(e){return{filter:e}}function YP(e,t){$e(t.eventCache.getNode().isIndexed(e.filter.getIndex()),"Event snap not indexed"),$e(t.serverCache.getNode().isIndexed(e.filter.getIndex()),"Server snap not indexed")}function XP(e,t,n,r,s){const i=new VP;let l,u;if(n.type===ba.OVERWRITE){const f=n;f.source.fromUser?l=Mm(e,t,f.path,f.snap,r,s,i):($e(f.source.fromServer,"Unknown source."),u=f.source.tagged||t.serverCache.isFiltered()&&!wt(f.path),l=uh(e,t,f.path,f.snap,r,s,u,i))}else if(n.type===ba.MERGE){const f=n;f.source.fromUser?l=JP(e,t,f.path,f.children,r,s,i):($e(f.source.fromServer,"Unknown source."),u=f.source.tagged||t.serverCache.isFiltered(),l=Bm(e,t,f.path,f.children,r,s,u,i))}else if(n.type===ba.ACK_USER_WRITE){const f=n;f.revert?l=tD(e,t,f.path,r,s,i):l=ZP(e,t,f.path,f.affectedTree,r,s,i)}else if(n.type===ba.LISTEN_COMPLETE)l=eD(e,t,n.path,r,i);else throw fl("Unknown operation type: "+n.type);const d=i.getChanges();return QP(t,l,d),{viewCache:l,changes:d}}function QP(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){const s=r.getNode().isLeafNode()||r.getNode().isEmpty(),i=Om(e);(n.length>0||!e.eventCache.isFullyInitialized()||s&&!r.getNode().equals(i)||!r.getNode().getPriority().equals(i.getPriority()))&&n.push(_S(Om(t)))}}function PS(e,t,n,r,s,i){const l=t.eventCache;if(ch(r,n)!=null)return t;{let u,d;if(wt(n))if($e(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const f=Ki(t),m=f instanceof ct?f:ct.EMPTY_NODE,p=Ap(r,m);u=e.filter.updateFullNode(t.eventCache.getNode(),p,i)}else{const f=lh(r,Ki(t));u=e.filter.updateFullNode(t.eventCache.getNode(),f,i)}else{const f=yt(n);if(f===".priority"){$e(ii(n)===1,"Can't have a priority with additional path components");const m=l.getNode();d=t.serverCache.getNode();const p=yy(r,n,m,d);p!=null?u=e.filter.updatePriority(m,p):u=l.getNode()}else{const m=Vt(n);let p;if(l.isCompleteForChild(f)){d=t.serverCache.getNode();const x=yy(r,n,l.getNode(),d);x!=null?p=l.getNode().getImmediateChild(f).updateChild(m,x):p=l.getNode().getImmediateChild(f)}else p=jp(r,f,t.serverCache);p!=null?u=e.filter.updateChild(l.getNode(),f,p,m,s,i):u=l.getNode()}}return vc(t,u,l.isFullyInitialized()||wt(n),e.filter.filtersNodes())}}function uh(e,t,n,r,s,i,l,u){const d=t.serverCache;let f;const m=l?e.filter:e.filter.getIndexedFilter();if(wt(n))f=m.updateFullNode(d.getNode(),r,null);else if(m.filtersNodes()&&!d.isFiltered()){const v=d.getNode().updateChild(n,r);f=m.updateFullNode(d.getNode(),v,null)}else{const v=yt(n);if(!d.isCompleteForPath(n)&&ii(n)>1)return t;const k=Vt(n),S=d.getNode().getImmediateChild(v).updateChild(k,r);v===".priority"?f=m.updatePriority(d.getNode(),S):f=m.updateChild(d.getNode(),v,S,k,IS,null)}const p=ES(t,f,d.isFullyInitialized()||wt(n),m.filtersNodes()),x=new Rp(s,p,i);return PS(e,p,n,s,x,u)}function Mm(e,t,n,r,s,i,l){const u=t.eventCache;let d,f;const m=new Rp(s,t,i);if(wt(n))f=e.filter.updateFullNode(t.eventCache.getNode(),r,l),d=vc(t,f,!0,e.filter.filtersNodes());else{const p=yt(n);if(p===".priority")f=e.filter.updatePriority(t.eventCache.getNode(),r),d=vc(t,f,u.isFullyInitialized(),u.isFiltered());else{const x=Vt(n),v=u.getNode().getImmediateChild(p);let k;if(wt(x))k=r;else{const y=m.getCompleteChild(p);y!=null?mS(x)===".priority"&&y.getChild(gS(x)).isEmpty()?k=y:k=y.updateChild(x,r):k=ct.EMPTY_NODE}if(v.equals(k))d=t;else{const y=e.filter.updateChild(u.getNode(),p,k,x,m,l);d=vc(t,y,u.isFullyInitialized(),e.filter.filtersNodes())}}}return d}function ky(e,t){return e.eventCache.isCompleteForChild(t)}function JP(e,t,n,r,s,i,l){let u=t;return r.foreach((d,f)=>{const m=Rn(n,d);ky(t,yt(m))&&(u=Mm(e,u,m,f,s,i,l))}),r.foreach((d,f)=>{const m=Rn(n,d);ky(t,yt(m))||(u=Mm(e,u,m,f,s,i,l))}),u}function wy(e,t,n){return n.foreach((r,s)=>{t=t.updateChild(r,s)}),t}function Bm(e,t,n,r,s,i,l,u){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let d=t,f;wt(n)?f=r:f=new Xt(null).setTree(n,r);const m=t.serverCache.getNode();return f.children.inorderTraversal((p,x)=>{if(m.hasChild(p)){const v=t.serverCache.getNode().getImmediateChild(p),k=wy(e,v,x);d=uh(e,d,new zt(p),k,s,i,l,u)}}),f.children.inorderTraversal((p,x)=>{const v=!t.serverCache.isCompleteForChild(p)&&x.value===null;if(!m.hasChild(p)&&!v){const k=t.serverCache.getNode().getImmediateChild(p),y=wy(e,k,x);d=uh(e,d,new zt(p),y,s,i,l,u)}}),d}function ZP(e,t,n,r,s,i,l){if(ch(s,n)!=null)return t;const u=t.serverCache.isFiltered(),d=t.serverCache;if(r.value!=null){if(wt(n)&&d.isFullyInitialized()||d.isCompleteForPath(n))return uh(e,t,n,d.getNode().getChild(n),s,i,u,l);if(wt(n)){let f=new Xt(null);return d.getNode().forEachChild(qo,(m,p)=>{f=f.set(new zt(m),p)}),Bm(e,t,n,f,s,i,u,l)}else return t}else{let f=new Xt(null);return r.foreach((m,p)=>{const x=Rn(n,m);d.isCompleteForPath(x)&&(f=f.set(m,d.getNode().getChild(x)))}),Bm(e,t,n,f,s,i,u,l)}}function eD(e,t,n,r,s){const i=t.serverCache,l=ES(t,i.getNode(),i.isFullyInitialized()||wt(n),i.isFiltered());return PS(e,l,n,r,IS,s)}function tD(e,t,n,r,s,i){let l;if(ch(r,n)!=null)return t;{const u=new Rp(r,t,s),d=t.eventCache.getNode();let f;if(wt(n)||yt(n)===".priority"){let m;if(t.serverCache.isFullyInitialized())m=lh(r,Ki(t));else{const p=t.serverCache.getNode();$e(p instanceof ct,"serverChildren would be complete if leaf node"),m=Ap(r,p)}m=m,f=e.filter.updateFullNode(d,m,i)}else{const m=yt(n);let p=jp(r,m,t.serverCache);p==null&&t.serverCache.isCompleteForChild(m)&&(p=d.getImmediateChild(m)),p!=null?f=e.filter.updateChild(d,m,p,Vt(n),u,i):t.eventCache.getNode().hasChild(m)?f=e.filter.updateChild(d,m,ct.EMPTY_NODE,Vt(n),u,i):f=d,f.isEmpty()&&t.serverCache.isFullyInitialized()&&(l=lh(r,Ki(t)),l.isLeafNode()&&(f=e.filter.updateFullNode(f,l,i)))}return l=t.serverCache.isFullyInitialized()||ch(r,It())!=null,vc(t,f,l,e.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nD{constructor(t,n){this.query_=t,this.eventRegistrations_=[];const r=this.query_._queryParams,s=new Cp(r.getIndex()),i=wP(r);this.processor_=KP(i);const l=n.serverCache,u=n.eventCache,d=s.updateFullNode(ct.EMPTY_NODE,l.getNode(),null),f=i.updateFullNode(ct.EMPTY_NODE,u.getNode(),null),m=new qi(d,l.isFullyInitialized(),s.filtersNodes()),p=new qi(f,u.isFullyInitialized(),i.filtersNodes());this.viewCache_=Fh(p,m),this.eventGenerator_=new bP(this.query_)}get query(){return this.query_}}function rD(e){return e.viewCache_.serverCache.getNode()}function aD(e,t){const n=Ki(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!wt(t)&&!n.getImmediateChild(yt(t)).isEmpty())?n.getChild(t):null}function Sy(e){return e.eventRegistrations_.length===0}function sD(e,t){e.eventRegistrations_.push(t)}function _y(e,t,n){const r=[];if(n){$e(t==null,"A cancel should cancel all event registrations.");const s=e.query._path;e.eventRegistrations_.forEach(i=>{const l=i.createCancelEvent(n,s);l&&r.push(l)})}if(t){let s=[];for(let i=0;i<e.eventRegistrations_.length;++i){const l=e.eventRegistrations_[i];if(!l.matches(t))s.push(l);else if(t.hasAnyCallback()){s=s.concat(e.eventRegistrations_.slice(i+1));break}}e.eventRegistrations_=s}else e.eventRegistrations_=[];return r}function Cy(e,t,n,r){t.type===ba.MERGE&&t.source.queryId!==null&&($e(Ki(e.viewCache_),"We should always have a full cache before handling merges"),$e(Om(e.viewCache_),"Missing event cache, even though we have a server cache"));const s=e.viewCache_,i=XP(e.processor_,s,t,n,r);return YP(e.processor_,i.viewCache),$e(i.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=i.viewCache,DS(e,i.changes,i.viewCache.eventCache.getNode(),null)}function iD(e,t){const n=e.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(fn,(i,l)=>{r.push(al(i,l))}),n.isFullyInitialized()&&r.push(_S(n.getNode())),DS(e,r,n.getNode(),t)}function DS(e,t,n,r){const s=r?[r]:e.eventRegistrations_;return AP(e.eventGenerator_,t,n,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dh;class oD{constructor(){this.views=new Map}}function lD(e){$e(!dh,"__referenceConstructor has already been defined"),dh=e}function cD(){return $e(dh,"Reference.ts has not been loaded"),dh}function uD(e){return e.views.size===0}function Ip(e,t,n,r){const s=t.source.queryId;if(s!==null){const i=e.views.get(s);return $e(i!=null,"SyncTree gave us an op for an invalid query."),Cy(i,t,n,r)}else{let i=[];for(const l of e.views.values())i=i.concat(Cy(l,t,n,r));return i}}function dD(e,t,n,r,s){const i=t._queryIdentifier,l=e.views.get(i);if(!l){let u=lh(n,s?r:null),d=!1;u?d=!0:r instanceof ct?(u=Ap(n,r),d=!1):(u=ct.EMPTY_NODE,d=!1);const f=Fh(new qi(u,d,!1),new qi(r,s,!1));return new nD(t,f)}return l}function hD(e,t,n,r,s,i){const l=dD(e,t,r,s,i);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,l),sD(l,n),iD(l,n)}function fD(e,t,n,r){const s=t._queryIdentifier,i=[];let l=[];const u=oi(e);if(s==="default")for(const[d,f]of e.views.entries())l=l.concat(_y(f,n,r)),Sy(f)&&(e.views.delete(d),f.query._queryParams.loadsAllData()||i.push(f.query));else{const d=e.views.get(s);d&&(l=l.concat(_y(d,n,r)),Sy(d)&&(e.views.delete(s),d.query._queryParams.loadsAllData()||i.push(d.query)))}return u&&!oi(e)&&i.push(new(cD())(t._repo,t._path)),{removed:i,events:l}}function OS(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function Ko(e,t){let n=null;for(const r of e.views.values())n=n||aD(r,t);return n}function LS(e,t){if(t._queryParams.loadsAllData())return Mh(e);{const r=t._queryIdentifier;return e.views.get(r)}}function FS(e,t){return LS(e,t)!=null}function oi(e){return Mh(e)!=null}function Mh(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hh;function mD(e){$e(!hh,"__referenceConstructor has already been defined"),hh=e}function pD(){return $e(hh,"Reference.ts has not been loaded"),hh}let gD=1;class Ny{constructor(t){this.listenProvider_=t,this.syncPointTree_=new Xt(null),this.pendingWriteTree_=GP(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function MS(e,t,n,r,s){return PP(e.pendingWriteTree_,t,n,r,s),s?ou(e,new Vi(NS(),t,n)):[]}function Mi(e,t,n=!1){const r=DP(e.pendingWriteTree_,t);if(OP(e.pendingWriteTree_,t)){let i=new Xt(null);return r.snap!=null?i=i.set(It(),!0):Lr(r.children,l=>{i=i.set(new zt(l),!0)}),ou(e,new oh(r.path,i,n))}else return[]}function Bh(e,t,n){return ou(e,new Vi(Ep(),t,n))}function xD(e,t,n){const r=Xt.fromObject(n);return ou(e,new Mc(Ep(),t,r))}function vD(e,t){return ou(e,new Fc(Ep(),t))}function yD(e,t,n){const r=Dp(e,n);if(r){const s=Op(r),i=s.path,l=s.queryId,u=Rr(i,t),d=new Fc(Tp(l),u);return Lp(e,i,d)}else return[]}function Um(e,t,n,r,s=!1){const i=t._path,l=e.syncPointTree_.get(i);let u=[];if(l&&(t._queryIdentifier==="default"||FS(l,t))){const d=fD(l,t,n,r);uD(l)&&(e.syncPointTree_=e.syncPointTree_.remove(i));const f=d.removed;if(u=d.events,!s){const m=f.findIndex(x=>x._queryParams.loadsAllData())!==-1,p=e.syncPointTree_.findOnPath(i,(x,v)=>oi(v));if(m&&!p){const x=e.syncPointTree_.subtree(i);if(!x.isEmpty()){const v=SD(x);for(let k=0;k<v.length;++k){const y=v[k],S=y.query,C=zS(e,y);e.listenProvider_.startListening(kc(S),fh(e,S),C.hashFn,C.onComplete)}}}!p&&f.length>0&&!r&&(m?e.listenProvider_.stopListening(kc(t),null):f.forEach(x=>{const v=e.queryToTagMap.get(Uh(x));e.listenProvider_.stopListening(kc(x),v)}))}_D(e,f)}return u}function kD(e,t,n,r){const s=Dp(e,r);if(s!=null){const i=Op(s),l=i.path,u=i.queryId,d=Rr(l,t),f=new Vi(Tp(u),d,n);return Lp(e,l,f)}else return[]}function wD(e,t,n,r){const s=Dp(e,r);if(s){const i=Op(s),l=i.path,u=i.queryId,d=Rr(l,t),f=Xt.fromObject(n),m=new Mc(Tp(u),d,f);return Lp(e,l,m)}else return[]}function Ey(e,t,n,r=!1){const s=t._path;let i=null,l=!1;e.syncPointTree_.foreachOnPath(s,(x,v)=>{const k=Rr(x,s);i=i||Ko(v,k),l=l||oi(v)});let u=e.syncPointTree_.get(s);u?(l=l||oi(u),i=i||Ko(u,It())):(u=new oD,e.syncPointTree_=e.syncPointTree_.set(s,u));let d;i!=null?d=!0:(d=!1,i=ct.EMPTY_NODE,e.syncPointTree_.subtree(s).foreachChild((v,k)=>{const y=Ko(k,It());y&&(i=i.updateImmediateChild(v,y))}));const f=FS(u,t);if(!f&&!t._queryParams.loadsAllData()){const x=Uh(t);$e(!e.queryToTagMap.has(x),"View does not exist, but we have a tag");const v=CD();e.queryToTagMap.set(x,v),e.tagToQueryMap.set(v,x)}const m=bp(e.pendingWriteTree_,s);let p=hD(u,t,n,m,i,d);if(!f&&!l&&!r){const x=LS(u,t);p=p.concat(ND(e,t,x))}return p}function Pp(e,t,n){const s=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,(l,u)=>{const d=Rr(l,t),f=Ko(u,d);if(f)return f});return AS(s,t,i,n,!0)}function ou(e,t){return BS(t,e.syncPointTree_,null,bp(e.pendingWriteTree_,It()))}function BS(e,t,n,r){if(wt(e.path))return US(e,t,n,r);{const s=t.get(It());n==null&&s!=null&&(n=Ko(s,It()));let i=[];const l=yt(e.path),u=e.operationForChild(l),d=t.children.get(l);if(d&&u){const f=n?n.getImmediateChild(l):null,m=jS(r,l);i=i.concat(BS(u,d,f,m))}return s&&(i=i.concat(Ip(s,e,r,n))),i}}function US(e,t,n,r){const s=t.get(It());n==null&&s!=null&&(n=Ko(s,It()));let i=[];return t.children.inorderTraversal((l,u)=>{const d=n?n.getImmediateChild(l):null,f=jS(r,l),m=e.operationForChild(l);m&&(i=i.concat(US(m,u,d,f)))}),s&&(i=i.concat(Ip(s,e,r,n))),i}function zS(e,t){const n=t.query,r=fh(e,n);return{hashFn:()=>(rD(t)||ct.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return r?yD(e,n._path,r):vD(e,n._path);{const i=kI(s,n);return Um(e,n,null,i)}}}}function fh(e,t){const n=Uh(t);return e.queryToTagMap.get(n)}function Uh(e){return e._path.toString()+"$"+e._queryIdentifier}function Dp(e,t){return e.tagToQueryMap.get(t)}function Op(e){const t=e.indexOf("$");return $e(t!==-1&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new zt(e.substr(0,t))}}function Lp(e,t,n){const r=e.syncPointTree_.get(t);$e(r,"Missing sync point for query tag that we're tracking");const s=bp(e.pendingWriteTree_,t);return Ip(r,n,s,null)}function SD(e){return e.fold((t,n,r)=>{if(n&&oi(n))return[Mh(n)];{let s=[];return n&&(s=OS(n)),Lr(r,(i,l)=>{s=s.concat(l)}),s}})}function kc(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(pD())(e._repo,e._path):e}function _D(e,t){for(let n=0;n<t.length;++n){const r=t[n];if(!r._queryParams.loadsAllData()){const s=Uh(r),i=e.queryToTagMap.get(s);e.queryToTagMap.delete(s),e.tagToQueryMap.delete(i)}}}function CD(){return gD++}function ND(e,t,n){const r=t._path,s=fh(e,t),i=zS(e,n),l=e.listenProvider_.startListening(kc(t),s,i.hashFn,i.onComplete),u=e.syncPointTree_.subtree(r);if(s)$e(!oi(u.value),"If we're adding a query, it shouldn't be shadowed");else{const d=u.fold((f,m,p)=>{if(!wt(f)&&m&&oi(m))return[Mh(m).query];{let x=[];return m&&(x=x.concat(OS(m).map(v=>v.query))),Lr(p,(v,k)=>{x=x.concat(k)}),x}});for(let f=0;f<d.length;++f){const m=d[f];e.listenProvider_.stopListening(kc(m),fh(e,m))}}return l}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fp{constructor(t){this.node_=t}getImmediateChild(t){const n=this.node_.getImmediateChild(t);return new Fp(n)}node(){return this.node_}}class Mp{constructor(t,n){this.syncTree_=t,this.path_=n}getImmediateChild(t){const n=Rn(this.path_,t);return new Mp(this.syncTree_,n)}node(){return Pp(this.syncTree_,this.path_)}}const ED=function(e){return e=e||{},e.timestamp=e.timestamp||new Date().getTime(),e},Ty=function(e,t,n){if(!e||typeof e!="object")return e;if($e(".sv"in e,"Unexpected leaf node or priority contents"),typeof e[".sv"]=="string")return TD(e[".sv"],t,n);if(typeof e[".sv"]=="object")return bD(e[".sv"],t);$e(!1,"Unexpected server value: "+JSON.stringify(e,null,2))},TD=function(e,t,n){switch(e){case"timestamp":return n.timestamp;default:$e(!1,"Unexpected server value: "+e)}},bD=function(e,t,n){e.hasOwnProperty("increment")||$e(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const r=e.increment;typeof r!="number"&&$e(!1,"Unexpected increment value: "+r);const s=t.node();if($e(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return r;const l=s.getValue();return typeof l!="number"?r:l+r},AD=function(e,t,n,r){return Bp(t,new Mp(n,e),r)},WS=function(e,t,n){return Bp(e,new Fp(t),n)};function Bp(e,t,n){const r=e.getPriority().val(),s=Ty(r,t.getImmediateChild(".priority"),n);let i;if(e.isLeafNode()){const l=e,u=Ty(l.getValue(),t,n);return u!==l.getValue()||s!==l.getPriority().val()?new zn(u,Jn(s)):e}else{const l=e;return i=l,s!==l.getPriority().val()&&(i=i.updatePriority(new zn(s))),l.forEachChild(fn,(u,d)=>{const f=Bp(d,t.getImmediateChild(u),n);f!==d&&(i=i.updateImmediateChild(u,f))}),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Up{constructor(t="",n=null,r={children:{},childCount:0}){this.name=t,this.parent=n,this.node=r}}function zp(e,t){let n=t instanceof zt?t:new zt(t),r=e,s=yt(n);for(;s!==null;){const i=nl(r.node.children,s)||{children:{},childCount:0};r=new Up(s,r,i),n=Vt(n),s=yt(n)}return r}function gl(e){return e.node.value}function HS(e,t){e.node.value=t,zm(e)}function GS(e){return e.node.childCount>0}function jD(e){return gl(e)===void 0&&!GS(e)}function zh(e,t){Lr(e.node.children,(n,r)=>{t(new Up(n,e,r))})}function $S(e,t,n,r){n&&t(e),zh(e,s=>{$S(s,t,!0)})}function RD(e,t,n){let r=e.parent;for(;r!==null;){if(t(r))return!0;r=r.parent}return!1}function lu(e){return new zt(e.parent===null?e.name:lu(e.parent)+"/"+e.name)}function zm(e){e.parent!==null&&ID(e.parent,e.name,e)}function ID(e,t,n){const r=jD(n),s=Ss(e.node.children,t);r&&s?(delete e.node.children[t],e.node.childCount--,zm(e)):!r&&!s&&(e.node.children[t]=n.node,e.node.childCount++,zm(e))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PD=/[\[\].#$\/\u0000-\u001F\u007F]/,DD=/[\[\].#$\u0000-\u001F\u007F]/,em=10*1024*1024,VS=function(e){return typeof e=="string"&&e.length!==0&&!PD.test(e)},qS=function(e){return typeof e=="string"&&e.length!==0&&!DD.test(e)},OD=function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),qS(e)},LD=function(e,t,n,r){Wp(pp(e,"value"),t,n)},Wp=function(e,t,n){const r=n instanceof zt?new ZI(n,e):n;if(t===void 0)throw new Error(e+"contains undefined "+Di(r));if(typeof t=="function")throw new Error(e+"contains a function "+Di(r)+" with contents = "+t.toString());if(qw(t))throw new Error(e+"contains "+t.toString()+" "+Di(r));if(typeof t=="string"&&t.length>em/3&&Oh(t)>em)throw new Error(e+"contains a string greater than "+em+" utf8 bytes "+Di(r)+" ('"+t.substring(0,50)+"...')");if(t&&typeof t=="object"){let s=!1,i=!1;if(Lr(t,(l,u)=>{if(l===".value")s=!0;else if(l!==".priority"&&l!==".sv"&&(i=!0,!VS(l)))throw new Error(e+" contains an invalid key ("+l+") "+Di(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);eP(r,l),Wp(e,u,r),tP(r)}),s&&i)throw new Error(e+' contains ".value" child '+Di(r)+" in addition to actual children.")}},KS=function(e,t,n,r){if(!qS(n))throw new Error(pp(e,t)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},FD=function(e,t,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),KS(e,t,n)},MD=function(e,t){if(yt(t)===".info")throw new Error(e+" failed = Can't modify data under /.info/")},BD=function(e,t){const n=t.path.toString();if(typeof t.repoInfo.host!="string"||t.repoInfo.host.length===0||!VS(t.repoInfo.namespace)&&t.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!OD(n))throw new Error(pp(e,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UD{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Hp(e,t){let n=null;for(let r=0;r<t.length;r++){const s=t[r],i=s.getPath();n!==null&&!wp(i,n.path)&&(e.eventLists_.push(n),n=null),n===null&&(n={events:[],path:i}),n.events.push(s)}n&&e.eventLists_.push(n)}function YS(e,t,n){Hp(e,n),XS(e,r=>wp(r,t))}function ys(e,t,n){Hp(e,n),XS(e,r=>Ta(r,t)||Ta(t,r))}function XS(e,t){e.recursionDepth_++;let n=!0;for(let r=0;r<e.eventLists_.length;r++){const s=e.eventLists_[r];if(s){const i=s.path;t(i)?(zD(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}function zD(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(n!==null){e.events[t]=null;const r=n.getEventRunner();gc&&cr("event: "+n.toString()),pl(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WD="repo_interrupt",HD=25;class GD{constructor(t,n,r,s){this.repoInfo_=t,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new UD,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=ih(),this.transactionQueueTree_=new Up,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function $D(e,t,n){if(e.stats_=yp(e.repoInfo_),e.forceRestClient_||CI())e.server_=new sh(e.repoInfo_,(r,s,i,l)=>{by(e,r,s,i,l)},e.authTokenProvider_,e.appCheckProvider_),setTimeout(()=>Ay(e,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{$n(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}e.persistentConnection_=new ds(e.repoInfo_,t,(r,s,i,l)=>{by(e,r,s,i,l)},r=>{Ay(e,r)},r=>{qD(e,r)},e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener(r=>{e.server_.refreshAuthToken(r)}),e.appCheckProvider_.addTokenChangeListener(r=>{e.server_.refreshAppCheckToken(r.token)}),e.statsReporter_=AI(e.repoInfo_,()=>new TP(e.stats_,e.server_)),e.infoData_=new SP,e.infoSyncTree_=new Ny({startListening:(r,s,i,l)=>{let u=[];const d=e.infoData_.getNode(r._path);return d.isEmpty()||(u=Bh(e.infoSyncTree_,r._path,d),setTimeout(()=>{l("ok")},0)),u},stopListening:()=>{}}),$p(e,"connected",!1),e.serverSyncTree_=new Ny({startListening:(r,s,i,l)=>(e.server_.listen(r,i,s,(u,d)=>{const f=l(u,d);ys(e.eventQueue_,r._path,f)}),[]),stopListening:(r,s)=>{e.server_.unlisten(r,s)}})}function VD(e){const n=e.infoData_.getNode(new zt(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Gp(e){return ED({timestamp:VD(e)})}function by(e,t,n,r,s){e.dataUpdateCount++;const i=new zt(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let l=[];if(s)if(r){const d=Jd(n,f=>Jn(f));l=wD(e.serverSyncTree_,i,d,s)}else{const d=Jn(n);l=kD(e.serverSyncTree_,i,d,s)}else if(r){const d=Jd(n,f=>Jn(f));l=xD(e.serverSyncTree_,i,d)}else{const d=Jn(n);l=Bh(e.serverSyncTree_,i,d)}let u=i;l.length>0&&(u=Wh(e,i)),ys(e.eventQueue_,u,l)}function Ay(e,t){$p(e,"connected",t),t===!1&&YD(e)}function qD(e,t){Lr(t,(n,r)=>{$p(e,n,r)})}function $p(e,t,n){const r=new zt("/.info/"+t),s=Jn(n);e.infoData_.updateSnapshot(r,s);const i=Bh(e.infoSyncTree_,r,s);ys(e.eventQueue_,r,i)}function QS(e){return e.nextWriteId_++}function KD(e,t,n,r,s){Vp(e,"set",{path:t.toString(),value:n,priority:r});const i=Gp(e),l=Jn(n,r),u=Pp(e.serverSyncTree_,t),d=WS(l,u,i),f=QS(e),m=MS(e.serverSyncTree_,t,d,f,!0);Hp(e.eventQueue_,m),e.server_.put(t.toString(),l.val(!0),(x,v)=>{const k=x==="ok";k||Pr("set at "+t+" failed: "+x);const y=Mi(e.serverSyncTree_,f,!k);ys(e.eventQueue_,t,y),JD(e,s,x,v)});const p=n_(e,t);Wh(e,p),ys(e.eventQueue_,p,[])}function YD(e){Vp(e,"onDisconnectEvents");const t=Gp(e),n=ih();Dm(e.onDisconnect_,It(),(s,i)=>{const l=AD(s,i,e.serverSyncTree_,t);CS(n,s,l)});let r=[];Dm(n,It(),(s,i)=>{r=r.concat(Bh(e.serverSyncTree_,s,i));const l=n_(e,s);Wh(e,l)}),e.onDisconnect_=ih(),ys(e.eventQueue_,It(),r)}function XD(e,t,n){let r;yt(t._path)===".info"?r=Ey(e.infoSyncTree_,t,n):r=Ey(e.serverSyncTree_,t,n),YS(e.eventQueue_,t._path,r)}function jy(e,t,n){let r;yt(t._path)===".info"?r=Um(e.infoSyncTree_,t,n):r=Um(e.serverSyncTree_,t,n),YS(e.eventQueue_,t._path,r)}function QD(e){e.persistentConnection_&&e.persistentConnection_.interrupt(WD)}function Vp(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),cr(n,...t)}function JD(e,t,n,r){t&&pl(()=>{if(n==="ok")t(null);else{const s=(n||"error").toUpperCase();let i=s;r&&(i+=": "+r);const l=new Error(i);l.code=s,t(l)}})}function JS(e,t,n){return Pp(e.serverSyncTree_,t,n)||ct.EMPTY_NODE}function qp(e,t=e.transactionQueueTree_){if(t||Hh(e,t),gl(t)){const n=e_(e,t);$e(n.length>0,"Sending zero length transaction queue"),n.every(s=>s.status===0)&&ZD(e,lu(t),n)}else GS(t)&&zh(t,n=>{qp(e,n)})}function ZD(e,t,n){const r=n.map(f=>f.currentWriteId),s=JS(e,t,r);let i=s;const l=s.hash();for(let f=0;f<n.length;f++){const m=n[f];$e(m.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),m.status=1,m.retryCount++;const p=Rr(t,m.path);i=i.updateChild(p,m.currentOutputSnapshotRaw)}const u=i.val(!0),d=t;e.server_.put(d.toString(),u,f=>{Vp(e,"transaction put response",{path:d.toString(),status:f});let m=[];if(f==="ok"){const p=[];for(let x=0;x<n.length;x++)n[x].status=2,m=m.concat(Mi(e.serverSyncTree_,n[x].currentWriteId)),n[x].onComplete&&p.push(()=>n[x].onComplete(null,!0,n[x].currentOutputSnapshotResolved)),n[x].unwatcher();Hh(e,zp(e.transactionQueueTree_,t)),qp(e,e.transactionQueueTree_),ys(e.eventQueue_,t,m);for(let x=0;x<p.length;x++)pl(p[x])}else{if(f==="datastale")for(let p=0;p<n.length;p++)n[p].status===3?n[p].status=4:n[p].status=0;else{Pr("transaction at "+d.toString()+" failed: "+f);for(let p=0;p<n.length;p++)n[p].status=4,n[p].abortReason=f}Wh(e,t)}},l)}function Wh(e,t){const n=ZS(e,t),r=lu(n),s=e_(e,n);return e3(e,s,r),r}function e3(e,t,n){if(t.length===0)return;const r=[];let s=[];const l=t.filter(u=>u.status===0).map(u=>u.currentWriteId);for(let u=0;u<t.length;u++){const d=t[u],f=Rr(n,d.path);let m=!1,p;if($e(f!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),d.status===4)m=!0,p=d.abortReason,s=s.concat(Mi(e.serverSyncTree_,d.currentWriteId,!0));else if(d.status===0)if(d.retryCount>=HD)m=!0,p="maxretry",s=s.concat(Mi(e.serverSyncTree_,d.currentWriteId,!0));else{const x=JS(e,d.path,l);d.currentInputSnapshot=x;const v=t[u].update(x.val());if(v!==void 0){Wp("transaction failed: Data returned ",v,d.path);let k=Jn(v);typeof v=="object"&&v!=null&&Ss(v,".priority")||(k=k.updatePriority(x.getPriority()));const S=d.currentWriteId,C=Gp(e),D=WS(k,x,C);d.currentOutputSnapshotRaw=k,d.currentOutputSnapshotResolved=D,d.currentWriteId=QS(e),l.splice(l.indexOf(S),1),s=s.concat(MS(e.serverSyncTree_,d.path,D,d.currentWriteId,d.applyLocally)),s=s.concat(Mi(e.serverSyncTree_,S,!0))}else m=!0,p="nodata",s=s.concat(Mi(e.serverSyncTree_,d.currentWriteId,!0))}ys(e.eventQueue_,n,s),s=[],m&&(t[u].status=2,(function(x){setTimeout(x,Math.floor(0))})(t[u].unwatcher),t[u].onComplete&&(p==="nodata"?r.push(()=>t[u].onComplete(null,!1,t[u].currentInputSnapshot)):r.push(()=>t[u].onComplete(new Error(p),!1,null))))}Hh(e,e.transactionQueueTree_);for(let u=0;u<r.length;u++)pl(r[u]);qp(e,e.transactionQueueTree_)}function ZS(e,t){let n,r=e.transactionQueueTree_;for(n=yt(t);n!==null&&gl(r)===void 0;)r=zp(r,n),t=Vt(t),n=yt(t);return r}function e_(e,t){const n=[];return t_(e,t,n),n.sort((r,s)=>r.order-s.order),n}function t_(e,t,n){const r=gl(t);if(r)for(let s=0;s<r.length;s++)n.push(r[s]);zh(t,s=>{t_(e,s,n)})}function Hh(e,t){const n=gl(t);if(n){let r=0;for(let s=0;s<n.length;s++)n[s].status!==2&&(n[r]=n[s],r++);n.length=r,HS(t,n.length>0?n:void 0)}zh(t,r=>{Hh(e,r)})}function n_(e,t){const n=lu(ZS(e,t)),r=zp(e.transactionQueueTree_,t);return RD(r,s=>{tm(e,s)}),tm(e,r),$S(r,s=>{tm(e,s)}),n}function tm(e,t){const n=gl(t);if(n){const r=[];let s=[],i=-1;for(let l=0;l<n.length;l++)n[l].status===3||(n[l].status===1?($e(i===l-1,"All SENT items should be at beginning of queue."),i=l,n[l].status=3,n[l].abortReason="set"):($e(n[l].status===0,"Unexpected transaction status in abort"),n[l].unwatcher(),s=s.concat(Mi(e.serverSyncTree_,n[l].currentWriteId,!0)),n[l].onComplete&&r.push(n[l].onComplete.bind(null,new Error("set"),!1,null))));i===-1?HS(t,void 0):n.length=i+1,ys(e.eventQueue_,lu(t),s);for(let l=0;l<r.length;l++)pl(r[l])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t3(e){let t="";const n=e.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let s=n[r];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}t+="/"+s}return t}function n3(e){const t={};e.charAt(0)==="?"&&(e=e.substring(1));for(const n of e.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Pr(`Invalid query segment '${n}' in query '${e}'`)}return t}const Ry=function(e,t){const n=r3(e),r=n.namespace;n.domain==="firebase.com"&&vs(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&vs("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||pI();const s=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new sS(n.host,n.secure,r,s,t,"",r!==n.subdomain),path:new zt(n.pathString)}},r3=function(e){let t="",n="",r="",s="",i="",l=!0,u="https",d=443;if(typeof e=="string"){let f=e.indexOf("//");f>=0&&(u=e.substring(0,f-1),e=e.substring(f+2));let m=e.indexOf("/");m===-1&&(m=e.length);let p=e.indexOf("?");p===-1&&(p=e.length),t=e.substring(0,Math.min(m,p)),m<p&&(s=t3(e.substring(m,p)));const x=n3(e.substring(Math.min(e.length,p)));f=t.indexOf(":"),f>=0?(l=u==="https"||u==="wss",d=parseInt(t.substring(f+1),10)):f=t.length;const v=t.slice(0,f);if(v.toLowerCase()==="localhost")n="localhost";else if(v.split(".").length<=2)n=v;else{const k=t.indexOf(".");r=t.substring(0,k).toLowerCase(),n=t.substring(k+1),i=r}"ns"in x&&(i=x.ns)}return{host:t,port:d,domain:n,subdomain:r,secure:l,scheme:u,pathString:s,namespace:i}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a3{constructor(t,n,r,s){this.eventType=t,this.eventRegistration=n,this.snapshot=r,this.prevName=s}getPath(){const t=this.snapshot.ref;return this.eventType==="value"?t._path:t.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+$n(this.snapshot.exportVal())}}class s3{constructor(t,n,r){this.eventRegistration=t,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i3{constructor(t,n){this.snapshotCallback=t,this.cancelCallback=n}onValue(t,n){this.snapshotCallback.call(null,t,n)}onCancel(t){return $e(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)}get hasCancelCallback(){return!!this.cancelCallback}matches(t){return this.snapshotCallback===t.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kp{constructor(t,n,r,s){this._repo=t,this._path=n,this._queryParams=r,this._orderByCalled=s}get key(){return wt(this._path)?null:mS(this._path)}get ref(){return new fi(this._repo,this._path)}get _queryIdentifier(){const t=my(this._queryParams),n=xp(t);return n==="{}"?"default":n}get _queryObject(){return my(this._queryParams)}isEqual(t){if(t=ru(t),!(t instanceof Kp))return!1;const n=this._repo===t._repo,r=wp(this._path,t._path),s=this._queryIdentifier===t._queryIdentifier;return n&&r&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+JI(this._path)}}class fi extends Kp{constructor(t,n){super(t,n,new Np,!1)}get parent(){const t=gS(this._path);return t===null?null:new fi(this._repo,t)}get root(){let t=this;for(;t.parent!==null;)t=t.parent;return t}}class mh{constructor(t,n,r){this._node=t,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(t){const n=new zt(t),r=Wm(this.ref,t);return new mh(this._node.getChild(n),r,fn)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(t){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,s)=>t(new mh(s,Wm(this.ref,r),fn)))}hasChild(t){const n=new zt(t);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Iy(e,t){return e=ru(e),e._checkNotDeleted("ref"),Wm(e._root,t)}function Wm(e,t){return e=ru(e),yt(e._path)===null?FD("child","path",t):KS("child","path",t),new fi(e._repo,Rn(e._path,t))}function o3(e,t){e=ru(e),MD("set",e._path),LD("set",t,e._path);const n=new Dh;return KD(e._repo,e._path,t,null,n.wrapCallback(()=>{})),n.promise}class Yp{constructor(t){this.callbackContext=t}respondsTo(t){return t==="value"}createEvent(t,n){const r=n._queryParams.getIndex();return new a3("value",this,new mh(t.snapshotNode,new fi(n._repo,n._path),r))}getEventRunner(t){return t.getEventType()==="cancel"?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,null)}createCancelEvent(t,n){return this.callbackContext.hasCancelCallback?new s3(this,t,n):null}matches(t){return t instanceof Yp?!t.callbackContext||!this.callbackContext?!0:t.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function l3(e,t,n,r,s){let i;if(typeof r=="object"&&(i=void 0,s=r),typeof r=="function"&&(i=r),s&&s.onlyOnce){const d=n,f=(m,p)=>{jy(e._repo,e,u),d(m,p)};f.userCallback=n.userCallback,f.context=n.context,n=f}const l=new i3(n,i||void 0),u=new Yp(l);return XD(e._repo,e,u),()=>jy(e._repo,e,u)}function c3(e,t,n,r){return l3(e,"value",t,n,r)}lD(fi);mD(fi);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u3="FIREBASE_DATABASE_EMULATOR_HOST",Hm={};let d3=!1;function h3(e,t,n,r){const s=t.lastIndexOf(":"),i=t.substring(0,s),l=mp(i);e.repoInfo_=new sS(t,l,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0,n),r&&(e.authTokenProvider_=r)}function f3(e,t,n,r,s){let i=r||e.options.databaseURL;i===void 0&&(e.options.projectId||vs("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),cr("Using default host for project ",e.options.projectId),i=`${e.options.projectId}-default-rtdb.firebaseio.com`);let l=Ry(i,s),u=l.repoInfo,d;typeof process<"u"&&X1&&(d=X1[u3]),d?(i=`http://${d}?ns=${u.namespace}`,l=Ry(i,s),u=l.repoInfo):l.repoInfo.secure;const f=new EI(e.name,e.options,t);BD("Invalid Firebase Database URL",l),wt(l.path)||vs("Database URL must point to the root of a Firebase Database (not including a child path).");const m=p3(u,e,f,new NI(e,n));return new g3(m,e)}function m3(e,t){const n=Hm[t];(!n||n[e.key]!==e)&&vs(`Database ${t}(${e.repoInfo_}) has already been deleted.`),QD(e),delete n[e.key]}function p3(e,t,n,r){let s=Hm[t.name];s||(s={},Hm[t.name]=s);let i=s[e.toURLString()];return i&&vs("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new GD(e,d3,n,r),s[e.toURLString()]=i,i}let g3=class{constructor(t,n){this._repoInternal=t,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||($D(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new fi(this._repo,It())),this._rootInternal}_delete(){return this._rootInternal!==null&&(m3(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){this._rootInternal===null&&vs("Cannot call "+t+" on a deleted database.")}};function x3(e=X4(),t){const n=$4(e,"database").getImmediate({identifier:t});if(!n._instanceStarted){const r=jR("database");r&&v3(n,...r)}return n}function v3(e,t,n,r={}){e=ru(e),e._checkNotDeleted("useEmulator");const s=`${t}:${n}`,i=e._repoInternal;if(e._instanceStarted){if(s===e._repoInternal.repoInfo_.host&&Zd(r,i.repoInfo_.emulatorOptions))return;vs("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let l;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&vs('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),l=new qd(qd.OWNER);else if(r.mockUserToken){const u=typeof r.mockUserToken=="string"?r.mockUserToken:IR(r.mockUserToken,e.app.options.projectId);l=new qd(u)}mp(t)&&(RR(t),OR("Database",!0)),h3(i,s,r,l)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y3(e){cI(Y4),th(new Rc("database",(t,{instanceIdentifier:n})=>{const r=t.getProvider("app").getImmediate(),s=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return f3(r,s,i,n)},"PUBLIC").setMultipleInstances(!0)),$o(Q1,J1,e),$o(Q1,J1,"esm2020")}ds.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)};ds.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};y3();const k3=!1,w3={apiKey:"AIzaSyARr5onKl0bgR-0Ui9Mk87zZMnx76kiPqo",authDomain:"mnr-container-system.firebaseapp.com",databaseURL:"https://mnr-container-system-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"mnr-container-system",storageBucket:"mnr-container-system.firebasestorage.app",messagingSenderId:"85083661142",appId:"1:85083661142:web:4d8d2a9b4efe1c4a64acf7",measurementId:"G-2TFWNGB9JZ"},S3=zw(w3),Py=x3(S3),r_=T.createContext(),_3="mnr_chats",Dy="chats";function C3({children:e}){const[t,n]=T.useState([]),[r,s]=T.useState(null),[i,l]=T.useState(!1),u=T.useRef(null),d=T.useCallback(()=>{const q=localStorage.getItem(_3);if(q)try{return JSON.parse(q)}catch(O){console.error("Error loading chats:",O)}return[]},[]),f=T.useCallback(q=>{{const O=Iy(Py,Dy),V={};q.forEach(X=>{V[X.id]=X}),o3(O,V).catch(X=>{console.error("Error saving to Firebase:",X)})}},[]);T.useEffect(()=>{{console.log(" Connecting to Firebase Realtime Database...");const q=Iy(Py,Dy);return u.current=c3(q,O=>{const V=O.val();if(V){const X=Object.values(V);console.log(" Firebase: Received",X.length,"chats"),n(X)}else n([])},O=>{console.error("Firebase Error:",O)}),()=>{u.current&&u.current()}}},[d]);const m=T.useCallback((q,O=null)=>{const V={id:"chat_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),guestEmail:(q==null?void 0:q.email)||null,guestName:(q==null?void 0:q.name)||null,userId:(O==null?void 0:O.id)||null,userName:(O==null?void 0:O.fullName)||(O==null?void 0:O.username)||null,companyName:(O==null?void 0:O.shippingLineCode)||null,status:"active",messages:[],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),assignedAgent:null,unreadAdmin:0};return n(X=>{const M=[...X,V];return f(M),M}),s(V.id),V},[f]),p=T.useCallback((q=null,O=null)=>{if(r){const X=t.find(M=>M.id===r&&M.status==="active");if(X)return X}let V=null;return O!=null&&O.id?V=t.find(X=>X.userId===O.id&&X.status==="active"):q!=null&&q.email&&(V=t.find(X=>X.guestEmail===q.email&&X.status==="active")),V?(s(V.id),V):m(q,O)},[r,t,m]),x=T.useCallback((q,O,V="guest")=>{const X={id:"msg_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),text:O,sender:V,timestamp:new Date().toISOString(),read:V==="agent"};return n(M=>{const me=M.map(ae=>ae.id===q?{...ae,messages:[...ae.messages,X],updatedAt:new Date().toISOString(),unreadAdmin:V!=="agent"?(ae.unreadAdmin||0)+1:ae.unreadAdmin}:ae);return f(me),me}),X},[f]),v=T.useCallback(q=>{n(O=>{const V=O.map(X=>X.id===q?{...X,messages:X.messages.map(M=>({...M,read:!0})),unreadAdmin:0}:X);return f(V),V})},[f]),k=T.useCallback(q=>{n(O=>{const V=O.map(X=>X.id===q?{...X,status:"closed"}:X);return f(V),V}),r===q&&s(null)},[r,f]),y=T.useCallback(q=>{n(O=>{const V=O.filter(X=>X.id!==q);return f(V),V}),r===q&&s(null)},[r,f]),S=T.useCallback((q,O,V)=>{n(X=>{const M=X.map(me=>me.id===q?{...me,assignedAgent:{id:O,name:V}}:me);return f(M),M})},[f]),C=T.useCallback(q=>{const O=t.find(V=>V.id===q);return O?O.messages.filter(V=>!V.read&&V.sender!=="agent").length:0},[t]),D=T.useCallback(()=>t.filter(q=>q.status==="active").reduce((q,O)=>{const V=O.messages.filter(X=>(X.sender==="user"||X.sender==="guest")&&!X.read).length;return q+V},0),[t]),N=T.useCallback(()=>t.filter(q=>q.status==="active").sort((q,O)=>new Date(O.updatedAt)-new Date(q.updatedAt)),[t]),b=T.useCallback(q=>t.find(O=>O.id===q),[t]),H=T.useCallback(()=>{},[d]),L=T.useCallback(()=>{const q=new Date().getHours();return q>=5&&q<12?"Good Morning":q>=12&&q<18?"Good Afternoon":"Good Evening"},[]),R={chats:t,activeChat:r,setActiveChat:s,isWidgetOpen:i,setIsWidgetOpen:l,isDemoMode:k3,createChat:m,getOrCreateChat:p,sendMessage:x,markAsRead:v,closeChat:k,deleteChat:y,assignChat:S,getUnreadCount:C,getTotalUnreadAdmin:D,getActiveChats:N,getChat:b,refreshChats:H,getGreeting:L};return a.jsx(r_.Provider,{value:R,children:e})}function Gh(){const e=T.useContext(r_);if(!e)throw new Error("useChat must be used within a ChatProvider");return e}/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N3=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a_=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var E3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T3=T.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:l,...u},d)=>T.createElement("svg",{ref:d,...E3,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:a_("lucide",s),...u},[...l.map(([f,m])=>T.createElement(f,m)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=(e,t)=>{const n=T.forwardRef(({className:r,...s},i)=>T.createElement(T3,{ref:i,iconNode:t,className:a_(`lucide-${N3(e)}`,r),...s}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yo=Le("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hr=Le("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $a=Le("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oy=Le("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ph=Le("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b3=Le("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=Le("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rd=Le("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gm=Le("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A3=Le("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yi=Le("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ao=Le("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gn=Le("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gh=Le("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s_=Le("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const St=Le("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j3=Le("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R3=Le("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I3=Le("CircleMinus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P3=Le("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=Le("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ly=Le("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=Le("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jr=Le("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=Le("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const il=Le("Container",[["path",{d:"M22 7.7c0-.6-.4-1.2-.8-1.5l-6.3-3.9a1.72 1.72 0 0 0-1.7 0l-10.3 6c-.5.2-.9.8-.9 1.4v6.6c0 .5.4 1.2.8 1.5l6.3 3.9a1.72 1.72 0 0 0 1.7 0l10.3-6c.5-.3.9-1 .9-1.5Z",key:"1t2lqe"}],["path",{d:"M10 21.9V14L2.1 9.1",key:"o7czzq"}],["path",{d:"m10 14 11.9-6.9",key:"zm5e20"}],["path",{d:"M14 19.8v-8.1",key:"159ecu"}],["path",{d:"M18 17.5V9.4",key:"11uown"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i_=Le("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D3=Le("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o_=Le("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cu=Le("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zn=Le("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l_=Le("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fy=Le("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qr=Le("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O3=Le("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wn=Le("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xp=Le("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L3=Le("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xo=Le("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F3=Le("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const My=Le("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M3=Le("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B3=Le("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xh=Le("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kd=Le("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c_=Le("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const By=Le("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U3=Le("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z3=Le("LifeBuoy",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uy=Le("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zy=Le("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W3=Le("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H3=Le("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G3=Le("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $h=Le("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ho=Le("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $3=Le("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $m=Le("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u_=Le("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qo=Le("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V3=Le("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q3=Le("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K3=Le("MousePointerClick",[["path",{d:"M14 4.1 12 6",key:"ita8i4"}],["path",{d:"m5.1 8-2.9-.8",key:"1go3kf"}],["path",{d:"m6 12-1.9 2",key:"mnht97"}],["path",{d:"M7.2 2.2 8 5.1",key:"1cfko1"}],["path",{d:"M9.037 9.69a.498.498 0 0 1 .653-.653l11 4.5a.5.5 0 0 1-.074.949l-4.349 1.041a1 1 0 0 0-.74.739l-1.04 4.35a.5.5 0 0 1-.95.074z",key:"s0h3yz"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=Le("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y3=Le("PanelLeftClose",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X3=Le("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q3=Le("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J3=Le("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vm=Le("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ai=Le("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xr=Le("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d_=Le("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xi=Le("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qp=Le("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oa=Le("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bn=Le("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jp=Le("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zp=Le("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wy=Le("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z3=Le("ShieldX",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m14.5 9.5-5 5",key:"17q4r4"}],["path",{d:"m9.5 9.5 5 5",key:"18nt4w"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bc=Le("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hy=Le("Ship",[["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1 .6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"iegodh"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-9-4-9 4c0 2.9.94 5.34 2.81 7.76",key:"fp8vka"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M12 10v4",key:"1kjpxc"}],["path",{d:"M12 2v3",key:"qbqxhf"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eO=Le("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gy=Le("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tO=Le("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nO=Le("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rO=Le("Sunrise",[["path",{d:"M12 2v8",key:"1q4o3n"}],["path",{d:"m4.93 10.93 1.41 1.41",key:"2a7f42"}],["path",{d:"M2 18h2",key:"j10viu"}],["path",{d:"M20 18h2",key:"wocana"}],["path",{d:"m19.07 10.93-1.41 1.41",key:"15zs5n"}],["path",{d:"M22 22H2",key:"19qnx5"}],["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M16 18a4 4 0 0 0-8 0",key:"1lzouq"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aO=Le("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h_=Le("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f_=Le("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const La=Le("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sO=Le("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dr=Le("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=Le("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vh=Le("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nm=Le("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=Le("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const si=Le("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aa=Le("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pn=Le("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iO=Le("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),m_=T.createContext(null);function oO({children:e}){const[t,n]=T.useState([]),r=T.useCallback((m,p="info",x=4e3)=>{const v=Date.now();return n(k=>[...k,{id:v,message:m,type:p}]),x>0&&setTimeout(()=>{s(v)},x),v},[]),s=T.useCallback(m=>{n(p=>p.filter(x=>x.id!==m))},[]),i=T.useCallback(m=>r(m,"success"),[r]),l=T.useCallback(m=>r(m,"error"),[r]),u=T.useCallback(m=>r(m,"warning"),[r]),d=T.useCallback(m=>r(m,"info"),[r]),f={success:a.jsx(St,{size:20}),error:a.jsx(Gr,{size:20}),warning:a.jsx(Dr,{size:20}),info:a.jsx(xh,{size:20})};return a.jsxs(m_.Provider,{value:{addToast:r,removeToast:s,success:i,error:l,warning:u,info:d},children:[e,a.jsx("div",{className:"toast-container",children:t.map(m=>a.jsxs("div",{className:`toast toast-${m.type}`,children:[f[m.type],a.jsx("span",{className:"toast-message",children:m.message}),a.jsx("button",{className:"toast-close",onClick:()=>s(m.id),children:a.jsx(Pn,{size:16})})]},m.id))})]})}function en(){const e=T.useContext(m_);if(!e)throw new Error("useToast must be used within a ToastProvider");return e}function p_(){const{isWidgetOpen:e,setIsWidgetOpen:t,activeChat:n,getUnreadCount:r}=Gh(),s=n?r(n):0,i=()=>{t(!e)};return a.jsxs("button",{className:"live-chat-button",onClick:i,"aria-label":"Open live chat",children:[a.jsx("span",{className:"chat-icon",children:a.jsx(Qo,{size:20})}),a.jsx("span",{className:"chat-text",children:"Ask Us"}),s>0&&a.jsx("span",{className:"unread-badge",children:s})]})}function lO({onSubmit:e}){const{getGreeting:t}=Gh(),[n,r]=T.useState({name:"",email:""}),[s,i]=T.useState(!1),l=f=>{const{name:m,value:p}=f.target;r(x=>({...x,[m]:p}))},u=async f=>{f.preventDefault(),!(!n.name.trim()||!n.email.trim())&&(i(!0),await e(n),i(!1))},d=n.name.trim()&&n.email.trim();return a.jsxs("div",{className:"guest-form",children:[a.jsxs("h3",{children:[t(),"! "]}),a.jsx("p",{children:"Please provide your details to start chatting with us."}),a.jsxs("form",{onSubmit:u,children:[a.jsxs("div",{className:"guest-form-field",children:[a.jsx("label",{htmlFor:"guest-name",children:"Your Name"}),a.jsx("input",{type:"text",id:"guest-name",name:"name",value:n.name,onChange:l,placeholder:"Enter your name",required:!0,autoFocus:!0})]}),a.jsxs("div",{className:"guest-form-field",children:[a.jsx("label",{htmlFor:"guest-email",children:"Email Address"}),a.jsx("input",{type:"email",id:"guest-email",name:"email",value:n.email,onChange:l,placeholder:"Enter your email",required:!0})]}),a.jsx("button",{type:"submit",className:"guest-form-submit",disabled:!d||s,children:s?"Starting...":"Start Chat"})]})]})}function g_(){const{isWidgetOpen:e,setIsWidgetOpen:t,activeChat:n,getOrCreateChat:r,sendMessage:s,getChat:i,getGreeting:l,markAsRead:u}=Gh(),{user:d,isAuthenticated:f}=Ft(),[m,p]=T.useState(""),[x,v]=T.useState(!1),[k,y]=T.useState(null),S=T.useRef(null);T.useEffect(()=>{S.current&&S.current.scrollIntoView({behavior:"smooth"})},[k==null?void 0:k.messages]),T.useEffect(()=>{if(n){const L=i(n);y(L),u(n)}},[n,i]),T.useEffect(()=>{if(e&&!n)if(f&&d){const L=r(null,d);y(L),v(!1)}else v(!0)},[e,f,d,n]),T.useEffect(()=>{if(!n)return;const L=setInterval(()=>{const R=i(n);y(R)},2e3);return()=>clearInterval(L)},[n,i]);const C=L=>{const R=r(L,null);y(R),v(!1),s(R.id,`Welcome ${L.name}! How can we help you today?`,"agent")},D=L=>{if(L.preventDefault(),!m.trim()||!k)return;const R=f?"user":"guest";s(k.id,m.trim(),R),p("");const q=i(k.id);y(q)},N=L=>new Date(L).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),b=()=>k!=null&&k.userName?k.userName:k!=null&&k.guestName?k.guestName:"Guest",H=()=>f&&(d!=null&&d.shippingLineCode)?d.shippingLineCode:"TIIT TECH Support";return e?a.jsxs("div",{className:"live-chat-widget",children:[a.jsxs("div",{className:"chat-widget-header",children:[a.jsxs("div",{className:"chat-widget-header-info",children:[a.jsx("div",{className:"chat-widget-avatar",children:a.jsx(Qo,{size:20})}),a.jsxs("div",{children:[a.jsx("div",{className:"chat-widget-title",children:x?"TIIT TECH Support":H()}),a.jsx("div",{className:"chat-widget-subtitle",children:x?"Start a conversation":"Online"})]})]}),a.jsx("button",{className:"chat-widget-close",onClick:()=>t(!1),"aria-label":"Close chat",children:a.jsx(Pn,{size:18})})]}),x?a.jsx(lO,{onSubmit:C}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"chat-messages",children:[(k==null?void 0:k.messages.length)===0&&a.jsxs("div",{className:"chat-greeting",children:[a.jsxs("h3",{children:[l(),", ",b(),"! "]}),a.jsx("p",{children:"How can we help you today?"})]}),k==null?void 0:k.messages.map(L=>a.jsxs("div",{className:`chat-message ${L.sender}`,children:[L.text,a.jsx("span",{className:"chat-message-time",children:N(L.timestamp)})]},L.id)),a.jsx("div",{ref:S})]}),a.jsxs("form",{className:"chat-input-area",onSubmit:D,children:[a.jsx("input",{type:"text",className:"chat-input",placeholder:"Type a message...",value:m,onChange:L=>p(L.target.value),autoFocus:!0}),a.jsx("button",{type:"submit",className:"chat-send-btn",disabled:!m.trim(),"aria-label":"Send message",children:a.jsx(Jp,{size:18})})]})]})]}):null}function cO(){const[e,t]=T.useState(""),[n,r]=T.useState(""),[s,i]=T.useState(""),[l,u]=T.useState(!1),[d,f]=T.useState("shippingAgent"),[m,p]=T.useState(!1),[x,v]=T.useState(!1),[k,y]=T.useState(!1),[S,C]=T.useState(null),[D,N]=T.useState(!1),{login:b,isAuthenticated:H,user:L}=Ft(),{getAnnouncements:R,getLinks:q,getBenefits:O,getWelcomeText:V,getCodeList:X}=On(),{t:M,language:me,languages:ae,changeLanguage:ce}=Wt(),ue=cn(),K=en(),W=R(),j=q(),F=O(),U=V();T.useEffect(()=>{H&&!x&&!D&&(L==null?void 0:L.userType)!=="EXTERNAL"&&ue("/",{replace:!0})},[H,x,D,ue,L]);const I=(X==null?void 0:X("LINERS"))||[],Z={shippingAgent:"Shipping Agent",forwardingAgent:"Forwarding Agent",shipperConsignee:"Shipper/Consignee"},Y=F.find(oe=>oe.roleType===Z[d])||F[0],P=async oe=>{oe.preventDefault(),i(""),u(!0),await new Promise(xe=>setTimeout(xe,500));const Te=b(e,n);Te.success?(y(!1),N(!0),C(Te.user),v(!0)):i(M("auth.loginError")),u(!1)},ne=()=>{v(!1),t(""),r(""),N(!1)},J=oe=>{oe==null||oe.preventDefault(),y(!0)},de=[{key:"home",label:M("portal.home"),isActive:!0},{key:"about",label:M("portal.about")},{key:"services",label:M("portal.services")},{key:"contactUs",label:M("portal.contactUs")},{key:"generalEnquiry",label:M("portal.generalEnquiry")},{key:"registration",label:M("portal.registration")},{key:"accessSystem",label:M("portal.accessSystem")||"Access System",onClick:he}],E=()=>{const oe=new Date().getHours();return oe>=5&&oe<12?M("greetings.goodMorning")||"Good Morning":oe>=12&&oe<18?M("greetings.goodAfternoon")||"Good Afternoon":M("greetings.goodEvening")||"Good Evening"},A=oe=>{if((oe==null?void 0:oe.userType)==="EXTERNAL"&&(oe!=null&&oe.shippingLineCode)){const Te=I.find(xe=>xe.code===oe.shippingLineCode);return(Te==null?void 0:Te.name)||oe.shippingLineCode}return(oe==null?void 0:oe.fullName)||"User"};function he(oe){if(oe==null||oe.preventDefault(),!H){K.error(M("auth.pleaseLoginFirst")||"Please login first to access the system.");return}ue("/")}const G=[{key:"shippingAgent",label:M("portal.shippingAgent")},{key:"forwardingAgent",label:M("portal.forwardingAgent")},{key:"shipperConsignee",label:M("portal.shipperConsignee")}],Ie=()=>{if((L==null?void 0:L.userType)==="EXTERNAL"&&(L!=null&&L.shippingLineCode)){const oe=I.find(xe=>xe.code===L.shippingLineCode);return`WELCOME ${((oe==null?void 0:oe.name)||L.shippingLineCode).toUpperCase()}`}return M("portal.welcomeTo")};return a.jsxs("div",{className:"alt-portal",children:[x&&a.jsx("div",{className:"alt-modal-overlay",children:a.jsxs("div",{className:"alt-success-modal",children:[a.jsx("div",{className:"alt-success-icon",children:a.jsx(St,{size:48})}),a.jsx("h2",{children:M("auth.loginSuccess")||"Login Successful"}),a.jsxs("p",{children:[`${E()}, ${A(S)}!`,a.jsx("br",{}),M("auth.loginSuccessMessage")||"You have logged in successfully."]}),a.jsx("button",{className:"alt-modal-btn",onClick:ne,children:"OK"})]})}),k&&a.jsx("div",{className:"alt-modal-overlay",onClick:()=>y(!1),children:a.jsxs("div",{className:"alt-login-modal",onClick:oe=>oe.stopPropagation(),children:[a.jsx("button",{className:"alt-login-modal-close",onClick:()=>y(!1),children:a.jsx(Pn,{size:20})}),a.jsxs("div",{className:"alt-login-modal-header",children:[a.jsx("div",{className:"alt-login-modal-logo",children:a.jsx("img",{src:"/logo.jpg",alt:"TIIT TECH"})}),a.jsx("h2",{children:M("auth.userLogin")||"User Login"}),a.jsx("p",{children:M("auth.enterCredentials")||"Enter your credentials to access the system"})]}),a.jsxs("form",{onSubmit:P,className:"alt-login-modal-form",children:[s&&a.jsxs("div",{className:"alt-error",children:[a.jsx(s_,{size:14}),a.jsx("span",{children:s})]}),a.jsxs("div",{className:"alt-form-group",children:[a.jsx("label",{children:M("auth.username")||"Username"}),a.jsx("input",{type:"text",placeholder:M("auth.enterUsername")||"Enter username",value:e,onChange:oe=>t(oe.target.value),required:!0,autoFocus:!0})]}),a.jsxs("div",{className:"alt-form-group",children:[a.jsx("label",{children:M("auth.password")||"Password"}),a.jsx("input",{type:"password",placeholder:M("auth.enterPassword")||"Enter password",value:n,onChange:oe=>r(oe.target.value),required:!0})]}),a.jsx("button",{type:"submit",className:"alt-login-submit",disabled:l,children:l?"...":M("auth.loginButton")||"Sign In"})]})]})}),a.jsxs("header",{className:"alt-header",role:"banner",children:[a.jsxs("div",{className:"alt-header-left",children:[a.jsx("button",{className:"alt-menu-btn",onClick:()=>p(!m),"aria-label":"Toggle navigation",children:m?a.jsx(Pn,{size:24}):a.jsx(u_,{size:24})}),a.jsxs("div",{className:"alt-logo",children:[a.jsx("div",{className:"alt-logo-icon",children:a.jsx("img",{src:"/logo.jpg",alt:"TIIT TECH",className:"alt-logo-image"})}),a.jsxs("div",{className:"alt-logo-text",children:[a.jsx("span",{className:"alt-brand",children:"TIIT TECH"}),a.jsx("span",{className:"alt-subtitle",children:M("portal.containerPortal")})]})]})]}),a.jsxs("div",{className:"alt-header-right",children:[H&&L&&a.jsxs("div",{className:"alt-user-greeting",children:[a.jsxs("span",{className:"alt-greeting-text",children:[E(),", ",A(L)]}),a.jsx("span",{className:`alt-user-type-badge ${L.userType==="INTERNAL"?"internal":"external"}`,children:L.userType==="INTERNAL"?M("admin.internal"):M("admin.external")})]}),a.jsxs("div",{className:"alt-lang","aria-label":M("auth.selectLanguage"),children:[a.jsx(Xo,{size:16}),a.jsx("select",{value:me,onChange:oe=>ce(oe.target.value),children:Object.values(ae).map(oe=>a.jsxs("option",{value:oe.code,children:[oe.flag," ",oe.name]},oe.code))})]})]})]}),a.jsx("nav",{className:"alt-topnav",role:"navigation","aria-label":"Main navigation",children:de.map(oe=>a.jsx("a",{href:"#",className:`alt-topnav-item ${oe.isActive?"active":""} ${oe.isEmphasized?"emphasized":""}`,onClick:oe.onClick||void 0,children:oe.label},oe.key))}),a.jsxs("nav",{className:`alt-drawer ${m?"open":""}`,role:"navigation",children:[a.jsx("ul",{children:de.map(oe=>a.jsx("li",{children:a.jsx("a",{href:"#",onClick:Te=>{p(!1),oe.onClick&&oe.onClick(Te)},children:oe.label})},oe.key))}),a.jsx("p",{className:"alt-drawer-footer",children:"TIIT TECH  Container Management"})]}),m&&a.jsx("div",{className:"alt-overlay",onClick:()=>p(!1)}),a.jsxs("main",{className:"alt-main",role:"main",children:[a.jsxs("div",{className:"alt-welcome-section",children:[a.jsx("p",{className:"alt-eyebrow",children:Ie()}),a.jsx("h1",{className:"alt-welcome-title",children:U.titleLine||"SINGLE ACCESS FOR SHIPPING AGENTS, FORWARDING AGENTS AND SHIPPERS / CONSIGNEES."}),a.jsx("p",{className:"alt-welcome-subtitle",children:U.subtitleLine||"Manage container operations, track cargo and access Johor Port services from a unified, secure interface."})]}),a.jsxs("div",{className:"alt-features",children:[a.jsxs("div",{className:"alt-feature-img",children:[a.jsx("img",{src:"/feature-1.jpg",alt:M("portal.containerOperations")}),a.jsx("span",{className:"alt-feature-label",children:M("portal.containerOperations")})]}),a.jsxs("div",{className:"alt-feature-img",children:[a.jsx("img",{src:"/feature-2.jpg",alt:M("portal.qualityAssurance")}),a.jsx("span",{className:"alt-feature-label",children:M("portal.qualityAssurance")})]}),a.jsxs("div",{className:"alt-feature-img",children:[a.jsx("img",{src:"/feature-3.jpg",alt:M("portal.support247")}),a.jsx("span",{className:"alt-feature-label",children:M("portal.support247")})]})]}),a.jsxs("div",{className:"alt-main-grid",children:[a.jsx("div",{className:"alt-left-col",children:a.jsxs("div",{className:"alt-role-card alt-role-card-expanded",children:[a.jsx("div",{className:"alt-tabs",children:G.map(oe=>a.jsx("button",{className:d===oe.key?"active":"",onClick:()=>f(oe.key),children:oe.label},oe.key))}),a.jsxs("div",{className:"alt-benefit alt-benefit-expanded",children:[a.jsx("span",{className:"alt-benefit-badge",children:M("portal.benefit")}),a.jsx("p",{children:(Y==null?void 0:Y.content)||"TIIT TECH Container Management System will help you in carrying your day-to-day business transaction in simple way and effortlessly"}),a.jsxs("div",{className:"alt-benefit-features",children:[a.jsxs("div",{className:"alt-benefit-feature",children:[a.jsx(St,{size:16}),a.jsx("span",{children:M("portal.containerOperations")||"Container Operations"})]}),a.jsxs("div",{className:"alt-benefit-feature",children:[a.jsx(St,{size:16}),a.jsx("span",{children:M("portal.qualityAssurance")||"Quality Assurance"})]}),a.jsxs("div",{className:"alt-benefit-feature",children:[a.jsx(St,{size:16}),a.jsx("span",{children:M("portal.support247")||"24/7 Support"})]})]}),a.jsxs("button",{className:"alt-login-btn",onClick:J,children:[a.jsx(H3,{size:16}),M("auth.login")||"Login"]})]})]})}),a.jsxs("div",{className:"alt-panel announcements-panel",children:[a.jsxs("h3",{children:[a.jsx($m,{size:16})," ",M("portal.announcement")]}),a.jsx("div",{className:"alt-panel-content auto-scroll",children:W.length===0?a.jsxs("ul",{children:[a.jsxs("li",{children:[a.jsx(Gn,{size:12})," Implementation of new Safety And Security System"]}),a.jsxs("li",{children:[a.jsx(Gn,{size:12})," Introduction of new Dangerous Cargo declaration system"]}),a.jsxs("li",{children:[a.jsx(Gn,{size:12})," Implementation of new Safety And Security System"]}),a.jsxs("li",{children:[a.jsx(Gn,{size:12})," Introduction of new Dangerous Cargo declaration system"]})]}):a.jsxs("ul",{children:[W.map(oe=>a.jsxs("li",{children:[a.jsx(Gn,{size:12}),a.jsxs("div",{children:[a.jsx("strong",{children:oe.title}),oe.content&&a.jsx("p",{children:oe.content})]})]},oe.id)),W.map(oe=>a.jsxs("li",{children:[a.jsx(Gn,{size:12}),a.jsxs("div",{children:[a.jsx("strong",{children:oe.title}),oe.content&&a.jsx("p",{children:oe.content})]})]},`${oe.id}-dup`))]})})]}),a.jsxs("div",{className:"alt-panel links-panel",children:[a.jsxs("h3",{children:[a.jsx(l_,{size:16})," ",M("portal.links")]}),a.jsx("div",{className:"alt-panel-content auto-scroll",children:j.length===0?a.jsxs("ul",{children:[a.jsx("li",{children:a.jsx("a",{href:"#",children:"Lembaga Pelabuhan Johor"})}),a.jsx("li",{children:a.jsx("a",{href:"#",children:"Kastam Diraja Malaysia"})}),a.jsx("li",{children:a.jsx("a",{href:"#",children:"MAQIS"})}),a.jsx("li",{children:a.jsx("a",{href:"#",children:"Kementerian Kesihatan Malaysia"})}),a.jsx("li",{children:a.jsx("a",{href:"#",children:"Lembaga Pelabuhan Johor"})}),a.jsx("li",{children:a.jsx("a",{href:"#",children:"Kastam Diraja Malaysia"})}),a.jsx("li",{children:a.jsx("a",{href:"#",children:"MAQIS"})}),a.jsx("li",{children:a.jsx("a",{href:"#",children:"Kementerian Kesihatan Malaysia"})})]}):a.jsxs("ul",{children:[j.map(oe=>a.jsx("li",{children:a.jsx("a",{href:oe.url,target:"_blank",rel:"noopener noreferrer",children:oe.title})},oe.id)),j.map(oe=>a.jsx("li",{children:a.jsx("a",{href:oe.url,target:"_blank",rel:"noopener noreferrer",children:oe.title})},`${oe.id}-dup`))]})})]})]}),a.jsxs("div",{className:"alt-actions",children:[a.jsxs("button",{className:"alt-action danger",children:[a.jsx(z3,{size:20}),a.jsx("span",{children:M("portal.helpDesk")})]}),a.jsxs("button",{className:"alt-action glass",children:[a.jsx(Xo,{size:20}),a.jsx("span",{children:M("portal.networkInfrastructure")})]}),a.jsxs("a",{href:"#",className:"alt-action green",children:[a.jsx(eO,{size:20}),a.jsx("span",{children:M("portal.onlineMarketplace")})]}),a.jsxs("button",{className:"alt-action glass",children:[a.jsx(R3,{size:20}),a.jsx("span",{children:M("portal.faq")})]})]})]}),a.jsxs("footer",{className:"alt-footer",role:"contentinfo",children:[a.jsx("span",{children:" TIIT TECH"}),a.jsx("span",{children:"Container Management System"})]}),a.jsx(p_,{}),a.jsx(g_,{})]})}const uO=[{path:"/dashboard",icon:By,labelKey:"nav.dashboard",screenId:"dashboard"},{section:"nav.containerManagement",sectionId:"container"},{path:"/containers/register",icon:P3,labelKey:"nav.registerContainer",screenId:"container_register"},{path:"/containers",icon:il,labelKey:"nav.allContainers",screenId:"container_list"},{path:"/containers/ar",icon:tr,labelKey:"nav.arContainers",screenId:"container_ar"},{section:"nav.surveyDamage",sectionId:"survey"},{path:"/surveys/search",icon:bn,labelKey:"nav.newSurvey",screenId:"survey_new"},{path:"/surveys",icon:jr,labelKey:"nav.surveyList",screenId:"survey_list"},{section:"nav.repairManagement",sectionId:"repair"},{path:"/eor",icon:wn,labelKey:"nav.eorList",screenId:"eor_list"},{path:"/repair-orders",icon:Aa,labelKey:"nav.repairOrders",screenId:"repair_list"},{section:"nav.yardOperations",sectionId:"operations"},{path:"/shunting",icon:Va,labelKey:"nav.shunting",screenId:"shunting"},{path:"/pre-inspection",icon:hs,labelKey:"nav.preInspection",screenId:"inspection"},{path:"/washing",icon:Zn,labelKey:"nav.washingStation",screenId:"washing"},{path:"/stacking",icon:Kr,labelKey:"nav.stackingRelease",screenId:"stacking"},{section:"nav.monitoring",sectionId:"monitoring"},{path:"/monitoring/jobs",icon:Yo,labelKey:"nav.jobMonitoring",screenId:"job_monitoring"},{section:"nav.administration",sectionId:"admin"},{path:"/admin/codes",icon:D3,labelKey:"nav.masterCodes",screenId:"config_codes"},{path:"/admin/groups",icon:Bc,labelKey:"nav.permissionGroups",screenId:"config_groups"},{path:"/admin/users",icon:si,labelKey:"nav.userManagement",screenId:"config_users"},{path:"/admin/settings",icon:Zp,labelKey:"nav.systemSettings",screenId:"config_settings"},{path:"/admin/homepage",icon:By,labelKey:"nav.homePageManagement",screenId:"config_homepage"},{path:"/admin/chats",icon:Qo,labelKey:"nav.chatManagement",screenId:"config_chats"}];function dO({isOpen:e,onClose:t,isCollapsed:n,onToggleCollapse:r}){var k;const s=ma(),{user:i}=Ft(),{canAccessScreen:l}=On(),{t:u}=Wt(),[d,f]=T.useState({container:!0,survey:!0,repair:!0,operations:!0,monitoring:!0,admin:!0}),m=y=>{f(S=>({...S,[y]:!S[y]}))},p=()=>{t&&t()},v=(()=>{if(!i)return[];const y=[];let S=null,C=null;for(const D of uO){if(D.section){S=D,C=D.sectionId;continue}l(i.id,D.screenId)&&(S&&!y.find(b=>b.sectionId===C)&&y.push(S),y.push({...D,parentSection:C}))}return y.filter((D,N)=>{if(D.section){const b=y[N+1];return b&&!b.section}return!0})})();return a.jsxs("aside",{className:`sidebar ${e?"open":""} ${n?"collapsed":""}`,children:[a.jsxs("div",{className:"sidebar-header",children:[a.jsx("div",{className:"sidebar-logo",children:a.jsx("img",{src:"/logo.jpg",alt:"TIIT TECH",className:"logo-image"})}),!n&&a.jsxs("div",{className:"sidebar-brand",children:[a.jsx("h1",{children:"TIIT TECH"}),a.jsx("span",{children:"Container Depot"})]}),a.jsx("button",{className:"sidebar-close-btn",onClick:t,"aria-label":"Close menu",children:a.jsx(Pn,{size:24})})]}),a.jsx("button",{className:"sidebar-collapse-btn",onClick:r,title:n?"Expand sidebar":"Collapse sidebar",children:n?a.jsx(X3,{size:18}):a.jsx(Y3,{size:18})}),a.jsx("nav",{className:"sidebar-nav",children:v.map((y,S)=>{if(y.section){if(n)return null;const b=d[y.sectionId];return a.jsxs("div",{className:`sidebar-section ${b?"expanded":"collapsed"}`,onClick:()=>m(y.sectionId),children:[a.jsx("span",{children:u(y.section)}),b?a.jsx(Yi,{size:14}):a.jsx(Gn,{size:14})]},S)}const C=y.icon,D=y.exact?s.pathname===y.path:s.pathname.startsWith(y.path);return y.parentSection&&!d[y.parentSection]?null:a.jsxs(kw,{to:y.path,className:`sidebar-link ${D?"active":""}`,onClick:p,title:n?u(y.labelKey):void 0,children:[a.jsx(C,{size:20}),!n&&a.jsx("span",{children:u(y.labelKey)})]},y.path)})}),!n&&a.jsx("div",{className:"sidebar-footer",children:a.jsxs("div",{className:"sidebar-user",children:[a.jsx("span",{className:"user-name",children:(i==null?void 0:i.fullName)||(i==null?void 0:i.username)}),a.jsx("span",{className:"user-role",children:((k=i==null?void 0:i.groups)==null?void 0:k[0])||"User"})]})})]})}const hO=e=>{const t=new Date().getHours();return t>=5&&t<12?{text:(e==null?void 0:e("greetings.goodMorning"))||"Good Morning",icon:rO}:t>=12&&t<17?{text:(e==null?void 0:e("greetings.goodAfternoon"))||"Good Afternoon",icon:nO}:{text:(e==null?void 0:e("greetings.goodEvening"))||"Good Evening",icon:q3}};function fO({onMenuToggle:e}){var ae;const t=cn(),{user:n,logout:r}=Ft(),{t:s,language:i,languages:l,changeLanguage:u}=Wt(),{containers:d}=qt(),{togglePanel:f,isPanelOpen:m,selectContainer:p}=Tw(),x=ma(),[v,k]=T.useState(!1),[y,S]=T.useState(!1),[C,D]=T.useState(!1),N=T.useRef(null),b=T.useRef(null),H=d.filter(ce=>ce.status==="DM"),L=H.length,R=hO(s),q=R.icon;T.useEffect(()=>{const ce=ue=>{N.current&&!N.current.contains(ue.target)&&k(!1),b.current&&!b.current.contains(ue.target)&&S(!1)};return document.addEventListener("mousedown",ce),()=>document.removeEventListener("mousedown",ce)},[]);const O=()=>{const ce={"/":s("nav.dashboard"),"/containers":s("nav.allContainers"),"/containers/ar":s("nav.arContainers"),"/containers/register":s("nav.registerContainer"),"/surveys":s("nav.surveyList"),"/surveys/search":s("nav.newSurvey"),"/eor":s("nav.eorList"),"/repair-orders":s("nav.repairOrders"),"/shunting":s("nav.shunting"),"/pre-inspection":s("nav.preInspection"),"/stacking":s("nav.stackingRelease"),"/admin/codes":s("nav.masterCodes"),"/admin/groups":s("nav.permissionGroups"),"/admin/users":s("nav.userManagement"),"/admin/settings":s("nav.systemSettings")};return ce[x.pathname]?ce[x.pathname]:x.pathname.startsWith("/surveys/new")?s("survey.newSurvey"):x.pathname.startsWith("/surveys/")?s("survey.title"):x.pathname.startsWith("/eor/new")?s("eor.createEOR"):x.pathname.startsWith("/eor/")?s("eor.title"):x.pathname.startsWith("/containers/")?s("container.title"):"M&R System"},V=()=>{k(!1),r()},X=()=>{k(!1),D(!0)},M=ce=>{S(!1),p(ce.id),t(`/surveys/new/${ce.id}`)},me=ce=>{S(!1),p(ce.id)};return a.jsxs(a.Fragment,{children:[a.jsxs("header",{className:"header",children:[a.jsxs("div",{className:"header-left",children:[a.jsx("button",{className:"mobile-menu-btn",onClick:e,"aria-label":"Toggle menu",children:a.jsx(u_,{size:24})}),a.jsx("h1",{className:"header-title",children:O()})]}),a.jsxs("div",{className:"header-right",children:[a.jsxs("div",{className:"header-language",children:[a.jsx(Xo,{size:18}),a.jsx("select",{value:i,onChange:ce=>u(ce.target.value),className:"language-select-mini",children:Object.values(l).map(ce=>a.jsx("option",{value:ce.code,children:ce.flag},ce.code))})]}),a.jsx("button",{className:`header-btn ${m?"active":""}`,onClick:f,title:"Workflow Guide",children:a.jsx(jr,{size:20})}),a.jsxs("div",{className:"header-notifications",ref:b,children:[a.jsxs("button",{className:`header-btn ${y?"active":""}`,onClick:()=>S(!y),children:[a.jsx(ph,{size:20}),L>0&&a.jsx("span",{className:"notification-badge",children:L>99?"99+":L})]}),y&&a.jsxs("div",{className:"notification-dropdown",children:[a.jsxs("div",{className:"notification-header",children:[a.jsx("span",{children:" Damaged Containers"}),a.jsx("button",{className:"btn btn-ghost btn-icon btn-xs",onClick:()=>S(!1),children:a.jsx(Pn,{size:14})})]}),a.jsx("div",{className:"notification-list",children:H.length>0?a.jsxs(a.Fragment,{children:[H.slice(0,5).map(ce=>a.jsxs("div",{className:"notification-item",children:[a.jsxs("div",{className:"notification-info",children:[a.jsx("strong",{children:ce.containerNumber}),a.jsxs("span",{children:[ce.liner,"  ",ce.size,"ft"]})]}),a.jsxs("div",{className:"notification-actions",children:[a.jsx("button",{className:"btn btn-primary btn-xs",onClick:()=>M(ce),children:"Survey"}),a.jsx("button",{className:"btn btn-ghost btn-xs",onClick:()=>me(ce),children:"View"})]})]},ce.id)),H.length>5&&a.jsxs("div",{className:"notification-more",children:["+",H.length-5," more containers"]})]}):a.jsx("div",{className:"notification-empty",children:a.jsx("span",{children:" No damaged containers"})})}),a.jsx("div",{className:"notification-footer",children:a.jsxs("button",{className:"btn btn-secondary btn-sm btn-block",onClick:()=>{S(!1),t("/containers?status=DM")},children:["View All Damaged ",a.jsx($a,{size:14})]})})]})]}),a.jsxs("div",{className:"header-user-dropdown",ref:N,children:[a.jsxs("button",{className:"header-user",onClick:()=>k(!v),children:[a.jsx("div",{className:"header-avatar",children:a.jsx(Js,{size:18})}),a.jsxs("div",{className:"header-user-info hide-mobile",children:[a.jsxs("span",{className:"header-greeting",children:[a.jsx(q,{size:14}),R.text,", ",a.jsx("strong",{children:(n==null?void 0:n.fullName)||(n==null?void 0:n.username)})]}),a.jsx("span",{className:"header-role",children:((ae=n==null?void 0:n.groups)==null?void 0:ae[0])||"User"})]}),a.jsx(Yi,{size:16,className:"hide-mobile"})]}),v&&a.jsxs("div",{className:"user-dropdown-menu",children:[a.jsxs("div",{className:"dropdown-user-info",children:[a.jsx("strong",{children:(n==null?void 0:n.fullName)||(n==null?void 0:n.username)}),a.jsx("span",{children:(n==null?void 0:n.email)||""})]}),a.jsx("div",{className:"dropdown-divider"}),a.jsxs("button",{className:"dropdown-item",onClick:X,children:[a.jsx(Kd,{size:16}),a.jsx("span",{children:s("auth.changePassword")||"Change Password"})]}),a.jsxs("button",{className:"dropdown-item danger",onClick:V,children:[a.jsx(G3,{size:16}),a.jsx("span",{children:s("common.logout")})]})]})]})]})]}),C&&a.jsx(mO,{onClose:()=>D(!1)})]})}function mO({onClose:e}){const{t}=Wt(),{user:n}=Ft(),{updateUserPassword:r}=On(),[s,i]=T.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[l,u]=T.useState(""),[d,f]=T.useState(!1),m=p=>{if(p.preventDefault(),u(""),s.newPassword!==s.confirmPassword){u(t("auth.passwordMismatch")||"Passwords do not match");return}if(s.newPassword.length<6){u(t("auth.passwordTooShort")||"Password must be at least 6 characters");return}const x=r==null?void 0:r(n==null?void 0:n.id,s.currentPassword,s.newPassword);x!=null&&x.success?(f(!0),setTimeout(e,1500)):u((x==null?void 0:x.error)||t("auth.currentPasswordWrong")||"Current password is incorrect")};return a.jsx("div",{className:"modal-overlay",onClick:e,children:a.jsxs("div",{className:"modal",onClick:p=>p.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h3",{className:"modal-title",children:t("auth.changePassword")||"Change Password"}),a.jsx("button",{className:"btn btn-ghost btn-icon",onClick:e,children:""})]}),a.jsxs("form",{onSubmit:m,children:[a.jsxs("div",{className:"modal-body",children:[l&&a.jsx("div",{className:"form-error",style:{marginBottom:"var(--space-3)"},children:l}),d&&a.jsx("div",{className:"form-success",style:{marginBottom:"var(--space-3)",color:"var(--success-500)"},children:t("auth.passwordChanged")||"Password changed successfully!"}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:t("auth.currentPassword")||"Current Password"}),a.jsx("input",{type:"password",className:"form-input",value:s.currentPassword,onChange:p=>i({...s,currentPassword:p.target.value}),required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:t("auth.newPassword")||"New Password"}),a.jsx("input",{type:"password",className:"form-input",value:s.newPassword,onChange:p=>i({...s,newPassword:p.target.value}),required:!0,minLength:6})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:t("auth.confirmPassword")||"Confirm Password"}),a.jsx("input",{type:"password",className:"form-input",value:s.confirmPassword,onChange:p=>i({...s,confirmPassword:p.target.value}),required:!0})]})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{type:"button",className:"btn btn-secondary",onClick:e,children:t("common.cancel")}),a.jsx("button",{type:"submit",className:"btn btn-primary",children:t("common.save")})]})]})]})})}function pO(){const{tabs:e,activeTabId:t,closeTab:n,switchTab:r,openTab:s,closeAllOthers:i,closeAllTabs:l}=yR(),u=ma(),d=T.useRef(null),[f,m]=T.useState({visible:!1,x:0,y:0,tabId:null});T.useEffect(()=>{const k=u.pathname;if(d.current===k)return;d.current=k;const y=e.find(S=>S.path===k);y?r(y.id):s(k)},[u.pathname]);const p=(k,y)=>{k.preventDefault(),m({visible:!0,x:k.clientX,y:k.clientY,tabId:y})};T.useEffect(()=>{const k=()=>m({visible:!1,x:0,y:0,tabId:null});if(f.visible)return document.addEventListener("click",k),()=>document.removeEventListener("click",k)},[f.visible]);const x=()=>{f.tabId&&i(f.tabId),m({visible:!1,x:0,y:0,tabId:null})},v=()=>{f.tabId&&n(f.tabId),m({visible:!1,x:0,y:0,tabId:null})};return e.length===0?null:a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"tab-bar",children:[a.jsx("div",{className:"tab-bar-scroll",children:e.map(k=>a.jsxs("div",{className:`tab-item ${k.id===t?"active":""}`,onClick:()=>r(k.id),onContextMenu:y=>p(y,k.id),children:[a.jsx("span",{className:"tab-title",children:k.title}),a.jsx("button",{className:"tab-close",onClick:y=>{y.stopPropagation(),n(k.id)},title:"Close tab (Ctrl+W)",children:a.jsx(Pn,{size:14})})]},k.id))}),a.jsxs("div",{className:"tab-bar-actions",children:[e.length>1&&a.jsx("button",{className:"tab-close-all",onClick:()=>i(),title:"Close all other tabs",children:a.jsx(Gr,{size:16})}),a.jsxs("span",{className:"tab-bar-info",children:[e.length," / 30"]})]})]}),f.visible&&a.jsxs("div",{className:"tab-context-menu",style:{left:f.x,top:f.y},children:[a.jsx("button",{onClick:v,children:"Close"}),a.jsx("button",{onClick:x,children:"Close Other Tabs"}),a.jsx("button",{onClick:()=>{l(),m({visible:!1,x:0,y:0,tabId:null})},children:"Close All Tabs"})]})]})}function gO(){const e=cn(),{t}=Wt(),{user:n}=Ft();en();const{containers:r,repairOrders:s,createRepairOrder:i,eors:l}=qt(),{selectedContainerId:u,selectedContainer:d,isPanelOpen:f,workflowSteps:m,currentStep:p,setIsPanelOpen:x,selectContainer:v,clearSelection:k,getNextAction:y,containerEOR:S}=Tw(),[C,D]=T.useState(""),N=T.useRef(null),b=r.filter(V=>["DM","STACKING","AR","REPAIR","COMPLETED"].includes(V.status)),H=C.length>0?b.filter(V=>{var X;return V.containerNumber.toLowerCase().includes(C.toLowerCase())||((X=V.liner)==null?void 0:X.toLowerCase().includes(C.toLowerCase()))}):b,L=V=>{v(V.id),D("")},R=()=>{var V;D(""),k(),(V=N.current)==null||V.focus()},q=V=>{D(V.target.value)},O={0:Kr,1:jr,2:jr,3:wn,4:aO,5:Va,6:Aa,7:Aa,8:Zn,9:bn,10:c_};return y(),f?a.jsxs("div",{className:"workflow-panel",children:[a.jsxs("div",{className:"workflow-header",children:[a.jsx("h3",{children:" Workflow Guide"}),a.jsx("button",{className:"btn btn-ghost btn-icon",onClick:()=>x(!1),children:a.jsx(Pn,{size:18})})]}),a.jsxs("div",{className:"workflow-selector",children:[a.jsx("label",{children:"Search Container"}),a.jsxs("div",{className:"workflow-search-wrapper",children:[a.jsx(bn,{size:16,className:"search-icon"}),a.jsx("input",{ref:N,type:"text",className:"workflow-search-input",placeholder:"Type to filter...",value:C,onChange:q,autoComplete:"off"}),C&&a.jsx("button",{type:"button",className:"search-clear",onClick:R,children:a.jsx(Pn,{size:14})})]})]}),!d&&a.jsx("div",{className:"workflow-container-list",children:H.length>0?H.map(V=>a.jsxs("div",{className:`container-list-item ${u===V.id?"selected":""}`,onClick:()=>L(V),children:[a.jsxs("div",{className:"container-list-main",children:[a.jsx(Kr,{size:14}),a.jsx("span",{className:"container-list-number",children:V.containerNumber}),a.jsx("span",{className:`container-list-status status-${V.status.toLowerCase()}`,children:V.status})]}),a.jsxs("div",{className:"container-list-detail",children:[V.liner,"  ",V.size,"ft ",V.type]})]},V.id)):a.jsx("div",{className:"container-list-empty",children:"No containers found"})}),d&&a.jsxs("div",{className:"workflow-steps",children:[a.jsxs("div",{className:"workflow-container-info",children:[a.jsx(Kr,{size:18}),a.jsxs("div",{children:[a.jsx("strong",{children:d.containerNumber}),a.jsxs("span",{children:[d.liner,"  ",d.size,"ft ",d.type]})]}),a.jsx("button",{className:"btn btn-ghost btn-xs",onClick:R,title:"Change container",children:"Change"})]}),a.jsx("div",{className:"steps-list",children:m.map((V,X)=>{var ue,K;const M=O[X]||Ly,me=V.status==="completed",ae=V.status==="current",ce=V.status==="skipped";return a.jsxs("div",{className:`step-item ${V.status}`,children:[a.jsxs("div",{className:"step-indicator",children:[me?a.jsx(j3,{size:20,className:"step-icon completed"}):ce?a.jsx(I3,{size:20,className:"step-icon skipped"}):ae?a.jsx("div",{className:"step-icon current",children:a.jsx(M,{size:14})}):a.jsx(Ly,{size:20,className:"step-icon pending"}),X<m.length-1&&a.jsx("div",{className:`step-line ${me?"completed":ce?"skipped":""}`})]}),a.jsxs("div",{className:"step-content",children:[a.jsxs("span",{className:"step-label",children:[V.label,ce&&a.jsx("span",{className:"step-skipped-badge",children:"Skipped"})]}),((ue=V.data)==null?void 0:ue.detail)&&a.jsx("span",{className:"step-detail",children:V.data.detail}),((K=V.data)==null?void 0:K.id)&&a.jsx("span",{className:"step-id",children:V.data.id})]})]},V.id)})})]}),a.jsx("div",{className:"workflow-footer",children:a.jsx("button",{className:"btn btn-secondary btn-sm btn-block",onClick:()=>e("/containers"),children:"View All Containers"})})]}):null}const xO=T.createContext();function vO(){const[e,t]=T.useState(!1),[n,r]=T.useState(!1),s=()=>{t(!e)},i=()=>{t(!1)},l=()=>{r(!n)};return a.jsx(xO.Provider,{value:{isMobileMenuOpen:e,toggleMobileMenu:s,closeMobileMenu:i},children:a.jsxs("div",{className:`layout ${n?"sidebar-collapsed":""}`,children:[a.jsx("div",{className:`sidebar-overlay ${e?"visible":""}`,onClick:i}),a.jsx(dO,{isOpen:e,onClose:i,isCollapsed:n,onToggleCollapse:l}),a.jsxs("div",{className:"layout-main",children:[a.jsx(fO,{onMenuToggle:s}),a.jsx(pO,{}),a.jsx("main",{className:"layout-content",children:a.jsx(dT,{})})]}),a.jsx(gO,{}),a.jsx(p_,{}),a.jsx(g_,{})]})})}function yO(){const{t:e}=Wt(),{user:t}=Ft(),n=()=>{const r=new Date().getHours();return r>=5&&r<12?e("greetings.goodMorning")||"Good Morning":r>=12&&r<18?e("greetings.goodAfternoon")||"Good Afternoon":e("greetings.goodEvening")||"Good Evening"};return a.jsx("div",{className:"workspace-empty",children:a.jsxs("div",{className:"workspace-content",children:[a.jsx("div",{className:"workspace-icon",children:a.jsx(U3,{size:48})}),a.jsxs("h2",{className:"workspace-greeting",children:[n(),", ",(t==null?void 0:t.fullName)||(t==null?void 0:t.username),"!"]}),a.jsx("p",{className:"workspace-message",children:e("workspace.selectScreen")||"Please select a screen from the menu to get started."}),a.jsxs("div",{className:"workspace-hint",children:[a.jsx(K3,{size:20}),a.jsx("span",{children:e("workspace.menuHint")||"Use the navigation menu on the left to open screens"})]})]})})}function kO(){var ce,ue,K;const{containers:e,surveys:t,eors:n,repairOrders:r,getContainerStats:s,getEORStats:i,auditLogs:l,reloadFromStorage:u}=qt(),{t:d}=Wt(),f=cn(),[m,p]=T.useState(""),[x,v]=T.useState([]),[k,y]=T.useState([]),[S,C]=T.useState([]),[D,N]=T.useState([]);T.useEffect(()=>{const W=()=>{v(JSON.parse(localStorage.getItem("mnr_shunting")||"[]")),y(JSON.parse(localStorage.getItem("mnr_preinspections")||"[]")),C(JSON.parse(localStorage.getItem("mnr_stacking")||"[]")),N(JSON.parse(localStorage.getItem("mnr_washing")||"[]"))};W();const j=setInterval(W,2e3),F=()=>{document.visibilityState==="visible"&&(W(),u())},U=()=>{W(),u()};return document.addEventListener("visibilitychange",F),window.addEventListener("focus",U),()=>{clearInterval(j),document.removeEventListener("visibilitychange",F),window.removeEventListener("focus",U)}},[]);const b=s(),H=i(),L=[{id:"stacking",label:d("workflow.stacking")||"Stacking",icon:Kr,count:e.filter(W=>W.status==="STACKING").length,color:"var(--neutral-500)",path:"/containers?status=STACKING"},{id:"washing",label:d("workflow.washing")||"Washing",icon:Zn,count:D.filter(W=>W.status!=="COMPLETED").length,color:"var(--info-500)",path:"/washing"},{id:"survey",label:d("workflow.survey")||"Survey",icon:jr,count:t.filter(W=>W.status==="DRAFT"||W.status==="IN_PROGRESS").length,color:"var(--primary-500)",path:"/surveys?workflow_filter=active"},{id:"eor",label:d("workflow.eor")||"EOR",icon:wn,count:n.filter(W=>W.status==="DRAFT"||W.status==="SENT").length,color:"var(--warning-500)",path:"/eor?workflow_filter=draft_sent"},{id:"approval",label:d("workflow.approval")||"Approval",icon:St,count:n.filter(W=>W.status==="PENDING"||W.status==="SENT").length,color:"var(--secondary-500)",path:"/eor?workflow_filter=pending_approval"},{id:"repair",label:d("workflow.repair")||"Repair",icon:Aa,count:r.filter(W=>W.status==="NEW"||W.status==="PENDING"||W.status==="IN_PROGRESS").length,color:"var(--error-500)",path:"/repair-orders?workflow_filter=active"},{id:"shunting",label:d("workflow.shunting")||"Shunting",icon:Va,count:x.filter(W=>W.status!=="COMPLETED").length,color:"var(--info-500)",path:"/shunting?workflow_filter=active"},{id:"qc",label:d("workflow.qc")||"QC",icon:hs,count:k.filter(W=>W.result==="PENDING").length,color:"var(--accent-500)",path:"/pre-inspection?workflow_filter=pending"},{id:"release",label:d("workflow.release")||"Release",icon:Kr,count:S.filter(W=>W.status==="COMPLETED").length,color:"var(--success-500)",path:"/stacking?workflow_filter=completed"}],R=[{id:"pending_surveys",label:d("pending.surveysToComplete")||"Surveys to Complete",count:t.filter(W=>W.status==="IN_PROGRESS").length,icon:jr,path:"/surveys?status=IN_PROGRESS",priority:"high"},{id:"pending_approvals",label:d("pending.approvalsNeeded")||"Approvals Needed",count:n.filter(W=>W.status==="PENDING"||W.status==="SENT").length,icon:St,path:"/eor?status=PENDING",priority:"high"},{id:"pending_repairs",label:d("pending.repairsInProgress")||"Repairs in Progress",count:r.filter(W=>W.status==="IN_PROGRESS").length,icon:Aa,path:"/repair-orders",priority:"medium"},{id:"pending_inspections",label:d("pending.inspectionsPending")||"Inspections Pending",count:k.filter(W=>W.result==="PENDING").length,icon:hs,path:"/pre-inspection",priority:"medium"}].filter(W=>W.count>0),q=[...t.slice(0,3).map(W=>({type:"survey",icon:jr,text:`Survey created for ${W.containerNumber}`,time:W.createdAt,path:`/surveys/${W.id}`})),...n.slice(0,3).map(W=>({type:"eor",icon:wn,text:`EOR ${W.status.toLowerCase()} - ${W.containerNumber}`,time:W.updatedAt||W.createdAt,path:`/eor/${W.id}`})),...r.slice(0,2).map(W=>({type:"repair",icon:Aa,text:`Repair order ${W.status.toLowerCase().replace("_"," ")} - ${W.containerNumber}`,time:W.createdAt,path:`/repair-orders/${W.id}`}))].sort((W,j)=>new Date(j.time)-new Date(W.time)).slice(0,8),O=W=>{W.preventDefault(),m.trim()&&f(`/containers?search=${encodeURIComponent(m.trim())}`)},V=[{icon:il,label:d("dashboard.totalContainers")||"Total Containers",value:b.total,color:"var(--primary-500)",bg:"rgba(22, 119, 255, 0.1)"},{icon:Dr,label:d("dashboard.damaged")||"Damaged (DM)",value:((ce=b.byStatus)==null?void 0:ce.DM)||0,color:"var(--warning-500)",bg:"rgba(250, 173, 20, 0.1)"},{icon:tr,label:d("dashboard.awaitingRepair")||"Awaiting Repair (AR)",value:((ue=b.byStatus)==null?void 0:ue.AR)||0,color:"var(--error-500)",bg:"rgba(255, 77, 79, 0.1)"},{icon:St,label:d("dashboard.available")||"Available (AV)",value:((K=b.byStatus)==null?void 0:K.AV)||0,color:"var(--success-500)",bg:"rgba(82, 196, 26, 0.1)"}],X=[{label:d("eor.draft")||"Draft",value:H.draft,status:"draft"},{label:d("eor.pending")||"Pending",value:H.pending,status:"pending"},{label:d("eor.approved")||"Approved",value:H.approved,status:"approved"},{label:d("dashboard.totalValue")||"Total Value",value:`RM ${H.totalValue.toLocaleString()}`,status:"value"}],M=t.slice(0,5),me=n.slice(0,5),ae=[{icon:jr,label:d("nav.newSurvey")||"New Survey",to:"/surveys/search",color:"var(--primary-500)"},{icon:wn,label:d("nav.eorList")||"Create EOR",to:"/eor",color:"var(--secondary-500)"},{icon:il,label:d("nav.arContainers")||"AR List",to:"/containers/ar",color:"var(--warning-500)"},{icon:Aa,label:d("nav.repairOrders")||"Repairs",to:"/repair-orders",color:"var(--success-500)"}];return a.jsxs("div",{className:"dashboard",children:[a.jsx("div",{className:"dashboard-search-bar",children:a.jsx("form",{onSubmit:O,className:"search-form",children:a.jsxs("div",{className:"search-input-wrapper",children:[a.jsx(bn,{size:20}),a.jsx("input",{type:"text",placeholder:d("dashboard.searchContainers")||"Search containers by number, liner, or size...",value:m,onChange:W=>p(W.target.value),className:"search-input"}),a.jsx("button",{type:"submit",className:"btn btn-primary btn-sm",children:d("common.search")||"Search"})]})})}),a.jsx("div",{className:"stats-row",children:V.map((W,j)=>{const F=W.icon;return a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-card-icon",style:{background:W.bg},children:a.jsx(F,{size:24,style:{color:W.color}})}),a.jsxs("div",{className:"stat-card-content",children:[a.jsx("div",{className:"stat-card-value",children:W.value}),a.jsx("div",{className:"stat-card-label",children:W.label})]})]},j)})}),a.jsxs("div",{className:"card workflow-tracker-card",children:[a.jsx("div",{className:"card-header",children:a.jsxs("h3",{className:"card-title",children:[a.jsx(sO,{size:18}),d("dashboard.workflowTracker")||"Workflow Progress Tracker"]})}),a.jsx("div",{className:"workflow-tracker",children:L.map((W,j)=>{const F=W.icon;return a.jsxs(vt,{to:W.path,className:"workflow-stage",children:[a.jsx("div",{className:"workflow-stage-icon",style:{background:`${W.color}15`,color:W.color},children:a.jsx(F,{size:20})}),a.jsxs("div",{className:"workflow-stage-content",children:[a.jsx("div",{className:"workflow-stage-count",children:W.count}),a.jsx("div",{className:"workflow-stage-label",children:W.label})]}),j<L.length-1&&a.jsx("div",{className:"workflow-connector",children:a.jsx($a,{size:14})})]},W.id)})})]}),a.jsxs("div",{className:"dashboard-grid",children:[a.jsxs("div",{className:"card pending-actions-card",children:[a.jsxs("div",{className:"card-header",children:[a.jsxs("h3",{className:"card-title",children:[a.jsx(ph,{size:18}),d("dashboard.pendingActions")||"Pending Actions"]}),R.length>0&&a.jsx("span",{className:"pending-badge",children:R.reduce((W,j)=>W+j.count,0)})]}),a.jsx("div",{className:"pending-actions-list",children:R.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx(St,{size:32}),a.jsx("p",{children:d("dashboard.noPendingActions")||"No pending actions"})]}):R.map(W=>{const j=W.icon;return a.jsxs(vt,{to:W.path,className:`pending-action-item priority-${W.priority}`,children:[a.jsx("div",{className:"pending-action-icon",children:a.jsx(j,{size:18})}),a.jsxs("div",{className:"pending-action-content",children:[a.jsx("span",{className:"pending-action-label",children:W.label}),a.jsx("span",{className:"pending-action-count",children:W.count})]}),a.jsx($a,{size:14,className:"pending-action-arrow"})]},W.id)})})]}),a.jsxs("div",{className:"card activity-feed-card",children:[a.jsx("div",{className:"card-header",children:a.jsxs("h3",{className:"card-title",children:[a.jsx(Yo,{size:18}),d("dashboard.recentActivity")||"Recent Activity"]})}),a.jsx("div",{className:"activity-feed",children:q.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx(Yo,{size:32}),a.jsx("p",{children:d("dashboard.noRecentActivity")||"No recent activity"})]}):q.map((W,j)=>{const F=W.icon;return a.jsxs(vt,{to:W.path,className:"activity-item",children:[a.jsx("div",{className:`activity-icon activity-${W.type}`,children:a.jsx(F,{size:14})}),a.jsxs("div",{className:"activity-content",children:[a.jsx("span",{className:"activity-text",children:W.text}),a.jsx("span",{className:"activity-time",children:new Date(W.time).toLocaleString()})]})]},j)})})]})]}),a.jsxs("div",{className:"dashboard-grid",children:[a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"card-header",children:[a.jsxs("h3",{className:"card-title",children:[a.jsx(wn,{size:18}),d("dashboard.eorOverview")||"EOR Overview"]}),a.jsxs("button",{onClick:()=>f("/eor"),className:"btn btn-ghost btn-sm",style:{cursor:"pointer"},children:[d("common.viewAll")||"View All"," ",a.jsx($a,{size:14})]})]}),a.jsx("div",{className:"eor-summary",children:X.map((W,j)=>a.jsxs("div",{className:`eor-stat eor-stat-${W.status}`,children:[a.jsx("div",{className:"eor-stat-value",children:W.value}),a.jsx("div",{className:"eor-stat-label",children:W.label})]},j))})]}),a.jsxs("div",{className:"card",children:[a.jsx("div",{className:"card-header",children:a.jsxs("h3",{className:"card-title",children:[a.jsx(c_,{size:18}),d("dashboard.quickActions")||"Quick Actions"]})}),a.jsx("div",{className:"quick-actions-compact",children:ae.map((W,j)=>{const F=W.icon;return a.jsxs(vt,{to:W.to,className:"quick-action-item",children:[a.jsx("div",{className:"quick-action-icon-sm",style:{background:`${W.color}15`,color:W.color},children:a.jsx(F,{size:18})}),a.jsx("span",{children:W.label}),a.jsx($a,{size:14,className:"quick-action-arrow"})]},j)})})]})]}),a.jsxs("div",{className:"dashboard-grid",children:[a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"card-header",children:[a.jsxs("h3",{className:"card-title",children:[a.jsx(jr,{size:18}),d("dashboard.recentSurveys")||"Recent Surveys"]}),a.jsxs(vt,{to:"/surveys",className:"btn btn-ghost btn-sm",children:[d("common.viewAll")||"View All"," ",a.jsx($a,{size:14})]})]}),a.jsx("div",{className:"recent-list",children:M.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx(jr,{size:32}),a.jsx("p",{children:d("dashboard.noSurveysYet")||"No surveys yet"})]}):M.map(W=>a.jsxs(vt,{to:`/surveys/${W.id}`,className:"recent-item",children:[a.jsxs("div",{className:"recent-item-main",children:[a.jsx("span",{className:"container-number",children:W.containerNumber}),a.jsx("span",{className:`badge badge-${W.status.toLowerCase()}`,children:W.status})]}),a.jsxs("div",{className:"recent-item-sub",children:[W.id,"  ",new Date(W.createdAt).toLocaleDateString()]})]},W.id))})]}),a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"card-header",children:[a.jsxs("h3",{className:"card-title",children:[a.jsx(wn,{size:18}),d("dashboard.recentEORs")||"Recent EORs"]}),a.jsxs(vt,{to:"/eor",className:"btn btn-ghost btn-sm",children:[d("common.viewAll")||"View All"," ",a.jsx($a,{size:14})]})]}),a.jsx("div",{className:"recent-list",children:me.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx(wn,{size:32}),a.jsx("p",{children:d("dashboard.noEORsYet")||"No EORs yet"})]}):me.map(W=>a.jsxs(vt,{to:`/eor/${W.id}`,className:"recent-item",children:[a.jsxs("div",{className:"recent-item-main",children:[a.jsx("span",{className:"container-number",children:W.containerNumber}),a.jsx("span",{className:`badge badge-${W.status.toLowerCase().replace("_","-")}`,children:W.autoApproved?"Auto":W.status.replace("_"," ")})]}),a.jsxs("div",{className:"recent-item-sub",children:[W.id,"  RM ",W.totalCost]})]},W.id))})]})]})]})}function _s({screenId:e,onRetrieve:t}){const{reloadFromStorage:n}=qt(),{hasScreenPermission:r}=Ft(),{t:s}=Wt(),i=en(),[l,u]=T.useState(!1);if(!r(e,"retrieve"))return null;const d=async()=>{u(!0);try{await new Promise(f=>setTimeout(f,300)),n(),i.success(s("common.dataReloaded")||"Data reloaded successfully"),t&&t()}catch{i.error(s("common.reloadError")||"Failed to reload data")}finally{u(!1)}};return a.jsxs("button",{className:`btn btn-secondary btn-sm ${l?"loading":""}`,onClick:d,disabled:l,title:s("common.retrieve")||"Retrieve",children:[a.jsx(Xi,{size:16,className:l?"spin":""}),s("common.retrieve")||"Retrieve"]})}const $y=[{code:"FREN",name:"Front End"},{code:"REEN",name:"Rear End"},{code:"LSP",name:"Left Side Panel"},{code:"RSP",name:"Right Side Panel"},{code:"ROOF",name:"Roof"},{code:"FLR",name:"Floor"},{code:"DOOR",name:"Door"},{code:"UR",name:"Under Rail"},{code:"CCR",name:"Corner Casting"},{code:"CFT",name:"Corner Fitting"},{code:"FORK",name:"Forklift Pocket"},{code:"SEAL",name:"Door Seal"},{code:"LOCK",name:"Lock Rod"}],Vy=[{code:"DT",name:"Dent"},{code:"HL",name:"Hole"},{code:"CR",name:"Crack"},{code:"BT",name:"Bent"},{code:"CT",name:"Cut"},{code:"RS",name:"Rust"},{code:"MS",name:"Missing"},{code:"BK",name:"Broken"},{code:"SC",name:"Scratched"},{code:"TN",name:"Torn"},{code:"WT",name:"Wet"},{code:"DR",name:"Dirty"},{code:"LP",name:"Leaking"},{code:"OD",name:"Odor"}],qy=[{code:"RP",name:"Repair",laborHours:1},{code:"RL",name:"Replace",laborHours:2},{code:"ST",name:"Straighten",laborHours:.5},{code:"WD",name:"Weld",laborHours:1.5},{code:"PT",name:"Paint",laborHours:.5},{code:"CL",name:"Clean",laborHours:.25},{code:"SB",name:"Sandblast",laborHours:1},{code:"PH",name:"Patch",laborHours:1.5}],Ky=[{code:"PNL",name:"Panel",unitPrice:45},{code:"CRN",name:"Corner Post",unitPrice:120},{code:"RAL",name:"Rail",unitPrice:80},{code:"XMB",name:"Cross Member",unitPrice:35},{code:"DPL",name:"Door Panel",unitPrice:150},{code:"DRL",name:"Door Rail",unitPrice:60},{code:"LCK",name:"Lock Rod",unitPrice:25},{code:"HNG",name:"Hinge",unitPrice:40},{code:"GSK",name:"Gasket",unitPrice:15},{code:"PLW",name:"Plywood",unitPrice:20},{code:"ALM",name:"Aluminum",unitPrice:55},{code:"STL",name:"Steel",unitPrice:30}],Ea=[{code:"MSC",name:"Mediterranean Shipping Company",email:"mnr@msc.com"},{code:"MSK",name:"Maersk Line",email:"mnr@maersk.com"},{code:"CMA",name:"CMA CGM",email:"mnr@cma-cgm.com"},{code:"CSL",name:"COSCO Shipping",email:"mnr@cosco.com"},{code:"HPL",name:"Hapag-Lloyd",email:"mnr@hapag-lloyd.com"},{code:"ONE",name:"Ocean Network Express",email:"mnr@one-line.com"},{code:"EVG",name:"Evergreen Marine",email:"mnr@evergreen-marine.com"},{code:"YML",name:"Yang Ming Line",email:"mnr@yangming.com"},{code:"PIL",name:"Pacific International Lines",email:"mnr@pilship.com"},{code:"ZIM",name:"ZIM Integrated Shipping",email:"mnr@zim.com"}],dc=[{code:"A",rows:20,tiers:5},{code:"B",rows:20,tiers:5},{code:"C",rows:15,tiers:4},{code:"D",rows:15,tiers:4},{code:"E",rows:10,tiers:3},{code:"R1",rows:8,tiers:2,type:"REPAIR"},{code:"R2",rows:8,tiers:2,type:"REPAIR"},{code:"BUF",rows:5,tiers:2,type:"BUFFER"}],Xs=(e,t)=>{const n=e.find(r=>r.code===t);return n?n.name:t};function wO(){const{containers:e,surveys:t,eors:n,repairOrders:r,updateContainer:s}=qt(),{user:i}=Ft(),u=(i==null?void 0:i.userType)==="EXTERNAL"&&(i!=null&&i.shippingLineCode)?i.shippingLineCode:null,[d,f]=T.useState(""),[m,p]=T.useState(u||"");u&&m!==u&&p(u);const{t:x}=Wt(),v=en(),k=cn(),[y,S]=T.useState(""),[C,D]=T.useState(1),[N,b]=T.useState([]),[H,L]=T.useState(!1),[R,q]=T.useState(""),[O,V]=T.useState(null),[X,M]=T.useState(!0),me=Gi.CONTAINERS_PER_PAGE,ae=JSON.parse(localStorage.getItem("mnr_shunting")||"[]"),ce=JSON.parse(localStorage.getItem("mnr_preinspections")||"[]"),ue=e.filter(E=>{const A=!y||E.containerNumber.toLowerCase().includes(y.toLowerCase())||E.booking&&E.booking.toLowerCase().includes(y.toLowerCase()),he=!d||E.status===d,G=!m||E.liner===m;return A&&he&&G}),K=Math.ceil(ue.length/me),W=(C-1)*me,j=W+me,F=ue.slice(W,j),U=(E,A)=>{E(A),D(1)},I=E=>{const A=[];return E.gateInDate&&A.push({event:"Gate In",date:E.gateInDate,status:"STACKING",icon:"gate"}),t.filter(xe=>xe.containerId===E.id).forEach(xe=>{A.push({event:"Survey Created",date:xe.createdAt,status:xe.status,details:`Type: ${xe.surveyType}`,id:xe.id,icon:"survey"}),xe.status==="COMPLETED"&&A.push({event:"Survey Completed",date:xe.completedAt||xe.updatedAt,status:"COMPLETED",details:xe.initialCondition==="DAMAGED"?"Damage Found":"No Damage",icon:"survey"})}),n.filter(xe=>xe.containerId===E.id).forEach(xe=>{A.push({event:"EOR Created",date:xe.createdAt,status:xe.status,details:`Cost: RM ${xe.totalCost}`,id:xe.id,icon:"eor"}),(xe.status==="APPROVED"||xe.status==="AUTO_APPROVED")&&A.push({event:xe.autoApproved?"Auto-Approved":"EOR Approved",date:xe.approvedAt||xe.updatedAt,status:"APPROVED",icon:"eor"})}),ae.filter(xe=>xe.containerId===E.id).forEach(xe=>{A.push({event:"Shunting Request",date:xe.createdAt,status:xe.status,details:`To: ${xe.toBlock}`,icon:"shunting"}),xe.status==="COMPLETED"&&A.push({event:"Shunting Completed",date:xe.completedAt,status:"COMPLETED",icon:"shunting"})}),r.filter(xe=>xe.containerId===E.id).forEach(xe=>{A.push({event:"Repair Order Created",date:xe.createdAt,status:xe.status,icon:"repair"}),xe.status==="IN_PROGRESS"&&A.push({event:"Repair Started",date:xe.startedAt||xe.updatedAt,status:"IN_PROGRESS",icon:"repair"}),xe.status==="COMPLETED"&&A.push({event:"Repair Completed",date:xe.completedAt,status:"COMPLETED",icon:"repair"})}),ce.filter(xe=>xe.containerId===E.id).forEach(xe=>{A.push({event:"Inspection Scheduled",date:xe.createdAt,status:xe.status,details:`Scheduled: ${new Date(xe.scheduledDate).toLocaleDateString()}`,icon:"inspection"}),xe.status==="COMPLETED"&&A.push({event:xe.result==="ACCEPTED"?"Inspection Passed":"Rework Required",date:xe.completedAt,status:xe.result,icon:"inspection"})}),A.sort((xe,we)=>new Date(xe.date)-new Date(we.date)),A},Z=E=>{b(A=>A.includes(E)?A.filter(he=>he!==E):[...A,E])},Y=()=>{const E=F.map(A=>A.id);E.every(A=>N.includes(A))?b(A=>A.filter(he=>!E.includes(he))):b(A=>[...new Set([...A,...E])])},P=()=>{!R||N.length===0||(N.forEach(E=>{s(E,{status:R},(i==null?void 0:i.username)||"SYSTEM")}),v.success(`Updated ${N.length} containers to ${Oi[R]}`),b([]),L(!1),q(""))},ne=(E,A)=>{s(E,{status:"DM"},(i==null?void 0:i.username)||"SYSTEM"),v.success(`Container ${A} changed to Damaged status`)},J=E=>`badge-${{STACKING:"stacking",AV:"av",DM:"dm",AR:"ar",REPAIR:"repair",COMPLETED:"completed"}[E]||"draft"}`,de=E=>r.find(Ie=>Ie.containerId===E.id&&Ie.status==="IN_PROGRESS")?{stage:"Repair",color:"var(--warning-500)"}:n.find(Ie=>Ie.containerId===E.id&&(Ie.status==="PENDING"||Ie.status==="SENT"))?{stage:"Approval",color:"var(--secondary-500)"}:t.find(Ie=>Ie.containerId===E.id&&Ie.status==="IN_PROGRESS")?{stage:"Survey",color:"var(--primary-500)"}:null;return a.jsxs("div",{className:"page-list-layout",children:[a.jsxs("div",{className:"page-list-header",children:[a.jsxs("div",{className:"page-header",children:[a.jsxs("div",{children:[a.jsx("h2",{children:x("nav.containerManagement")}),a.jsx("p",{className:"text-muted",children:x("container.allContainers")})]}),a.jsxs("div",{className:"header-stats",children:[a.jsxs("div",{className:"header-stat",children:[a.jsx("span",{className:"header-stat-value",children:e.filter(E=>E.status==="STACKING").length}),a.jsx("span",{className:"header-stat-label",children:"Stacking"})]}),a.jsxs("div",{className:"header-stat",children:[a.jsx("span",{className:"header-stat-value",children:e.filter(E=>E.status==="DM").length}),a.jsx("span",{className:"header-stat-label",children:"Damaged"})]}),a.jsxs("div",{className:"header-stat",children:[a.jsx("span",{className:"header-stat-value",children:e.filter(E=>E.status==="REPAIR").length}),a.jsx("span",{className:"header-stat-label",children:"In Repair"})]}),a.jsxs("div",{className:"header-stat",children:[a.jsx("span",{className:"header-stat-value",children:e.filter(E=>E.status==="AV").length}),a.jsx("span",{className:"header-stat-label",children:"Available"})]}),a.jsx(_s,{screenId:"container_list"}),a.jsxs("button",{className:`filter-toggle-btn ${X?"":"collapsed"}`,onClick:()=>M(!X),title:X?"Hide Filters":"Show Filters",children:[a.jsx(Xp,{size:14}),X?a.jsx(gh,{size:14}):a.jsx(Yi,{size:14})]})]})]}),a.jsx("div",{className:`filters-wrapper ${X?"":"collapsed"}`,children:a.jsxs("div",{className:"filters",children:[a.jsxs("div",{className:"search-box",children:[a.jsx(bn,{size:18}),a.jsx("input",{type:"text",className:"form-input",placeholder:x("common.search")+"...",value:y,onChange:E=>U(S,E.target.value)})]}),a.jsxs("select",{className:"form-input",style:{width:180},value:d,onChange:E=>U(f,E.target.value),children:[a.jsx("option",{value:"",children:x("common.allStatuses")||"All Statuses"}),Object.entries(Oi).map(([E,A])=>a.jsx("option",{value:E,children:A},E))]}),a.jsxs("select",{className:"form-input",style:{width:180},value:m,onChange:E=>U(p,E.target.value),disabled:!!u,title:u?"Restricted to your shipping line":"",children:[a.jsx("option",{value:"",children:x("common.allLiners")||"All Liners"}),Ea.map(E=>a.jsxs("option",{value:E.code,children:[E.code," - ",E.name]},E.code))]}),N.length>0&&a.jsxs("div",{className:"bulk-actions",children:[a.jsxs("span",{className:"selected-count",children:[N.length," ",x("common.selected")||"selected"]}),a.jsxs("button",{className:"btn btn-primary btn-sm",onClick:()=>L(!0),children:[a.jsx(Gy,{size:14})," ",x("container.batchUpdate")||"Batch Update"]}),a.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>b([]),children:x("common.clearSelection")||"Clear"})]})]})}),a.jsx("div",{className:"pagination-info",children:a.jsxs("span",{children:[x("common.showing")||"Showing"," ",ue.length>0?W+1:0," - ",Math.min(j,ue.length)," ",x("common.of")||"of"," ",ue.length," ",x("common.containers")||"containers"]})})]}),a.jsxs("div",{className:"page-list-content",children:[a.jsx("div",{className:"table-container",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{width:40},children:a.jsx("input",{type:"checkbox",onChange:Y,checked:F.length>0&&F.every(E=>N.includes(E.id))})}),a.jsx("th",{children:x("columns.containerNumber")}),a.jsxs("th",{children:[x("columns.size"),"/",x("columns.type")]}),a.jsx("th",{children:x("columns.liner")}),a.jsx("th",{children:x("columns.containerStatus")}),a.jsx("th",{children:x("container.workflowStage")||"Stage"}),a.jsx("th",{children:x("columns.location")}),a.jsx("th",{children:x("columns.gateInDate")}),a.jsx("th",{children:x("columns.actions")})]})}),a.jsx("tbody",{children:F.map(E=>{const A=de(E);return a.jsxs("tr",{onDoubleClick:()=>k(`/containers/${E.id}`),style:{cursor:"pointer"},children:[a.jsx("td",{onClick:he=>he.stopPropagation(),children:a.jsx("input",{type:"checkbox",checked:N.includes(E.id),onChange:()=>Z(E.id)})}),a.jsx("td",{children:a.jsx("span",{className:"container-number",children:E.containerNumber})}),a.jsx("td",{children:E.size}),a.jsx("td",{children:E.liner}),a.jsx("td",{children:a.jsx("span",{className:`badge ${J(E.status)}`,children:Oi[E.status]})}),a.jsx("td",{children:A?a.jsx("span",{className:"workflow-stage-badge",style:{background:A.color},children:A.stage}):"-"}),a.jsx("td",{children:E.yardLocation?`${E.yardLocation.block}-${E.yardLocation.row}-${E.yardLocation.tier}`:"-"}),a.jsx("td",{children:new Date(E.gateInDate).toLocaleDateString()}),a.jsx("td",{children:a.jsxs("div",{className:"action-buttons",children:[a.jsx("button",{className:"btn btn-ghost btn-sm",onClick:he=>{he.stopPropagation(),V(E)},title:x("container.viewTimeline")||"View Timeline",children:a.jsx(My,{size:16})}),a.jsxs(vt,{to:`/containers/${E.id}`,className:"btn btn-ghost btn-sm",onClick:he=>he.stopPropagation(),children:[a.jsx(qr,{size:16})," ",x("common.view")||"View"]}),E.status==="STACKING"&&a.jsxs("button",{className:"btn btn-warning btn-sm",onClick:he=>{he.stopPropagation(),ne(E.id,E.containerNumber)},title:"Change to Damaged for Survey",children:[a.jsx(Dr,{size:16})," ",x("container.toDM")||"To DM"]})]})})]},E.id)})})]})}),ue.length===0&&a.jsxs("div",{className:"empty-state",children:[a.jsx(il,{size:48}),a.jsx("h3",{children:x("container.noContainersFound")||"No containers found"}),a.jsx("p",{children:x("container.adjustFilters")||"Try adjusting your search or filters"})]})]}),K>1&&a.jsx("div",{className:"page-list-footer",children:a.jsxs("div",{className:"pagination",children:[a.jsxs("button",{className:"btn btn-ghost btn-sm",onClick:()=>D(E=>Math.max(1,E-1)),disabled:C===1,children:[a.jsx(ao,{size:16})," ",x("common.previous")||"Previous"]}),a.jsx("div",{className:"pagination-pages",children:Array.from({length:Math.min(5,K)},(E,A)=>{let he;return K<=5||C<=3?he=A+1:C>=K-2?he=K-4+A:he=C-2+A,a.jsx("button",{className:`btn btn-sm ${C===he?"btn-primary":"btn-ghost"}`,onClick:()=>D(he),children:he},he)})}),a.jsxs("button",{className:"btn btn-ghost btn-sm",onClick:()=>D(E=>Math.min(K,E+1)),disabled:C===K,children:[x("common.next")||"Next"," ",a.jsx(Gn,{size:16})]})]})}),O&&a.jsx("div",{className:"modal-overlay",onClick:()=>V(null),children:a.jsxs("div",{className:"modal modal-lg",onClick:E=>E.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsxs("h3",{className:"modal-title",children:[a.jsx(My,{size:20})," ",x("container.containerTimeline")||"Container Timeline"]}),a.jsxs("div",{className:"modal-container-info",children:[a.jsx("span",{className:"container-number",children:O.containerNumber}),a.jsx("span",{className:"text-muted",children:O.liner}),a.jsx("span",{className:`badge ${J(O.status)}`,children:Oi[O.status]})]})]}),a.jsx("div",{className:"modal-body",children:a.jsxs("div",{className:"container-timeline",children:[I(O).map((E,A)=>{var he;return a.jsxs("div",{className:`timeline-event ${(he=E.status)==null?void 0:he.toLowerCase()}`,children:[a.jsx("div",{className:"timeline-event-dot"}),a.jsxs("div",{className:"timeline-event-content",children:[a.jsxs("div",{className:"timeline-event-header",children:[a.jsx("strong",{children:E.event}),a.jsx("span",{className:"timeline-event-date",children:new Date(E.date).toLocaleString()})]}),E.details&&a.jsx("p",{className:"timeline-event-details",children:E.details})]})]},A)}),I(O).length===0&&a.jsxs("div",{className:"empty-state",children:[a.jsx(tr,{size:32}),a.jsx("p",{children:x("container.noTimelineEvents")||"No timeline events yet"})]})]})}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{className:"btn btn-ghost",onClick:()=>V(null),children:x("common.close")||"Close"}),a.jsxs(vt,{to:`/containers/${O.id}`,className:"btn btn-primary",children:[a.jsx(qr,{size:16})," ",x("container.viewDetails")||"View Details"]})]})]})}),H&&a.jsx("div",{className:"modal-overlay",onClick:()=>L(!1),children:a.jsxs("div",{className:"modal",onClick:E=>E.stopPropagation(),children:[a.jsx("div",{className:"modal-header",children:a.jsxs("h3",{className:"modal-title",children:[a.jsx(Gy,{size:20})," ",x("container.batchStatusUpdate")||"Batch Status Update"]})}),a.jsxs("div",{className:"modal-body",children:[a.jsxs("p",{className:"mb-4",children:[x("container.batchUpdateConfirm")||"Update status for"," ",a.jsx("strong",{children:N.length})," ",x("common.containers")||"containers",":"]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label required",children:x("container.newStatus")||"New Status"}),a.jsxs("select",{className:"form-input",value:R,onChange:E=>q(E.target.value),children:[a.jsx("option",{value:"",children:x("common.select")||"Select status..."}),Object.entries(Oi).map(([E,A])=>a.jsx("option",{value:E,children:A},E))]})]})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{className:"btn btn-ghost",onClick:()=>L(!1),children:x("common.cancel")||"Cancel"}),a.jsxs("button",{className:"btn btn-primary",onClick:P,disabled:!R,children:[a.jsx(St,{size:16})," ",x("container.updateContainers")||"Update Containers"]})]})]})})]})}function SO(){const{id:e}=ws(),{getContainer:t,getSurveysByContainer:n,getEORsByContainer:r,getROsByContainer:s}=qt(),i=t(e),l=n(e),u=r(e);return s(e),i?a.jsxs("div",{className:"page",children:[a.jsx("div",{className:"page-header",children:a.jsxs(vt,{to:"/containers",className:"btn btn-ghost",children:[a.jsx(hr,{size:16})," Back"]})}),a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"card-header",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"container-number",style:{fontSize:"1.5rem"},children:i.containerNumber}),a.jsx("span",{className:`badge badge-${i.status.toLowerCase()}`,style:{marginTop:8},children:Oi[i.status]})]}),a.jsxs(vt,{to:`/surveys/new/${e}`,className:"btn btn-primary",children:[a.jsx(jr,{size:16})," New Survey"]})]}),a.jsxs("div",{className:"grid grid-cols-3 mt-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Size/Type"}),a.jsx("p",{style:{margin:0,fontWeight:500},children:i.size})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Liner"}),a.jsx("p",{style:{margin:0,fontWeight:500},children:i.liner})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Gate In Date"}),a.jsx("p",{style:{margin:0,fontWeight:500},children:new Date(i.gateInDate).toLocaleDateString()})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Location"}),a.jsx("p",{style:{margin:0,fontWeight:500},children:i.yardLocation?`Block ${i.yardLocation.block}, Row ${i.yardLocation.row}, Tier ${i.yardLocation.tier}`:"-"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Booking"}),a.jsx("p",{style:{margin:0,fontWeight:500},children:i.booking||"-"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Sequence"}),a.jsx("p",{style:{margin:0,fontWeight:500},children:i.sequence})]})]})]}),a.jsxs("div",{className:"card mt-4",children:[a.jsx("div",{className:"card-header",children:a.jsxs("h3",{className:"card-title",children:[a.jsx(jr,{size:18})," Surveys (",l.length,")"]})}),l.length===0?a.jsx("p",{className:"text-muted",children:"No surveys recorded for this container."}):a.jsx("div",{className:"recent-list",children:l.map(d=>a.jsxs(vt,{to:`/surveys/${d.id}`,className:"recent-item",children:[a.jsxs("div",{className:"recent-item-main",children:[a.jsx("span",{children:d.id}),a.jsx("span",{className:`badge badge-${d.status.toLowerCase()}`,children:d.status})]}),a.jsxs("div",{className:"recent-item-sub",children:[d.surveyType,"  ",new Date(d.createdAt).toLocaleDateString()]})]},d.id))})]}),a.jsxs("div",{className:"card mt-4",children:[a.jsx("div",{className:"card-header",children:a.jsxs("h3",{className:"card-title",children:[a.jsx(wn,{size:18})," EORs (",u.length,")"]})}),u.length===0?a.jsx("p",{className:"text-muted",children:"No EORs created for this container."}):a.jsx("div",{className:"recent-list",children:u.map(d=>a.jsxs(vt,{to:`/eor/${d.id}`,className:"recent-item",children:[a.jsxs("div",{className:"recent-item-main",children:[a.jsx("span",{children:d.id}),a.jsx("span",{className:`badge badge-${d.status.toLowerCase().replace("_","-")}`,children:d.autoApproved?"Auto-Approved":d.status})]}),a.jsxs("div",{className:"recent-item-sub",children:["RM ",d.totalCost,"  ",new Date(d.createdAt).toLocaleDateString()]})]},d.id))})]})]}):a.jsx("div",{className:"page",children:a.jsxs("div",{className:"empty-state",children:[a.jsx("h3",{children:"Container not found"}),a.jsxs(vt,{to:"/containers",className:"btn btn-primary mt-4",children:[a.jsx(hr,{size:16})," Back to List"]})]})})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var yh={};yh.version="0.18.5";var x_=1252,_O=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],eg={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},tg=function(e){_O.indexOf(e)!=-1&&(x_=eg[0]=e)};function CO(){tg(1252)}var ja=function(e){tg(e)};function ng(){ja(1200),CO()}function Yy(e){for(var t=[],n=0,r=e.length;n<r;++n)t[n]=e.charCodeAt(n);return t}function NO(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n)+(e.charCodeAt(2*n+1)<<8));return t.join("")}function v_(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}var hc=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return t==255&&n==254?NO(e.slice(2)):t==254&&n==255?v_(e.slice(2)):t==65279?e.slice(1):e},Id=function(t){return String.fromCharCode(t)},Xy=function(t){return String.fromCharCode(t)},Uc,Zs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function zc(e){for(var t="",n=0,r=0,s=0,i=0,l=0,u=0,d=0,f=0;f<e.length;)n=e.charCodeAt(f++),i=n>>2,r=e.charCodeAt(f++),l=(n&3)<<4|r>>4,s=e.charCodeAt(f++),u=(r&15)<<2|s>>6,d=s&63,isNaN(r)?u=d=64:isNaN(s)&&(d=64),t+=Zs.charAt(i)+Zs.charAt(l)+Zs.charAt(u)+Zs.charAt(d);return t}function Qr(e){var t="",n=0,r=0,s=0,i=0,l=0,u=0,d=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)i=Zs.indexOf(e.charAt(f++)),l=Zs.indexOf(e.charAt(f++)),n=i<<2|l>>4,t+=String.fromCharCode(n),u=Zs.indexOf(e.charAt(f++)),r=(l&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(r)),d=Zs.indexOf(e.charAt(f++)),s=(u&3)<<6|d,d!==64&&(t+=String.fromCharCode(s));return t}var pt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Cs=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,n){return n?new Buffer(t,n):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function li(e){return pt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Qy(e){return pt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var $r=function(t){return pt?Cs(t,"binary"):t.split("").map(function(n){return n.charCodeAt(0)&255})};function Vh(e){if(typeof ArrayBuffer>"u")return $r(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=e.charCodeAt(r)&255;return t}function mi(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function EO(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function rg(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return rg(new Uint8Array(e));for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t}var Vn=pt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Cs(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),s=0;for(t=0,n=0;t<e.length;n+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if(typeof e[t]=="string")throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function TO(e){for(var t=[],n=0,r=e.length+250,s=li(e.length+255),i=0;i<e.length;++i){var l=e.charCodeAt(i);if(l<128)s[n++]=l;else if(l<2048)s[n++]=192|l>>6&31,s[n++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var u=e.charCodeAt(++i)&1023;s[n++]=240|l>>8&7,s[n++]=128|l>>2&63,s[n++]=128|u>>6&15|(l&3)<<4,s[n++]=128|u&63}else s[n++]=224|l>>12&15,s[n++]=128|l>>6&63,s[n++]=128|l&63;n>r&&(t.push(s.slice(0,n)),n=0,s=li(65535),r=65530)}return t.push(s.slice(0,n)),Vn(t)}var Sr=/\u0000/g,fc=/[\u0001-\u0006]/g;function Jo(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function Ra(e,t){var n=""+e;return n.length>=t?n:hn("0",t-n.length)+n}function ag(e,t){var n=""+e;return n.length>=t?n:hn(" ",t-n.length)+n}function kh(e,t){var n=""+e;return n.length>=t?n:n+hn(" ",t-n.length)}function bO(e,t){var n=""+Math.round(e);return n.length>=t?n:hn("0",t-n.length)+n}function AO(e,t){var n=""+e;return n.length>=t?n:hn("0",t-n.length)+n}var Jy=Math.pow(2,32);function Fo(e,t){if(e>Jy||e<-Jy)return bO(e,t);var n=Math.round(e);return AO(n,t)}function wh(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Zy=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],rm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function jO(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var st={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},ek={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},RO={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Sh(e,t,n){for(var r=e<0?-1:1,s=e*r,i=0,l=1,u=0,d=1,f=0,m=0,p=Math.floor(s);f<t&&(p=Math.floor(s),u=p*l+i,m=p*f+d,!(s-p<5e-8));)s=1/(s-p),i=l,l=u,d=f,f=m;if(m>t&&(f>t?(m=d,u=i):(m=f,u=l)),!n)return[0,r*u,m];var x=Math.floor(r*u/m);return[x,r*u-x*m,m]}function Bi(e,t,n){if(e>2958465||e<0)return null;var r=e|0,s=Math.floor(86400*(e-r)),i=0,l=[],u={D:r,T:s,u:86400*(e-r)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(r+=1462),u.u>.9999&&(u.u=0,++s==86400&&(u.T=s=0,++r,++u.D)),r===60)l=n?[1317,10,29]:[1900,2,29],i=3;else if(r===0)l=n?[1317,8,29]:[1900,1,0],i=6;else{r>60&&--r;var d=new Date(1900,0,1);d.setDate(d.getDate()+r-1),l=[d.getFullYear(),d.getMonth()+1,d.getDate()],i=d.getDay(),r<60&&(i=(i+6)%7),n&&(i=FO(d,l))}return u.y=l[0],u.m=l[1],u.d=l[2],u.S=s%60,s=Math.floor(s/60),u.M=s%60,s=Math.floor(s/60),u.H=s,u.q=i,u}var y_=new Date(1899,11,31,0,0,0),IO=y_.getTime(),PO=new Date(1900,2,1,0,0,0);function k_(e,t){var n=e.getTime();return t?n-=1461*24*60*60*1e3:e>=PO&&(n+=1440*60*1e3),(n-(IO+(e.getTimezoneOffset()-y_.getTimezoneOffset())*6e4))/(1440*60*1e3)}function sg(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function DO(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function OO(e){var t=e<0?12:11,n=sg(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10),n.length<=t)?n:e.toExponential(5)}function LO(e){var t=sg(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Wc(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),n;return t>=-4&&t<=-1?n=e.toPrecision(10+t):Math.abs(t)<=9?n=OO(e):t===10?n=e.toFixed(10).substr(0,12):n=LO(e),sg(DO(n.toUpperCase()))}function Qi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Wc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return da(14,k_(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function FO(e,t){t[0]-=581;var n=e.getDay();return e<60&&(n=(n+6)%7),n}function MO(e,t,n,r){var s="",i=0,l=0,u=n.y,d,f=0;switch(e){case 98:u=n.y+543;case 121:switch(t.length){case 1:case 2:d=u%100,f=2;break;default:d=u%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:d=n.m,f=t.length;break;case 3:return rm[n.m-1][1];case 5:return rm[n.m-1][0];default:return rm[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:d=n.d,f=t.length;break;case 3:return Zy[n.q][0];default:return Zy[n.q][1]}break;case 104:switch(t.length){case 1:case 2:d=1+(n.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:d=n.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:d=n.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return n.u===0&&(t=="s"||t=="ss")?Ra(n.S,t.length):(r>=2?l=r===3?1e3:100:l=r===1?10:1,i=Math.round(l*(n.S+n.u)),i>=60*l&&(i=0),t==="s"?i===0?"0":""+i/l:(s=Ra(i,2+r),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":d=n.D*24+n.H;break;case"[m]":case"[mm]":d=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":d=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:d=u,f=1;break}var m=f>0?Ra(d,f):"";return m}function ei(e){var t=3;if(e.length<=t)return e;for(var n=e.length%t,r=e.substr(0,n);n!=e.length;n+=t)r+=(r.length>0?",":"")+e.substr(n,t);return r}var w_=/%/g;function BO(e,t,n){var r=t.replace(w_,""),s=t.length-r.length;return fs(e,r,n*Math.pow(10,2*s))+hn("%",s)}function UO(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return fs(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function S_(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+S_(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),n=(t/Math.pow(10,i)).toPrecision(r+1+(s+i)%s),n.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(l-n.length+i):n+="E+"+(l-i);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,s)+"."+n.substr(2+s),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,d,f,m){return d+f+m.substr(0,(s+i)%s)+"."+m.substr(i)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var __=/# (\?+)( ?)\/( ?)(\d+)/;function zO(e,t,n){var r=parseInt(e[4],10),s=Math.round(t*r),i=Math.floor(s/r),l=s-i*r,u=r;return n+(i===0?"":""+i)+" "+(l===0?hn(" ",e[1].length+1+e[4].length):ag(l,e[1].length)+e[2]+"/"+e[3]+Ra(u,e[4].length))}function WO(e,t,n){return n+(t===0?"":""+t)+hn(" ",e[1].length+2+e[4].length)}var C_=/^#*0*\.([0#]+)/,N_=/\).*[0#]/,E_=/\(###\) ###\\?-####/;function kr(e){for(var t="",n,r=0;r!=e.length;++r)switch(n=e.charCodeAt(r)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(n)}return t}function tk(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function nk(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function HO(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function GO(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function sa(e,t,n){if(e.charCodeAt(0)===40&&!t.match(N_)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?sa("n",r,n):"("+sa("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return UO(e,t,n);if(t.indexOf("%")!==-1)return BO(e,t,n);if(t.indexOf("E")!==-1)return S_(t,n);if(t.charCodeAt(0)===36)return"$"+sa(e,t.substr(t.charAt(1)==" "?2:1),n);var s,i,l,u,d=Math.abs(n),f=n<0?"-":"";if(t.match(/^00+$/))return f+Fo(d,t.length);if(t.match(/^[#?]+$/))return s=Fo(n,0),s==="0"&&(s=""),s.length>t.length?s:kr(t.substr(0,t.length-s.length))+s;if(i=t.match(__))return zO(i,d,f);if(t.match(/^#+0+$/))return f+Fo(d,t.length-t.indexOf("0"));if(i=t.match(C_))return s=tk(n,i[1].length).replace(/^([^\.]+)$/,"$1."+kr(i[1])).replace(/\.$/,"."+kr(i[1])).replace(/\.(\d*)$/,function(k,y){return"."+y+hn("0",kr(i[1]).length-y.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return f+tk(d,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return f+ei(Fo(d,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+sa(e,t,-n):ei(""+(Math.floor(n)+HO(n,i[1].length)))+"."+Ra(nk(n,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return sa(e,t.replace(/^#,#*,/,""),n);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Jo(sa(e,t.replace(/[\\-]/g,""),n)),l=0,Jo(Jo(t.replace(/\\/g,"")).replace(/[0#]/g,function(k){return l<s.length?s.charAt(l++):k==="0"?"0":""}));if(t.match(E_))return s=sa(e,"##########",n),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var m="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),u=Sh(d,Math.pow(10,l)-1,!1),s=""+f,m=fs("n",i[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),s+=m+i[2]+"/"+i[3],m=kh(u[2],l),m.length<i[4].length&&(m=kr(i[4].substr(i[4].length-m.length))+m),s+=m,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),u=Sh(d,Math.pow(10,l)-1,!0),f+(u[0]||(u[1]?"":"0"))+" "+(u[1]?ag(u[1],l)+i[2]+"/"+i[3]+kh(u[2],l):hn(" ",2*l+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=Fo(n,0),t.length<=s.length?s:kr(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+n.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=s.indexOf(".");var p=t.indexOf(".")-l,x=t.length-s.length-p;return kr(t.substr(0,p)+s+t.substr(t.length-x))}if(i=t.match(/^00,000\.([#0]*0)$/))return l=nk(n,i[1].length),n<0?"-"+sa(e,t,-n):ei(GO(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?Ra(0,3-k.length):"")+k})+"."+Ra(l,i[1].length);switch(t){case"###,##0.00":return sa(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var v=ei(Fo(d,0));return v!=="0"?f+v:"";case"###,###.00":return sa(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return sa(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function $O(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return fs(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function VO(e,t,n){var r=t.replace(w_,""),s=t.length-r.length;return fs(e,r,n*Math.pow(10,2*s))+hn("%",s)}function T_(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+T_(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),n=(t/Math.pow(10,i)).toPrecision(r+1+(s+i)%s),!n.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(l-n.length+i):n+="E+"+(l-i),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,d,f,m){return d+f+m.substr(0,(s+i)%s)+"."+m.substr(i)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function Ha(e,t,n){if(e.charCodeAt(0)===40&&!t.match(N_)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Ha("n",r,n):"("+Ha("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return $O(e,t,n);if(t.indexOf("%")!==-1)return VO(e,t,n);if(t.indexOf("E")!==-1)return T_(t,n);if(t.charCodeAt(0)===36)return"$"+Ha(e,t.substr(t.charAt(1)==" "?2:1),n);var s,i,l,u,d=Math.abs(n),f=n<0?"-":"";if(t.match(/^00+$/))return f+Ra(d,t.length);if(t.match(/^[#?]+$/))return s=""+n,n===0&&(s=""),s.length>t.length?s:kr(t.substr(0,t.length-s.length))+s;if(i=t.match(__))return WO(i,d,f);if(t.match(/^#+0+$/))return f+Ra(d,t.length-t.indexOf("0"));if(i=t.match(C_))return s=(""+n).replace(/^([^\.]+)$/,"$1."+kr(i[1])).replace(/\.$/,"."+kr(i[1])),s=s.replace(/\.(\d*)$/,function(k,y){return"."+y+hn("0",kr(i[1]).length-y.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return f+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return f+ei(""+d);if(i=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Ha(e,t,-n):ei(""+n)+"."+hn("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Ha(e,t.replace(/^#,#*,/,""),n);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Jo(Ha(e,t.replace(/[\\-]/g,""),n)),l=0,Jo(Jo(t.replace(/\\/g,"")).replace(/[0#]/g,function(k){return l<s.length?s.charAt(l++):k==="0"?"0":""}));if(t.match(E_))return s=Ha(e,"##########",n),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var m="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),u=Sh(d,Math.pow(10,l)-1,!1),s=""+f,m=fs("n",i[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),s+=m+i[2]+"/"+i[3],m=kh(u[2],l),m.length<i[4].length&&(m=kr(i[4].substr(i[4].length-m.length))+m),s+=m,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),u=Sh(d,Math.pow(10,l)-1,!0),f+(u[0]||(u[1]?"":"0"))+" "+(u[1]?ag(u[1],l)+i[2]+"/"+i[3]+kh(u[2],l):hn(" ",2*l+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=""+n,t.length<=s.length?s:kr(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0]+)\.([#0]+)$/)){s=""+n.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=s.indexOf(".");var p=t.indexOf(".")-l,x=t.length-s.length-p;return kr(t.substr(0,p)+s+t.substr(t.length-x))}if(i=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+Ha(e,t,-n):ei(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?Ra(0,3-k.length):"")+k})+"."+Ra(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var v=ei(""+d);return v!=="0"?f+v:"";default:if(t.match(/\.[0#?]*$/))return Ha(e,t.slice(0,t.lastIndexOf(".")),n)+kr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function fs(e,t,n){return(n|0)===n?Ha(e,t,n):sa(e,t,n)}function qO(e){for(var t=[],n=!1,r=0,s=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(s,r-s),s=r+1}if(t[t.length]=e.substr(s),n===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var b_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function xl(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":wh(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(r=n;e.charAt(t++)!=="]"&&t<e.length;)r+=e.charAt(t);if(r.match(b_))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||n=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function KO(e,t,n,r){for(var s=[],i="",l=0,u="",d="t",f,m,p,x="H";l<e.length;)switch(u=e.charAt(l)){case"G":if(!wh(e,l))throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"G",v:"General"},l+=7;break;case'"':for(i="";(p=e.charCodeAt(++l))!==34&&l<e.length;)i+=String.fromCharCode(p);s[s.length]={t:"t",v:i},++l;break;case"\\":var v=e.charAt(++l),k=v==="("||v===")"?v:"t";s[s.length]={t:k,v},++l;break;case"_":s[s.length]={t:"t",v:" "},l+=2;break;case"@":s[s.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(f==null&&(f=Bi(t,n,e.charAt(l+1)==="2"),f==null))return"";s[s.length]={t:"X",v:e.substr(l,2)},d=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=Bi(t,n),f==null))return"";for(i=u;++l<e.length&&e.charAt(l).toLowerCase()===u;)i+=u;u==="m"&&d.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=x),s[s.length]={t:u,v:i},d=u;break;case"A":case"a":case"":var y={t:u,v:u};if(f==null&&(f=Bi(t,n)),e.substr(l,3).toUpperCase()==="A/P"?(f!=null&&(y.v=f.H>=12?"P":"A"),y.t="T",x="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(f!=null&&(y.v=f.H>=12?"PM":"AM"),y.t="T",l+=5,x="h"):e.substr(l,5).toUpperCase()==="/"?(f!=null&&(y.v=f.H>=12?"":""),y.t="T",l+=5,x="h"):(y.t="t",++l),f==null&&y.t==="T")return"";s[s.length]=y,d=u;break;case"[":for(i=u;e.charAt(l++)!=="]"&&l<e.length;)i+=e.charAt(l);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(b_)){if(f==null&&(f=Bi(t,n),f==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},d=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",xl(e)||(s[s.length]={t:"t",v:i}));break;case".":if(f!=null){for(i=u;++l<e.length&&(u=e.charAt(l))==="0";)i+=u;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=u;++l<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(l))>-1;)i+=u;s[s.length]={t:"n",v:i};break;case"?":for(i=u;e.charAt(++l)===u;)i+=u;s[s.length]={t:u,v:i},d=u;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":s[s.length]={t:r===1?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=u;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)i+=e.charAt(l);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:u,v:u},++l;break;case"$":s[s.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"t",v:u},++l;break}var S=0,C=0,D;for(l=s.length-1,d="t";l>=0;--l)switch(s[l].t){case"h":case"H":s[l].t=x,d="h",S<1&&(S=1);break;case"s":(D=s[l].v.match(/\.0+$/))&&(C=Math.max(C,D[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":d=s[l].t;break;case"m":d==="s"&&(s[l].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&s[l].v.match(/[Hh]/)&&(S=1),S<2&&s[l].v.match(/[Mm]/)&&(S=2),S<3&&s[l].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var N="",b;for(l=0;l<s.length;++l)switch(s[l].t){case"t":case"T":case" ":case"D":break;case"X":s[l].v="",s[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[l].v=MO(s[l].t.charCodeAt(0),s[l].v,f,C),s[l].t="t";break;case"n":case"?":for(b=l+1;s[b]!=null&&((u=s[b].t)==="?"||u==="D"||(u===" "||u==="t")&&s[b+1]!=null&&(s[b+1].t==="?"||s[b+1].t==="t"&&s[b+1].v==="/")||s[l].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(s[b].v==="/"||s[b].v===" "&&s[b+1]!=null&&s[b+1].t=="?"));)s[l].v+=s[b].v,s[b]={v:"",t:";"},++b;N+=s[l].v,l=b-1;break;case"G":s[l].t="t",s[l].v=Qi(t,n);break}var H="",L,R;if(N.length>0){N.charCodeAt(0)==40?(L=t<0&&N.charCodeAt(0)===45?-t:t,R=fs("n",N,L)):(L=t<0&&r>1?-t:t,R=fs("n",N,L),L<0&&s[0]&&s[0].t=="t"&&(R=R.substr(1),s[0].v="-"+s[0].v)),b=R.length-1;var q=s.length;for(l=0;l<s.length;++l)if(s[l]!=null&&s[l].t!="t"&&s[l].v.indexOf(".")>-1){q=l;break}var O=s.length;if(q===s.length&&R.indexOf("E")===-1){for(l=s.length-1;l>=0;--l)s[l]==null||"n?".indexOf(s[l].t)===-1||(b>=s[l].v.length-1?(b-=s[l].v.length,s[l].v=R.substr(b+1,s[l].v.length)):b<0?s[l].v="":(s[l].v=R.substr(0,b+1),b=-1),s[l].t="t",O=l);b>=0&&O<s.length&&(s[O].v=R.substr(0,b+1)+s[O].v)}else if(q!==s.length&&R.indexOf("E")===-1){for(b=R.indexOf(".")-1,l=q;l>=0;--l)if(!(s[l]==null||"n?".indexOf(s[l].t)===-1)){for(m=s[l].v.indexOf(".")>-1&&l===q?s[l].v.indexOf(".")-1:s[l].v.length-1,H=s[l].v.substr(m+1);m>=0;--m)b>=0&&(s[l].v.charAt(m)==="0"||s[l].v.charAt(m)==="#")&&(H=R.charAt(b--)+H);s[l].v=H,s[l].t="t",O=l}for(b>=0&&O<s.length&&(s[O].v=R.substr(0,b+1)+s[O].v),b=R.indexOf(".")+1,l=q;l<s.length;++l)if(!(s[l]==null||"n?(".indexOf(s[l].t)===-1&&l!==q)){for(m=s[l].v.indexOf(".")>-1&&l===q?s[l].v.indexOf(".")+1:0,H=s[l].v.substr(0,m);m<s[l].v.length;++m)b<R.length&&(H+=R.charAt(b++));s[l].v=H,s[l].t="t",O=l}}}for(l=0;l<s.length;++l)s[l]!=null&&"n?".indexOf(s[l].t)>-1&&(L=r>1&&t<0&&l>0&&s[l-1].v==="-"?-t:t,s[l].v=fs(s[l].t,s[l].v,L),s[l].t="t");var V="";for(l=0;l!==s.length;++l)s[l]!=null&&(V+=s[l].v);return V}var rk=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ak(e,t){if(t==null)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0;break}return!1}function YO(e,t){var n=qO(e),r=n.length,s=n[r-1].indexOf("@");if(r<4&&s>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof t!="number")return[4,n.length===4||s>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=s>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=s>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=s>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var i=t>0?n[0]:t<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,i];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var l=n[0].match(rk),u=n[1].match(rk);return ak(t,l)?[r,n[0]]:ak(t,u)?[r,n[1]]:[r,n[l!=null&&u!=null?2:1]]}return[r,i]}function da(e,t,n){n==null&&(n={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&n.dateNF?r=n.dateNF:r=e;break;case"number":e==14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:st)[e],r==null&&(r=n.table&&n.table[ek[e]]||st[ek[e]]),r==null&&(r=RO[e]||"General");break}if(wh(r,0))return Qi(t,n);t instanceof Date&&(t=k_(t,n.date1904));var s=YO(r,t);if(wh(s[1]))return Qi(t,n);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return KO(s[1],t,n,s[0])}function ms(e,t){if(typeof t!="number"){t=+t||-1;for(var n=0;n<392;++n){if(st[n]==null){t<0&&(t=n);continue}if(st[n]==e){t=n;break}}t<0&&(t=391)}return st[t]=e,t}function qh(e){for(var t=0;t!=392;++t)e[t]!==void 0&&ms(e[t],t)}function vl(){st=jO()}var XO={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},A_=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function QO(e){var t=typeof e=="number"?st[e]:e;return t=t.replace(A_,"(\\d+)"),new RegExp("^"+t+"$")}function JO(e,t,n){var r=-1,s=-1,i=-1,l=-1,u=-1,d=-1;(t.match(A_)||[]).forEach(function(p,x){var v=parseInt(n[x+1],10);switch(p.toLowerCase().charAt(0)){case"y":r=v;break;case"d":i=v;break;case"h":l=v;break;case"s":d=v;break;case"m":l>=0?u=v:s=v;break}}),d>=0&&u==-1&&s>=0&&(u=s,s=-1);var f=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var m=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return l==-1&&u==-1&&d==-1?f:r==-1&&s==-1&&i==-1?m:f+"T"+m}var ZO=(function(){var e={};e.version="1.2.0";function t(){for(var R=0,q=new Array(256),O=0;O!=256;++O)R=O,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,q[O]=R;return typeof Int32Array<"u"?new Int32Array(q):q}var n=t();function r(R){var q=0,O=0,V=0,X=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(V=0;V!=256;++V)X[V]=R[V];for(V=0;V!=256;++V)for(O=R[V],q=256+V;q<4096;q+=256)O=X[q]=O>>>8^R[O&255];var M=[];for(V=1;V!=16;++V)M[V-1]=typeof Int32Array<"u"?X.subarray(V*256,V*256+256):X.slice(V*256,V*256+256);return M}var s=r(n),i=s[0],l=s[1],u=s[2],d=s[3],f=s[4],m=s[5],p=s[6],x=s[7],v=s[8],k=s[9],y=s[10],S=s[11],C=s[12],D=s[13],N=s[14];function b(R,q){for(var O=q^-1,V=0,X=R.length;V<X;)O=O>>>8^n[(O^R.charCodeAt(V++))&255];return~O}function H(R,q){for(var O=q^-1,V=R.length-15,X=0;X<V;)O=N[R[X++]^O&255]^D[R[X++]^O>>8&255]^C[R[X++]^O>>16&255]^S[R[X++]^O>>>24]^y[R[X++]]^k[R[X++]]^v[R[X++]]^x[R[X++]]^p[R[X++]]^m[R[X++]]^f[R[X++]]^d[R[X++]]^u[R[X++]]^l[R[X++]]^i[R[X++]]^n[R[X++]];for(V+=15;X<V;)O=O>>>8^n[(O^R[X++])&255];return~O}function L(R,q){for(var O=q^-1,V=0,X=R.length,M=0,me=0;V<X;)M=R.charCodeAt(V++),M<128?O=O>>>8^n[(O^M)&255]:M<2048?(O=O>>>8^n[(O^(192|M>>6&31))&255],O=O>>>8^n[(O^(128|M&63))&255]):M>=55296&&M<57344?(M=(M&1023)+64,me=R.charCodeAt(V++)&1023,O=O>>>8^n[(O^(240|M>>8&7))&255],O=O>>>8^n[(O^(128|M>>2&63))&255],O=O>>>8^n[(O^(128|me>>6&15|(M&3)<<4))&255],O=O>>>8^n[(O^(128|me&63))&255]):(O=O>>>8^n[(O^(224|M>>12&15))&255],O=O>>>8^n[(O^(128|M>>6&63))&255],O=O>>>8^n[(O^(128|M&63))&255]);return~O}return e.table=n,e.bstr=b,e.buf=H,e.str=L,e})(),nt=(function(){var t={};t.version="1.2.1";function n(z,re){for(var Q=z.split("/"),te=re.split("/"),se=0,ie=0,Ce=Math.min(Q.length,te.length);se<Ce;++se){if(ie=Q[se].length-te[se].length)return ie;if(Q[se]!=te[se])return Q[se]<te[se]?-1:1}return Q.length-te.length}function r(z){if(z.charAt(z.length-1)=="/")return z.slice(0,-1).indexOf("/")===-1?z:r(z.slice(0,-1));var re=z.lastIndexOf("/");return re===-1?z:z.slice(0,re+1)}function s(z){if(z.charAt(z.length-1)=="/")return s(z.slice(0,-1));var re=z.lastIndexOf("/");return re===-1?z:z.slice(re+1)}function i(z,re){typeof re=="string"&&(re=new Date(re));var Q=re.getHours();Q=Q<<6|re.getMinutes(),Q=Q<<5|re.getSeconds()>>>1,z.write_shift(2,Q);var te=re.getFullYear()-1980;te=te<<4|re.getMonth()+1,te=te<<5|re.getDate(),z.write_shift(2,te)}function l(z){var re=z.read_shift(2)&65535,Q=z.read_shift(2)&65535,te=new Date,se=Q&31;Q>>>=5;var ie=Q&15;Q>>>=4,te.setMilliseconds(0),te.setFullYear(Q+1980),te.setMonth(ie-1),te.setDate(se);var Ce=re&31;re>>>=5;var je=re&63;return re>>>=6,te.setHours(re),te.setMinutes(je),te.setSeconds(Ce<<1),te}function u(z){Qn(z,0);for(var re={},Q=0;z.l<=z.length-4;){var te=z.read_shift(2),se=z.read_shift(2),ie=z.l+se,Ce={};switch(te){case 21589:Q=z.read_shift(1),Q&1&&(Ce.mtime=z.read_shift(4)),se>5&&(Q&2&&(Ce.atime=z.read_shift(4)),Q&4&&(Ce.ctime=z.read_shift(4))),Ce.mtime&&(Ce.mt=new Date(Ce.mtime*1e3));break}z.l=ie,re[te]=Ce}return re}var d;function f(){return d||(d={})}function m(z,re){if(z[0]==80&&z[1]==75)return Ts(z,re);if((z[0]|32)==109&&(z[1]|32)==105)return Su(z,re);if(z.length<512)throw new Error("CFB file size "+z.length+" < 512");var Q=3,te=512,se=0,ie=0,Ce=0,je=0,_e=0,Ne=[],Ee=z.slice(0,512);Qn(Ee,0);var Me=p(Ee);switch(Q=Me[0],Q){case 3:te=512;break;case 4:te=4096;break;case 0:if(Me[1]==0)return Ts(z,re);default:throw new Error("Major Version: Expected 3 or 4 saw "+Q)}te!==512&&(Ee=z.slice(0,te),Qn(Ee,28));var Ve=z.slice(0,te);x(Ee,Q);var Ye=Ee.read_shift(4,"i");if(Q===3&&Ye!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ye);Ee.l+=4,Ce=Ee.read_shift(4,"i"),Ee.l+=4,Ee.chk("00100000","Mini Stream Cutoff Size: "),je=Ee.read_shift(4,"i"),se=Ee.read_shift(4,"i"),_e=Ee.read_shift(4,"i"),ie=Ee.read_shift(4,"i");for(var ze=-1,Ue=0;Ue<109&&(ze=Ee.read_shift(4,"i"),!(ze<0));++Ue)Ne[Ue]=ze;var ht=v(z,te);S(_e,ie,ht,te,Ne);var Ut=D(ht,Ce,Ne,te);Ut[Ce].name="!Directory",se>0&&je!==me&&(Ut[je].name="!MiniFAT"),Ut[Ne[0]].name="!FAT",Ut.fat_addrs=Ne,Ut.ssz=te;var Ht={},gn=[],ki=[],js=[];N(Ce,Ut,ht,gn,se,Ht,ki,je),k(ki,js,gn),gn.shift();var Fa={FileIndex:ki,FullPaths:js};return re&&re.raw&&(Fa.raw={header:Ve,sectors:ht}),Fa}function p(z){if(z[z.l]==80&&z[z.l+1]==75)return[0,0];z.chk(ae,"Header Signature: "),z.l+=16;var re=z.read_shift(2,"u");return[z.read_shift(2,"u"),re]}function x(z,re){var Q=9;switch(z.l+=2,Q=z.read_shift(2)){case 9:if(re!=3)throw new Error("Sector Shift: Expected 9 saw "+Q);break;case 12:if(re!=4)throw new Error("Sector Shift: Expected 12 saw "+Q);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Q)}z.chk("0600","Mini Sector Shift: "),z.chk("000000000000","Reserved: ")}function v(z,re){for(var Q=Math.ceil(z.length/re)-1,te=[],se=1;se<Q;++se)te[se-1]=z.slice(se*re,(se+1)*re);return te[Q-1]=z.slice(Q*re),te}function k(z,re,Q){for(var te=0,se=0,ie=0,Ce=0,je=0,_e=Q.length,Ne=[],Ee=[];te<_e;++te)Ne[te]=Ee[te]=te,re[te]=Q[te];for(;je<Ee.length;++je)te=Ee[je],se=z[te].L,ie=z[te].R,Ce=z[te].C,Ne[te]===te&&(se!==-1&&Ne[se]!==se&&(Ne[te]=Ne[se]),ie!==-1&&Ne[ie]!==ie&&(Ne[te]=Ne[ie])),Ce!==-1&&(Ne[Ce]=te),se!==-1&&te!=Ne[te]&&(Ne[se]=Ne[te],Ee.lastIndexOf(se)<je&&Ee.push(se)),ie!==-1&&te!=Ne[te]&&(Ne[ie]=Ne[te],Ee.lastIndexOf(ie)<je&&Ee.push(ie));for(te=1;te<_e;++te)Ne[te]===te&&(ie!==-1&&Ne[ie]!==ie?Ne[te]=Ne[ie]:se!==-1&&Ne[se]!==se&&(Ne[te]=Ne[se]));for(te=1;te<_e;++te)if(z[te].type!==0){if(je=te,je!=Ne[je])do je=Ne[je],re[te]=re[je]+"/"+re[te];while(je!==0&&Ne[je]!==-1&&je!=Ne[je]);Ne[te]=-1}for(re[0]+="/",te=1;te<_e;++te)z[te].type!==2&&(re[te]+="/")}function y(z,re,Q){for(var te=z.start,se=z.size,ie=[],Ce=te;Q&&se>0&&Ce>=0;)ie.push(re.slice(Ce*M,Ce*M+M)),se-=M,Ce=Li(Q,Ce*4);return ie.length===0?Ae(0):Vn(ie).slice(0,z.size)}function S(z,re,Q,te,se){var ie=me;if(z===me){if(re!==0)throw new Error("DIFAT chain shorter than expected")}else if(z!==-1){var Ce=Q[z],je=(te>>>2)-1;if(!Ce)return;for(var _e=0;_e<je&&(ie=Li(Ce,_e*4))!==me;++_e)se.push(ie);S(Li(Ce,te-4),re-1,Q,te,se)}}function C(z,re,Q,te,se){var ie=[],Ce=[];se||(se=[]);var je=te-1,_e=0,Ne=0;for(_e=re;_e>=0;){se[_e]=!0,ie[ie.length]=_e,Ce.push(z[_e]);var Ee=Q[Math.floor(_e*4/te)];if(Ne=_e*4&je,te<4+Ne)throw new Error("FAT boundary crossed: "+_e+" 4 "+te);if(!z[Ee])break;_e=Li(z[Ee],Ne)}return{nodes:ie,data:gk([Ce])}}function D(z,re,Q,te){var se=z.length,ie=[],Ce=[],je=[],_e=[],Ne=te-1,Ee=0,Me=0,Ve=0,Ye=0;for(Ee=0;Ee<se;++Ee)if(je=[],Ve=Ee+re,Ve>=se&&(Ve-=se),!Ce[Ve]){_e=[];var ze=[];for(Me=Ve;Me>=0;){ze[Me]=!0,Ce[Me]=!0,je[je.length]=Me,_e.push(z[Me]);var Ue=Q[Math.floor(Me*4/te)];if(Ye=Me*4&Ne,te<4+Ye)throw new Error("FAT boundary crossed: "+Me+" 4 "+te);if(!z[Ue]||(Me=Li(z[Ue],Ye),ze[Me]))break}ie[Ve]={nodes:je,data:gk([_e])}}return ie}function N(z,re,Q,te,se,ie,Ce,je){for(var _e=0,Ne=te.length?2:0,Ee=re[z].data,Me=0,Ve=0,Ye;Me<Ee.length;Me+=128){var ze=Ee.slice(Me,Me+128);Qn(ze,64),Ve=ze.read_shift(2),Ye=hg(ze,0,Ve-Ne),te.push(Ye);var Ue={name:Ye,type:ze.read_shift(1),color:ze.read_shift(1),L:ze.read_shift(4,"i"),R:ze.read_shift(4,"i"),C:ze.read_shift(4,"i"),clsid:ze.read_shift(16),state:ze.read_shift(4,"i"),start:0,size:0},ht=ze.read_shift(2)+ze.read_shift(2)+ze.read_shift(2)+ze.read_shift(2);ht!==0&&(Ue.ct=b(ze,ze.l-8));var Ut=ze.read_shift(2)+ze.read_shift(2)+ze.read_shift(2)+ze.read_shift(2);Ut!==0&&(Ue.mt=b(ze,ze.l-8)),Ue.start=ze.read_shift(4,"i"),Ue.size=ze.read_shift(4,"i"),Ue.size<0&&Ue.start<0&&(Ue.size=Ue.type=0,Ue.start=me,Ue.name=""),Ue.type===5?(_e=Ue.start,se>0&&_e!==me&&(re[_e].name="!StreamData")):Ue.size>=4096?(Ue.storage="fat",re[Ue.start]===void 0&&(re[Ue.start]=C(Q,Ue.start,re.fat_addrs,re.ssz)),re[Ue.start].name=Ue.name,Ue.content=re[Ue.start].data.slice(0,Ue.size)):(Ue.storage="minifat",Ue.size<0?Ue.size=0:_e!==me&&Ue.start!==me&&re[_e]&&(Ue.content=y(Ue,re[_e].data,(re[je]||{}).data))),Ue.content&&Qn(Ue.content,0),ie[Ye]=Ue,Ce.push(Ue)}}function b(z,re){return new Date((Hr(z,re+4)/1e7*Math.pow(2,32)+Hr(z,re)/1e7-11644473600)*1e3)}function H(z,re){return f(),m(d.readFileSync(z),re)}function L(z,re){var Q=re&&re.type;switch(Q||pt&&Buffer.isBuffer(z)&&(Q="buffer"),Q||"base64"){case"file":return H(z,re);case"base64":return m($r(Qr(z)),re);case"binary":return m($r(z),re)}return m(z,re)}function R(z,re){var Q=re||{},te=Q.root||"Root Entry";if(z.FullPaths||(z.FullPaths=[]),z.FileIndex||(z.FileIndex=[]),z.FullPaths.length!==z.FileIndex.length)throw new Error("inconsistent CFB structure");z.FullPaths.length===0&&(z.FullPaths[0]=te+"/",z.FileIndex[0]={name:te,type:5}),Q.CLSID&&(z.FileIndex[0].clsid=Q.CLSID),q(z)}function q(z){var re="Sh33tJ5";if(!nt.find(z,"/"+re)){var Q=Ae(4);Q[0]=55,Q[1]=Q[3]=50,Q[2]=54,z.FileIndex.push({name:re,type:2,content:Q,size:4,L:69,R:69,C:69}),z.FullPaths.push(z.FullPaths[0]+re),O(z)}}function O(z,re){R(z);for(var Q=!1,te=!1,se=z.FullPaths.length-1;se>=0;--se){var ie=z.FileIndex[se];switch(ie.type){case 0:te?Q=!0:(z.FileIndex.pop(),z.FullPaths.pop());break;case 1:case 2:case 5:te=!0,isNaN(ie.R*ie.L*ie.C)&&(Q=!0),ie.R>-1&&ie.L>-1&&ie.R==ie.L&&(Q=!0);break;default:Q=!0;break}}if(!(!Q&&!re)){var Ce=new Date(1987,1,19),je=0,_e=Object.create?Object.create(null):{},Ne=[];for(se=0;se<z.FullPaths.length;++se)_e[z.FullPaths[se]]=!0,z.FileIndex[se].type!==0&&Ne.push([z.FullPaths[se],z.FileIndex[se]]);for(se=0;se<Ne.length;++se){var Ee=r(Ne[se][0]);te=_e[Ee],te||(Ne.push([Ee,{name:s(Ee).replace("/",""),type:1,clsid:ue,ct:Ce,mt:Ce,content:null}]),_e[Ee]=!0)}for(Ne.sort(function(Ye,ze){return n(Ye[0],ze[0])}),z.FullPaths=[],z.FileIndex=[],se=0;se<Ne.length;++se)z.FullPaths[se]=Ne[se][0],z.FileIndex[se]=Ne[se][1];for(se=0;se<Ne.length;++se){var Me=z.FileIndex[se],Ve=z.FullPaths[se];if(Me.name=s(Ve).replace("/",""),Me.L=Me.R=Me.C=-(Me.color=1),Me.size=Me.content?Me.content.length:0,Me.start=0,Me.clsid=Me.clsid||ue,se===0)Me.C=Ne.length>1?1:-1,Me.size=0,Me.type=5;else if(Ve.slice(-1)=="/"){for(je=se+1;je<Ne.length&&r(z.FullPaths[je])!=Ve;++je);for(Me.C=je>=Ne.length?-1:je,je=se+1;je<Ne.length&&r(z.FullPaths[je])!=r(Ve);++je);Me.R=je>=Ne.length?-1:je,Me.type=1}else r(z.FullPaths[se+1]||"")==r(Ve)&&(Me.R=se+1),Me.type=2}}}function V(z,re){var Q=re||{};if(Q.fileType=="mad")return vi(z,Q);switch(O(z),Q.fileType){case"zip":return As(z,Q)}var te=(function(Ye){for(var ze=0,Ue=0,ht=0;ht<Ye.FileIndex.length;++ht){var Ut=Ye.FileIndex[ht];if(Ut.content){var Ht=Ut.content.length;Ht>0&&(Ht<4096?ze+=Ht+63>>6:Ue+=Ht+511>>9)}}for(var gn=Ye.FullPaths.length+3>>2,ki=ze+7>>3,js=ze+127>>7,Fa=ki+Ue+gn+js,Fn=Fa+127>>7,_l=Fn<=109?0:Math.ceil((Fn-109)/127);Fa+Fn+_l+127>>7>Fn;)_l=++Fn<=109?0:Math.ceil((Fn-109)/127);var xn=[1,_l,Fn,js,gn,Ue,ze,0];return Ye.FileIndex[0].size=ze<<6,xn[7]=(Ye.FileIndex[0].start=xn[0]+xn[1]+xn[2]+xn[3]+xn[4]+xn[5])+(xn[6]+7>>3),xn})(z),se=Ae(te[7]<<9),ie=0,Ce=0;{for(ie=0;ie<8;++ie)se.write_shift(1,ce[ie]);for(ie=0;ie<8;++ie)se.write_shift(2,0);for(se.write_shift(2,62),se.write_shift(2,3),se.write_shift(2,65534),se.write_shift(2,9),se.write_shift(2,6),ie=0;ie<3;++ie)se.write_shift(2,0);for(se.write_shift(4,0),se.write_shift(4,te[2]),se.write_shift(4,te[0]+te[1]+te[2]+te[3]-1),se.write_shift(4,0),se.write_shift(4,4096),se.write_shift(4,te[3]?te[0]+te[1]+te[2]-1:me),se.write_shift(4,te[3]),se.write_shift(-4,te[1]?te[0]-1:me),se.write_shift(4,te[1]),ie=0;ie<109;++ie)se.write_shift(-4,ie<te[2]?te[1]+ie:-1)}if(te[1])for(Ce=0;Ce<te[1];++Ce){for(;ie<236+Ce*127;++ie)se.write_shift(-4,ie<te[2]?te[1]+ie:-1);se.write_shift(-4,Ce===te[1]-1?me:Ce+1)}var je=function(Ye){for(Ce+=Ye;ie<Ce-1;++ie)se.write_shift(-4,ie+1);Ye&&(++ie,se.write_shift(-4,me))};for(Ce=ie=0,Ce+=te[1];ie<Ce;++ie)se.write_shift(-4,K.DIFSECT);for(Ce+=te[2];ie<Ce;++ie)se.write_shift(-4,K.FATSECT);je(te[3]),je(te[4]);for(var _e=0,Ne=0,Ee=z.FileIndex[0];_e<z.FileIndex.length;++_e)Ee=z.FileIndex[_e],Ee.content&&(Ne=Ee.content.length,!(Ne<4096)&&(Ee.start=Ce,je(Ne+511>>9)));for(je(te[6]+7>>3);se.l&511;)se.write_shift(-4,K.ENDOFCHAIN);for(Ce=ie=0,_e=0;_e<z.FileIndex.length;++_e)Ee=z.FileIndex[_e],Ee.content&&(Ne=Ee.content.length,!(!Ne||Ne>=4096)&&(Ee.start=Ce,je(Ne+63>>6)));for(;se.l&511;)se.write_shift(-4,K.ENDOFCHAIN);for(ie=0;ie<te[4]<<2;++ie){var Me=z.FullPaths[ie];if(!Me||Me.length===0){for(_e=0;_e<17;++_e)se.write_shift(4,0);for(_e=0;_e<3;++_e)se.write_shift(4,-1);for(_e=0;_e<12;++_e)se.write_shift(4,0);continue}Ee=z.FileIndex[ie],ie===0&&(Ee.start=Ee.size?Ee.start-1:me);var Ve=ie===0&&Q.root||Ee.name;if(Ne=2*(Ve.length+1),se.write_shift(64,Ve,"utf16le"),se.write_shift(2,Ne),se.write_shift(1,Ee.type),se.write_shift(1,Ee.color),se.write_shift(-4,Ee.L),se.write_shift(-4,Ee.R),se.write_shift(-4,Ee.C),Ee.clsid)se.write_shift(16,Ee.clsid,"hex");else for(_e=0;_e<4;++_e)se.write_shift(4,0);se.write_shift(4,Ee.state||0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,Ee.start),se.write_shift(4,Ee.size),se.write_shift(4,0)}for(ie=1;ie<z.FileIndex.length;++ie)if(Ee=z.FileIndex[ie],Ee.size>=4096)if(se.l=Ee.start+1<<9,pt&&Buffer.isBuffer(Ee.content))Ee.content.copy(se,se.l,0,Ee.size),se.l+=Ee.size+511&-512;else{for(_e=0;_e<Ee.size;++_e)se.write_shift(1,Ee.content[_e]);for(;_e&511;++_e)se.write_shift(1,0)}for(ie=1;ie<z.FileIndex.length;++ie)if(Ee=z.FileIndex[ie],Ee.size>0&&Ee.size<4096)if(pt&&Buffer.isBuffer(Ee.content))Ee.content.copy(se,se.l,0,Ee.size),se.l+=Ee.size+63&-64;else{for(_e=0;_e<Ee.size;++_e)se.write_shift(1,Ee.content[_e]);for(;_e&63;++_e)se.write_shift(1,0)}if(pt)se.l=se.length;else for(;se.l<se.length;)se.write_shift(1,0);return se}function X(z,re){var Q=z.FullPaths.map(function(_e){return _e.toUpperCase()}),te=Q.map(function(_e){var Ne=_e.split("/");return Ne[Ne.length-(_e.slice(-1)=="/"?2:1)]}),se=!1;re.charCodeAt(0)===47?(se=!0,re=Q[0].slice(0,-1)+re):se=re.indexOf("/")!==-1;var ie=re.toUpperCase(),Ce=se===!0?Q.indexOf(ie):te.indexOf(ie);if(Ce!==-1)return z.FileIndex[Ce];var je=!ie.match(fc);for(ie=ie.replace(Sr,""),je&&(ie=ie.replace(fc,"!")),Ce=0;Ce<Q.length;++Ce)if((je?Q[Ce].replace(fc,"!"):Q[Ce]).replace(Sr,"")==ie||(je?te[Ce].replace(fc,"!"):te[Ce]).replace(Sr,"")==ie)return z.FileIndex[Ce];return null}var M=64,me=-2,ae="d0cf11e0a1b11ae1",ce=[208,207,17,224,161,177,26,225],ue="00000000000000000000000000000000",K={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:me,FREESECT:-1,HEADER_SIGNATURE:ae,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ue,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function W(z,re,Q){f();var te=V(z,Q);d.writeFileSync(re,te)}function j(z){for(var re=new Array(z.length),Q=0;Q<z.length;++Q)re[Q]=String.fromCharCode(z[Q]);return re.join("")}function F(z,re){var Q=V(z,re);switch(re&&re.type||"buffer"){case"file":return f(),d.writeFileSync(re.filename,Q),Q;case"binary":return typeof Q=="string"?Q:j(Q);case"base64":return zc(typeof Q=="string"?Q:j(Q));case"buffer":if(pt)return Buffer.isBuffer(Q)?Q:Cs(Q);case"array":return typeof Q=="string"?$r(Q):Q}return Q}var U;function I(z){try{var re=z.InflateRaw,Q=new re;if(Q._processChunk(new Uint8Array([3,0]),Q._finishFlushFlag),Q.bytesRead)U=z;else throw new Error("zlib does not expose bytesRead")}catch(te){console.error("cannot use native zlib: "+(te.message||te))}}function Z(z,re){if(!U)return Ln(z,re);var Q=U.InflateRaw,te=new Q,se=te._processChunk(z.slice(z.l),te._finishFlushFlag);return z.l+=te.bytesRead,se}function Y(z){return U?U.deflateRawSync(z):qe(z)}var P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ne=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],J=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function de(z){var re=(z<<1|z<<11)&139536|(z<<5|z<<15)&558144;return(re>>16|re>>8|re)&255}for(var E=typeof Uint8Array<"u",A=E?new Uint8Array(256):[],he=0;he<256;++he)A[he]=de(he);function G(z,re){var Q=A[z&255];return re<=8?Q>>>8-re:(Q=Q<<8|A[z>>8&255],re<=16?Q>>>16-re:(Q=Q<<8|A[z>>16&255],Q>>>24-re))}function Ie(z,re){var Q=re&7,te=re>>>3;return(z[te]|(Q<=6?0:z[te+1]<<8))>>>Q&3}function oe(z,re){var Q=re&7,te=re>>>3;return(z[te]|(Q<=5?0:z[te+1]<<8))>>>Q&7}function Te(z,re){var Q=re&7,te=re>>>3;return(z[te]|(Q<=4?0:z[te+1]<<8))>>>Q&15}function xe(z,re){var Q=re&7,te=re>>>3;return(z[te]|(Q<=3?0:z[te+1]<<8))>>>Q&31}function we(z,re){var Q=re&7,te=re>>>3;return(z[te]|(Q<=1?0:z[te+1]<<8))>>>Q&127}function fe(z,re,Q){var te=re&7,se=re>>>3,ie=(1<<Q)-1,Ce=z[se]>>>te;return Q<8-te||(Ce|=z[se+1]<<8-te,Q<16-te)||(Ce|=z[se+2]<<16-te,Q<24-te)||(Ce|=z[se+3]<<24-te),Ce&ie}function ye(z,re,Q){var te=re&7,se=re>>>3;return te<=5?z[se]|=(Q&7)<<te:(z[se]|=Q<<te&255,z[se+1]=(Q&7)>>8-te),re+3}function ee(z,re,Q){var te=re&7,se=re>>>3;return Q=(Q&1)<<te,z[se]|=Q,re+1}function Pe(z,re,Q){var te=re&7,se=re>>>3;return Q<<=te,z[se]|=Q&255,Q>>>=8,z[se+1]=Q,re+8}function Fe(z,re,Q){var te=re&7,se=re>>>3;return Q<<=te,z[se]|=Q&255,Q>>>=8,z[se+1]=Q&255,z[se+2]=Q>>>8,re+16}function et(z,re){var Q=z.length,te=2*Q>re?2*Q:re+5,se=0;if(Q>=re)return z;if(pt){var ie=Qy(te);if(z.copy)z.copy(ie);else for(;se<z.length;++se)ie[se]=z[se];return ie}else if(E){var Ce=new Uint8Array(te);if(Ce.set)Ce.set(z);else for(;se<Q;++se)Ce[se]=z[se];return Ce}return z.length=te,z}function dt(z){for(var re=new Array(z),Q=0;Q<z;++Q)re[Q]=0;return re}function jt(z,re,Q){var te=1,se=0,ie=0,Ce=0,je=0,_e=z.length,Ne=E?new Uint16Array(32):dt(32);for(ie=0;ie<32;++ie)Ne[ie]=0;for(ie=_e;ie<Q;++ie)z[ie]=0;_e=z.length;var Ee=E?new Uint16Array(_e):dt(_e);for(ie=0;ie<_e;++ie)Ne[se=z[ie]]++,te<se&&(te=se),Ee[ie]=0;for(Ne[0]=0,ie=1;ie<=te;++ie)Ne[ie+16]=je=je+Ne[ie-1]<<1;for(ie=0;ie<_e;++ie)je=z[ie],je!=0&&(Ee[ie]=Ne[je+16]++);var Me=0;for(ie=0;ie<_e;++ie)if(Me=z[ie],Me!=0)for(je=G(Ee[ie],te)>>te-Me,Ce=(1<<te+4-Me)-1;Ce>=0;--Ce)re[je|Ce<<Me]=Me&15|ie<<4;return te}var un=E?new Uint16Array(512):dt(512),gr=E?new Uint16Array(32):dt(32);if(!E){for(var ge=0;ge<512;++ge)un[ge]=0;for(ge=0;ge<32;++ge)gr[ge]=0}(function(){for(var z=[],re=0;re<32;re++)z.push(5);jt(z,gr,32);var Q=[];for(re=0;re<=143;re++)Q.push(8);for(;re<=255;re++)Q.push(9);for(;re<=279;re++)Q.push(7);for(;re<=287;re++)Q.push(8);jt(Q,un,288)})();var Je=(function(){for(var re=E?new Uint8Array(32768):[],Q=0,te=0;Q<J.length-1;++Q)for(;te<J[Q+1];++te)re[te]=Q;for(;te<32768;++te)re[te]=29;var se=E?new Uint8Array(259):[];for(Q=0,te=0;Q<ne.length-1;++Q)for(;te<ne[Q+1];++te)se[te]=Q;function ie(je,_e){for(var Ne=0;Ne<je.length;){var Ee=Math.min(65535,je.length-Ne),Me=Ne+Ee==je.length;for(_e.write_shift(1,+Me),_e.write_shift(2,Ee),_e.write_shift(2,~Ee&65535);Ee-- >0;)_e[_e.l++]=je[Ne++]}return _e.l}function Ce(je,_e){for(var Ne=0,Ee=0,Me=E?new Uint16Array(32768):[];Ee<je.length;){var Ve=Math.min(65535,je.length-Ee);if(Ve<10){for(Ne=ye(_e,Ne,+(Ee+Ve==je.length)),Ne&7&&(Ne+=8-(Ne&7)),_e.l=Ne/8|0,_e.write_shift(2,Ve),_e.write_shift(2,~Ve&65535);Ve-- >0;)_e[_e.l++]=je[Ee++];Ne=_e.l*8;continue}Ne=ye(_e,Ne,+(Ee+Ve==je.length)+2);for(var Ye=0;Ve-- >0;){var ze=je[Ee];Ye=(Ye<<5^ze)&32767;var Ue=-1,ht=0;if((Ue=Me[Ye])&&(Ue|=Ee&-32768,Ue>Ee&&(Ue-=32768),Ue<Ee))for(;je[Ue+ht]==je[Ee+ht]&&ht<250;)++ht;if(ht>2){ze=se[ht],ze<=22?Ne=Pe(_e,Ne,A[ze+1]>>1)-1:(Pe(_e,Ne,3),Ne+=5,Pe(_e,Ne,A[ze-23]>>5),Ne+=3);var Ut=ze<8?0:ze-4>>2;Ut>0&&(Fe(_e,Ne,ht-ne[ze]),Ne+=Ut),ze=re[Ee-Ue],Ne=Pe(_e,Ne,A[ze]>>3),Ne-=3;var Ht=ze<4?0:ze-2>>1;Ht>0&&(Fe(_e,Ne,Ee-Ue-J[ze]),Ne+=Ht);for(var gn=0;gn<ht;++gn)Me[Ye]=Ee&32767,Ye=(Ye<<5^je[Ee])&32767,++Ee;Ve-=ht-1}else ze<=143?ze=ze+48:Ne=ee(_e,Ne,1),Ne=Pe(_e,Ne,A[ze]),Me[Ye]=Ee&32767,++Ee}Ne=Pe(_e,Ne,0)-1}return _e.l=(Ne+7)/8|0,_e.l}return function(_e,Ne){return _e.length<8?ie(_e,Ne):Ce(_e,Ne)}})();function qe(z){var re=Ae(50+Math.floor(z.length*1.1)),Q=Je(z,re);return re.slice(0,Q)}var ot=E?new Uint16Array(32768):dt(32768),Mt=E?new Uint16Array(32768):dt(32768),Ct=E?new Uint16Array(128):dt(128),rn=1,ga=1;function Rt(z,re){var Q=xe(z,re)+257;re+=5;var te=xe(z,re)+1;re+=5;var se=Te(z,re)+4;re+=4;for(var ie=0,Ce=E?new Uint8Array(19):dt(19),je=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],_e=1,Ne=E?new Uint8Array(8):dt(8),Ee=E?new Uint8Array(8):dt(8),Me=Ce.length,Ve=0;Ve<se;++Ve)Ce[P[Ve]]=ie=oe(z,re),_e<ie&&(_e=ie),Ne[ie]++,re+=3;var Ye=0;for(Ne[0]=0,Ve=1;Ve<=_e;++Ve)Ee[Ve]=Ye=Ye+Ne[Ve-1]<<1;for(Ve=0;Ve<Me;++Ve)(Ye=Ce[Ve])!=0&&(je[Ve]=Ee[Ye]++);var ze=0;for(Ve=0;Ve<Me;++Ve)if(ze=Ce[Ve],ze!=0){Ye=A[je[Ve]]>>8-ze;for(var Ue=(1<<7-ze)-1;Ue>=0;--Ue)Ct[Ye|Ue<<ze]=ze&7|Ve<<3}var ht=[];for(_e=1;ht.length<Q+te;)switch(Ye=Ct[we(z,re)],re+=Ye&7,Ye>>>=3){case 16:for(ie=3+Ie(z,re),re+=2,Ye=ht[ht.length-1];ie-- >0;)ht.push(Ye);break;case 17:for(ie=3+oe(z,re),re+=3;ie-- >0;)ht.push(0);break;case 18:for(ie=11+we(z,re),re+=7;ie-- >0;)ht.push(0);break;default:ht.push(Ye),_e<Ye&&(_e=Ye);break}var Ut=ht.slice(0,Q),Ht=ht.slice(Q);for(Ve=Q;Ve<286;++Ve)Ut[Ve]=0;for(Ve=te;Ve<30;++Ve)Ht[Ve]=0;return rn=jt(Ut,ot,286),ga=jt(Ht,Mt,30),re}function xa(z,re){if(z[0]==3&&!(z[1]&3))return[li(re),2];for(var Q=0,te=0,se=Qy(re||1<<18),ie=0,Ce=se.length>>>0,je=0,_e=0;(te&1)==0;){if(te=oe(z,Q),Q+=3,te>>>1)te>>1==1?(je=9,_e=5):(Q=Rt(z,Q),je=rn,_e=ga);else{Q&7&&(Q+=8-(Q&7));var Ne=z[Q>>>3]|z[(Q>>>3)+1]<<8;if(Q+=32,Ne>0)for(!re&&Ce<ie+Ne&&(se=et(se,ie+Ne),Ce=se.length);Ne-- >0;)se[ie++]=z[Q>>>3],Q+=8;continue}for(;;){!re&&Ce<ie+32767&&(se=et(se,ie+32767),Ce=se.length);var Ee=fe(z,Q,je),Me=te>>>1==1?un[Ee]:ot[Ee];if(Q+=Me&15,Me>>>=4,(Me>>>8&255)===0)se[ie++]=Me;else{if(Me==256)break;Me-=257;var Ve=Me<8?0:Me-4>>2;Ve>5&&(Ve=0);var Ye=ie+ne[Me];Ve>0&&(Ye+=fe(z,Q,Ve),Q+=Ve),Ee=fe(z,Q,_e),Me=te>>>1==1?gr[Ee]:Mt[Ee],Q+=Me&15,Me>>>=4;var ze=Me<4?0:Me-2>>1,Ue=J[Me];for(ze>0&&(Ue+=fe(z,Q,ze),Q+=ze),!re&&Ce<Ye&&(se=et(se,Ye+100),Ce=se.length);ie<Ye;)se[ie]=se[ie-Ue],++ie}}}return re?[se,Q+7>>>3]:[se.slice(0,ie),Q+7>>>3]}function Ln(z,re){var Q=z.slice(z.l||0),te=xa(Q,re);return z.l+=te[1],te[0]}function Xa(z,re){if(z)typeof console<"u"&&console.error(re);else throw new Error(re)}function Ts(z,re){var Q=z;Qn(Q,0);var te=[],se=[],ie={FileIndex:te,FullPaths:se};R(ie,{root:re.root});for(var Ce=Q.length-4;(Q[Ce]!=80||Q[Ce+1]!=75||Q[Ce+2]!=5||Q[Ce+3]!=6)&&Ce>=0;)--Ce;Q.l=Ce+4,Q.l+=4;var je=Q.read_shift(2);Q.l+=6;var _e=Q.read_shift(4);for(Q.l=_e,Ce=0;Ce<je;++Ce){Q.l+=20;var Ne=Q.read_shift(4),Ee=Q.read_shift(4),Me=Q.read_shift(2),Ve=Q.read_shift(2),Ye=Q.read_shift(2);Q.l+=8;var ze=Q.read_shift(4),Ue=u(Q.slice(Q.l+Me,Q.l+Me+Ve));Q.l+=Me+Ve+Ye;var ht=Q.l;Q.l=ze+4,bs(Q,Ne,Ee,ie,Ue),Q.l=ht}return ie}function bs(z,re,Q,te,se){z.l+=2;var ie=z.read_shift(2),Ce=z.read_shift(2),je=l(z);if(ie&8257)throw new Error("Unsupported ZIP encryption");for(var _e=z.read_shift(4),Ne=z.read_shift(4),Ee=z.read_shift(4),Me=z.read_shift(2),Ve=z.read_shift(2),Ye="",ze=0;ze<Me;++ze)Ye+=String.fromCharCode(z[z.l++]);if(Ve){var Ue=u(z.slice(z.l,z.l+Ve));(Ue[21589]||{}).mt&&(je=Ue[21589].mt),((se||{})[21589]||{}).mt&&(je=se[21589].mt)}z.l+=Ve;var ht=z.slice(z.l,z.l+Ne);switch(Ce){case 8:ht=Z(z,Ee);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ce)}var Ut=!1;ie&8&&(_e=z.read_shift(4),_e==134695760&&(_e=z.read_shift(4),Ut=!0),Ne=z.read_shift(4),Ee=z.read_shift(4)),Ne!=re&&Xa(Ut,"Bad compressed size: "+re+" != "+Ne),Ee!=Q&&Xa(Ut,"Bad uncompressed size: "+Q+" != "+Ee),Qa(te,Ye,ht,{unsafe:!0,mt:je})}function As(z,re){var Q=re||{},te=[],se=[],ie=Ae(1),Ce=Q.compression?8:0,je=0,_e=0,Ne=0,Ee=0,Me=0,Ve=z.FullPaths[0],Ye=Ve,ze=z.FileIndex[0],Ue=[],ht=0;for(_e=1;_e<z.FullPaths.length;++_e)if(Ye=z.FullPaths[_e].slice(Ve.length),ze=z.FileIndex[_e],!(!ze.size||!ze.content||Ye=="Sh33tJ5")){var Ut=Ee,Ht=Ae(Ye.length);for(Ne=0;Ne<Ye.length;++Ne)Ht.write_shift(1,Ye.charCodeAt(Ne)&127);Ht=Ht.slice(0,Ht.l),Ue[Me]=ZO.buf(ze.content,0);var gn=ze.content;Ce==8&&(gn=Y(gn)),ie=Ae(30),ie.write_shift(4,67324752),ie.write_shift(2,20),ie.write_shift(2,je),ie.write_shift(2,Ce),ze.mt?i(ie,ze.mt):ie.write_shift(4,0),ie.write_shift(-4,Ue[Me]),ie.write_shift(4,gn.length),ie.write_shift(4,ze.content.length),ie.write_shift(2,Ht.length),ie.write_shift(2,0),Ee+=ie.length,te.push(ie),Ee+=Ht.length,te.push(Ht),Ee+=gn.length,te.push(gn),ie=Ae(46),ie.write_shift(4,33639248),ie.write_shift(2,0),ie.write_shift(2,20),ie.write_shift(2,je),ie.write_shift(2,Ce),ie.write_shift(4,0),ie.write_shift(-4,Ue[Me]),ie.write_shift(4,gn.length),ie.write_shift(4,ze.content.length),ie.write_shift(2,Ht.length),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(4,0),ie.write_shift(4,Ut),ht+=ie.l,se.push(ie),ht+=Ht.length,se.push(Ht),++Me}return ie=Ae(22),ie.write_shift(4,101010256),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,Me),ie.write_shift(2,Me),ie.write_shift(4,ht),ie.write_shift(4,Ee),ie.write_shift(2,0),Vn([Vn(te),Vn(se),ie])}var xi={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function vu(z,re){if(z.ctype)return z.ctype;var Q=z.name||"",te=Q.match(/\.([^\.]+)$/);return te&&xi[te[1]]||re&&(te=(Q=re).match(/[\.\\]([^\.\\])+$/),te&&xi[te[1]])?xi[te[1]]:"application/octet-stream"}function yu(z){for(var re=zc(z),Q=[],te=0;te<re.length;te+=76)Q.push(re.slice(te,te+76));return Q.join(`\r
`)+`\r
`}function ku(z){var re=z.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ne){var Ee=Ne.charCodeAt(0).toString(16).toUpperCase();return"="+(Ee.length==1?"0"+Ee:Ee)});re=re.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),re.charAt(0)==`
`&&(re="=0D"+re.slice(1)),re=re.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Q=[],te=re.split(`\r
`),se=0;se<te.length;++se){var ie=te[se];if(ie.length==0){Q.push("");continue}for(var Ce=0;Ce<ie.length;){var je=76,_e=ie.slice(Ce,Ce+je);_e.charAt(je-1)=="="?je--:_e.charAt(je-2)=="="?je-=2:_e.charAt(je-3)=="="&&(je-=3),_e=ie.slice(Ce,Ce+je),Ce+=je,Ce<ie.length&&(_e+="="),Q.push(_e)}}return Q.join(`\r
`)}function wu(z){for(var re=[],Q=0;Q<z.length;++Q){for(var te=z[Q];Q<=z.length&&te.charAt(te.length-1)=="=";)te=te.slice(0,te.length-1)+z[++Q];re.push(te)}for(var se=0;se<re.length;++se)re[se]=re[se].replace(/[=][0-9A-Fa-f]{2}/g,function(ie){return String.fromCharCode(parseInt(ie.slice(1),16))});return $r(re.join(`\r
`))}function wl(z,re,Q){for(var te="",se="",ie="",Ce,je=0;je<10;++je){var _e=re[je];if(!_e||_e.match(/^\s*$/))break;var Ne=_e.match(/^(.*?):\s*([^\s].*)$/);if(Ne)switch(Ne[1].toLowerCase()){case"content-location":te=Ne[2].trim();break;case"content-type":ie=Ne[2].trim();break;case"content-transfer-encoding":se=Ne[2].trim();break}}switch(++je,se.toLowerCase()){case"base64":Ce=$r(Qr(re.slice(je).join("")));break;case"quoted-printable":Ce=wu(re.slice(je));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+se)}var Ee=Qa(z,te.slice(Q.length),Ce,{unsafe:!0});ie&&(Ee.ctype=ie)}function Su(z,re){if(j(z.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Q=re&&re.root||"",te=(pt&&Buffer.isBuffer(z)?z.toString("binary"):j(z)).split(`\r
`),se=0,ie="";for(se=0;se<te.length;++se)if(ie=te[se],!!/^Content-Location:/i.test(ie)&&(ie=ie.slice(ie.indexOf("file")),Q||(Q=ie.slice(0,ie.lastIndexOf("/")+1)),ie.slice(0,Q.length)!=Q))for(;Q.length>0&&(Q=Q.slice(0,Q.length-1),Q=Q.slice(0,Q.lastIndexOf("/")+1),ie.slice(0,Q.length)!=Q););var Ce=(te[1]||"").match(/boundary="(.*?)"/);if(!Ce)throw new Error("MAD cannot find boundary");var je="--"+(Ce[1]||""),_e=[],Ne=[],Ee={FileIndex:_e,FullPaths:Ne};R(Ee);var Me,Ve=0;for(se=0;se<te.length;++se){var Ye=te[se];Ye!==je&&Ye!==je+"--"||(Ve++&&wl(Ee,te.slice(Me,se),Q),Me=se)}return Ee}function vi(z,re){var Q=re||{},te=Q.boundary||"SheetJS";te="------="+te;for(var se=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+te.slice(2)+'"',"","",""],ie=z.FullPaths[0],Ce=ie,je=z.FileIndex[0],_e=1;_e<z.FullPaths.length;++_e)if(Ce=z.FullPaths[_e].slice(ie.length),je=z.FileIndex[_e],!(!je.size||!je.content||Ce=="Sh33tJ5")){Ce=Ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ht){return"_x"+ht.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ht){return"_u"+ht.charCodeAt(0).toString(16)+"_"});for(var Ne=je.content,Ee=pt&&Buffer.isBuffer(Ne)?Ne.toString("binary"):j(Ne),Me=0,Ve=Math.min(1024,Ee.length),Ye=0,ze=0;ze<=Ve;++ze)(Ye=Ee.charCodeAt(ze))>=32&&Ye<128&&++Me;var Ue=Me>=Ve*4/5;se.push(te),se.push("Content-Location: "+(Q.root||"file:///C:/SheetJS/")+Ce),se.push("Content-Transfer-Encoding: "+(Ue?"quoted-printable":"base64")),se.push("Content-Type: "+vu(je,Ce)),se.push(""),se.push(Ue?ku(Ee):yu(Ee))}return se.push(te+`--\r
`),se.join(`\r
`)}function Sl(z){var re={};return R(re,z),re}function Qa(z,re,Q,te){var se=te&&te.unsafe;se||R(z);var ie=!se&&nt.find(z,re);if(!ie){var Ce=z.FullPaths[0];re.slice(0,Ce.length)==Ce?Ce=re:(Ce.slice(-1)!="/"&&(Ce+="/"),Ce=(Ce+re).replace("//","/")),ie={name:s(re),type:2},z.FileIndex.push(ie),z.FullPaths.push(Ce),se||nt.utils.cfb_gc(z)}return ie.content=Q,ie.size=Q?Q.length:0,te&&(te.CLSID&&(ie.clsid=te.CLSID),te.mt&&(ie.mt=te.mt),te.ct&&(ie.ct=te.ct)),ie}function tf(z,re){R(z);var Q=nt.find(z,re);if(Q){for(var te=0;te<z.FileIndex.length;++te)if(z.FileIndex[te]==Q)return z.FileIndex.splice(te,1),z.FullPaths.splice(te,1),!0}return!1}function yi(z,re,Q){R(z);var te=nt.find(z,re);if(te){for(var se=0;se<z.FileIndex.length;++se)if(z.FileIndex[se]==te)return z.FileIndex[se].name=s(Q),z.FullPaths[se]=Q,!0}return!1}function ho(z){O(z,!0)}return t.find=X,t.read=L,t.parse=m,t.write=F,t.writeFile=W,t.utils={cfb_new:Sl,cfb_add:Qa,cfb_del:tf,cfb_mov:yi,cfb_gc:ho,ReadShift:wc,CheckField:Q_,prep_blob:Qn,bconcat:Vn,use_zlib:I,_deflateRaw:qe,_inflateRaw:Ln,consts:K},t})();function eL(e){return typeof e=="string"?Vh(e):Array.isArray(e)?EO(e):e}function uu(e,t,n){if(typeof Deno<"u"){if(n&&typeof t=="string")switch(n){case"utf8":t=new TextEncoder(n).encode(t);break;case"binary":t=Vh(t);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(e,t)}var r=n=="utf8"?qa(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,e);if(typeof Blob<"u"){var s=new Blob([eL(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=i,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(e);return u.open("w"),u.encoding="binary",Array.isArray(t)&&(t=mi(t)),u.write(t),u.close(),t}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+e)}function tL(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var n=t.read();return t.close(),n}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}function pn(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function sk(e,t){for(var n=[],r=pn(e),s=0;s!==r.length;++s)n[e[r[s]][t]]==null&&(n[e[r[s]][t]]=r[s]);return n}function Kh(e){for(var t=[],n=pn(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}function Yh(e){for(var t=[],n=pn(e),r=0;r!==n.length;++r)t[e[n[r]]]=parseInt(n[r],10);return t}function nL(e){for(var t=[],n=pn(e),r=0;r!==n.length;++r)t[e[n[r]]]==null&&(t[e[n[r]]]=[]),t[e[n[r]]].push(n[r]);return t}var _h=new Date(1899,11,30,0,0,0);function Dn(e,t){var n=e.getTime(),r=_h.getTime()+(e.getTimezoneOffset()-_h.getTimezoneOffset())*6e4;return(n-r)/(1440*60*1e3)}var j_=new Date,rL=_h.getTime()+(j_.getTimezoneOffset()-_h.getTimezoneOffset())*6e4,ik=j_.getTimezoneOffset();function Xh(e){var t=new Date;return t.setTime(e*24*60*60*1e3+rL),t.getTimezoneOffset()!==ik&&t.setTime(t.getTime()+(t.getTimezoneOffset()-ik)*6e4),t}function aL(e){var t=0,n=0,r=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(n=1,i>3&&(r=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":n*=24;case"H":n*=60;case"M":if(r)n*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=n*parseInt(s[i],10)}return t}var ok=new Date("2017-02-19T19:06:09.000Z"),R_=isNaN(ok.getFullYear())?new Date("2/19/17"):ok,sL=R_.getFullYear()==2017;function Jt(e,t){var n=new Date(e);if(sL)return t>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):t<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(e instanceof Date)return e;if(R_.getFullYear()==1917&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Ji(e,t){if(pt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return qa(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return qa(v_(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return qa(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return qa(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return n[i]||i})}catch{}for(var r=[],s=0;s!=e.length;++s)r.push(String.fromCharCode(e[s]));return r.join("")}function Zt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=Zt(e[n]));return t}function hn(e,t){for(var n="";n.length<t;)n+=e;return n}function Pa(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(t=Number(r))||(r=r.replace(/[(](.*)[)]/,function(s,i){return n=-n,i}),!isNaN(t=Number(r)))?t/n:t}var iL=["january","february","march","april","may","june","july","august","september","october","november","december"];function ol(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),s=t.getMonth(),i=t.getDate();if(isNaN(i))return n;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&iL.indexOf(l)==-1)return n}else if(l.match(/[a-z]/))return n;return r<0||r>8099?n:(s>0||i>1)&&r!=101?t:e.match(/[^-0-9:,\/\\]/)?n:t}var oL=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(n,r,s){if(e||typeof r=="string")return n.split(r);for(var i=n.split(r),l=[i[0]],u=1;u<i.length;++u)l.push(s),l.push(i[u]);return l}})();function I_(e){return e?e.content&&e.type?Ji(e.content,!0):e.data?hc(e.data):e.asNodeBuffer&&pt?hc(e.asNodeBuffer().toString("binary")):e.asBinary?hc(e.asBinary()):e._data&&e._data.getContent?hc(Ji(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function P_(e){if(!e)return null;if(e.data)return Yy(e.data);if(e.asNodeBuffer&&pt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Yy(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function lL(e){return e&&e.name.slice(-4)===".bin"?P_(e):I_(e)}function la(e,t){for(var n=e.FullPaths||pn(e.files),r=t.toLowerCase().replace(/[\/]/g,"\\"),s=r.replace(/\\/g,"/"),i=0;i<n.length;++i){var l=n[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==l||s==l)return e.files?e.files[n[i]]:e.FileIndex[i]}return null}function ig(e,t){var n=la(e,t);if(n==null)throw new Error("Cannot find file "+t+" in zip");return n}function En(e,t,n){if(!n)return lL(ig(e,t));if(!t)return null;try{return En(e,t)}catch{return null}}function Vr(e,t,n){if(!n)return I_(ig(e,t));if(!t)return null;try{return Vr(e,t)}catch{return null}}function cL(e,t,n){return P_(ig(e,t))}function lk(e){for(var t=e.FullPaths||pn(e.files),n=[],r=0;r<t.length;++r)t[r].slice(-1)!="/"&&n.push(t[r].replace(/^Root Entry[\/]/,""));return n.sort()}function mt(e,t,n){if(e.FullPaths){if(typeof n=="string"){var r;return pt?r=Cs(n):r=TO(n),nt.utils.cfb_add(e,t,r)}nt.utils.cfb_add(e,t,n)}else e.file(t,n)}function og(){return nt.utils.cfb_new()}function D_(e,t){switch(t.type){case"base64":return nt.read(e,{type:"base64"});case"binary":return nt.read(e,{type:"binary"});case"buffer":case"array":return nt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function mc(e,t){if(e.charAt(0)=="/")return e.slice(1);var n=t.split("/");t.slice(-1)!="/"&&n.pop();for(var r=e.split("/");r.length!==0;){var s=r.shift();s===".."?n.pop():s!=="."&&n.push(s)}return n.join("/")}var _n=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,uL=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,ck=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,dL=/<[^>]*>/g,pr=_n.match(ck)?ck:dL,hL=/<\w*:/,fL=/<(\/?)\w+:/;function lt(e,t,n){for(var r={},s=0,i=0;s!==e.length&&!((i=e.charCodeAt(s))===32||i===10||i===13);++s);if(t||(r[0]=e.slice(0,s)),s===e.length)return r;var l=e.match(uL),u=0,d="",f=0,m="",p="",x=1;if(l)for(f=0;f!=l.length;++f){for(p=l[f],i=0;i!=p.length&&p.charCodeAt(i)!==61;++i);for(m=p.slice(0,i).trim();p.charCodeAt(i+1)==32;)++i;for(x=(s=p.charCodeAt(i+1))==34||s==39?1:0,d=p.slice(i+1+x,p.length-x),u=0;u!=m.length&&m.charCodeAt(u)!==58;++u);if(u===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),r[m]=d,r[m.toLowerCase()]=d;else{var v=(u===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(u+1);if(r[v]&&m.slice(u-3,u)=="ext")continue;r[v]=d,r[v.toLowerCase()]=d}}return r}function Ka(e){return e.replace(fL,"<$1")}var O_={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},lg=Kh(O_),Et=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function n(r){var s=r+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(e,function(u,d){return O_[u]||String.fromCharCode(parseInt(d,u.indexOf("x")>-1?16:10))||u}).replace(t,function(u,d){return String.fromCharCode(parseInt(d,16))});var l=s.indexOf("]]>");return n(s.slice(0,i))+s.slice(i+9,l)+n(s.slice(l+3))}})(),cg=/[&<>'"]/g,mL=/[\u0000-\u0008\u000b-\u001f]/g;function Lt(e){var t=e+"";return t.replace(cg,function(n){return lg[n]}).replace(mL,function(n){return"_x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+"_"})}function uk(e){return Lt(e).replace(/ /g,"_x0020_")}var L_=/[\u0000-\u001f]/g;function ug(e){var t=e+"";return t.replace(cg,function(n){return lg[n]}).replace(/\n/g,"<br/>").replace(L_,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}function pL(e){var t=e+"";return t.replace(cg,function(n){return lg[n]}).replace(L_,function(n){return"&#x"+n.charCodeAt(0).toString(16).toUpperCase()+";"})}var dk=(function(){var e=/&#(\d+);/g;function t(n,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(e,t)}})();function gL(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Qt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function am(e){for(var t="",n=0,r=0,s=0,i=0,l=0,u=0;n<e.length;){if(r=e.charCodeAt(n++),r<128){t+=String.fromCharCode(r);continue}if(s=e.charCodeAt(n++),r>191&&r<224){l=(r&31)<<6,l|=s&63,t+=String.fromCharCode(l);continue}if(i=e.charCodeAt(n++),r<240){t+=String.fromCharCode((r&15)<<12|(s&63)<<6|i&63);continue}l=e.charCodeAt(n++),u=((r&7)<<18|(s&63)<<12|(i&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function hk(e){var t=li(2*e.length),n,r,s=1,i=0,l=0,u;for(r=0;r<e.length;r+=s)s=1,(u=e.charCodeAt(r))<128?n=u:u<224?(n=(u&31)*64+(e.charCodeAt(r+1)&63),s=2):u<240?(n=(u&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),s=3):(s=4,n=(u&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),n-=65536,l=55296+(n>>>10&1023),n=56320+(n&1023)),l!==0&&(t[i++]=l&255,t[i++]=l>>>8,l=0),t[i++]=n%256,t[i++]=n>>>8;return t.slice(0,i).toString("ucs2")}function fk(e){return Cs(e,"binary").toString("utf8")}var Pd="foo bar baz",Bt=pt&&(fk(Pd)==am(Pd)&&fk||hk(Pd)==am(Pd)&&hk)||am,qa=pt?function(e){return Cs(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,s=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,s=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)))}return t.join("")},Hc=(function(){var e={};return function(n,r){var s=n+"|"+(r||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+n+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+n+">",r||"")}})(),F_=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(n){for(var r=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)r=r.replace(e[s][0],e[s][1]);return r}})(),xL=(function(){var e={};return function(n){return e[n]!==void 0?e[n]:e[n]=new RegExp("<(?:vt:)?"+n+">([\\s\\S]*?)</(?:vt:)?"+n+">","g")}})(),vL=/<\/?(?:vt:)?variant>/g,yL=/<(?:vt:)([^>]*)>([\s\S]*)</;function mk(e,t){var n=lt(e),r=e.match(xL(n.baseType))||[],s=[];if(r.length!=n.size){if(t.WTF)throw new Error("unexpected vector length "+r.length+" != "+n.size);return s}return r.forEach(function(i){var l=i.replace(vL,"").match(yL);l&&s.push({v:Bt(l[2]),t:l[1]})}),s}var M_=/(^\s|\s$|\n)/;function er(e,t){return"<"+e+(t.match(M_)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Gc(e){return pn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function He(e,t,n){return"<"+e+(n!=null?Gc(n):"")+(t!=null?(t.match(M_)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function qm(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(n){if(t)throw n}return""}function kL(e,t){switch(typeof e){case"string":var n=He("vt:lpwstr",Lt(e));return n=n.replace(/&quot;/g,"_x0022_"),n;case"number":return He((e|0)==e?"vt:i4":"vt:r8",Lt(String(e)));case"boolean":return He("vt:bool",e?"true":"false")}if(e instanceof Date)return He("vt:filetime",qm(e));throw new Error("Unable to serialize "+e)}function dg(e){if(pt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Bt(mi(rg(e)));throw new Error("Bad input format: expected Buffer or string")}var $c=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,In={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},so=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Wr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function wL(e,t){for(var n=1-2*(e[t+7]>>>7),r=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,i=5;i>=0;--i)s=s*256+e[t+i];return r==2047?s==0?n*(1/0):NaN:(r==0?r=-1022:(r-=1023,s+=Math.pow(2,52)),n*Math.pow(2,r-52)*s)}function SL(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,s=0,i=0,l=r?-t:t;isFinite(l)?l==0?s=i=0:(s=Math.floor(Math.log(l)/Math.LN2),i=l*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(t)?26985:0);for(var u=0;u<=5;++u,i/=256)e[n+u]=i&255;e[n+6]=(s&15)<<4|i&15,e[n+7]=s>>4|r}var pk=function(e){for(var t=[],n=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var s=0,i=e[0][r].length;s<i;s+=n)t.push.apply(t,e[0][r].slice(s,s+n));return t},gk=pt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Cs(t)})):pk(e)}:pk,xk=function(e,t,n){for(var r=[],s=t;s<n;s+=2)r.push(String.fromCharCode(cs(e,s)));return r.join("").replace(Sr,"")},hg=pt?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(Sr,""):xk(e,t,n)}:xk,vk=function(e,t,n){for(var r=[],s=t;s<t+n;++s)r.push(("0"+e[s].toString(16)).slice(-2));return r.join("")},B_=pt?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):vk(e,t,n)}:vk,yk=function(e,t,n){for(var r=[],s=t;s<n;s++)r.push(String.fromCharCode(zo(e,s)));return r.join("")},du=pt?function(t,n,r){return Buffer.isBuffer(t)?t.toString("utf8",n,r):yk(t,n,r)}:yk,U_=function(e,t){var n=Hr(e,t);return n>0?du(e,t+4,t+4+n-1):""},z_=U_,W_=function(e,t){var n=Hr(e,t);return n>0?du(e,t+4,t+4+n-1):""},H_=W_,G_=function(e,t){var n=2*Hr(e,t);return n>0?du(e,t+4,t+4+n-1):""},$_=G_,V_=function(t,n){var r=Hr(t,n);return r>0?hg(t,n+4,n+4+r):""},q_=V_,K_=function(e,t){var n=Hr(e,t);return n>0?du(e,t+4,t+4+n):""},Y_=K_,X_=function(e,t){return wL(e,t)},Ch=X_,fg=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};pt&&(z_=function(t,n){if(!Buffer.isBuffer(t))return U_(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},H_=function(t,n){if(!Buffer.isBuffer(t))return W_(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},$_=function(t,n){if(!Buffer.isBuffer(t))return G_(t,n);var r=2*t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r-1)},q_=function(t,n){if(!Buffer.isBuffer(t))return V_(t,n);var r=t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r)},Y_=function(t,n){if(!Buffer.isBuffer(t))return K_(t,n);var r=t.readUInt32LE(n);return t.toString("utf8",n+4,n+4+r)},Ch=function(t,n){return Buffer.isBuffer(t)?t.readDoubleLE(n):X_(t,n)},fg=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var zo=function(e,t){return e[t]},cs=function(e,t){return e[t+1]*256+e[t]},_L=function(e,t){var n=e[t+1]*256+e[t];return n<32768?n:(65535-n+1)*-1},Hr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Li=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},CL=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function wc(e,t){var n="",r,s,i=[],l,u,d,f;switch(t){case"dbcs":if(f=this.l,pt&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*e).toString("utf16le");else for(d=0;d<e;++d)n+=String.fromCharCode(cs(this,f)),f+=2;e*=2;break;case"utf8":n=du(this,this.l,this.l+e);break;case"utf16le":e*=2,n=hg(this,this.l,this.l+e);break;case"wstr":return wc.call(this,e,"dbcs");case"lpstr-ansi":n=z_(this,this.l),e=4+Hr(this,this.l);break;case"lpstr-cp":n=H_(this,this.l),e=4+Hr(this,this.l);break;case"lpwstr":n=$_(this,this.l),e=4+2*Hr(this,this.l);break;case"lpp4":e=4+Hr(this,this.l),n=q_(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Hr(this,this.l),n=Y_(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,n="";(l=zo(this,this.l+e++))!==0;)i.push(Id(l));n=i.join("");break;case"_wstr":for(e=0,n="";(l=cs(this,this.l+e))!==0;)i.push(Id(l)),e+=2;e+=2,n=i.join("");break;case"dbcs-cont":for(n="",f=this.l,d=0;d<e;++d){if(this.lens&&this.lens.indexOf(f)!==-1)return l=zo(this,f),this.l=f+1,u=wc.call(this,e-d,l?"dbcs-cont":"sbcs-cont"),i.join("")+u;i.push(Id(cs(this,f))),f+=2}n=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(n="",f=this.l,d=0;d!=e;++d){if(this.lens&&this.lens.indexOf(f)!==-1)return l=zo(this,f),this.l=f+1,u=wc.call(this,e-d,l?"dbcs-cont":"sbcs-cont"),i.join("")+u;i.push(Id(zo(this,f))),f+=1}n=i.join("");break;default:switch(e){case 1:return r=zo(this,this.l),this.l++,r;case 2:return r=(t==="i"?_L:cs)(this,this.l),this.l+=2,r;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(r=(e>0?Li:CL)(this,this.l),this.l+=4,r):(s=Hr(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=Ch(this,this.l):s=Ch([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:n=B_(this,this.l,e);break}}return this.l+=e,n}var NL=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},EL=function(e,t,n){e[n]=t&255,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},TL=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255};function bL(e,t,n){var r=0,s=0;if(n==="dbcs"){for(s=0;s!=t.length;++s)TL(this,t.charCodeAt(s),this.l+2*s);r=2*t.length}else if(n==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;r=t.length}else if(n==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(n==="utf16le"){var i=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var l=t.charCodeAt(s);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=t&255;break;case 2:r=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:r=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:r=4,NL(this,t,this.l);break;case 8:if(r=8,n==="f"){SL(this,t,this.l);break}case 16:break;case-4:r=4,EL(this,t,this.l);break}return this.l+=r,this}function Q_(e,t){var n=B_(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function Qn(e,t){e.l=t,e.read_shift=wc,e.chk=Q_,e.write_shift=bL}function mr(e,t){e.l+=t}function Ae(e){var t=li(e);return Qn(t,0),t}function Ns(e,t,n){if(e){var r,s,i;Qn(e,e.l||0);for(var l=e.length,u=0,d=0;e.l<l;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var f=Qc[u]||Qc[65535];for(r=e.read_shift(1),i=r&127,s=1;s<4&&r&128;++s)i+=((r=e.read_shift(1))&127)<<7*s;d=e.l+i;var m=f.f&&f.f(e,i,n);if(e.l=d,t(m,f,u))return}}}function Or(){var e=[],t=pt?256:2048,n=function(f){var m=Ae(f);return Qn(m,0),m},r=n(t),s=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},i=function(f){return r&&f<r.length-r.l?r:(s(),r=n(Math.max(f+1,t)))},l=function(){return s(),Vn(e)},u=function(f){s(),r=f,r.l==null&&(r.l=r.length),i(t)};return{next:i,push:u,end:l,_bufs:e}}function Re(e,t,n,r){var s=+t,i;if(!isNaN(s)){r||(r=Qc[s].p||(n||[]).length||0),i=1+(s>=128?1:0)+1,r>=128&&++i,r>=16384&&++i,r>=2097152&&++i;var l=e.next(i);s<=127?l.write_shift(1,s):(l.write_shift(1,(s&127)+128),l.write_shift(1,s>>7));for(var u=0;u!=4;++u)if(r>=128)l.write_shift(1,(r&127)+128),r>>=7;else{l.write_shift(1,r);break}r>0&&fg(n)&&e.push(n)}}function Sc(e,t,n){var r=Zt(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function kk(e,t,n){var r=Zt(e);return r.s=Sc(r.s,t.s,n),r.e=Sc(r.e,t.s,n),r}function _c(e,t){if(e.cRel&&e.c<0)for(e=Zt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Zt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=it(e);return!e.cRel&&e.cRel!=null&&(n=RL(n)),!e.rRel&&e.rRel!=null&&(n=AL(n)),n}function sm(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+on(e.s.c)+":"+(e.e.cRel?"":"$")+on(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Sn(e.s.r)+":"+(e.e.rRel?"":"$")+Sn(e.e.r):_c(e.s,t.biff)+":"+_c(e.e,t.biff)}function mg(e){return parseInt(jL(e),10)-1}function Sn(e){return""+(e+1)}function AL(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function jL(e){return e.replace(/\$(\d+)$/,"$1")}function pg(e){for(var t=IL(e),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function on(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function RL(e){return e.replace(/^([A-Z])/,"$$$1")}function IL(e){return e.replace(/^\$([A-Z])/,"$1")}function PL(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ln(e){for(var t=0,n=0,r=0;r<e.length;++r){var s=e.charCodeAt(r);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(n=26*n+(s-64))}return{c:n-1,r:t-1}}function it(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function Fr(e){var t=e.indexOf(":");return t==-1?{s:ln(e),e:ln(e)}:{s:ln(e.slice(0,t)),e:ln(e.slice(t+1))}}function ft(e,t){return typeof t>"u"||typeof t=="number"?ft(e.s,e.e):(typeof e!="string"&&(e=it(e)),typeof t!="string"&&(t=it(t)),e==t?e:e+":"+t)}function Tt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,s=0,i=e.length;for(n=0;r<i&&!((s=e.charCodeAt(r)-64)<1||s>26);++r)n=26*n+s;for(t.s.c=--n,n=0;r<i&&!((s=e.charCodeAt(r)-48)<0||s>9);++r)n=10*n+s;if(t.s.r=--n,r===i||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=i&&!((s=e.charCodeAt(r)-64)<1||s>26);++r)n=26*n+s;for(t.e.c=--n,n=0;r!=i&&!((s=e.charCodeAt(r)-48)<0||s>9);++r)n=10*n+s;return t.e.r=--n,t}function wk(e,t){var n=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=da(e.z,n?Dn(t):t)}catch{}try{return e.w=da((e.XF||{}).numFmtId||(n?14:0),n?Dn(t):t)}catch{return""+t}}function ks(e,t,n){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),e.t=="e"?Es[e.v]||e.v:t==null?wk(e,e.v):wk(e,t))}function pi(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function J_(e,t,n){var r=n||{},s=e?Array.isArray(e):r.dense,i=e||(s?[]:{}),l=0,u=0;if(i&&r.origin!=null){if(typeof r.origin=="number")l=r.origin;else{var d=typeof r.origin=="string"?ln(r.origin):r.origin;l=d.r,u=d.c}i["!ref"]||(i["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var m=Tt(i["!ref"]);f.s.c=m.s.c,f.s.r=m.s.r,f.e.c=Math.max(f.e.c,m.e.c),f.e.r=Math.max(f.e.r,m.e.r),l==-1&&(f.e.r=l=m.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=t[p].length;++x)if(!(typeof t[p][x]>"u")){var v={v:t[p][x]},k=l+p,y=u+x;if(f.s.r>k&&(f.s.r=k),f.s.c>y&&(f.s.c=y),f.e.r<k&&(f.e.r=k),f.e.c<y&&(f.e.c=y),t[p][x]&&typeof t[p][x]=="object"&&!Array.isArray(t[p][x])&&!(t[p][x]instanceof Date))v=t[p][x];else if(Array.isArray(v.v)&&(v.f=t[p][x][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(r.nullError)v.t="e",v.v=0;else if(r.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=r.dateNF||st[14],r.cellDates?(v.t="d",v.w=da(v.z,Dn(v.v))):(v.t="n",v.v=Dn(v.v),v.w=da(v.z,v.v))):v.t="s";if(s)i[k]||(i[k]=[]),i[k][y]&&i[k][y].z&&(v.z=i[k][y].z),i[k][y]=v;else{var S=it({c:y,r:k});i[S]&&i[S].z&&(v.z=i[S].z),i[S]=v}}}return f.s.c<1e7&&(i["!ref"]=ft(f)),i}function yl(e,t){return J_(null,e,t)}function DL(e){return e.read_shift(4,"i")}function Da(e,t){return t||(t=Ae(4)),t.write_shift(4,e),t}function fr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function qn(e,t){var n=!1;return t==null&&(n=!0,t=Ae(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}function OL(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function LL(e,t){return t||(t=Ae(4)),t.write_shift(2,0),t.write_shift(2,0),t}function gg(e,t){var n=e.l,r=e.read_shift(1),s=fr(e),i=[],l={t:s,h:s};if((r&1)!==0){for(var u=e.read_shift(4),d=0;d!=u;++d)i.push(OL(e));l.r=i}else l.r=[{ich:0,ifnt:0}];return e.l=n+t,l}function FL(e,t){var n=!1;return t==null&&(n=!0,t=Ae(15+4*e.t.length)),t.write_shift(1,0),qn(e.t,t),n?t.slice(0,t.l):t}var ML=gg;function BL(e,t){var n=!1;return t==null&&(n=!0,t=Ae(23+4*e.t.length)),t.write_shift(1,1),qn(e.t,t),t.write_shift(4,1),LL({},t),n?t.slice(0,t.l):t}function pa(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function io(e,t){return t==null&&(t=Ae(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function oo(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function lo(e,t){return t==null&&(t=Ae(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var UL=fr,Z_=qn;function xg(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Nh(e,t){var n=!1;return t==null&&(n=!0,t=Ae(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}var zL=fr,Km=xg,vg=Nh;function yg(e){var t=e.slice(e.l,e.l+4),n=t[0]&1,r=t[0]&2;e.l+=4;var s=r===0?Ch([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Li(t,0)>>2;return n?s/100:s}function eC(e,t){t==null&&(t=Ae(4));var n=0,r=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?r=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(r=1,n=1),r)t.write_shift(-4,((n?s:e)<<2)+(n+2));else throw new Error("unsupported RkNumber "+e)}function tC(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function WL(e,t){return t||(t=Ae(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var co=tC,kl=WL;function dr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Zi(e,t){return(t||Ae(8)).write_shift(8,e,"f")}function HL(e){var t={},n=e.read_shift(1),r=n>>>1,s=e.read_shift(1),i=e.read_shift(2,"i"),l=e.read_shift(1),u=e.read_shift(1),d=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=s;var f=Ui[s];f&&(t.rgb=qc(f));break;case 2:t.rgb=qc([l,u,d]);break;case 3:t.theme=s;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function Eh(e,t){if(t||(t=Ae(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var n=e.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),t.write_shift(2,n),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var r=e.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}return t}function GL(e){var t=e.read_shift(1);e.l++;var n={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return n}function $L(e,t){t||(t=Ae(2));var n=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,n),t.write_shift(1,0),t}function nC(e,t){var n={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return n[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function VL(e){return nC(e,1)}function qL(e){return nC(e,2)}var kg=2,Ar=3,Dd=11,Sk=12,Th=19,Od=64,KL=65,YL=71,XL=4108,QL=4126,Wn=80,rC=81,JL=[Wn,rC],Ym={1:{n:"CodePage",t:kg},2:{n:"Category",t:Wn},3:{n:"PresentationFormat",t:Wn},4:{n:"ByteCount",t:Ar},5:{n:"LineCount",t:Ar},6:{n:"ParagraphCount",t:Ar},7:{n:"SlideCount",t:Ar},8:{n:"NoteCount",t:Ar},9:{n:"HiddenCount",t:Ar},10:{n:"MultimediaClipCount",t:Ar},11:{n:"ScaleCrop",t:Dd},12:{n:"HeadingPairs",t:XL},13:{n:"TitlesOfParts",t:QL},14:{n:"Manager",t:Wn},15:{n:"Company",t:Wn},16:{n:"LinksUpToDate",t:Dd},17:{n:"CharacterCount",t:Ar},19:{n:"SharedDoc",t:Dd},22:{n:"HyperlinksChanged",t:Dd},23:{n:"AppVersion",t:Ar,p:"version"},24:{n:"DigSig",t:KL},26:{n:"ContentType",t:Wn},27:{n:"ContentStatus",t:Wn},28:{n:"Language",t:Wn},29:{n:"Version",t:Wn},255:{},2147483648:{n:"Locale",t:Th},2147483651:{n:"Behavior",t:Th},1919054434:{}},Xm={1:{n:"CodePage",t:kg},2:{n:"Title",t:Wn},3:{n:"Subject",t:Wn},4:{n:"Author",t:Wn},5:{n:"Keywords",t:Wn},6:{n:"Comments",t:Wn},7:{n:"Template",t:Wn},8:{n:"LastAuthor",t:Wn},9:{n:"RevNumber",t:Wn},10:{n:"EditTime",t:Od},11:{n:"LastPrinted",t:Od},12:{n:"CreatedDate",t:Od},13:{n:"ModifiedDate",t:Od},14:{n:"PageCount",t:Ar},15:{n:"WordCount",t:Ar},16:{n:"CharCount",t:Ar},17:{n:"Thumbnail",t:YL},18:{n:"Application",t:Wn},19:{n:"DocSecurity",t:Ar},255:{},2147483648:{n:"Locale",t:Th},2147483651:{n:"Behavior",t:Th},1919054434:{}},_k={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},ZL=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function eF(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var tF=eF([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ui=Zt(tF),Es={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},aC={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Qm={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Ld={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function wg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function nF(e){var t=wg();if(!e||!e.match)return t;var n={};if((e.match(pr)||[]).forEach(function(r){var s=lt(r);switch(s[0].replace(hL,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[s.Extension]=s.ContentType;break;case"<Override":t[Qm[s.ContentType]]!==void 0&&t[Qm[s.ContentType]].push(s.PartName);break}}),t.xmlns!==In.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=n,delete t.calcchains,t}function sC(e,t){var n=nL(Qm),r=[],s;r[r.length]=_n,r[r.length]=He("Types",null,{xmlns:In.CT,"xmlns:xsd":In.xsd,"xmlns:xsi":In.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return He("Default",null,{Extension:d[0],ContentType:d[1]})}));var i=function(d){e[d]&&e[d].length>0&&(s=e[d][0],r[r.length]=He("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Ld[d][t.bookType]||Ld[d].xlsx}))},l=function(d){(e[d]||[]).forEach(function(f){r[r.length]=He("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:Ld[d][t.bookType]||Ld[d].xlsx})})},u=function(d){(e[d]||[]).forEach(function(f){r[r.length]=He("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:n[d][0]})})};return i("workbooks"),l("sheets"),l("charts"),u("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),l("metadata"),u("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var xt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Vc(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Cc(e,t){var n={"!id":{}};if(!e)return n;t.charAt(0)!=="/"&&(t="/"+t);var r={};return(e.match(pr)||[]).forEach(function(s){var i=lt(s);if(i[0]==="<Relationship"){var l={};l.Type=i.Type,l.Target=i.Target,l.Id=i.Id,i.TargetMode&&(l.TargetMode=i.TargetMode);var u=i.TargetMode==="External"?i.Target:mc(i.Target,t);n[u]=l,r[i.Id]=l}}),n["!id"]=r,n}function Zo(e){var t=[_n,He("Relationships",null,{xmlns:In.RELS})];return pn(e["!id"]).forEach(function(n){t[t.length]=He("Relationship",null,e["!id"][n])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ot(e,t,n,r,s,i){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=r,s.Target=n,[xt.HLINK,xt.XPATH,xt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var rF="application/vnd.oasis.opendocument.spreadsheet";function aF(e,t){for(var n=dg(e),r,s;r=$c.exec(n);)switch(r[3]){case"manifest":break;case"file-entry":if(s=lt(r[0],!1),s.path=="/"&&s.type!==rF)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw r}}function sF(e){var t=[_n];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Ck(e,t,n){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function iF(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function oF(e){var t=[_n];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var n=0;n!=e.length;++n)t.push(Ck(e[n][0],e[n][1])),t.push(iF("",e[n][0]));return t.push(Ck("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function iC(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+yh.version+"</meta:generator></office:meta></office:document-meta>"}var ua=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],lF=(function(){for(var e=new Array(ua.length),t=0;t<ua.length;++t){var n=ua[t],r="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);e[t]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e})();function oC(e){var t={};e=Bt(e);for(var n=0;n<ua.length;++n){var r=ua[n],s=e.match(lF[n]);s!=null&&s.length>0&&(t[r[1]]=Et(s[1])),r[2]==="date"&&t[r[1]]&&(t[r[1]]=Jt(t[r[1]]))}return t}function im(e,t,n,r,s){s[e]!=null||t==null||t===""||(s[e]=t,t=Lt(t),r[r.length]=n?He(e,t,n):er(e,t))}function lC(e,t){var n=t||{},r=[_n,He("cp:coreProperties",null,{"xmlns:cp":In.CORE_PROPS,"xmlns:dc":In.dc,"xmlns:dcterms":In.dcterms,"xmlns:dcmitype":In.dcmitype,"xmlns:xsi":In.xsi})],s={};if(!e&&!n.Props)return r.join("");e&&(e.CreatedDate!=null&&im("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:qm(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,s),e.ModifiedDate!=null&&im("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:qm(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,s));for(var i=0;i!=ua.length;++i){var l=ua[i],u=n.Props&&n.Props[l[1]]!=null?n.Props[l[1]]:e?e[l[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&im(l[0],u,null,r,s)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var zi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],cC=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function uC(e,t,n,r){var s=[];if(typeof e=="string")s=mk(e,r);else for(var i=0;i<e.length;++i)s=s.concat(e[i].map(function(m){return{v:m}}));var l=typeof t=="string"?mk(t,r).map(function(m){return m.v}):t,u=0,d=0;if(l.length>0)for(var f=0;f!==s.length;f+=2){switch(d=+s[f+1].v,s[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":n.Worksheets=d,n.SheetNames=l.slice(u,u+d);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":n.NamedRanges=d,n.DefinedNames=l.slice(u,u+d);break;case"Charts":case"Diagramme":n.Chartsheets=d,n.ChartNames=l.slice(u,u+d);break}u+=d}}function cF(e,t,n){var r={};return t||(t={}),e=Bt(e),zi.forEach(function(s){var i=(e.match(Hc(s[0]))||[])[1];switch(s[2]){case"string":i&&(t[s[1]]=Et(i));break;case"bool":t[s[1]]=i==="true";break;case"raw":var l=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));l&&l.length>0&&(r[s[1]]=l[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&uC(r.HeadingPairs,r.TitlesOfParts,t,n),t}function dC(e){var t=[],n=He;return e||(e={}),e.Application="SheetJS",t[t.length]=_n,t[t.length]=He("Properties",null,{xmlns:In.EXT_PROPS,"xmlns:vt":In.vt}),zi.forEach(function(r){if(e[r[1]]!==void 0){var s;switch(r[2]){case"string":s=Lt(String(e[r[1]]));break;case"bool":s=e[r[1]]?"true":"false";break}s!==void 0&&(t[t.length]=n(r[0],s))}}),t[t.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map(function(r){return"<vt:lpstr>"+Lt(r)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var uF=/<[^>]+>[^<]*/g;function dF(e,t){var n={},r="",s=e.match(uF);if(s)for(var i=0;i!=s.length;++i){var l=s[i],u=lt(l);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":r=Et(u.name);break;case"</property>":r=null;break;default:if(l.indexOf("<vt:")===0){var d=l.split(">"),f=d[0].slice(4),m=d[1];switch(f){case"lpstr":case"bstr":case"lpwstr":n[r]=Et(m);break;case"bool":n[r]=Qt(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[r]=parseInt(m,10);break;case"r4":case"r8":case"decimal":n[r]=parseFloat(m);break;case"filetime":case"date":n[r]=Jt(m);break;case"cy":case"error":n[r]=Et(m);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,f,d)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return n}function hC(e){var t=[_n,He("Properties",null,{xmlns:In.CUST_PROPS,"xmlns:vt":In.vt})];if(!e)return t.join("");var n=1;return pn(e).forEach(function(s){++n,t[t.length]=He("property",kL(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:Lt(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Jm={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},om;function hF(e,t,n){om||(om=Kh(Jm)),t=om[t]||t,e[t]=n}function fF(e,t){var n=[];return pn(Jm).map(function(r){for(var s=0;s<ua.length;++s)if(ua[s][1]==r)return ua[s];for(s=0;s<zi.length;++s)if(zi[s][1]==r)return zi[s];throw r}).forEach(function(r){if(e[r[1]]!=null){var s=t&&t.Props&&t.Props[r[1]]!=null?t.Props[r[1]]:e[r[1]];switch(r[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),n.push(er(Jm[r[1]]||r[1],s))}}),He("DocumentProperties",n.join(""),{xmlns:Wr.o})}function mF(e,t){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",s=[];return e&&pn(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var l=0;l<ua.length;++l)if(i==ua[l][1])return;for(l=0;l<zi.length;++l)if(i==zi[l][1])return;for(l=0;l<n.length;++l)if(i==n[l])return;var u=e[i],d="string";typeof u=="number"?(d="float",u=String(u)):u===!0||u===!1?(d="boolean",u=u?"1":"0"):u=String(u),s.push(He(uk(i),u,{"dt:dt":d}))}}),t&&pn(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var l=t[i],u="string";typeof l=="number"?(u="float",l=String(l)):l===!0||l===!1?(u="boolean",l=l?"1":"0"):l instanceof Date?(u="dateTime.tz",l=l.toISOString()):l=String(l),s.push(He(uk(i),l,{"dt:dt":u}))}}),"<"+r+' xmlns="'+Wr.o+'">'+s.join("")+"</"+r+">"}function Sg(e){var t=e.read_shift(4),n=e.read_shift(4);return new Date((n/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function pF(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,n=t.getTime()/1e3+11644473600,r=n%Math.pow(2,32),s=(n-r)/Math.pow(2,32);r*=1e7,s*=1e7;var i=r/Math.pow(2,32)|0;i>0&&(r=r%Math.pow(2,32),s+=i);var l=Ae(8);return l.write_shift(4,r),l.write_shift(4,s),l}function fC(e,t,n){var r=e.l,s=e.read_shift(0,"lpstr-cp");if(n)for(;e.l-r&3;)++e.l;return s}function mC(e,t,n){var r=e.read_shift(0,"lpwstr");return r}function pC(e,t,n){return t===31?mC(e):fC(e,t,n)}function Zm(e,t,n){return pC(e,t,n===!1?0:4)}function gF(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return pC(e,t,0)}function xF(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r){var s=e.l;n[r]=e.read_shift(0,"lpwstr").replace(Sr,""),e.l-s&2&&(e.l+=2)}return n}function vF(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r)n[r]=e.read_shift(0,"lpstr-cp").replace(Sr,"");return n}function yF(e){var t=e.l,n=bh(e,rC);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var r=bh(e,Ar);return[n,r]}function kF(e){for(var t=e.read_shift(4),n=[],r=0;r<t/2;++r)n.push(yF(e));return n}function Nk(e,t){for(var n=e.read_shift(4),r={},s=0;s!=n;++s){var i=e.read_shift(4),l=e.read_shift(4);r[i]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(Sr,"").replace(fc,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),r}function gC(e){var t=e.read_shift(4),n=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),n}function wF(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function bh(e,t,n){var r=e.read_shift(2),s,i=n||{};if(e.l+=2,t!==Sk&&r!==t&&JL.indexOf(t)===-1&&!((t&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+t+" saw "+r);switch(t===Sk?r:t){case 2:return s=e.read_shift(2,"i"),i.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return fC(e,r,4).replace(Sr,"");case 31:return mC(e);case 64:return Sg(e);case 65:return gC(e);case 71:return wF(e);case 80:return Zm(e,r,!i.raw).replace(Sr,"");case 81:return gF(e,r).replace(Sr,"");case 4108:return kF(e);case 4126:case 4127:return r==4127?xF(e):vF(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+r)}}function Ek(e,t){var n=Ae(4),r=Ae(4);switch(n.write_shift(4,e==80?31:e),e){case 3:r.write_shift(-4,t);break;case 5:r=Ae(8),r.write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=pF(t);break;case 31:case 80:for(r=Ae(4+2*(t.length+1)+(t.length%2?0:2)),r.write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Vn([n,r])}function Tk(e,t){var n=e.l,r=e.read_shift(4),s=e.read_shift(4),i=[],l=0,u=0,d=-1,f={};for(l=0;l!=s;++l){var m=e.read_shift(4),p=e.read_shift(4);i[l]=[m,p+n]}i.sort(function(D,N){return D[1]-N[1]});var x={};for(l=0;l!=s;++l){if(e.l!==i[l][1]){var v=!0;if(l>0&&t)switch(t[i[l-1][0]].t){case 2:e.l+2===i[l][1]&&(e.l+=2,v=!1);break;case 80:e.l<=i[l][1]&&(e.l=i[l][1],v=!1);break;case 4108:e.l<=i[l][1]&&(e.l=i[l][1],v=!1);break}if((!t||l==0)&&e.l<=i[l][1]&&(v=!1,e.l=i[l][1]),v)throw new Error("Read Error: Expected address "+i[l][1]+" at "+e.l+" :"+l)}if(t){var k=t[i[l][0]];if(x[k.n]=bh(e,k.t,{raw:!0}),k.p==="version"&&(x[k.n]=String(x[k.n]>>16)+"."+("0000"+String(x[k.n]&65535)).slice(-4)),k.n=="CodePage")switch(x[k.n]){case 0:x[k.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ja(u=x[k.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[k.n])}}else if(i[l][0]===1){if(u=x.CodePage=bh(e,kg),ja(u),d!==-1){var y=e.l;e.l=i[d][1],f=Nk(e,u),e.l=y}}else if(i[l][0]===0){if(u===0){d=l,e.l=i[l+1][1];continue}f=Nk(e,u)}else{var S=f[i[l][0]],C;switch(e[e.l]){case 65:e.l+=4,C=gC(e);break;case 30:e.l+=4,C=Zm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,C=Zm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,C=e.read_shift(4,"i");break;case 19:e.l+=4,C=e.read_shift(4);break;case 5:e.l+=4,C=e.read_shift(8,"f");break;case 11:e.l+=4,C=kn(e,4);break;case 64:e.l+=4,C=Jt(Sg(e));break;default:throw new Error("unparsed value: "+e[e.l])}x[S]=C}}return e.l=n+r,x}var xC=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function SF(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function bk(e,t,n){var r=Ae(8),s=[],i=[],l=8,u=0,d=Ae(8),f=Ae(8);if(d.write_shift(4,2),d.write_shift(4,1200),f.write_shift(4,1),i.push(d),s.push(f),l+=8+d.length,!t){f=Ae(8),f.write_shift(4,0),s.unshift(f);var m=[Ae(4)];for(m[0].write_shift(4,e.length),u=0;u<e.length;++u){var p=e[u][0];for(d=Ae(8+2*(p.length+1)+(p.length%2?0:2)),d.write_shift(4,u+2),d.write_shift(4,p.length+1),d.write_shift(0,p,"dbcs");d.l!=d.length;)d.write_shift(1,0);m.push(d)}d=Vn(m),i.unshift(d),l+=8+d.length}for(u=0;u<e.length;++u)if(!(t&&!t[e[u][0]])&&!(xC.indexOf(e[u][0])>-1||cC.indexOf(e[u][0])>-1)&&e[u][1]!=null){var x=e[u][1],v=0;if(t){v=+t[e[u][0]];var k=n[v];if(k.p=="version"&&typeof x=="string"){var y=x.split(".");x=(+y[0]<<16)+(+y[1]||0)}d=Ek(k.t,x)}else{var S=SF(x);S==-1&&(S=31,x=String(x)),d=Ek(S,x)}i.push(d),f=Ae(8),f.write_shift(4,t?v:2+u),s.push(f),l+=8+d.length}var C=8*(i.length+1);for(u=0;u<i.length;++u)s[u].write_shift(4,C),C+=i[u].length;return r.write_shift(4,l),r.write_shift(4,i.length),Vn([r].concat(s).concat(i))}function Ak(e,t,n){var r=e.content;if(!r)return{};Qn(r,0);var s,i,l,u,d=0;r.chk("feff","Byte Order: "),r.read_shift(2);var f=r.read_shift(4),m=r.read_shift(16);if(m!==nt.utils.consts.HEADER_CLSID&&m!==n)throw new Error("Bad PropertySet CLSID "+m);if(s=r.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=r.read_shift(16),u=r.read_shift(4),s===1&&u!==r.l)throw new Error("Length mismatch: "+u+" !== "+r.l);s===2&&(l=r.read_shift(16),d=r.read_shift(4));var p=Tk(r,t),x={SystemIdentifier:f};for(var v in p)x[v]=p[v];if(x.FMTID=i,s===1)return x;if(d-r.l==2&&(r.l+=2),r.l!==d)throw new Error("Length mismatch 2: "+r.l+" !== "+d);var k;try{k=Tk(r,null)}catch{}for(v in k)x[v]=k[v];return x.FMTID=[i,l],x}function jk(e,t,n,r,s,i){var l=Ae(s?68:48),u=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,nt.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,s?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,s?68:48);var d=bk(e,n,r);if(u.push(d),s){var f=bk(s,null,null);l.write_shift(16,i,"hex"),l.write_shift(4,68+d.length),u.push(f)}return Vn(u)}function Qs(e,t){return e.read_shift(t),null}function _F(e,t){t||(t=Ae(e));for(var n=0;n<e;++n)t.write_shift(1,0);return t}function CF(e,t,n){for(var r=[],s=e.l+t;e.l<s;)r.push(n(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return r}function kn(e,t){return e.read_shift(t)===1}function wr(e,t){return t||(t=Ae(2)),t.write_shift(2,+!!e),t}function Tn(e){return e.read_shift(2,"u")}function ca(e,t){return t||(t=Ae(2)),t.write_shift(2,e),t}function vC(e,t){return CF(e,t,Tn)}function NF(e){var t=e.read_shift(1),n=e.read_shift(1);return n===1?t:t===1}function yC(e,t,n){return n||(n=Ae(2)),n.write_shift(1,t=="e"?+e:+!!e),n.write_shift(1,t=="e"?1:0),n}function hu(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),s="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var i=e.read_shift(1);i&&(s="dbcs-cont")}else n.biff==12&&(s="wstr");n.biff>=2&&n.biff<=5&&(s="cpstr");var l=r?e.read_shift(r,s):"";return l}function EF(e){var t=e.read_shift(2),n=e.read_shift(1),r=n&4,s=n&8,i=1+(n&1),l=0,u,d={};s&&(l=e.read_shift(2)),r&&(u=e.read_shift(4));var f=i==2?"dbcs-cont":"sbcs-cont",m=t===0?"":e.read_shift(t,f);return s&&(e.l+=4*l),r&&(e.l+=u),d.t=m,s||(d.raw="<t>"+d.t+"</t>",d.r=d.t),d}function TF(e){var t=e.t||"",n=Ae(3);n.write_shift(2,t.length),n.write_shift(1,1);var r=Ae(2*t.length);r.write_shift(2*t.length,t,"utf16le");var s=[n,r];return Vn(s)}function eo(e,t,n){var r;if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?r=e.read_shift(t,"sbcs-cont"):r=e.read_shift(t,"dbcs-cont"),r}function fu(e,t,n){var r=e.read_shift(n&&n.biff==2?1:2);return r===0?(e.l++,""):eo(e,r,n)}function uo(e,t,n){if(n.biff>5)return fu(e,t,n);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function kC(e,t,n){return n||(n=Ae(3+2*e.length)),n.write_shift(2,e.length),n.write_shift(1,1),n.write_shift(31,e,"utf16le"),n}function bF(e){var t=e.read_shift(1);e.l++;var n=e.read_shift(2);return e.l+=2,[t,n]}function AF(e){var t=e.read_shift(4),n=e.l,r=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),e.l=n);var s=e.read_shift((r?t-24:t)>>1,"utf16le").replace(Sr,"");return r&&(e.l+=24),s}function jF(e){for(var t=e.read_shift(2),n="";t-- >0;)n+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return n+r.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(i>>1,"utf16le").replace(Sr,"");return n+l}function RF(e,t){var n=e.read_shift(16);switch(n){case"e0c9ea79f9bace118c8200aa004ba90b":return AF(e);case"0303000000000000c000000000000046":return jF(e);default:throw new Error("Unsupported Moniker "+n)}}function Fd(e){var t=e.read_shift(4),n=t>0?e.read_shift(t,"utf16le").replace(Sr,""):"";return n}function Rk(e,t){t||(t=Ae(6+e.length*2)),t.write_shift(4,1+e.length);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function IF(e,t){var n=e.l+t,r=e.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var s=e.read_shift(2);e.l+=2;var i,l,u,d,f="",m,p;s&16&&(i=Fd(e,n-e.l)),s&128&&(l=Fd(e,n-e.l)),(s&257)===257&&(u=Fd(e,n-e.l)),(s&257)===1&&(d=RF(e,n-e.l)),s&8&&(f=Fd(e,n-e.l)),s&32&&(m=e.read_shift(16)),s&64&&(p=Sg(e)),e.l=n;var x=l||u||d||"";x&&f&&(x+="#"+f),x||(x="#"+f),s&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var v={Target:x};return m&&(v.guid=m),p&&(v.time=p),i&&(v.Tooltip=i),v}function PF(e){var t=Ae(512),n=0,r=e.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var s=r.indexOf("#"),i=s>-1?31:23;switch(r.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var l=[8,6815827,6619237,4849780,83];for(n=0;n<l.length;++n)t.write_shift(4,l[n]);if(i==28)r=r.slice(1),Rk(r,t);else if(i&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<l.length;++n)t.write_shift(1,parseInt(l[n],16));var u=s>-1?r.slice(0,s):r;for(t.write_shift(4,2*(u.length+1)),n=0;n<u.length;++n)t.write_shift(2,u.charCodeAt(n));t.write_shift(2,0),i&8&&Rk(s>-1?r.slice(s+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<l.length;++n)t.write_shift(1,parseInt(l[n],16));for(var d=0;r.slice(d*3,d*3+3)=="../"||r.slice(d*3,d*3+3)=="..\\";)++d;for(t.write_shift(2,d),t.write_shift(4,r.length-3*d+1),n=0;n<r.length-3*d;++n)t.write_shift(1,r.charCodeAt(n+3*d)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),n=0;n<6;++n)t.write_shift(4,0)}return t.slice(0,t.l)}function wC(e){var t=e.read_shift(1),n=e.read_shift(1),r=e.read_shift(1),s=e.read_shift(1);return[t,n,r,s]}function SC(e,t){var n=wC(e);return n[3]=0,n}function Ya(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2);return{r:t,c:n,ixfe:r}}function to(e,t,n,r){return r||(r=Ae(6)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,n||0),r}function DF(e){var t=e.read_shift(2),n=e.read_shift(2);return e.l+=8,{type:t,flags:n}}function OF(e,t,n){return t===0?"":uo(e,t,n)}function LF(e,t,n){var r=n.biff>8?4:2,s=e.read_shift(r),i=e.read_shift(r,"i"),l=e.read_shift(r,"i");return[s,i,l]}function _C(e){var t=e.read_shift(2),n=yg(e);return[t,n]}function FF(e,t,n){e.l+=4,t-=4;var r=e.l+t,s=hu(e,t,n),i=e.read_shift(2);if(r-=e.l,i!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+i);return e.l+=i,s}function Qh(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return{s:{c:r,r:t},e:{c:s,r:n}}}function CC(e,t){return t||(t=Ae(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function NC(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(1),s=e.read_shift(1);return{s:{c:r,r:t},e:{c:s,r:n}}}var MF=NC;function EC(e){e.l+=4;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[n,t,r]}function BF(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function UF(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function ir(e){e.l+=2,e.l+=e.read_shift(2)}var zF={0:ir,4:ir,5:ir,6:ir,7:UF,8:ir,9:ir,10:ir,11:ir,12:ir,13:BF,14:ir,15:ir,16:ir,17:ir,18:ir,19:ir,20:ir,21:EC};function WF(e,t){for(var n=e.l+t,r=[];e.l<n;){var s=e.read_shift(2);e.l-=2;try{r.push(zF[s](e,n-e.l))}catch{return e.l=n,r}}return e.l!=n&&(e.l=n),r}function Md(e,t){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=e.read_shift(2),t-=2,t>=2&&(n.dt=e.read_shift(2),e.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return e.read_shift(t),n}function _g(e,t,n){var r=1536,s=16;switch(n.bookType){case"biff8":break;case"biff5":r=1280,s=8;break;case"biff4":r=4,s=6;break;case"biff3":r=3,s=6;break;case"biff2":r=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Ae(s);return i.write_shift(2,r),i.write_shift(2,t),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function HF(e,t){return t===0||e.read_shift(2),1200}function GF(e,t,n){if(n.enc)return e.l+=t,"";var r=e.l,s=uo(e,0,n);return e.read_shift(t+r-e.l),s}function $F(e,t){var n=!t||t.biff==8,r=Ae(n?112:54);for(r.write_shift(t.biff==8?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}function VF(e,t,n){var r=n&&n.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function qF(e,t,n){var r=e.read_shift(4),s=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var l=hu(e,0,n);return l.length===0&&(l="Sheet1"),{pos:r,hs:s,dt:i,name:l}}function KF(e,t){var n=!t||t.biff>=8?2:1,r=Ae(8+n*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(n*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=r.slice(0,r.l);return s.l=r.l,s}function YF(e,t){for(var n=e.l+t,r=e.read_shift(4),s=e.read_shift(4),i=[],l=0;l!=s&&e.l<n;++l)i.push(EF(e));return i.Count=r,i.Unique=s,i}function XF(e,t){var n=Ae(8);n.write_shift(4,e.Count),n.write_shift(4,e.Unique);for(var r=[],s=0;s<e.length;++s)r[s]=TF(e[s]);var i=Vn([n].concat(r));return i.parts=[n.length].concat(r.map(function(l){return l.length})),i}function QF(e,t){var n={};return n.dsst=e.read_shift(2),e.l+=t-2,n}function JF(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var n=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,r&7&&(t.level=r&7),r&32&&(t.hidden=!0),r&64&&(t.hpt=n/20),t}function ZF(e){var t=DF(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var n=e.read_shift(4);return n!==0}function e6(e){return e.read_shift(2),e.read_shift(4)}function Ik(e,t,n){var r=0;n&&n.biff==2||(r=e.read_shift(2));var s=e.read_shift(2);n&&n.biff==2&&(r=1-(s>>15),s&=32767);var i={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[i,s]}function t6(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2),d=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,n],Dim:[r,s],Flags:i,CurTab:l,FirstTab:u,Selected:d,TabRatio:f}}function n6(){var e=Ae(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function r6(e,t,n){if(n&&n.biff>=2&&n.biff<5)return{};var r=e.read_shift(2);return{RTL:r&64}}function a6(e){var t=Ae(18),n=1718;return e&&e.RTL&&(n|=64),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function s6(){}function i6(e,t,n){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return r.name=hu(e,0,n),r}function o6(e,t){var n=e.name||"Arial",r=t&&t.biff==5,s=r?15+n.length:16+2*n.length,i=Ae(s);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,n.length),r||i.write_shift(1,1),i.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),i}function l6(e){var t=Ya(e);return t.isst=e.read_shift(4),t}function c6(e,t,n,r){var s=Ae(10);return to(e,t,r,s),s.write_shift(4,n),s}function u6(e,t,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=e.l+t,s=Ya(e);n.biff==2&&e.l++;var i=fu(e,r-e.l,n);return s.val=i,s}function d6(e,t,n,r,s){var i=!s||s.biff==8,l=Ae(8+ +i+(1+i)*n.length);return to(e,t,r,l),l.write_shift(2,n.length),i&&l.write_shift(1,1),l.write_shift((1+i)*n.length,n,i?"utf16le":"sbcs"),l}function h6(e,t,n){var r=e.read_shift(2),s=uo(e,0,n);return[r,s]}function f6(e,t,n,r){var s=n&&n.biff==5;r||(r=Ae(s?3+t.length:5+2*t.length)),r.write_shift(2,e),r.write_shift(s?1:2,t.length),s||r.write_shift(1,1),r.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var i=r.length>r.l?r.slice(0,r.l):r;return i.l==null&&(i.l=i.length),i}var m6=uo;function Pk(e,t,n){var r=e.l+t,s=n.biff==8||!n.biff?4:2,i=e.read_shift(s),l=e.read_shift(s),u=e.read_shift(2),d=e.read_shift(2);return e.l=r,{s:{r:i,c:u},e:{r:l,c:d}}}function p6(e,t){var n=t.biff==8||!t.biff?4:2,r=Ae(2*n+6);return r.write_shift(n,e.s.r),r.write_shift(n,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}function g6(e){var t=e.read_shift(2),n=e.read_shift(2),r=_C(e);return{r:t,c:n,ixfe:r[0],rknum:r[1]}}function x6(e,t){for(var n=e.l+t-2,r=e.read_shift(2),s=e.read_shift(2),i=[];e.l<n;)i.push(_C(e));if(e.l!==n)throw new Error("MulRK read error");var l=e.read_shift(2);if(i.length!=l-s+1)throw new Error("MulRK length mismatch");return{r,c:s,C:l,rkrec:i}}function v6(e,t){for(var n=e.l+t-2,r=e.read_shift(2),s=e.read_shift(2),i=[];e.l<n;)i.push(e.read_shift(2));if(e.l!==n)throw new Error("MulBlank read error");var l=e.read_shift(2);if(i.length!=l-s+1)throw new Error("MulBlank length mismatch");return{r,c:s,C:l,ixfe:i}}function y6(e,t,n,r){var s={},i=e.read_shift(4),l=e.read_shift(4),u=e.read_shift(4),d=e.read_shift(2);return s.patternType=ZL[u>>26],r.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=l&15,s.dgRight=l>>4&15,s.dgTop=l>>8&15,s.dgBottom=l>>12&15,s.icvLeft=l>>16&127,s.icvRight=l>>23&127,s.grbitDiag=l>>30&3,s.icvTop=u&127,s.icvBottom=u>>7&127,s.icvDiag=u>>14&127,s.dgDiag=u>>21&15,s.icvFore=d&127,s.icvBack=d>>7&127,s.fsxButton=d>>14&1),s}function k6(e,t,n){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,t-=6,r.data=y6(e,t,r.fStyle,n),r}function Dk(e,t,n,r){var s=n&&n.biff==5;r||(r=Ae(s?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&s&&(i|=1024),r.write_shift(4,i),r.write_shift(4,0),s||r.write_shift(4,0),r.write_shift(2,0),r}function w6(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function S6(e){var t=Ae(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Ok(e,t,n){var r=Ya(e);(n.biff==2||t==9)&&++e.l;var s=NF(e);return r.val=s,r.t=s===!0||s===!1?"b":"e",r}function _6(e,t,n,r,s,i){var l=Ae(8);return to(e,t,r,l),yC(n,i,l),l}function C6(e,t,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=Ya(e),s=dr(e);return r.val=s,r}function N6(e,t,n,r){var s=Ae(14);return to(e,t,r,s),Zi(n,s),s}var Lk=OF;function E6(e,t,n){var r=e.l+t,s=e.read_shift(2),i=e.read_shift(2);if(n.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var l=eo(e,i),u=[];r>e.l;)u.push(fu(e));return[i,s,l,u]}function Fk(e,t,n){var r=e.read_shift(2),s,i={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return n.sbcch===14849&&(s=FF(e,t-2,n)),i.body=s||e.read_shift(t-2),typeof s=="string"&&(i.Name=s),i}var T6=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Mk(e,t,n){var r=e.l+t,s=e.read_shift(2),i=e.read_shift(1),l=e.read_shift(1),u=e.read_shift(n&&n.biff==2?1:2),d=0;(!n||n.biff>=5)&&(n.biff!=5&&(e.l+=2),d=e.read_shift(2),n.biff==5&&(e.l+=2),e.l+=4);var f=eo(e,l,n);s&32&&(f=T6[f.charCodeAt(0)]);var m=r-e.l;n&&n.biff==2&&--m;var p=r==e.l||u===0||!(m>0)?[]:WB(e,m,n,u);return{chKey:i,Name:f,itab:d,rgce:p}}function TC(e,t,n){if(n.biff<8)return b6(e,t,n);for(var r=[],s=e.l+t,i=e.read_shift(n.biff>8?4:2);i--!==0;)r.push(LF(e,n.biff>8?12:6,n));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return r}function b6(e,t,n){e[e.l+1]==3&&e[e.l]++;var r=hu(e,t,n);return r.charCodeAt(0)==3?r.slice(1):r}function A6(e,t,n){if(n.biff<8){e.l+=t;return}var r=e.read_shift(2),s=e.read_shift(2),i=eo(e,r,n),l=eo(e,s,n);return[i,l]}function j6(e,t,n){var r=NC(e);e.l++;var s=e.read_shift(1);return t-=8,[HB(e,t,n),s,r]}function Bk(e,t,n){var r=MF(e);switch(n.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[r,UB(e,t,n)]}function R6(e){var t=e.read_shift(4)!==0,n=e.read_shift(4)!==0,r=e.read_shift(4);return[t,n,r]}function I6(e,t,n){if(!(n.biff<8)){var r=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),u=uo(e,0,n);return n.biff<8&&e.read_shift(1),[{r,c:s},u,l,i]}}function P6(e,t,n){return I6(e,t,n)}function D6(e,t){for(var n=[],r=e.read_shift(2);r--;)n.push(Qh(e));return n}function O6(e){var t=Ae(2+e.length*8);t.write_shift(2,e.length);for(var n=0;n<e.length;++n)CC(e[n],t);return t}function L6(e,t,n){if(n&&n.biff<8)return M6(e,t,n);var r=EC(e),s=WF(e,t-22,r[1]);return{cmo:r,ft:s}}var F6={8:function(e,t){var n=e.l+t;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=n,{fmt:r}}};function M6(e,t,n){e.l+=4;var r=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((F6[r]||mr)(e,t,n)),{cmo:[s,r,i],ft:l}}function B6(e,t,n){var r=e.l,s="";try{e.l+=4;var i=(n.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:l=bF(e,6,n);var u=e.read_shift(2);e.read_shift(2),Tn(e,2);var d=e.read_shift(2);e.l+=d;for(var f=1;f<e.lens.length-1;++f){if(e.l-r!=e.lens[f])throw new Error("TxO: bad continue record");var m=e[e.l],p=eo(e,e.lens[f+1]-e.lens[f]-1);if(s+=p,s.length>=(m?u:2*u))break}if(s.length!==u&&s.length!==u*2)throw new Error("cchText: "+u+" != "+s.length);return e.l=r+t,{t:s}}catch{return e.l=r+t,{t:s}}}function U6(e,t){var n=Qh(e);e.l+=16;var r=IF(e,t-24);return[n,r]}function z6(e){var t=Ae(24),n=ln(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(r[s],16));return Vn([t,PF(e[1])])}function W6(e,t){e.read_shift(2);var n=Qh(e),r=e.read_shift((t-10)/2,"dbcs-cont");return r=r.replace(Sr,""),[n,r]}function H6(e){var t=e[1].Tooltip,n=Ae(10+2*(t.length+1));n.write_shift(2,2048);var r=ln(e[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var s=0;s<t.length;++s)n.write_shift(2,t.charCodeAt(s));return n.write_shift(2,0),n}function G6(e){var t=[0,0],n;return n=e.read_shift(2),t[0]=_k[n]||n,n=e.read_shift(2),t[1]=_k[n]||n,t}function $6(e){return e||(e=Ae(4)),e.write_shift(2,1),e.write_shift(2,1),e}function V6(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(SC(e));return n}function q6(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(SC(e));return n}function K6(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function bC(e,t,n){if(!n.cellStyles)return mr(e,t);var r=n&&n.biff>=12?4:2,s=e.read_shift(r),i=e.read_shift(r),l=e.read_shift(r),u=e.read_shift(r),d=e.read_shift(2);r==2&&(e.l+=2);var f={s,e:i,w:l,ixfe:u,flags:d};return(n.biff>=5||!n.biff)&&(f.level=d>>8&7),f}function Y6(e,t){var n=Ae(12);n.write_shift(2,t),n.write_shift(2,t),n.write_shift(2,e.width*256),n.write_shift(2,0);var r=0;return e.hidden&&(r|=1),n.write_shift(1,r),r=e.level||0,n.write_shift(1,r),n.write_shift(2,0),n}function X6(e,t){var n={};return t<32||(e.l+=16,n.header=dr(e),n.footer=dr(e),e.l+=2),n}function Q6(e,t,n){var r={area:!1};if(n.biff!=5)return e.l+=t,r;var s=e.read_shift(1);return e.l+=3,s&16&&(r.area=!0),r}function J6(e){for(var t=Ae(2*e),n=0;n<e;++n)t.write_shift(2,n+1);return t}var Z6=Ya,eM=vC,tM=fu;function nM(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),s={fmt:t,env:n,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,s}function rM(e,t,n){n.biffguess&&n.biff==5&&(n.biff=2);var r=Ya(e);++e.l;var s=uo(e,t-7,n);return r.t="str",r.val=s,r}function aM(e){var t=Ya(e);++e.l;var n=dr(e);return t.t="n",t.val=n,t}function sM(e,t,n){var r=Ae(15);return xu(r,e,t),r.write_shift(8,n,"f"),r}function iM(e){var t=Ya(e);++e.l;var n=e.read_shift(2);return t.t="n",t.val=n,t}function oM(e,t,n){var r=Ae(9);return xu(r,e,t),r.write_shift(2,n),r}function lM(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function cM(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function uM(e,t,n){var r=e.l+t,s=Ya(e),i=e.read_shift(2),l=eo(e,i,n);return e.l=r,s.t="str",s.val=l,s}var dM=[2,3,48,49,131,139,140,245],ep=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Kh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(u,d){var f=[],m=li(1);switch(d.type){case"base64":m=$r(Qr(u));break;case"binary":m=$r(u);break;case"buffer":case"array":m=u;break}Qn(m,0);var p=m.read_shift(1),x=!!(p&136),v=!1,k=!1;switch(p){case 2:break;case 3:break;case 48:v=!0,x=!0;break;case 49:v=!0,x=!0;break;case 131:break;case 139:break;case 140:k=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var y=0,S=521;p==2&&(y=m.read_shift(2)),m.l+=3,p!=2&&(y=m.read_shift(4)),y>1048576&&(y=1e6),p!=2&&(S=m.read_shift(2));var C=m.read_shift(2),D=d.codepage||1252;p!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(D=e[m[m.l]]),m.l+=1,m.l+=2),k&&(m.l+=36);for(var N=[],b={},H=Math.min(m.length,p==2?521:S-10-(v?264:0)),L=k?32:11;m.l<H&&m[m.l]!=13;)switch(b={},b.name=Uc.utils.decode(D,m.slice(m.l,m.l+L)).replace(/[\u0000\r\n].*$/g,""),m.l+=L,b.type=String.fromCharCode(m.read_shift(1)),p!=2&&!k&&(b.offset=m.read_shift(4)),b.len=m.read_shift(1),p==2&&(b.offset=m.read_shift(2)),b.dec=m.read_shift(1),b.name.length&&N.push(b),p!=2&&(m.l+=k?13:14),b.type){case"B":(!v||b.len!=8)&&d.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+b.type)}if(m[m.l]!==13&&(m.l=S-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=S;var R=0,q=0;for(f[0]=[],q=0;q!=N.length;++q)f[0][q]=N[q].name;for(;y-- >0;){if(m[m.l]===42){m.l+=C;continue}for(++m.l,f[++R]=[],q=0,q=0;q!=N.length;++q){var O=m.slice(m.l,m.l+N[q].len);m.l+=N[q].len,Qn(O,0);var V=Uc.utils.decode(D,O);switch(N[q].type){case"C":V.trim().length&&(f[R][q]=V.replace(/\s+$/,""));break;case"D":V.length===8?f[R][q]=new Date(+V.slice(0,4),+V.slice(4,6)-1,+V.slice(6,8)):f[R][q]=V;break;case"F":f[R][q]=parseFloat(V.trim());break;case"+":case"I":f[R][q]=k?O.read_shift(-4,"i")^2147483648:O.read_shift(4,"i");break;case"L":switch(V.trim().toUpperCase()){case"Y":case"T":f[R][q]=!0;break;case"N":case"F":f[R][q]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+V+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));f[R][q]="##MEMO##"+(k?parseInt(V.trim(),10):O.read_shift(4));break;case"N":V=V.replace(/\u0000/g,"").trim(),V&&V!="."&&(f[R][q]=+V||0);break;case"@":f[R][q]=new Date(O.read_shift(-8,"f")-621356832e5);break;case"T":f[R][q]=new Date((O.read_shift(4)-2440588)*864e5+O.read_shift(4));break;case"Y":f[R][q]=O.read_shift(4,"i")/1e4+O.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[R][q]=-O.read_shift(-8,"f");break;case"B":if(v&&N[q].len==8){f[R][q]=O.read_shift(8,"f");break}case"G":case"P":O.l+=N[q].len;break;case"0":if(N[q].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+N[q].type)}}}if(p!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return d&&d.sheetRows&&(f=f.slice(0,d.sheetRows)),d.DBF=N,f}function r(u,d){var f=d||{};f.dateNF||(f.dateNF="yyyymmdd");var m=yl(n(u,f),f);return m["!cols"]=f.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete f.DBF,m}function s(u,d){try{return pi(r(u,d),d)}catch(f){if(d&&d.WTF)throw f}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function l(u,d){var f=d||{};if(+f.codepage>=0&&ja(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var m=Or(),p=Rh(u,{header:1,raw:!0,cellDates:!0}),x=p[0],v=p.slice(1),k=u["!cols"]||[],y=0,S=0,C=0,D=1;for(y=0;y<x.length;++y){if(((k[y]||{}).DBF||{}).name){x[y]=k[y].DBF.name,++C;continue}if(x[y]!=null){if(++C,typeof x[y]=="number"&&(x[y]=x[y].toString(10)),typeof x[y]!="string")throw new Error("DBF Invalid column name "+x[y]+" |"+typeof x[y]+"|");if(x.indexOf(x[y])!==y){for(S=0;S<1024;++S)if(x.indexOf(x[y]+"_"+S)==-1){x[y]+="_"+S;break}}}}var N=Tt(u["!ref"]),b=[],H=[],L=[];for(y=0;y<=N.e.c-N.s.c;++y){var R="",q="",O=0,V=[];for(S=0;S<v.length;++S)v[S][y]!=null&&V.push(v[S][y]);if(V.length==0||x[y]==null){b[y]="?";continue}for(S=0;S<V.length;++S){switch(typeof V[S]){case"number":q="B";break;case"string":q="C";break;case"boolean":q="L";break;case"object":q=V[S]instanceof Date?"D":"C";break;default:q="C"}O=Math.max(O,String(V[S]).length),R=R&&R!=q?"C":q}O>250&&(O=250),q=((k[y]||{}).DBF||{}).type,q=="C"&&k[y].DBF.len>O&&(O=k[y].DBF.len),R=="B"&&q=="N"&&(R="N",L[y]=k[y].DBF.dec,O=k[y].DBF.len),H[y]=R=="C"||q=="N"?O:i[R]||0,D+=H[y],b[y]=R}var X=m.next(32);for(X.write_shift(4,318902576),X.write_shift(4,v.length),X.write_shift(2,296+32*C),X.write_shift(2,D),y=0;y<4;++y)X.write_shift(4,0);for(X.write_shift(4,0|(+t[x_]||3)<<8),y=0,S=0;y<x.length;++y)if(x[y]!=null){var M=m.next(32),me=(x[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);M.write_shift(1,me,"sbcs"),M.write_shift(1,b[y]=="?"?"C":b[y],"sbcs"),M.write_shift(4,S),M.write_shift(1,H[y]||i[b[y]]||0),M.write_shift(1,L[y]||0),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(1,0),M.write_shift(4,0),M.write_shift(4,0),S+=H[y]||i[b[y]]||0}var ae=m.next(264);for(ae.write_shift(4,13),y=0;y<65;++y)ae.write_shift(4,0);for(y=0;y<v.length;++y){var ce=m.next(D);for(ce.write_shift(1,0),S=0;S<x.length;++S)if(x[S]!=null)switch(b[S]){case"L":ce.write_shift(1,v[y][S]==null?63:v[y][S]?84:70);break;case"B":ce.write_shift(8,v[y][S]||0,"f");break;case"N":var ue="0";for(typeof v[y][S]=="number"&&(ue=v[y][S].toFixed(L[S]||0)),C=0;C<H[S]-ue.length;++C)ce.write_shift(1,32);ce.write_shift(1,ue,"sbcs");break;case"D":v[y][S]?(ce.write_shift(4,("0000"+v[y][S].getFullYear()).slice(-4),"sbcs"),ce.write_shift(2,("00"+(v[y][S].getMonth()+1)).slice(-2),"sbcs"),ce.write_shift(2,("00"+v[y][S].getDate()).slice(-2),"sbcs")):ce.write_shift(8,"00000000","sbcs");break;case"C":var K=String(v[y][S]!=null?v[y][S]:"").slice(0,H[S]);for(ce.write_shift(1,K,"sbcs"),C=0;C<H[S]-K.length;++C)ce.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:s,to_sheet:r,from_sheet:l}})(),AC=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+pn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(x,v){var k=e[v];return typeof k=="number"?Xy(k):k},r=function(x,v,k){var y=v.charCodeAt(0)-32<<4|k.charCodeAt(0)-48;return y==59?x:Xy(y)};e["|"]=254;function s(x,v){switch(v.type){case"base64":return i(Qr(x),v);case"binary":return i(x,v);case"buffer":return i(pt&&Buffer.isBuffer(x)?x.toString("binary"):mi(x),v);case"array":return i(Ji(x),v)}throw new Error("Unrecognized type "+v.type)}function i(x,v){var k=x.split(/[\n\r]+/),y=-1,S=-1,C=0,D=0,N=[],b=[],H=null,L={},R=[],q=[],O=[],V=0,X;for(+v.codepage>=0&&ja(+v.codepage);C!==k.length;++C){V=0;var M=k[C].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),me=M.replace(/;;/g,"\0").split(";").map(function(P){return P.replace(/\u0000/g,";")}),ae=me[0],ce;if(M.length>0)switch(ae){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":me[1].charAt(0)=="P"&&b.push(M.slice(3).replace(/;;/g,";"));break;case"C":var ue=!1,K=!1,W=!1,j=!1,F=-1,U=-1;for(D=1;D<me.length;++D)switch(me[D].charAt(0)){case"A":break;case"X":S=parseInt(me[D].slice(1))-1,K=!0;break;case"Y":for(y=parseInt(me[D].slice(1))-1,K||(S=0),X=N.length;X<=y;++X)N[X]=[];break;case"K":ce=me[D].slice(1),ce.charAt(0)==='"'?ce=ce.slice(1,ce.length-1):ce==="TRUE"?ce=!0:ce==="FALSE"?ce=!1:isNaN(Pa(ce))?isNaN(ol(ce).getDate())||(ce=Jt(ce)):(ce=Pa(ce),H!==null&&xl(H)&&(ce=Xh(ce))),ue=!0;break;case"E":j=!0;var I=el(me[D].slice(1),{r:y,c:S});N[y][S]=[N[y][S],I];break;case"S":W=!0,N[y][S]=[N[y][S],"S5S"];break;case"G":break;case"R":F=parseInt(me[D].slice(1))-1;break;case"C":U=parseInt(me[D].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+M)}if(ue&&(N[y][S]&&N[y][S].length==2?N[y][S][0]=ce:N[y][S]=ce,H=null),W){if(j)throw new Error("SYLK shared formula cannot have own formula");var Z=F>-1&&N[F][U];if(!Z||!Z[1])throw new Error("SYLK shared formula cannot find base");N[y][S][1]=qC(Z[1],{r:y-F,c:S-U})}break;case"F":var Y=0;for(D=1;D<me.length;++D)switch(me[D].charAt(0)){case"X":S=parseInt(me[D].slice(1))-1,++Y;break;case"Y":for(y=parseInt(me[D].slice(1))-1,X=N.length;X<=y;++X)N[X]=[];break;case"M":V=parseInt(me[D].slice(1))/20;break;case"F":break;case"G":break;case"P":H=b[parseInt(me[D].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(O=me[D].slice(1).split(" "),X=parseInt(O[0],10);X<=parseInt(O[1],10);++X)V=parseInt(O[2],10),q[X-1]=V===0?{hidden:!0}:{wch:V},ci(q[X-1]);break;case"C":S=parseInt(me[D].slice(1))-1,q[S]||(q[S]={});break;case"R":y=parseInt(me[D].slice(1))-1,R[y]||(R[y]={}),V>0?(R[y].hpt=V,R[y].hpx=cl(V)):V===0&&(R[y].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+M)}Y<1&&(H=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+M)}}return R.length>0&&(L["!rows"]=R),q.length>0&&(L["!cols"]=q),v&&v.sheetRows&&(N=N.slice(0,v.sheetRows)),[N,L]}function l(x,v){var k=s(x,v),y=k[0],S=k[1],C=yl(y,v);return pn(S).forEach(function(D){C[D]=S[D]}),C}function u(x,v){return pi(l(x,v),v)}function d(x,v,k,y){var S="C;Y"+(k+1)+";X"+(y+1)+";K";switch(x.t){case"n":S+=x.v||0,x.f&&!x.F&&(S+=";E"+Ag(x.f,{r:k,c:y}));break;case"b":S+=x.v?"TRUE":"FALSE";break;case"e":S+=x.w||x.v;break;case"d":S+='"'+(x.w||x.v)+'"';break;case"s":S+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function f(x,v){v.forEach(function(k,y){var S="F;W"+(y+1)+" "+(y+1)+" ";k.hidden?S+="0":(typeof k.width=="number"&&!k.wpx&&(k.wpx=Kc(k.width)),typeof k.wpx=="number"&&!k.wch&&(k.wch=Yc(k.wpx)),typeof k.wch=="number"&&(S+=Math.round(k.wch))),S.charAt(S.length-1)!=" "&&x.push(S)})}function m(x,v){v.forEach(function(k,y){var S="F;";k.hidden?S+="M0;":k.hpt?S+="M"+20*k.hpt+";":k.hpx&&(S+="M"+20*Xc(k.hpx)+";"),S.length>2&&x.push(S+"R"+(y+1))})}function p(x,v){var k=["ID;PWXL;N;E"],y=[],S=Tt(x["!ref"]),C,D=Array.isArray(x),N=`\r
`;k.push("P;PGeneral"),k.push("F;P0;DG0G8;M255"),x["!cols"]&&f(k,x["!cols"]),x["!rows"]&&m(k,x["!rows"]),k.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var b=S.s.r;b<=S.e.r;++b)for(var H=S.s.c;H<=S.e.c;++H){var L=it({r:b,c:H});C=D?(x[b]||[])[H]:x[L],!(!C||C.v==null&&(!C.f||C.F))&&y.push(d(C,x,b,H))}return k.join(N)+N+y.join(N)+N+"E"+N}return{to_workbook:u,to_sheet:l,from_sheet:p}})(),jC=(function(){function e(i,l){switch(l.type){case"base64":return t(Qr(i),l);case"binary":return t(i,l);case"buffer":return t(pt&&Buffer.isBuffer(i)?i.toString("binary"):mi(i),l);case"array":return t(Ji(i),l)}throw new Error("Unrecognized type "+l.type)}function t(i,l){for(var u=i.split(`
`),d=-1,f=-1,m=0,p=[];m!==u.length;++m){if(u[m].trim()==="BOT"){p[++d]=[],f=0;continue}if(!(d<0)){var x=u[m].trim().split(","),v=x[0],k=x[1];++m;for(var y=u[m]||"";(y.match(/["]/g)||[]).length&1&&m<u.length-1;)y+=`
`+u[++m];switch(y=y.trim(),+v){case-1:if(y==="BOT"){p[++d]=[],f=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?p[d][f]=!0:y==="FALSE"?p[d][f]=!1:isNaN(Pa(k))?isNaN(ol(k).getDate())?p[d][f]=k:p[d][f]=Jt(k):p[d][f]=Pa(k),++f;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),p[d][f++]=y!==""?y:null;break}if(y==="EOD")break}}return l&&l.sheetRows&&(p=p.slice(0,l.sheetRows)),p}function n(i,l){return yl(e(i,l),l)}function r(i,l){return pi(n(i,l),l)}var s=(function(){var i=function(d,f,m,p,x){d.push(f),d.push(m+","+p),d.push('"'+x.replace(/"/g,'""')+'"')},l=function(d,f,m,p){d.push(f+","+m),d.push(f==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(d){var f=[],m=Tt(d["!ref"]),p,x=Array.isArray(d);i(f,"TABLE",0,1,"sheetjs"),i(f,"VECTORS",0,m.e.r-m.s.r+1,""),i(f,"TUPLES",0,m.e.c-m.s.c+1,""),i(f,"DATA",0,0,"");for(var v=m.s.r;v<=m.e.r;++v){l(f,-1,0,"BOT");for(var k=m.s.c;k<=m.e.c;++k){var y=it({r:v,c:k});if(p=x?(d[v]||[])[k]:d[y],!p){l(f,1,0,"");continue}switch(p.t){case"n":var S=p.w;!S&&p.v!=null&&(S=p.v),S==null?p.f&&!p.F?l(f,1,0,"="+p.f):l(f,1,0,""):l(f,0,S,"V");break;case"b":l(f,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":l(f,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=da(p.z||st[14],Dn(Jt(p.v)))),l(f,0,p.w,"V");break;default:l(f,1,0,"")}}}l(f,-1,0,"EOD");var C=`\r
`,D=f.join(C);return D}})();return{to_workbook:r,to_sheet:n,from_sheet:s}})(),RC=(function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(p,x){for(var v=p.split(`
`),k=-1,y=-1,S=0,C=[];S!==v.length;++S){var D=v[S].trim().split(":");if(D[0]==="cell"){var N=ln(D[1]);if(C.length<=N.r)for(k=C.length;k<=N.r;++k)C[k]||(C[k]=[]);switch(k=N.r,y=N.c,D[2]){case"t":C[k][y]=e(D[3]);break;case"v":C[k][y]=+D[3];break;case"vtf":var b=D[D.length-1];case"vtc":switch(D[3]){case"nl":C[k][y]=!!+D[4];break;default:C[k][y]=+D[4];break}D[2]=="vtf"&&(C[k][y]=[C[k][y],b])}}}return x&&x.sheetRows&&(C=C.slice(0,x.sheetRows)),C}function r(p,x){return yl(n(p,x),x)}function s(p,x){return pi(r(p,x),x)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function f(p){if(!p||!p["!ref"])return"";for(var x=[],v=[],k,y="",S=Fr(p["!ref"]),C=Array.isArray(p),D=S.s.r;D<=S.e.r;++D)for(var N=S.s.c;N<=S.e.c;++N)if(y=it({r:D,c:N}),k=C?(p[D]||[])[N]:p[y],!(!k||k.v==null||k.t==="z")){switch(v=["cell",y,"t"],k.t){case"s":case"str":v.push(t(k.v));break;case"n":k.f?(v[2]="vtf",v[3]="n",v[4]=k.v,v[5]=t(k.f)):(v[2]="v",v[3]=k.v);break;case"b":v[2]="vt"+(k.f?"f":"c"),v[3]="nl",v[4]=k.v?"1":"0",v[5]=t(k.f||(k.v?"TRUE":"FALSE"));break;case"d":var b=Dn(Jt(k.v));v[2]="vtc",v[3]="nd",v[4]=""+b,v[5]=k.w||da(k.z||st[14],b);break;case"e":continue}x.push(v.join(":"))}return x.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function m(p){return[i,l,u,l,f(p),d].join(`
`)}return{to_workbook:s,to_sheet:r,from_sheet:m}})(),ll=(function(){function e(m,p,x,v,k){k.raw?p[x][v]=m:m===""||(m==="TRUE"?p[x][v]=!0:m==="FALSE"?p[x][v]=!1:isNaN(Pa(m))?isNaN(ol(m).getDate())?p[x][v]=m:p[x][v]=Jt(m):p[x][v]=Pa(m))}function t(m,p){var x=p||{},v=[];if(!m||m.length===0)return v;for(var k=m.split(/[\r\n]/),y=k.length-1;y>=0&&k[y].length===0;)--y;for(var S=10,C=0,D=0;D<=y;++D)C=k[D].indexOf(" "),C==-1?C=k[D].length:C++,S=Math.max(S,C);for(D=0;D<=y;++D){v[D]=[];var N=0;for(e(k[D].slice(0,S).trim(),v,D,N,x),N=1;N<=(k[D].length-S)/10+1;++N)e(k[D].slice(S+(N-1)*10,S+N*10).trim(),v,D,N,x)}return x.sheetRows&&(v=v.slice(0,x.sheetRows)),v}var n={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function s(m){for(var p={},x=!1,v=0,k=0;v<m.length;++v)(k=m.charCodeAt(v))==34?x=!x:!x&&k in n&&(p[k]=(p[k]||0)+1);k=[];for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&k.push([p[v],v]);if(!k.length){p=r;for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&k.push([p[v],v])}return k.sort(function(y,S){return y[0]-S[0]||r[y[1]]-r[S[1]]}),n[k.pop()[1]]||44}function i(m,p){var x=p||{},v="",k=x.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(v=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(v=m.charAt(4),m=m.slice(6)):v=s(m.slice(0,1024)):x&&x.FS?v=x.FS:v=s(m.slice(0,1024));var S=0,C=0,D=0,N=0,b=0,H=v.charCodeAt(0),L=!1,R=0,q=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var O=x.dateNF!=null?QO(x.dateNF):null;function V(){var X=m.slice(N,b),M={};if(X.charAt(0)=='"'&&X.charAt(X.length-1)=='"'&&(X=X.slice(1,-1).replace(/""/g,'"')),X.length===0)M.t="z";else if(x.raw)M.t="s",M.v=X;else if(X.trim().length===0)M.t="s",M.v=X;else if(X.charCodeAt(0)==61)X.charCodeAt(1)==34&&X.charCodeAt(X.length-1)==34?(M.t="s",M.v=X.slice(2,-1).replace(/""/g,'"')):E5(X)?(M.t="n",M.f=X.slice(1)):(M.t="s",M.v=X);else if(X=="TRUE")M.t="b",M.v=!0;else if(X=="FALSE")M.t="b",M.v=!1;else if(!isNaN(D=Pa(X)))M.t="n",x.cellText!==!1&&(M.w=X),M.v=D;else if(!isNaN(ol(X).getDate())||O&&X.match(O)){M.z=x.dateNF||st[14];var me=0;O&&X.match(O)&&(X=JO(X,x.dateNF,X.match(O)||[]),me=1),x.cellDates?(M.t="d",M.v=Jt(X,me)):(M.t="n",M.v=Dn(Jt(X,me))),x.cellText!==!1&&(M.w=da(M.z,M.v instanceof Date?Dn(M.v):M.v)),x.cellNF||delete M.z}else M.t="s",M.v=X;if(M.t=="z"||(x.dense?(k[S]||(k[S]=[]),k[S][C]=M):k[it({c:C,r:S})]=M),N=b+1,q=m.charCodeAt(N),y.e.c<C&&(y.e.c=C),y.e.r<S&&(y.e.r=S),R==H)++C;else if(C=0,++S,x.sheetRows&&x.sheetRows<=S)return!0}e:for(;b<m.length;++b)switch(R=m.charCodeAt(b)){case 34:q===34&&(L=!L);break;case H:case 10:case 13:if(!L&&V())break e;break}return b-N>0&&V(),k["!ref"]=ft(y),k}function l(m,p){return!(p&&p.PRN)||p.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?i(m,p):yl(t(m,p),p)}function u(m,p){var x="",v=p.type=="string"?[0,0,0,0]:Fg(m,p);switch(p.type){case"base64":x=Qr(m);break;case"binary":x=m;break;case"buffer":p.codepage==65001?x=m.toString("utf8"):p.codepage&&typeof Uc<"u"||(x=pt&&Buffer.isBuffer(m)?m.toString("binary"):mi(m));break;case"array":x=Ji(m);break;case"string":x=m;break;default:throw new Error("Unrecognized type "+p.type)}return v[0]==239&&v[1]==187&&v[2]==191?x=Bt(x.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?x=Bt(x):p.type=="binary"&&typeof Uc<"u",x.slice(0,19)=="socialcalc:version:"?RC.to_sheet(p.type=="string"?x:Bt(x),p):l(x,p)}function d(m,p){return pi(u(m,p),p)}function f(m){for(var p=[],x=Tt(m["!ref"]),v,k=Array.isArray(m),y=x.s.r;y<=x.e.r;++y){for(var S=[],C=x.s.c;C<=x.e.c;++C){var D=it({r:y,c:C});if(v=k?(m[y]||[])[C]:m[D],!v||v.v==null){S.push("          ");continue}for(var N=(v.w||(ks(v),v.w)||"").slice(0,10);N.length<10;)N+=" ";S.push(N+(C===0?" ":""))}p.push(S.join(""))}return p.join(`
`)}return{to_workbook:d,to_sheet:u,from_sheet:f}})();function hM(e,t){var n=t||{},r=!!n.WTF;n.WTF=!0;try{var s=AC.to_workbook(e,n);return n.WTF=r,s}catch(i){if(n.WTF=r,!i.message.match(/SYLK bad record ID/)&&r)throw i;return ll.to_workbook(e,t)}}var Wi=(function(){function e(I,Z,Y){if(I){Qn(I,I.l||0);for(var P=Y.Enum||F;I.l<I.length;){var ne=I.read_shift(2),J=P[ne]||P[65535],de=I.read_shift(2),E=I.l+de,A=J.f&&J.f(I,de,Y);if(I.l=E,Z(A,J,ne))return}}}function t(I,Z){switch(Z.type){case"base64":return n($r(Qr(I)),Z);case"binary":return n($r(I),Z);case"buffer":case"array":return n(I,Z)}throw"Unsupported type "+Z.type}function n(I,Z){if(!I)return I;var Y=Z||{},P=Y.dense?[]:{},ne="Sheet1",J="",de=0,E={},A=[],he=[],G={s:{r:0,c:0},e:{r:0,c:0}},Ie=Y.sheetRows||0;if(I[2]==0&&(I[3]==8||I[3]==9)&&I.length>=16&&I[14]==5&&I[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(I[2]==2)Y.Enum=F,e(I,function(we,fe,ye){switch(ye){case 0:Y.vers=we,we>=4096&&(Y.qpro=!0);break;case 6:G=we;break;case 204:we&&(J=we);break;case 222:J=we;break;case 15:case 51:Y.qpro||(we[1].v=we[1].v.slice(1));case 13:case 14:case 16:ye==14&&(we[2]&112)==112&&(we[2]&15)>1&&(we[2]&15)<15&&(we[1].z=Y.dateNF||st[14],Y.cellDates&&(we[1].t="d",we[1].v=Xh(we[1].v))),Y.qpro&&we[3]>de&&(P["!ref"]=ft(G),E[ne]=P,A.push(ne),P=Y.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},de=we[3],ne=J||"Sheet"+(de+1),J="");var ee=Y.dense?(P[we[0].r]||[])[we[0].c]:P[it(we[0])];if(ee){ee.t=we[1].t,ee.v=we[1].v,we[1].z!=null&&(ee.z=we[1].z),we[1].f!=null&&(ee.f=we[1].f);break}Y.dense?(P[we[0].r]||(P[we[0].r]=[]),P[we[0].r][we[0].c]=we[1]):P[it(we[0])]=we[1];break}},Y);else if(I[2]==26||I[2]==14)Y.Enum=U,I[2]==14&&(Y.qpro=!0,I.l=0),e(I,function(we,fe,ye){switch(ye){case 204:ne=we;break;case 22:we[1].v=we[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(we[3]>de&&(P["!ref"]=ft(G),E[ne]=P,A.push(ne),P=Y.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},de=we[3],ne="Sheet"+(de+1)),Ie>0&&we[0].r>=Ie)break;Y.dense?(P[we[0].r]||(P[we[0].r]=[]),P[we[0].r][we[0].c]=we[1]):P[it(we[0])]=we[1],G.e.c<we[0].c&&(G.e.c=we[0].c),G.e.r<we[0].r&&(G.e.r=we[0].r);break;case 27:we[14e3]&&(he[we[14e3][0]]=we[14e3][1]);break;case 1537:he[we[0]]=we[1],we[0]==de&&(ne=we[1]);break}},Y);else throw new Error("Unrecognized LOTUS BOF "+I[2]);if(P["!ref"]=ft(G),E[J||ne]=P,A.push(J||ne),!he.length)return{SheetNames:A,Sheets:E};for(var oe={},Te=[],xe=0;xe<he.length;++xe)E[A[xe]]?(Te.push(he[xe]||A[xe]),oe[he[xe]]=E[he[xe]]||E[A[xe]]):(Te.push(he[xe]),oe[he[xe]]={"!ref":"A1"});return{SheetNames:Te,Sheets:oe}}function r(I,Z){var Y=Z||{};if(+Y.codepage>=0&&ja(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK1 to JS string");var P=Or(),ne=Tt(I["!ref"]),J=Array.isArray(I),de=[];Ge(P,0,i(1030)),Ge(P,6,d(ne));for(var E=Math.min(ne.e.r,8191),A=ne.s.r;A<=E;++A)for(var he=Sn(A),G=ne.s.c;G<=ne.e.c;++G){A===ne.s.r&&(de[G]=on(G));var Ie=de[G]+he,oe=J?(I[A]||[])[G]:I[Ie];if(!(!oe||oe.t=="z"))if(oe.t=="n")(oe.v|0)==oe.v&&oe.v>=-32768&&oe.v<=32767?Ge(P,13,v(A,G,oe.v)):Ge(P,14,y(A,G,oe.v));else{var Te=ks(oe);Ge(P,15,p(A,G,Te.slice(0,239)))}}return Ge(P,1),P.end()}function s(I,Z){var Y=Z||{};if(+Y.codepage>=0&&ja(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK3 to JS string");var P=Or();Ge(P,0,l(I));for(var ne=0,J=0;ne<I.SheetNames.length;++ne)(I.Sheets[I.SheetNames[ne]]||{})["!ref"]&&Ge(P,27,j(I.SheetNames[ne],J++));var de=0;for(ne=0;ne<I.SheetNames.length;++ne){var E=I.Sheets[I.SheetNames[ne]];if(!(!E||!E["!ref"])){for(var A=Tt(E["!ref"]),he=Array.isArray(E),G=[],Ie=Math.min(A.e.r,8191),oe=A.s.r;oe<=Ie;++oe)for(var Te=Sn(oe),xe=A.s.c;xe<=A.e.c;++xe){oe===A.s.r&&(G[xe]=on(xe));var we=G[xe]+Te,fe=he?(E[oe]||[])[xe]:E[we];if(!(!fe||fe.t=="z"))if(fe.t=="n")Ge(P,23,V(oe,xe,de,fe.v));else{var ye=ks(fe);Ge(P,22,R(oe,xe,de,ye.slice(0,239)))}}++de}}return Ge(P,1),P.end()}function i(I){var Z=Ae(2);return Z.write_shift(2,I),Z}function l(I){var Z=Ae(26);Z.write_shift(2,4096),Z.write_shift(2,4),Z.write_shift(4,0);for(var Y=0,P=0,ne=0,J=0;J<I.SheetNames.length;++J){var de=I.SheetNames[J],E=I.Sheets[de];if(!(!E||!E["!ref"])){++ne;var A=Fr(E["!ref"]);Y<A.e.r&&(Y=A.e.r),P<A.e.c&&(P=A.e.c)}}return Y>8191&&(Y=8191),Z.write_shift(2,Y),Z.write_shift(1,ne),Z.write_shift(1,P),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(1,1),Z.write_shift(1,2),Z.write_shift(4,0),Z.write_shift(4,0),Z}function u(I,Z,Y){var P={s:{c:0,r:0},e:{c:0,r:0}};return Z==8&&Y.qpro?(P.s.c=I.read_shift(1),I.l++,P.s.r=I.read_shift(2),P.e.c=I.read_shift(1),I.l++,P.e.r=I.read_shift(2),P):(P.s.c=I.read_shift(2),P.s.r=I.read_shift(2),Z==12&&Y.qpro&&(I.l+=2),P.e.c=I.read_shift(2),P.e.r=I.read_shift(2),Z==12&&Y.qpro&&(I.l+=2),P.s.c==65535&&(P.s.c=P.e.c=P.s.r=P.e.r=0),P)}function d(I){var Z=Ae(8);return Z.write_shift(2,I.s.c),Z.write_shift(2,I.s.r),Z.write_shift(2,I.e.c),Z.write_shift(2,I.e.r),Z}function f(I,Z,Y){var P=[{c:0,r:0},{t:"n",v:0},0,0];return Y.qpro&&Y.vers!=20768?(P[0].c=I.read_shift(1),P[3]=I.read_shift(1),P[0].r=I.read_shift(2),I.l+=2):(P[2]=I.read_shift(1),P[0].c=I.read_shift(2),P[0].r=I.read_shift(2)),P}function m(I,Z,Y){var P=I.l+Z,ne=f(I,Z,Y);if(ne[1].t="s",Y.vers==20768){I.l++;var J=I.read_shift(1);return ne[1].v=I.read_shift(J,"utf8"),ne}return Y.qpro&&I.l++,ne[1].v=I.read_shift(P-I.l,"cstr"),ne}function p(I,Z,Y){var P=Ae(7+Y.length);P.write_shift(1,255),P.write_shift(2,Z),P.write_shift(2,I),P.write_shift(1,39);for(var ne=0;ne<P.length;++ne){var J=Y.charCodeAt(ne);P.write_shift(1,J>=128?95:J)}return P.write_shift(1,0),P}function x(I,Z,Y){var P=f(I,Z,Y);return P[1].v=I.read_shift(2,"i"),P}function v(I,Z,Y){var P=Ae(7);return P.write_shift(1,255),P.write_shift(2,Z),P.write_shift(2,I),P.write_shift(2,Y,"i"),P}function k(I,Z,Y){var P=f(I,Z,Y);return P[1].v=I.read_shift(8,"f"),P}function y(I,Z,Y){var P=Ae(13);return P.write_shift(1,255),P.write_shift(2,Z),P.write_shift(2,I),P.write_shift(8,Y,"f"),P}function S(I,Z,Y){var P=I.l+Z,ne=f(I,Z,Y);if(ne[1].v=I.read_shift(8,"f"),Y.qpro)I.l=P;else{var J=I.read_shift(2);b(I.slice(I.l,I.l+J),ne),I.l+=J}return ne}function C(I,Z,Y){var P=Z&32768;return Z&=-32769,Z=(P?I:0)+(Z>=8192?Z-16384:Z),(P?"":"$")+(Y?on(Z):Sn(Z))}var D={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function b(I,Z){Qn(I,0);for(var Y=[],P=0,ne="",J="",de="",E="";I.l<I.length;){var A=I[I.l++];switch(A){case 0:Y.push(I.read_shift(8,"f"));break;case 1:J=C(Z[0].c,I.read_shift(2),!0),ne=C(Z[0].r,I.read_shift(2),!1),Y.push(J+ne);break;case 2:{var he=C(Z[0].c,I.read_shift(2),!0),G=C(Z[0].r,I.read_shift(2),!1);J=C(Z[0].c,I.read_shift(2),!0),ne=C(Z[0].r,I.read_shift(2),!1),Y.push(he+G+":"+J+ne)}break;case 3:if(I.l<I.length){console.error("WK1 premature formula end");return}break;case 4:Y.push("("+Y.pop()+")");break;case 5:Y.push(I.read_shift(2));break;case 6:{for(var Ie="";A=I[I.l++];)Ie+=String.fromCharCode(A);Y.push('"'+Ie.replace(/"/g,'""')+'"')}break;case 8:Y.push("-"+Y.pop());break;case 23:Y.push("+"+Y.pop());break;case 22:Y.push("NOT("+Y.pop()+")");break;case 20:case 21:E=Y.pop(),de=Y.pop(),Y.push(["AND","OR"][A-20]+"("+de+","+E+")");break;default:if(A<32&&N[A])E=Y.pop(),de=Y.pop(),Y.push(de+N[A]+E);else if(D[A]){if(P=D[A][1],P==69&&(P=I[I.l++]),P>Y.length){console.error("WK1 bad formula parse 0x"+A.toString(16)+":|"+Y.join("|")+"|");return}var oe=Y.slice(-P);Y.length-=P,Y.push(D[A][0]+"("+oe.join(",")+")")}else return A<=7?console.error("WK1 invalid opcode "+A.toString(16)):A<=24?console.error("WK1 unsupported op "+A.toString(16)):A<=30?console.error("WK1 invalid opcode "+A.toString(16)):A<=115?console.error("WK1 unsupported function opcode "+A.toString(16)):console.error("WK1 unrecognized opcode "+A.toString(16))}}Y.length==1?Z[1].f=""+Y[0]:console.error("WK1 bad formula parse |"+Y.join("|")+"|")}function H(I){var Z=[{c:0,r:0},{t:"n",v:0},0];return Z[0].r=I.read_shift(2),Z[3]=I[I.l++],Z[0].c=I[I.l++],Z}function L(I,Z){var Y=H(I);return Y[1].t="s",Y[1].v=I.read_shift(Z-4,"cstr"),Y}function R(I,Z,Y,P){var ne=Ae(6+P.length);ne.write_shift(2,I),ne.write_shift(1,Y),ne.write_shift(1,Z),ne.write_shift(1,39);for(var J=0;J<P.length;++J){var de=P.charCodeAt(J);ne.write_shift(1,de>=128?95:de)}return ne.write_shift(1,0),ne}function q(I,Z){var Y=H(I);Y[1].v=I.read_shift(2);var P=Y[1].v>>1;if(Y[1].v&1)switch(P&7){case 0:P=(P>>3)*5e3;break;case 1:P=(P>>3)*500;break;case 2:P=(P>>3)/20;break;case 3:P=(P>>3)/200;break;case 4:P=(P>>3)/2e3;break;case 5:P=(P>>3)/2e4;break;case 6:P=(P>>3)/16;break;case 7:P=(P>>3)/64;break}return Y[1].v=P,Y}function O(I,Z){var Y=H(I),P=I.read_shift(4),ne=I.read_shift(4),J=I.read_shift(2);if(J==65535)return P===0&&ne===3221225472?(Y[1].t="e",Y[1].v=15):P===0&&ne===3489660928?(Y[1].t="e",Y[1].v=42):Y[1].v=0,Y;var de=J&32768;return J=(J&32767)-16446,Y[1].v=(1-de*2)*(ne*Math.pow(2,J+32)+P*Math.pow(2,J)),Y}function V(I,Z,Y,P){var ne=Ae(14);if(ne.write_shift(2,I),ne.write_shift(1,Y),ne.write_shift(1,Z),P==0)return ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(2,65535),ne;var J=0,de=0,E=0,A=0;return P<0&&(J=1,P=-P),de=Math.log2(P)|0,P/=Math.pow(2,de-31),A=P>>>0,(A&2147483648)==0&&(P/=2,++de,A=P>>>0),P-=A,A|=2147483648,A>>>=0,P*=Math.pow(2,32),E=P>>>0,ne.write_shift(4,E),ne.write_shift(4,A),de+=16383+(J?32768:0),ne.write_shift(2,de),ne}function X(I,Z){var Y=O(I);return I.l+=Z-14,Y}function M(I,Z){var Y=H(I),P=I.read_shift(4);return Y[1].v=P>>6,Y}function me(I,Z){var Y=H(I),P=I.read_shift(8,"f");return Y[1].v=P,Y}function ae(I,Z){var Y=me(I);return I.l+=Z-10,Y}function ce(I,Z){return I[I.l+Z-1]==0?I.read_shift(Z,"cstr"):""}function ue(I,Z){var Y=I[I.l++];Y>Z-1&&(Y=Z-1);for(var P="";P.length<Y;)P+=String.fromCharCode(I[I.l++]);return P}function K(I,Z,Y){if(!(!Y.qpro||Z<21)){var P=I.read_shift(1);I.l+=17,I.l+=1,I.l+=2;var ne=I.read_shift(Z-21,"cstr");return[P,ne]}}function W(I,Z){for(var Y={},P=I.l+Z;I.l<P;){var ne=I.read_shift(2);if(ne==14e3){for(Y[ne]=[0,""],Y[ne][0]=I.read_shift(2);I[I.l];)Y[ne][1]+=String.fromCharCode(I[I.l]),I.l++;I.l++}}return Y}function j(I,Z){var Y=Ae(5+I.length);Y.write_shift(2,14e3),Y.write_shift(2,Z);for(var P=0;P<I.length;++P){var ne=I.charCodeAt(P);Y[Y.l++]=ne>127?95:ne}return Y[Y.l++]=0,Y}var F={0:{n:"BOF",f:Tn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:k},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ce},222:{n:"SHEETNAMELP",f:ue},65535:{n:""}},U={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:L},23:{n:"NUMBER17",f:O},24:{n:"NUMBER18",f:q},25:{n:"FORMULA19",f:X},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:W},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:M},38:{n:"??"},39:{n:"NUMBER27",f:me},40:{n:"FORMULA28",f:ae},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:K},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:s,to_workbook:t}})();function fM(e){var t={},n=e.match(pr),r=0,s=!1;if(n)for(;r!=n.length;++r){var i=lt(n[r]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=eg[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return t}var mM=(function(){var e=Hc("t"),t=Hc("rPr");function n(i){var l=i.match(e);if(!l)return{t:"s",v:""};var u={t:"s",v:Et(l[1])},d=i.match(t);return d&&(u.s=fM(d[1])),u}var r=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(l){return l.replace(r,"").split(s).map(n).filter(function(u){return u.v})}})(),pM=(function(){var t=/(\r\n|\n)/g;function n(s,i,l){var u=[];s.u&&u.push("text-decoration: underline;"),s.uval&&u.push("text-underline-style:"+s.uval+";"),s.sz&&u.push("font-size:"+s.sz+"pt;"),s.outline&&u.push("text-effect: outline;"),s.shadow&&u.push("text-shadow: auto;"),i.push('<span style="'+u.join("")+'">'),s.b&&(i.push("<b>"),l.push("</b>")),s.i&&(i.push("<i>"),l.push("</i>")),s.strike&&(i.push("<s>"),l.push("</s>"));var d=s.valign||"";return d=="superscript"||d=="super"?d="sup":d=="subscript"&&(d="sub"),d!=""&&(i.push("<"+d+">"),l.push("</"+d+">")),l.push("</span>"),s}function r(s){var i=[[],s.v,[]];return s.v?(s.s&&n(s.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(r).join("")}})(),gM=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,xM=/<(?:\w+:)?r>/,vM=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Cg(e,t){var n=t?t.cellHTML:!0,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=Et(Bt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Bt(e),n&&(r.h=ug(r.t))):e.match(xM)&&(r.r=Bt(e),r.t=Et(Bt((e.replace(vM,"").match(gM)||[]).join("").replace(pr,""))),n&&(r.h=pM(mM(r.r)))),r):{t:""}}var yM=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,kM=/<(?:\w+:)?(?:si|sstItem)>/g,wM=/<\/(?:\w+:)?(?:si|sstItem)>/;function SM(e,t){var n=[],r="";if(!e)return n;var s=e.match(yM);if(s){r=s[2].replace(kM,"").split(wM);for(var i=0;i!=r.length;++i){var l=Cg(r[i].trim(),t);l!=null&&(n[n.length]=l)}s=lt(s[1]),n.Count=s.count,n.Unique=s.uniqueCount}return n}var _M=/^\s|\s$|[\t\n\r]/;function IC(e,t){if(!t.bookSST)return"";var n=[_n];n[n.length]=He("sst",null,{xmlns:so[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(e[r]!=null){var s=e[r],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(_M)&&(i+=' xml:space="preserve"'),i+=">"+Lt(s.t)+"</t>"),i+="</si>",n[n.length]=i}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}function CM(e){return[e.read_shift(4),e.read_shift(4)]}function NM(e,t){var n=[],r=!1;return Ns(e,function(i,l,u){switch(u){case 159:n.Count=i[0],n.Unique=i[1];break;case 19:n.push(i);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(l.T,!r||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function EM(e,t){return t||(t=Ae(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var TM=FL;function bM(e){var t=Or();Re(t,159,EM(e));for(var n=0;n<e.length;++n)Re(t,19,TM(e[n]));return Re(t,160),t.end()}function PC(e){for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function ps(e,t){var n={};return n.Major=e.read_shift(2),n.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),n}function AM(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ps(e,4),t.U=ps(e,4),t.W=ps(e,4),t}function jM(e){for(var t=e.read_shift(4),n=e.l+t-4,r={},s=e.read_shift(4),i=[];s-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=i,e.l!=n)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+n);return r}function RM(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(jM(e));return t}function IM(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function PM(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ps(e,4),t.U=ps(e,4),t.W=ps(e,4),t}function DM(e){var t=PM(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function DC(e,t){var n=e.l+t,r={};r.Flags=e.read_shift(4)&63,e.l+=4,r.AlgID=e.read_shift(4);var s=!1;switch(r.AlgID){case 26126:case 26127:case 26128:s=r.Flags==36;break;case 26625:s=r.Flags==4;break;case 0:s=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(n-e.l>>1,"utf16le"),e.l=n,r}function OC(e,t){var n={},r=e.l+t;return e.l+=4,n.Salt=e.slice(e.l,e.l+16),e.l+=16,n.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),n.VerifierHash=e.slice(e.l,r),e.l=r,n}function OM(e){var t=ps(e);switch(t.Minor){case 2:return[t.Minor,LM(e)];case 3:return[t.Minor,FM()];case 4:return[t.Minor,MM(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function LM(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var n=e.read_shift(4),r=DC(e,n),s=OC(e,e.length-e.l);return{t:"Std",h:r,v:s}}function FM(){throw new Error("File is password-protected: ECMA-376 Extensible")}function MM(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var n=e.read_shift(e.length-e.l,"utf8"),r={};return n.replace(pr,function(i){var l=lt(i);switch(Ka(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(u){r[u]=l[u]});break;case"<dataIntegrity":r.encryptedHmacKey=l.encryptedHmacKey,r.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(l);break;default:throw l[0]}}),r}function BM(e,t){var n={},r=n.EncryptionVersionInfo=ps(e,4);if(t-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);n.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,n.EncryptionHeader=DC(e,s),t-=s,n.EncryptionVerifier=OC(e,t),n}function UM(e){var t={},n=t.EncryptionVersionInfo=ps(e,4);if(n.Major!=1||n.Minor!=1)throw"unrecognized version code "+n.Major+" : "+n.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Ng(e){var t=0,n,r=PC(e),s=r.length+1,i,l,u,d,f;for(n=li(s),n[0]=r.length,i=1;i!=s;++i)n[i]=r[i-1];for(i=s-1;i>=0;--i)l=n[i],u=(t&16384)===0?0:1,d=t<<1&32767,f=u|d,t=f^l;return t^52811}var LC=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(l){return(l/2|l*128)&255},s=function(l,u){return r(l^u)},i=function(l){for(var u=t[l.length-1],d=104,f=l.length-1;f>=0;--f)for(var m=l[f],p=0;p!=7;++p)m&64&&(u^=n[d]),m*=2,--d;return u};return function(l){for(var u=PC(l),d=i(u),f=u.length,m=li(16),p=0;p!=16;++p)m[p]=0;var x,v,k;for((f&1)===1&&(x=d>>8,m[f]=s(e[0],x),--f,x=d&255,v=u[u.length-1],m[f]=s(v,x));f>0;)--f,x=d>>8,m[f]=s(u[f],x),--f,x=d&255,m[f]=s(u[f],x);for(f=15,k=15-u.length;k>0;)x=d>>8,m[f]=s(e[k],x),--f,--k,x=d&255,m[f]=s(u[f],x),--f,--k;return m}})(),zM=function(e,t,n,r,s){s||(s=t),r||(r=LC(e));var i,l;for(i=0;i!=t.length;++i)l=t[i],l^=r[n],l=(l>>5|l<<3)&255,s[i]=l,++n;return[s,n,r]},WM=function(e){var t=0,n=LC(e);return function(r){var s=zM("",r,t,n);return t=s[1],s[0]}};function HM(e,t,n,r){var s={key:Tn(e),verificationBytes:Tn(e)};return n.password&&(s.verifier=Ng(n.password)),r.valid=s.verificationBytes===s.verifier,r.valid&&(r.insitu=WM(n.password)),s}function GM(e,t,n){var r=n||{};return r.Info=e.read_shift(2),e.l-=2,r.Info===1?r.Data=UM(e):r.Data=BM(e,t),r}function $M(e,t,n){var r={Type:n.biff>=8?e.read_shift(2):0};return r.Type?GM(e,t-2,r):HM(e,n.biff>=8?t:t-2,n,r),r}var FC=(function(){function e(s,i){switch(i.type){case"base64":return t(Qr(s),i);case"binary":return t(s,i);case"buffer":return t(pt&&Buffer.isBuffer(s)?s.toString("binary"):mi(s),i);case"array":return t(Ji(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){var l=i||{},u=l.dense?[]:{},d=s.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(m,p){Array.isArray(u)&&(u[p]=[]);for(var x=/\\\w+\b/g,v=0,k,y=-1;k=x.exec(m);){switch(k[0]){case"\\cell":var S=m.slice(v,x.lastIndex-k[0].length);if(S[0]==" "&&(S=S.slice(1)),++y,S.length){var C={v:S,t:"s"};Array.isArray(u)?u[p][y]=C:u[it({r:p,c:y})]=C}break}v=x.lastIndex}y>f.e.c&&(f.e.c=y)}),u["!ref"]=ft(f),u}function n(s,i){return pi(e(s,i),i)}function r(s){for(var i=["{\\rtf1\\ansi"],l=Tt(s["!ref"]),u,d=Array.isArray(s),f=l.s.r;f<=l.e.r;++f){i.push("\\trowd\\trautofit1");for(var m=l.s.c;m<=l.e.c;++m)i.push("\\cellx"+(m+1));for(i.push("\\pard\\intbl"),m=l.s.c;m<=l.e.c;++m){var p=it({r:f,c:m});u=d?(s[f]||[])[m]:s[p],!(!u||u.v==null&&(!u.f||u.F))&&(i.push(" "+(u.w||(ks(u),u.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:n,to_sheet:e,from_sheet:r}})();function VM(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function qc(e){for(var t=0,n=1;t!=3;++t)n=n*256+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}function qM(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255,s=Math.max(t,n,r),i=Math.min(t,n,r),l=s-i;if(l===0)return[0,0,t];var u=0,d=0,f=s+i;switch(d=l/(f>1?2-f:f),s){case t:u=((n-r)/l+6)%6;break;case n:u=(r-t)/l+2;break;case r:u=(t-n)/l+4;break}return[u/6,d,f/2]}function KM(e){var t=e[0],n=e[1],r=e[2],s=n*2*(r<.5?r:1-r),i=r-s/2,l=[i,i,i],u=6*t,d;if(n!==0)switch(u|0){case 0:case 6:d=s*u,l[0]+=s,l[1]+=d;break;case 1:d=s*(2-u),l[0]+=d,l[1]+=s;break;case 2:d=s*(u-2),l[1]+=s,l[2]+=d;break;case 3:d=s*(4-u),l[1]+=d,l[2]+=s;break;case 4:d=s*(u-4),l[2]+=s,l[0]+=d;break;case 5:d=s*(6-u),l[2]+=d,l[0]+=s;break}for(var f=0;f!=3;++f)l[f]=Math.round(l[f]*255);return l}function Ah(e,t){if(t===0)return e;var n=qM(VM(e));return t<0?n[2]=n[2]*(1+t):n[2]=1-(1-n[2])*(1-t),qc(KM(n))}var MC=6,YM=15,XM=1,ur=MC;function Kc(e){return Math.floor((e+Math.round(128/ur)/256)*ur)}function Yc(e){return Math.floor((e-5)/ur*100+.5)/100}function jh(e){return Math.round((e*ur+5)/ur*256)/256}function lm(e){return jh(Yc(Kc(e)))}function Eg(e){var t=Math.abs(e-lm(e)),n=ur;if(t>.005)for(ur=XM;ur<YM;++ur)Math.abs(e-lm(e))<=t&&(t=Math.abs(e-lm(e)),n=ur);ur=n}function ci(e){e.width?(e.wpx=Kc(e.width),e.wch=Yc(e.wpx),e.MDW=ur):e.wpx?(e.wch=Yc(e.wpx),e.width=jh(e.wch),e.MDW=ur):typeof e.wch=="number"&&(e.width=jh(e.wch),e.wpx=Kc(e.width),e.MDW=ur),e.customWidth&&delete e.customWidth}var QM=96,BC=QM;function Xc(e){return e*96/BC}function cl(e){return e*BC/96}var JM={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function ZM(e,t,n,r){t.Borders=[];var s={},i=!1;(e[0].match(pr)||[]).forEach(function(l){var u=lt(l);switch(Ka(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},u.diagonalUp&&(s.diagonalUp=Qt(u.diagonalUp)),u.diagonalDown&&(s.diagonalDown=Qt(u.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+u[0]+" in borders")}})}function e8(e,t,n,r){t.Fills=[];var s={},i=!1;(e[0].match(pr)||[]).forEach(function(l){var u=lt(l);switch(Ka(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":u.patternType&&(s.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),u.indexed&&(s.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(s.bgColor.theme=parseInt(u.theme,10)),u.tint&&(s.bgColor.tint=parseFloat(u.tint)),u.rgb&&(s.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),u.theme&&(s.fgColor.theme=parseInt(u.theme,10)),u.tint&&(s.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(s.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+u[0]+" in fills")}})}function t8(e,t,n,r){t.Fonts=[];var s={},i=!1;(e[0].match(pr)||[]).forEach(function(l){var u=lt(l);switch(Ka(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":u.val&&(s.name=Bt(u.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=u.val?Qt(u.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=u.val?Qt(u.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(u.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=u.val?Qt(u.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=u.val?Qt(u.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=u.val?Qt(u.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=u.val?Qt(u.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=u.val?Qt(u.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":u.val&&(s.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(s.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(s.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(s.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=eg[parseInt(u.val,10)];break;case"<color":if(s.color||(s.color={}),u.auto&&(s.color.auto=Qt(u.auto)),u.rgb)s.color.rgb=u.rgb.slice(-6);else if(u.indexed){s.color.index=parseInt(u.indexed,10);var d=Ui[s.color.index];s.color.index==81&&(d=Ui[1]),d||(d=Ui[1]),s.color.rgb=d[0].toString(16)+d[1].toString(16)+d[2].toString(16)}else u.theme&&(s.color.theme=parseInt(u.theme,10),u.tint&&(s.color.tint=parseFloat(u.tint)),u.theme&&n.themeElements&&n.themeElements.clrScheme&&(s.color.rgb=Ah(n.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+u[0]+" in fonts")}})}function n8(e,t,n){t.NumberFmt=[];for(var r=pn(st),s=0;s<r.length;++s)t.NumberFmt[r[s]]=st[r[s]];var i=e[0].match(pr);if(i)for(s=0;s<i.length;++s){var l=lt(i[s]);switch(Ka(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Et(Bt(l.formatCode)),d=parseInt(l.numFmtId,10);if(t.NumberFmt[d]=u,d>0){if(d>392){for(d=392;d>60&&t.NumberFmt[d]!=null;--d);t.NumberFmt[d]=u}ms(u,d)}}break;case"</numFmt>":break;default:if(n.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function r8(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)e[r]!=null&&(t[t.length]=He("numFmt",null,{numFmtId:r,formatCode:Lt(e[r])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=He("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Bd=["numFmtId","fillId","fontId","borderId","xfId"],Ud=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function a8(e,t,n){t.CellXf=[];var r,s=!1;(e[0].match(pr)||[]).forEach(function(i){var l=lt(i),u=0;switch(Ka(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=l,delete r[0],u=0;u<Bd.length;++u)r[Bd[u]]&&(r[Bd[u]]=parseInt(r[Bd[u]],10));for(u=0;u<Ud.length;++u)r[Ud[u]]&&(r[Ud[u]]=Qt(r[Ud[u]]));if(t.NumberFmt&&r.numFmtId>392){for(u=392;u>60;--u)if(t.NumberFmt[r.numFmtId]==t.NumberFmt[u]){r.numFmtId=u;break}}t.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var d={};l.vertical&&(d.vertical=l.vertical),l.horizontal&&(d.horizontal=l.horizontal),l.textRotation!=null&&(d.textRotation=l.textRotation),l.indent&&(d.indent=l.indent),l.wrapText&&(d.wrapText=Qt(l.wrapText)),r.alignment=d;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function s8(e){var t=[];return t[t.length]=He("cellXfs",null),e.forEach(function(n){t[t.length]=He("xf",null,n)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=He("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var i8=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,n=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,d,f){var m={};if(!u)return m;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=u.match(t))&&n8(p,m,f),(p=u.match(s))&&t8(p,m,d,f),(p=u.match(r))&&e8(p,m,d,f),(p=u.match(i))&&ZM(p,m,d,f),(p=u.match(n))&&a8(p,m,f),m}})();function UC(e,t){var n=[_n,He("styleSheet",null,{xmlns:so[0],"xmlns:vt":In.vt})],r;return e.SSF&&(r=r8(e.SSF))!=null&&(n[n.length]=r),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=s8(t.cellXfs))&&(n[n.length]=r),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function o8(e,t){var n=e.read_shift(2),r=fr(e);return[n,r]}function l8(e,t,n){n||(n=Ae(6+4*t.length)),n.write_shift(2,e),qn(t,n);var r=n.length>n.l?n.slice(0,n.l):n;return n.l==null&&(n.l=n.length),r}function c8(e,t,n){var r={};r.sz=e.read_shift(2)/20;var s=GL(e);s.fItalic&&(r.italic=1),s.fCondense&&(r.condense=1),s.fExtend&&(r.extend=1),s.fShadow&&(r.shadow=1),s.fOutline&&(r.outline=1),s.fStrikeout&&(r.strike=1);var i=e.read_shift(2);switch(i===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(r.underline=l);var u=e.read_shift(1);u>0&&(r.family=u);var d=e.read_shift(1);switch(d>0&&(r.charset=d),e.l++,r.color=HL(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=fr(e),r}function u8(e,t){t||(t=Ae(153)),t.write_shift(2,e.sz*20),$L(e,t),t.write_shift(2,e.bold?700:400);var n=0;e.vertAlign=="superscript"?n=1:e.vertAlign=="subscript"&&(n=2),t.write_shift(2,n),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Eh(e.color,t);var r=0;return r=2,t.write_shift(1,r),qn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var d8=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],cm,h8=mr;function Uk(e,t){t||(t=Ae(84)),cm||(cm=Kh(d8));var n=cm[e.patternType];n==null&&(n=40),t.write_shift(4,n);var r=0;if(n!=40)for(Eh({auto:1},t),Eh({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function f8(e,t){var n=e.l+t,r=e.read_shift(2),s=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:s}}function zC(e,t,n){n||(n=Ae(16)),n.write_shift(2,t||0),n.write_shift(2,e.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);var r=0;return n.write_shift(1,r),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function uc(e,t){return t||(t=Ae(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var m8=mr;function p8(e,t){return t||(t=Ae(51)),t.write_shift(1,0),uc(null,t),uc(null,t),uc(null,t),uc(null,t),uc(null,t),t.length>t.l?t.slice(0,t.l):t}function g8(e,t){return t||(t=Ae(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Nh(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function x8(e,t,n){var r=Ae(2052);return r.write_shift(4,e),Nh(t,r),Nh(n,r),r.length>r.l?r.slice(0,r.l):r}function v8(e,t,n){var r={};r.NumberFmt=[];for(var s in st)r.NumberFmt[s]=st[s];r.CellXf=[],r.Fonts=[];var i=[],l=!1;return Ns(e,function(d,f,m){switch(m){case 44:r.NumberFmt[d[0]]=d[1],ms(d[1],d[0]);break;case 43:r.Fonts.push(d),d.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(d.color.rgb=Ah(t.themeElements.clrScheme[d.color.theme].rgb,d.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&r.CellXf.push(d);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:i.push(m),l=!0;break;case 38:i.pop(),l=!1;break;default:if(f.T>0)i.push(m);else if(f.T<0)i.pop();else if(!l||n.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),r}function y8(e,t){if(t){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)t[s]!=null&&++n}),n!=0&&(Re(e,615,Da(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)t[s]!=null&&Re(e,44,l8(s,t[s]))}),Re(e,616))}}function k8(e){var t=1;Re(e,611,Da(t)),Re(e,43,u8({sz:12,color:{theme:1},name:"Calibri",family:2})),Re(e,612)}function w8(e){var t=2;Re(e,603,Da(t)),Re(e,45,Uk({patternType:"none"})),Re(e,45,Uk({patternType:"gray125"})),Re(e,604)}function S8(e){var t=1;Re(e,613,Da(t)),Re(e,46,p8()),Re(e,614)}function _8(e){var t=1;Re(e,626,Da(t)),Re(e,47,zC({numFmtId:0},65535)),Re(e,627)}function C8(e,t){Re(e,617,Da(t.length)),t.forEach(function(n){Re(e,47,zC(n,0))}),Re(e,618)}function N8(e){var t=1;Re(e,619,Da(t)),Re(e,48,g8({xfId:0,name:"Normal"})),Re(e,620)}function E8(e){var t=0;Re(e,505,Da(t)),Re(e,506)}function T8(e){var t=0;Re(e,508,x8(t,"TableStyleMedium9","PivotStyleMedium4")),Re(e,509)}function b8(e,t){var n=Or();return Re(n,278),y8(n,e.SSF),k8(n),w8(n),S8(n),_8(n),C8(n,t.cellXfs),N8(n),E8(n),T8(n),Re(n,279),n.end()}var A8=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function j8(e,t,n){t.themeElements.clrScheme=[];var r={};(e[0].match(pr)||[]).forEach(function(s){var i=lt(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=i.val;break;case"<a:sysClr":r.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[A8.indexOf(i[0])]=r,r={}):r.name=i[0].slice(3,i[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function R8(){}function I8(){}var P8=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,D8=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,O8=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function L8(e,t,n){t.themeElements={};var r;[["clrScheme",P8,j8],["fontScheme",D8,R8],["fmtScheme",O8,I8]].forEach(function(s){if(!(r=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](r,t,n)})}var F8=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function WC(e,t){(!e||e.length===0)&&(e=Tg());var n,r={};if(!(n=e.match(F8)))throw new Error("themeElements not found in theme");return L8(n[0],r,t),r.raw=e,r}function Tg(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var n=[_n];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function M8(e,t,n){var r=e.l+t,s=e.read_shift(4);if(s!==124226){if(!n.cellStyles){e.l=r;return}var i=e.slice(e.l);e.l=r;var l;try{l=D_(i,{type:"array"})}catch{return}var u=Vr(l,"theme/theme/theme1.xml",!0);if(u)return WC(u,n)}}function B8(e){return e.read_shift(4)}function U8(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=z8(e,4);break;case 2:t.xclrValue=wC(e);break;case 3:t.xclrValue=B8(e);break;case 4:e.l+=4;break}return e.l+=8,t}function z8(e,t){return mr(e,t)}function W8(e,t){return mr(e,t)}function H8(e){var t=e.read_shift(2),n=e.read_shift(2)-4,r=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=U8(e);break;case 6:r[1]=W8(e,n);break;case 14:case 15:r[1]=e.read_shift(n===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+n)}return r}function G8(e,t){var n=e.l+t;e.l+=2;var r=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),i=[];s-- >0;)i.push(H8(e,n-e.l));return{ixfe:r,ext:i}}function $8(e,t){t.forEach(function(n){n[0]})}function V8(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:fr(e)}}function q8(e){var t=Ae(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),qn(e.name,t),t.slice(0,t.l)}function K8(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Y8(e){var t=Ae(4+8*e.length);t.write_shift(4,e.length);for(var n=0;n<e.length;++n)t.write_shift(4,e[n][0]),t.write_shift(4,e[n][1]);return t}function X8(e,t){var n=Ae(8+2*t.length);return n.write_shift(4,e),qn(t,n),n.slice(0,n.l)}function Q8(e){return e.l+=4,e.read_shift(4)!=0}function J8(e,t){var n=Ae(8);return n.write_shift(4,e),n.write_shift(4,1),n}function Z8(e,t,n){var r={Types:[],Cell:[],Value:[]},s=n||{},i=[],l=!1,u=2;return Ns(e,function(d,f,m){switch(m){case 335:r.Types.push({name:d.name});break;case 51:d.forEach(function(p){u==1?r.Cell.push({type:r.Types[p[0]-1].name,index:p[1]}):u==0&&r.Value.push({type:r.Types[p[0]-1].name,index:p[1]})});break;case 337:u=d?1:0;break;case 338:u=2;break;case 35:i.push(m),l=!0;break;case 36:i.pop(),l=!1;break;default:if(!f.T){if(!l||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),r}function e5(){var e=Or();return Re(e,332),Re(e,334,Da(1)),Re(e,335,q8({name:"XLDAPR",version:12e4,flags:3496657072})),Re(e,336),Re(e,339,X8(1,"XLDAPR")),Re(e,52),Re(e,35,Da(514)),Re(e,4096,Da(0)),Re(e,4097,ca(1)),Re(e,36),Re(e,53),Re(e,340),Re(e,337,J8(1)),Re(e,51,Y8([[1,0]])),Re(e,338),Re(e,333),e.end()}function t5(e,t,n){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var s=!1,i=2,l;return e.replace(pr,function(u){var d=lt(u);switch(Ka(d[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:d.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<r.Types.length;++f)r.Types[f].name==d.name&&(l=r.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?r.Cell.push({type:r.Types[d.t-1].name,index:+d.v}):i==0&&r.Value.push({type:r.Types[d.t-1].name,index:+d.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+d.i);break;default:if(!s&&n.WTF)throw new Error("unrecognized "+d[0]+" in metadata")}return u}),r}function HC(){var e=[_n];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function n5(e){var t=[];if(!e)return t;var n=1;return(e.match(pr)||[]).forEach(function(r){var s=lt(r);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?n=s.i:s.i=n,t.push(s);break}}),t}function r5(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=it(n);var r=e.read_shift(1);return r&2&&(t.l="1"),r&8&&(t.a="1"),t}function a5(e,t,n){var r=[];return Ns(e,function(i,l,u){switch(u){case 63:r.push(i);break;default:if(!l.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function s5(e,t,n,r){if(!e)return e;var s=r||{},i=!1;Ns(e,function(u,d,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!d.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},s)}function i5(e,t){if(!e)return"??";var n=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][n].Target}var Go=1024;function GC(e,t){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),s=[He("xml",null,{"xmlns:v":Wr.v,"xmlns:o":Wr.o,"xmlns:x":Wr.x,"xmlns:mv":Wr.mv}).replace(/\/>/,">"),He("o:shapelayout",He("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),He("v:shapetype",[He("v:stroke",null,{joinstyle:"miter"}),He("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];Go<e*1e3;)Go+=1e3;return t.forEach(function(i){var l=ln(i[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var d=u.type=="gradient"?He("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=He("v:fill",d,u),m={on:"t",obscured:"t"};++Go,s=s.concat(["<v:shape"+Gc({id:"_x0000_s"+Go,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,He("v:shadow",null,m),He("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",er("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),er("x:AutoFill","False"),er("x:Row",String(l.r)),er("x:Column",String(l.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function zk(e,t,n,r){var s=Array.isArray(e),i;t.forEach(function(l){var u=ln(l.ref);if(s?(e[u.r]||(e[u.r]=[]),i=e[u.r][u.c]):i=e[l.ref],!i){i={t:"z"},s?e[u.r][u.c]=i:e[l.ref]=i;var d=Tt(e["!ref"]||"BDWGO1000001:A1");d.s.r>u.r&&(d.s.r=u.r),d.e.r<u.r&&(d.e.r=u.r),d.s.c>u.c&&(d.s.c=u.c),d.e.c<u.c&&(d.e.c=u.c);var f=ft(d);f!==e["!ref"]&&(e["!ref"]=f)}i.c||(i.c=[]);var m={a:l.author,t:l.t,r:l.r,T:n};l.h&&(m.h=l.h);for(var p=i.c.length-1;p>=0;--p){if(!n&&i.c[p].T)return;n&&!i.c[p].T&&i.c.splice(p,1)}if(n&&r){for(p=0;p<r.length;++p)if(m.a==r[p].id){m.a=r[p].name||m.a;break}}i.c.push(m)})}function o5(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],r=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&n.push(u[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?comment[^>]*>/);if(u){var d=lt(u[0]),f={author:d.authorId&&n[d.authorId]||"sheetjsghost",ref:d.ref,guid:d.guid},m=ln(d.ref);if(!(t.sheetRows&&t.sheetRows<=m.r)){var p=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!p&&!!p[1]&&Cg(p[1])||{r:"",t:"",h:""};f.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),f.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=x.h),r.push(f)}}}}),r}function $C(e){var t=[_n,He("comments",null,{xmlns:so[0]})],n=[];return t.push("<authors>"),e.forEach(function(r){r[1].forEach(function(s){var i=Lt(s.a);n.indexOf(i)==-1&&(n.push(i),t.push("<author>"+i+"</author>")),s.T&&s.ID&&n.indexOf("tc="+s.ID)==-1&&(n.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),n.length==0&&(n.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(r){var s=0,i=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?s=n.indexOf("tc="+r[1][0].ID):r[1].forEach(function(d){d.a&&(s=n.indexOf(Lt(d.a))),i.push(d.t||"")}),t.push('<comment ref="'+r[0]+'" authorId="'+s+'"><text>'),i.length<=1)t.push(er("t",Lt(i[0]||"")));else{for(var l=`Comment:
    `+i[0]+`
`,u=1;u<i.length;++u)l+=`Reply:
    `+i[u]+`
`;t.push(er("t",Lt(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function l5(e,t){var n=[],r=!1,s={},i=0;return e.replace(pr,function(u,d){var f=lt(u);switch(Ka(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":s.t!=null&&n.push(s);break;case"<text>":case"<text":i=d+u.length;break;case"</text>":s.t=e.slice(i,d).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return u}),n}function c5(e,t,n){var r=[_n,He("ThreadedComments",null,{xmlns:In.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var i="";(s[1]||[]).forEach(function(l,u){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var d={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};u==0?i=d.id:d.parentId=i,l.ID=d.id,l.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),r.push(He("threadedComment",er("text",l.t||""),d))})}),r.push("</ThreadedComments>"),r.join("")}function u5(e,t){var n=[],r=!1;return e.replace(pr,function(i){var l=lt(i);switch(Ka(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":n.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),n}function d5(e){var t=[_n,He("personList",null,{xmlns:In.TCMNT,"xmlns:x":so[0]}).replace(/[\/]>/,">")];return e.forEach(function(n,r){t.push(He("person",null,{displayName:n,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:n,providerId:"None"}))}),t.push("</personList>"),t.join("")}function h5(e){var t={};t.iauthor=e.read_shift(4);var n=co(e);return t.rfx=n.s,t.ref=it(n.s),e.l+=16,t}function f5(e,t){return t==null&&(t=Ae(36)),t.write_shift(4,e[1].iauthor),kl(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var m5=fr;function p5(e){return qn(e.slice(0,54))}function g5(e,t){var n=[],r=[],s={},i=!1;return Ns(e,function(u,d,f){switch(f){case 632:r.push(u);break;case 635:s=u;break;case 637:s.t=u.t,s.h=u.h,s.r=u.r;break;case 636:if(s.author=r[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,n.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!d.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function x5(e){var t=Or(),n=[];return Re(t,628),Re(t,630),e.forEach(function(r){r[1].forEach(function(s){n.indexOf(s.a)>-1||(n.push(s.a.slice(0,54)),Re(t,632,p5(s.a)))})}),Re(t,631),Re(t,633),e.forEach(function(r){r[1].forEach(function(s){s.iauthor=n.indexOf(s.a);var i={s:ln(r[0]),e:ln(r[0])};Re(t,635,f5([i,s])),s.t&&s.t.length>0&&Re(t,637,BL(s)),Re(t,636),delete s.iauthor})}),Re(t,634),Re(t,629),t.end()}var v5="application/vnd.ms-office.vbaProject";function y5(e){var t=nt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(n,r){if(!(n.slice(-1)==="/"||!n.match(/_VBA_PROJECT_CUR/))){var s=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");nt.utils.cfb_add(t,s,e.FileIndex[r].content)}}),nt.write(t)}function k5(e,t){t.FullPaths.forEach(function(n,r){if(r!=0){var s=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&nt.utils.cfb_add(e,s,t.FileIndex[r].content)}})}var VC=["xlsb","xlsm","xlam","biff8","xla"];function w5(){return{"!type":"dialog"}}function S5(){return{"!type":"dialog"}}function _5(){return{"!type":"macro"}}function C5(){return{"!type":"macro"}}var el=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(r,s,i,l){var u=!1,d=!1;i.length==0?d=!0:i.charAt(0)=="["&&(d=!0,i=i.slice(1,-1)),l.length==0?u=!0:l.charAt(0)=="["&&(u=!0,l=l.slice(1,-1));var f=i.length>0?parseInt(i,10)|0:0,m=l.length>0?parseInt(l,10)|0:0;return u?m+=t.c:--m,d?f+=t.r:--f,s+(u?"":"$")+on(m)+(d?"":"$")+Sn(f)}return function(s,i){return t=i,s.replace(e,n)}})(),bg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Ag=(function(){return function(t,n){return t.replace(bg,function(r,s,i,l,u,d){var f=pg(l)-(i?0:n.c),m=mg(d)-(u?0:n.r),p=m==0?"":u?m+1:"["+m+"]",x=f==0?"":i?f+1:"["+f+"]";return s+"R"+p+"C"+x})}})();function qC(e,t){return e.replace(bg,function(n,r,s,i,l,u){return r+(s=="$"?s+i:on(pg(i)+t.c))+(l=="$"?l+u:Sn(mg(u)+t.r))})}function N5(e,t,n){var r=Fr(t),s=r.s,i=ln(n),l={r:i.r-s.r,c:i.c-s.c};return qC(e,l)}function E5(e){return e.length!=1}function Wk(e){return e.replace(/_xlfn\./g,"")}function Nn(e){e.l+=1}function ui(e,t){var n=e.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function KC(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return YC(e);n.biff==12&&(r=4)}var s=e.read_shift(r),i=e.read_shift(r),l=ui(e),u=ui(e);return{s:{r:s,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:u[0],cRel:u[1],rRel:u[2]}}}function YC(e){var t=ui(e),n=ui(e),r=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:s,cRel:n[1],rRel:n[2]}}}function T5(e,t,n){if(n.biff<8)return YC(e);var r=e.read_shift(n.biff==12?4:2),s=e.read_shift(n.biff==12?4:2),i=ui(e),l=ui(e);return{s:{r,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function XC(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return b5(e);var r=e.read_shift(n&&n.biff==12?4:2),s=ui(e);return{r,c:s[0],cRel:s[1],rRel:s[2]}}function b5(e){var t=ui(e),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}function A5(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function j5(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return R5(e);var s=e.read_shift(r>=12?4:2),i=e.read_shift(2),l=(i&16384)>>14,u=(i&32768)>>15;if(i&=16383,u==1)for(;s>524287;)s-=1048576;if(l==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:l,rRel:u}}function R5(e){var t=e.read_shift(2),n=e.read_shift(1),r=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,r==1&&t>=8192&&(t=t-16384),s==1&&n>=128&&(n=n-256),{r:t,c:n,cRel:s,rRel:r}}function I5(e,t,n){var r=(e[e.l++]&96)>>5,s=KC(e,n.biff>=2&&n.biff<=5?6:8,n);return[r,s]}function P5(e,t,n){var r=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),i=8;if(n)switch(n.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var l=KC(e,i,n);return[r,s,l]}function D5(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}function O5(e,t,n){var r=(e[e.l++]&96)>>5,s=e.read_shift(2),i=8;if(n)switch(n.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[r,s]}function L5(e,t,n){var r=(e[e.l++]&96)>>5,s=T5(e,t-1,n);return[r,s]}function F5(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n.biff==2?6:n.biff==12?14:7,[r]}function Hk(e){var t=e[e.l+1]&1,n=1;return e.l+=4,[t,n]}function M5(e,t,n){e.l+=2;for(var r=e.read_shift(n&&n.biff==2?1:2),s=[],i=0;i<=r;++i)s.push(e.read_shift(n&&n.biff==2?1:2));return s}function B5(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function U5(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function z5(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function W5(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=n&&n.biff==2?3:4,[r]}function QC(e){var t=e.read_shift(1),n=e.read_shift(1);return[t,n]}function H5(e){return e.read_shift(2),QC(e)}function G5(e){return e.read_shift(2),QC(e)}function $5(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var s=XC(e,0,n);return[r,s]}function V5(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var s=j5(e,0,n);return[r,s]}function q5(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);n&&n.biff==5&&(e.l+=12);var i=XC(e,0,n);return[r,s,i]}function K5(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(n&&n.biff<=3?1:2);return[QB[s],e2[s],r]}function Y5(e,t,n){var r=e[e.l++],s=e.read_shift(1),i=n&&n.biff<=3?[r==88?-1:0,e.read_shift(1)]:X5(e);return[s,(i[0]===0?e2:XB)[i[1]]]}function X5(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Q5(e,t,n){e.l+=n&&n.biff==2?3:4}function J5(e,t,n){if(e.l++,n&&n.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),s=e.read_shift(n&&n.biff==2?1:2);return[r,s]}function Z5(e){return e.l++,Es[e.read_shift(1)]}function eB(e){return e.l++,e.read_shift(2)}function tB(e){return e.l++,e.read_shift(1)!==0}function nB(e){return e.l++,dr(e)}function rB(e,t,n){return e.l++,hu(e,t-1,n)}function aB(e,t){var n=[e.read_shift(1)];if(t==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=kn(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:n[1]=Es[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:n[1]=dr(e);break;case 2:n[1]=uo(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function sB(e,t,n){for(var r=e.read_shift(n.biff==12?4:2),s=[],i=0;i!=r;++i)s.push((n.biff==12?co:Qh)(e));return s}function iB(e,t,n){var r=0,s=0;n.biff==12?(r=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,--s==0&&(s=256));for(var i=0,l=[];i!=r&&(l[i]=[]);++i)for(var u=0;u!=s;++u)l[i][u]=aB(e,n.biff);return l}function oB(e,t,n){var r=e.read_shift(1)>>>5&3,s=!n||n.biff>=8?4:2,i=e.read_shift(s);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,i]}function lB(e,t,n){if(n.biff==5)return cB(e);var r=e.read_shift(1)>>>5&3,s=e.read_shift(2),i=e.read_shift(4);return[r,s,i]}function cB(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}function uB(e,t,n){var r=e.read_shift(1)>>>5&3;e.l+=n&&n.biff==2?3:4;var s=e.read_shift(n&&n.biff==2?1:2);return[r,s]}function dB(e,t,n){var r=e.read_shift(1)>>>5&3,s=e.read_shift(n&&n.biff==2?1:2);return[r,s]}function hB(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,n.biff==12&&(e.l+=2),[r]}function fB(e,t,n){var r=(e[e.l++]&96)>>5,s=e.read_shift(2),i=4;if(n)switch(n.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[r,s]}var mB=mr,pB=mr,gB=mr;function mu(e,t,n){return e.l+=2,[A5(e)]}function jg(e){return e.l+=6,[]}var xB=mu,vB=jg,yB=jg,kB=mu;function JC(e){return e.l+=2,[Tn(e),e.read_shift(2)&1]}var wB=mu,SB=JC,_B=jg,CB=mu,NB=mu,EB=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function TB(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),s=e.read_shift(2),i=e.read_shift(2),l=EB[n>>2&31];return{ixti:t,coltype:n&3,rt:l,idx:r,c:s,C:i}}function bB(e){return e.l+=2,[e.read_shift(4)]}function AB(e,t,n){return e.l+=5,e.l+=2,e.l+=n.biff==2?1:4,["PTGSHEET"]}function jB(e,t,n){return e.l+=n.biff==2?4:5,["PTGENDSHEET"]}function RB(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function IB(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function PB(e){return e.l+=4,[0,0]}var Gk={1:{n:"PtgExp",f:J5},2:{n:"PtgTbl",f:gB},3:{n:"PtgAdd",f:Nn},4:{n:"PtgSub",f:Nn},5:{n:"PtgMul",f:Nn},6:{n:"PtgDiv",f:Nn},7:{n:"PtgPower",f:Nn},8:{n:"PtgConcat",f:Nn},9:{n:"PtgLt",f:Nn},10:{n:"PtgLe",f:Nn},11:{n:"PtgEq",f:Nn},12:{n:"PtgGe",f:Nn},13:{n:"PtgGt",f:Nn},14:{n:"PtgNe",f:Nn},15:{n:"PtgIsect",f:Nn},16:{n:"PtgUnion",f:Nn},17:{n:"PtgRange",f:Nn},18:{n:"PtgUplus",f:Nn},19:{n:"PtgUminus",f:Nn},20:{n:"PtgPercent",f:Nn},21:{n:"PtgParen",f:Nn},22:{n:"PtgMissArg",f:Nn},23:{n:"PtgStr",f:rB},26:{n:"PtgSheet",f:AB},27:{n:"PtgEndSheet",f:jB},28:{n:"PtgErr",f:Z5},29:{n:"PtgBool",f:tB},30:{n:"PtgInt",f:eB},31:{n:"PtgNum",f:nB},32:{n:"PtgArray",f:F5},33:{n:"PtgFunc",f:K5},34:{n:"PtgFuncVar",f:Y5},35:{n:"PtgName",f:oB},36:{n:"PtgRef",f:$5},37:{n:"PtgArea",f:I5},38:{n:"PtgMemArea",f:uB},39:{n:"PtgMemErr",f:mB},40:{n:"PtgMemNoMem",f:pB},41:{n:"PtgMemFunc",f:dB},42:{n:"PtgRefErr",f:hB},43:{n:"PtgAreaErr",f:D5},44:{n:"PtgRefN",f:V5},45:{n:"PtgAreaN",f:L5},46:{n:"PtgMemAreaN",f:RB},47:{n:"PtgMemNoMemN",f:IB},57:{n:"PtgNameX",f:lB},58:{n:"PtgRef3d",f:q5},59:{n:"PtgArea3d",f:P5},60:{n:"PtgRefErr3d",f:fB},61:{n:"PtgAreaErr3d",f:O5},255:{}},DB={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},OB={1:{n:"PtgElfLel",f:JC},2:{n:"PtgElfRw",f:CB},3:{n:"PtgElfCol",f:xB},6:{n:"PtgElfRwV",f:NB},7:{n:"PtgElfColV",f:kB},10:{n:"PtgElfRadical",f:wB},11:{n:"PtgElfRadicalS",f:_B},13:{n:"PtgElfColS",f:vB},15:{n:"PtgElfColSV",f:yB},16:{n:"PtgElfRadicalLel",f:SB},25:{n:"PtgList",f:TB},29:{n:"PtgSxName",f:bB},255:{}},LB={0:{n:"PtgAttrNoop",f:PB},1:{n:"PtgAttrSemi",f:W5},2:{n:"PtgAttrIf",f:U5},4:{n:"PtgAttrChoose",f:M5},8:{n:"PtgAttrGoto",f:B5},16:{n:"PtgAttrSum",f:Q5},32:{n:"PtgAttrBaxcel",f:Hk},33:{n:"PtgAttrBaxcel",f:Hk},64:{n:"PtgAttrSpace",f:H5},65:{n:"PtgAttrSpaceSemi",f:G5},128:{n:"PtgAttrIfError",f:z5},255:{}};function pu(e,t,n,r){if(r.biff<8)return mr(e,t);for(var s=e.l+t,i=[],l=0;l!==n.length;++l)switch(n[l][0]){case"PtgArray":n[l][1]=iB(e,0,r),i.push(n[l][1]);break;case"PtgMemArea":n[l][2]=sB(e,n[l][1],r),i.push(n[l][2]);break;case"PtgExp":r&&r.biff==12&&(n[l][1][1]=e.read_shift(4),i.push(n[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[l][0]}return t=s-e.l,t!==0&&i.push(mr(e,t)),i}function gu(e,t,n){for(var r=e.l+t,s,i,l=[];r!=e.l;)t=r-e.l,i=e[e.l],s=Gk[i]||Gk[DB[i]],(i===24||i===25)&&(s=(i===24?OB:LB)[e[e.l+1]]),!s||!s.f?mr(e,t):l.push([s.n,s.f(e,t,n)]);return l}function FB(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],s=[],i=0;i<r.length;++i){var l=r[i];if(l)switch(l[0]){case 2:s.push('"'+l[1].replace(/"/g,'""')+'"');break;default:s.push(l[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var MB={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function BB(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function ZC(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var s="";if(n.biff>8)switch(e[r[0]][0]){case 357:return s=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?s:s+":"+e.SheetNames[r[2]];case 358:return n.SID!=null?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return s=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?s:s+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[r[0]][0][3]?(s=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?s:s+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function $k(e,t,n){var r=ZC(e,t,n);return r=="#REF"?r:BB(r,n)}function lr(e,t,n,r,s){var i=s&&s.biff||8,l={s:{c:0,r:0}},u=[],d,f,m,p=0,x=0,v,k="";if(!e[0]||!e[0][0])return"";for(var y=-1,S="",C=0,D=e[0].length;C<D;++C){var N=e[0][C];switch(N[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=u.pop(),f=u.pop(),y>=0){switch(e[0][y][1][0]){case 0:S=hn(" ",e[0][y][1][1]);break;case 1:S=hn("\r",e[0][y][1][1]);break;default:if(S="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}f=f+S,y=-1}u.push(f+MB[N[0]]+d);break;case"PtgIsect":d=u.pop(),f=u.pop(),u.push(f+" "+d);break;case"PtgUnion":d=u.pop(),f=u.pop(),u.push(f+","+d);break;case"PtgRange":d=u.pop(),f=u.pop(),u.push(f+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=Sc(N[1][1],l,s),u.push(_c(m,i));break;case"PtgRefN":m=n?Sc(N[1][1],n,s):N[1][1],u.push(_c(m,i));break;case"PtgRef3d":p=N[1][1],m=Sc(N[1][2],l,s),k=$k(r,p,s),u.push(k+"!"+_c(m,i));break;case"PtgFunc":case"PtgFuncVar":var b=N[1][0],H=N[1][1];b||(b=0),b&=127;var L=b==0?[]:u.slice(-b);u.length-=b,H==="User"&&(H=L.shift()),u.push(H+"("+L.join(",")+")");break;case"PtgBool":u.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(N[1]);break;case"PtgNum":u.push(String(N[1]));break;case"PtgStr":u.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(N[1]);break;case"PtgAreaN":v=kk(N[1][1],n?{s:n}:l,s),u.push(sm(v,s));break;case"PtgArea":v=kk(N[1][1],l,s),u.push(sm(v,s));break;case"PtgArea3d":p=N[1][1],v=N[1][2],k=$k(r,p,s),u.push(k+"!"+sm(v,s));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=N[1][2];var R=(r.names||[])[x-1]||(r[0]||[])[x],q=R?R.Name:"SH33TJSNAME"+String(x);q&&q.slice(0,6)=="_xlfn."&&!s.xlfn&&(q=q.slice(6)),u.push(q);break;case"PtgNameX":var O=N[1][1];x=N[1][2];var V;if(s.biff<=5)O<0&&(O=-O),r[O]&&(V=r[O][x]);else{var X="";if(((r[O]||[])[0]||[])[0]==14849||(((r[O]||[])[0]||[])[0]==1025?r[O][x]&&r[O][x].itab>0&&(X=r.SheetNames[r[O][x].itab-1]+"!"):X=r.SheetNames[x-1]+"!"),r[O]&&r[O][x])X+=r[O][x].Name;else if(r[0]&&r[0][x])X+=r[0][x].Name;else{var M=(ZC(r,O,s)||"").split(";;");M[x-1]?X=M[x-1]:X+="SH33TJSERRX"}u.push(X);break}V||(V={Name:"SH33TJSERRY"}),u.push(V.Name);break;case"PtgParen":var me="(",ae=")";if(y>=0){switch(S="",e[0][y][1][0]){case 2:me=hn(" ",e[0][y][1][1])+me;break;case 3:me=hn("\r",e[0][y][1][1])+me;break;case 4:ae=hn(" ",e[0][y][1][1])+ae;break;case 5:ae=hn("\r",e[0][y][1][1])+ae;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}y=-1}u.push(me+u.pop()+ae);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":m={c:N[1][1],r:N[1][0]};var ce={c:n.c,r:n.r};if(r.sharedf[it(m)]){var ue=r.sharedf[it(m)];u.push(lr(ue,l,ce,r,s))}else{var K=!1;for(d=0;d!=r.arrayf.length;++d)if(f=r.arrayf[d],!(m.c<f[0].s.c||m.c>f[0].e.c)&&!(m.r<f[0].s.r||m.r>f[0].e.r)){u.push(lr(f[1],l,ce,r,s)),K=!0;break}K||u.push(N[1])}break;case"PtgArray":u.push("{"+FB(N[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=C;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(N));default:throw new Error("Unrecognized Formula Token: "+String(N))}var W=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&y>=0&&W.indexOf(e[0][C][0])==-1){N=e[0][y];var j=!0;switch(N[1][0]){case 4:j=!1;case 0:S=hn(" ",N[1][1]);break;case 5:j=!1;case 1:S=hn("\r",N[1][1]);break;default:if(S="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}u.push((j?S:"")+u.pop()+(j?"":S)),y=-1}}if(u.length>1&&s.WTF)throw new Error("bad formula stack");return u[0]}function UB(e,t,n){var r=e.l+t,s=n.biff==2?1:2,i,l=e.read_shift(s);if(l==65535)return[[],mr(e,t-2)];var u=gu(e,l,n);return t!==l+s&&(i=pu(e,t-l-s,u,n)),e.l=r,[u,i]}function zB(e,t,n){var r=e.l+t,s=n.biff==2?1:2,i,l=e.read_shift(s);if(l==65535)return[[],mr(e,t-2)];var u=gu(e,l,n);return t!==l+s&&(i=pu(e,t-l-s,u,n)),e.l=r,[u,i]}function WB(e,t,n,r){var s=e.l+t,i=gu(e,r,n),l;return s!==e.l&&(l=pu(e,s-e.l,i,n)),[i,l]}function HB(e,t,n){var r=e.l+t,s,i=e.read_shift(2),l=gu(e,i,n);return i==65535?[[],mr(e,t-2)]:(t!==i+2&&(s=pu(e,r-i-2,l,n)),[l,s])}function GB(e){var t;if(cs(e,e.l+6)!==65535)return[dr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function $B(e){if(e==null){var t=Ae(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Zi(e);return Zi(0)}function um(e,t,n){var r=e.l+t,s=Ya(e);n.biff==2&&++e.l;var i=GB(e),l=e.read_shift(1);n.biff!=2&&(e.read_shift(1),n.biff>=5&&e.read_shift(4));var u=zB(e,r-e.l,n);return{cell:s,val:i[0],formula:u,shared:l>>3&1,tt:i[1]}}function VB(e,t,n,r,s){var i=to(t,n,s),l=$B(e.v),u=Ae(6),d=33;u.write_shift(2,d),u.write_shift(4,0);for(var f=Ae(e.bf.length),m=0;m<e.bf.length;++m)f[m]=e.bf[m];var p=Vn([i,l,u,f]);return p}function Jh(e,t,n){var r=e.read_shift(4),s=gu(e,r,n),i=e.read_shift(4),l=i>0?pu(e,i,s,n):null;return[s,l]}var qB=Jh,Zh=Jh,KB=Jh,YB=Jh,XB={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},e2={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},QB={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Vk(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,n){return n.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function JB(e){var t="of:="+e.replace(bg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function dm(e){var t=e.split(":"),n=t[0].split(".")[0];return[n,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function ZB(e){return e.replace(/\./,"!")}var Nc={},tl={},Ec=typeof Map<"u";function Rg(e,t,n){var r=0,s=e.length;if(n){if(Ec?n.has(t):Object.prototype.hasOwnProperty.call(n,t)){for(var i=Ec?n.get(t):n[t];r<i.length;++r)if(e[i[r]].t===t)return e.Count++,i[r]}}else for(;r<s;++r)if(e[r].t===t)return e.Count++,r;return e[s]={t},e.Count++,e.Unique++,n&&(Ec?(n.has(t)||n.set(t,[]),n.get(t).push(s)):(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=[]),n[t].push(s))),s}function ef(e,t){var n={min:e+1,max:e+1},r=-1;return t.MDW&&(ur=t.MDW),t.width!=null?n.customWidth=1:t.wpx!=null?r=Yc(t.wpx):t.wch!=null&&(r=t.wch),r>-1?(n.width=jh(r),n.customWidth=1):t.width!=null&&(n.width=t.width),t.hidden&&(n.hidden=!0),t.level!=null&&(n.outlineLevel=n.level=t.level),n}function Hi(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(n=[1,1,1,1,.5,.5]),e.left==null&&(e.left=n[0]),e.right==null&&(e.right=n[1]),e.top==null&&(e.top=n[2]),e.bottom==null&&(e.bottom=n[3]),e.header==null&&(e.header=n[4]),e.footer==null&&(e.footer=n[5])}}function gi(e,t,n){var r=n.revssf[t.z!=null?t.z:"General"],s=60,i=e.length;if(r==null&&n.ssf){for(;s<392;++s)if(n.ssf[s]==null){ms(t.z,s),n.ssf[s]=t.z,n.revssf[t.z]=r=s;break}}for(s=0;s!=i;++s)if(e[s].numFmtId===r)return s;return e[i]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function t2(e,t,n,r,s,i){try{r.cellNF&&(e.z=st[t])}catch(u){if(r.WTF)throw u}if(!(e.t==="z"&&!r.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Jt(e.v)),(!r||r.cellText!==!1)&&e.t!=="z")try{if(st[t]==null&&ms(XO[t]||"General",t),e.t==="e")e.w=e.w||Es[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Wc(e.v);else if(e.t==="d"){var l=Dn(e.v);(l|0)===l?e.w=l.toString(10):e.w=Wc(l)}else{if(e.v===void 0)return"";e.w=Qi(e.v,tl)}else e.t==="d"?e.w=da(t,Dn(e.v),tl):e.w=da(t,e.v,tl)}catch(u){if(r.WTF)throw u}if(r.cellStyles&&n!=null)try{e.s=i.Fills[n],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Ah(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Ah(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(r.WTF&&i.Fills)throw u}}}function e7(e,t,n){if(e&&e["!ref"]){var r=Tt(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}function t7(e,t){var n=Tt(t);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(e["!ref"]=ft(n))}var n7=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,r7=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,a7=/<(?:\w:)?hyperlink [^>]*>/mg,s7=/"(\w*:\w*)"/,i7=/<(?:\w:)?col\b[^>]*[\/]?>/g,o7=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,l7=/<(?:\w:)?pageMargins[^>]*\/>/g,n2=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,c7=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,u7=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function d7(e,t,n,r,s,i,l){if(!e)return e;r||(r={"!id":{}});var u=t.dense?[]:{},d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",m="",p=e.match(r7);p?(f=e.slice(0,p.index),m=e.slice(p.index+p[0].length)):f=m=e;var x=f.match(n2);x?Ig(x[0],u,s,n):(x=f.match(c7))&&f7(x[0],x[1]||"",u,s,n);var v=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var k=f.slice(v,v+50).match(s7);k&&t7(u,k[1])}var y=f.match(u7);y&&y[1]&&E7(y[1],s);var S=[];if(t.cellStyles){var C=f.match(i7);C&&w7(S,C)}p&&A7(p[1],u,t,d,i,l);var D=m.match(o7);D&&(u["!autofilter"]=_7(D[0]));var N=[],b=m.match(n7);if(b)for(v=0;v!=b.length;++v)N[v]=Tt(b[v].slice(b[v].indexOf('"')+1));var H=m.match(a7);H&&v7(u,H,r);var L=m.match(l7);if(L&&(u["!margins"]=y7(lt(L[0]))),!u["!ref"]&&d.e.c>=d.s.c&&d.e.r>=d.s.r&&(u["!ref"]=ft(d)),t.sheetRows>0&&u["!ref"]){var R=Tt(u["!ref"]);t.sheetRows<=+R.e.r&&(R.e.r=t.sheetRows-1,R.e.r>d.e.r&&(R.e.r=d.e.r),R.e.r<R.s.r&&(R.s.r=R.e.r),R.e.c>d.e.c&&(R.e.c=d.e.c),R.e.c<R.s.c&&(R.s.c=R.e.c),u["!fullref"]=u["!ref"],u["!ref"]=ft(R))}return S.length>0&&(u["!cols"]=S),N.length>0&&(u["!merges"]=N),u}function h7(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+ft(e[n])+'"/>';return t+"</mergeCells>"}function Ig(e,t,n,r){var s=lt(e);n.Sheets[r]||(n.Sheets[r]={}),s.codeName&&(n.Sheets[r].CodeName=Et(Bt(s.codeName)))}function f7(e,t,n,r,s){Ig(e.slice(0,e.indexOf(">")),n,r,s)}function m7(e,t,n,r,s){var i=!1,l={},u=null;if(r.bookType!=="xlsx"&&t.vbaraw){var d=t.SheetNames[n];try{t.Workbook&&(d=t.Workbook.Sheets[n].CodeName||d)}catch{}i=!0,l.codeName=qa(Lt(d))}if(e&&e["!outline"]){var f={summaryBelow:1,summaryRight:1};e["!outline"].above&&(f.summaryBelow=0),e["!outline"].left&&(f.summaryRight=0),u=(u||"")+He("outlinePr",null,f)}!i&&!u||(s[s.length]=He("sheetPr",u,l))}var p7=["objects","scenarios","selectLockedCells","selectUnlockedCells"],g7=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function x7(e){var t={sheet:1};return p7.forEach(function(n){e[n]!=null&&e[n]&&(t[n]="1")}),g7.forEach(function(n){e[n]!=null&&!e[n]&&(t[n]="0")}),e.password&&(t.password=Ng(e.password).toString(16).toUpperCase()),He("sheetProtection",null,t)}function v7(e,t,n){for(var r=Array.isArray(e),s=0;s!=t.length;++s){var i=lt(Bt(t[s]),!0);if(!i.ref)return;var l=((n||{})["!id"]||[])[i.id];l?(i.Target=l.Target,i.location&&(i.Target+="#"+Et(i.location))):(i.Target="#"+Et(i.location),l={Target:i.Target,TargetMode:"Internal"}),i.Rel=l,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var u=Tt(i.ref),d=u.s.r;d<=u.e.r;++d)for(var f=u.s.c;f<=u.e.c;++f){var m=it({c:f,r:d});r?(e[d]||(e[d]=[]),e[d][f]||(e[d][f]={t:"z",v:void 0}),e[d][f].l=i):(e[m]||(e[m]={t:"z",v:void 0}),e[m].l=i)}}}function y7(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(n){e[n]&&(t[n]=parseFloat(e[n]))}),t}function k7(e){return Hi(e),He("pageMargins",null,e)}function w7(e,t){for(var n=!1,r=0;r!=t.length;++r){var s=lt(t[r],!0);s.hidden&&(s.hidden=Qt(s.hidden));var i=parseInt(s.min,10)-1,l=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!n&&s.width&&(n=!0,Eg(s.width)),ci(s);i<=l;)e[i++]=Zt(s)}}function S7(e,t){for(var n=["<cols>"],r,s=0;s!=t.length;++s)(r=t[s])&&(n[n.length]=He("col",null,ef(s,r)));return n[n.length]="</cols>",n.join("")}function _7(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function C7(e,t,n,r){var s=typeof e.ref=="string"?e.ref:ft(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var i=n.Workbook.Names,l=Fr(s);l.s.r==l.e.r&&(l.e.r=Fr(t["!ref"]).e.r,s=ft(l));for(var u=0;u<i.length;++u){var d=i[u];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==r){d.Ref="'"+n.SheetNames[r]+"'!"+s;break}}return u==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+s}),He("autoFilter",null,{ref:s})}var N7=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function E7(e,t){t.Views||(t.Views=[{}]),(e.match(N7)||[]).forEach(function(n,r){var s=lt(n);t.Views[r]||(t.Views[r]={}),+s.zoomScale&&(t.Views[r].zoom=+s.zoomScale),Qt(s.rightToLeft)&&(t.Views[r].RTL=!0)})}function T7(e,t,n,r){var s={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),He("sheetViews",He("sheetView",null,s),{})}function b7(e,t,n,r){if(e.c&&n["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",i=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=Es[e.v];break;case"d":r&&r.cellDates?s=Jt(e.v,-1).toISOString():(e=Zt(e),e.t="n",s=""+(e.v=Dn(Jt(e.v)))),typeof e.z>"u"&&(e.z=st[14]);break;default:s=e.v;break}var u=er("v",Lt(s)),d={r:t},f=gi(r.cellXfs,e,r);switch(f!==0&&(d.s=f),e.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){u=er("v",""+Rg(r.Strings,e.v,r.revStrings)),d.t="s";break}d.t="str";break}if(e.t!=i&&(e.t=i,e.v=l),typeof e.f=="string"&&e.f){var m=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;u=He("f",Lt(e.f),m)+(e.v!=null?u:"")}return e.l&&n["!links"].push([t,e.l]),e.D&&(d.cm=1),He("c",u,d)}var A7=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=Hc("v"),l=Hc("f");return function(d,f,m,p,x,v){for(var k=0,y="",S=[],C=[],D=0,N=0,b=0,H="",L,R,q=0,O=0,V,X,M=0,me=0,ae=Array.isArray(v.CellXf),ce,ue=[],K=[],W=Array.isArray(f),j=[],F={},U=!1,I=!!m.sheetStubs,Z=d.split(t),Y=0,P=Z.length;Y!=P;++Y){y=Z[Y].trim();var ne=y.length;if(ne!==0){var J=0;e:for(k=0;k<ne;++k)switch(y[k]){case">":if(y[k-1]!="/"){++k;break e}if(m&&m.cellStyles){if(R=lt(y.slice(J,k),!0),q=R.r!=null?parseInt(R.r,10):q+1,O=-1,m.sheetRows&&m.sheetRows<q)continue;F={},U=!1,R.ht&&(U=!0,F.hpt=parseFloat(R.ht),F.hpx=cl(F.hpt)),R.hidden=="1"&&(U=!0,F.hidden=!0),R.outlineLevel!=null&&(U=!0,F.level=+R.outlineLevel),U&&(j[q-1]=F)}break;case"<":J=k;break}if(J>=k)break;if(R=lt(y.slice(J,k),!0),q=R.r!=null?parseInt(R.r,10):q+1,O=-1,!(m.sheetRows&&m.sheetRows<q)){p.s.r>q-1&&(p.s.r=q-1),p.e.r<q-1&&(p.e.r=q-1),m&&m.cellStyles&&(F={},U=!1,R.ht&&(U=!0,F.hpt=parseFloat(R.ht),F.hpx=cl(F.hpt)),R.hidden=="1"&&(U=!0,F.hidden=!0),R.outlineLevel!=null&&(U=!0,F.level=+R.outlineLevel),U&&(j[q-1]=F)),S=y.slice(k).split(e);for(var de=0;de!=S.length&&S[de].trim().charAt(0)=="<";++de);for(S=S.slice(de),k=0;k!=S.length;++k)if(y=S[k].trim(),y.length!==0){if(C=y.match(n),D=k,N=0,b=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,C!=null&&C.length===2){for(D=0,H=C[1],N=0;N!=H.length&&!((b=H.charCodeAt(N)-64)<1||b>26);++N)D=26*D+b;--D,O=D}else++O;for(N=0;N!=y.length&&y.charCodeAt(N)!==62;++N);if(++N,R=lt(y.slice(0,N),!0),R.r||(R.r=it({r:q-1,c:O})),H=y.slice(N),L={t:""},(C=H.match(i))!=null&&C[1]!==""&&(L.v=Et(C[1])),m.cellFormula){if((C=H.match(l))!=null&&C[1]!==""){if(L.f=Et(Bt(C[1])).replace(/\r\n/g,`
`),m.xlfn||(L.f=Wk(L.f)),C[0].indexOf('t="array"')>-1)L.F=(H.match(s)||[])[1],L.F.indexOf(":")>-1&&ue.push([Tt(L.F),L.F]);else if(C[0].indexOf('t="shared"')>-1){X=lt(C[0]);var E=Et(Bt(C[1]));m.xlfn||(E=Wk(E)),K[parseInt(X.si,10)]=[X,E,R.r]}}else(C=H.match(/<f[^>]*\/>/))&&(X=lt(C[0]),K[X.si]&&(L.f=N5(K[X.si][1],K[X.si][2],R.r)));var A=ln(R.r);for(N=0;N<ue.length;++N)A.r>=ue[N][0].s.r&&A.r<=ue[N][0].e.r&&A.c>=ue[N][0].s.c&&A.c<=ue[N][0].e.c&&(L.F=ue[N][1])}if(R.t==null&&L.v===void 0)if(L.f||L.F)L.v=0,L.t="n";else if(I)L.t="z";else continue;else L.t=R.t||"n";switch(p.s.c>O&&(p.s.c=O),p.e.c<O&&(p.e.c=O),L.t){case"n":if(L.v==""||L.v==null){if(!I)continue;L.t="z"}else L.v=parseFloat(L.v);break;case"s":if(typeof L.v>"u"){if(!I)continue;L.t="z"}else V=Nc[parseInt(L.v,10)],L.v=V.t,L.r=V.r,m.cellHTML&&(L.h=V.h);break;case"str":L.t="s",L.v=L.v!=null?Bt(L.v):"",m.cellHTML&&(L.h=ug(L.v));break;case"inlineStr":C=H.match(r),L.t="s",C!=null&&(V=Cg(C[1]))?(L.v=V.t,m.cellHTML&&(L.h=V.h)):L.v="";break;case"b":L.v=Qt(L.v);break;case"d":m.cellDates?L.v=Jt(L.v,1):(L.v=Dn(Jt(L.v,1)),L.t="n");break;case"e":(!m||m.cellText!==!1)&&(L.w=L.v),L.v=aC[L.v];break}if(M=me=0,ce=null,ae&&R.s!==void 0&&(ce=v.CellXf[R.s],ce!=null&&(ce.numFmtId!=null&&(M=ce.numFmtId),m.cellStyles&&ce.fillId!=null&&(me=ce.fillId))),t2(L,M,me,m,x,v),m.cellDates&&ae&&L.t=="n"&&xl(st[M])&&(L.t="d",L.v=Xh(L.v)),R.cm&&m.xlmeta){var he=(m.xlmeta.Cell||[])[+R.cm-1];he&&he.type=="XLDAPR"&&(L.D=!0)}if(W){var G=ln(R.r);f[G.r]||(f[G.r]=[]),f[G.r][G.c]=L}else f[R.r]=L}}}}j.length>0&&(f["!rows"]=j)}})();function j7(e,t,n,r){var s=[],i=[],l=Tt(e["!ref"]),u="",d,f="",m=[],p=0,x=0,v=e["!rows"],k=Array.isArray(e),y={r:f},S,C=-1;for(x=l.s.c;x<=l.e.c;++x)m[x]=on(x);for(p=l.s.r;p<=l.e.r;++p){for(i=[],f=Sn(p),x=l.s.c;x<=l.e.c;++x){d=m[x]+f;var D=k?(e[p]||[])[x]:e[d];D!==void 0&&(u=b7(D,d,e,t))!=null&&i.push(u)}(i.length>0||v&&v[p])&&(y={r:f},v&&v[p]&&(S=v[p],S.hidden&&(y.hidden=1),C=-1,S.hpx?C=Xc(S.hpx):S.hpt&&(C=S.hpt),C>-1&&(y.ht=C,y.customHeight=1),S.level&&(y.outlineLevel=S.level)),s[s.length]=He("row",i.join(""),y))}if(v)for(;p<v.length;++p)v&&v[p]&&(y={r:p+1},S=v[p],S.hidden&&(y.hidden=1),C=-1,S.hpx?C=Xc(S.hpx):S.hpt&&(C=S.hpt),C>-1&&(y.ht=C,y.customHeight=1),S.level&&(y.outlineLevel=S.level),s[s.length]=He("row","",y));return s.join("")}function r2(e,t,n,r){var s=[_n,He("worksheet",null,{xmlns:so[0],"xmlns:r":In.r})],i=n.SheetNames[e],l=0,u="",d=n.Sheets[i];d==null&&(d={});var f=d["!ref"]||"A1",m=Tt(f);if(m.e.c>16383||m.e.r>1048575){if(t.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),f=ft(m)}r||(r={}),d["!comments"]=[];var p=[];m7(d,n,e,t,s),s[s.length]=He("dimension",null,{ref:f}),s[s.length]=T7(d,t,e,n),t.sheetFormat&&(s[s.length]=He("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(s[s.length]=S7(d,d["!cols"])),s[l=s.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(u=j7(d,t),u.length>0&&(s[s.length]=u)),s.length>l+1&&(s[s.length]="</sheetData>",s[l]=s[l].replace("/>",">")),d["!protect"]&&(s[s.length]=x7(d["!protect"])),d["!autofilter"]!=null&&(s[s.length]=C7(d["!autofilter"],d,n,e)),d["!merges"]!=null&&d["!merges"].length>0&&(s[s.length]=h7(d["!merges"]));var x=-1,v,k=-1;return d["!links"].length>0&&(s[s.length]="<hyperlinks>",d["!links"].forEach(function(y){y[1].Target&&(v={ref:y[0]},y[1].Target.charAt(0)!="#"&&(k=Ot(r,-1,Lt(y[1].Target).replace(/#.*$/,""),xt.HLINK),v["r:id"]="rId"+k),(x=y[1].Target.indexOf("#"))>-1&&(v.location=Lt(y[1].Target.slice(x+1))),y[1].Tooltip&&(v.tooltip=Lt(y[1].Tooltip)),s[s.length]=He("hyperlink",null,v))}),s[s.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(s[s.length]=k7(d["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=er("ignoredErrors",He("ignoredError",null,{numberStoredAsText:1,sqref:f}))),p.length>0&&(k=Ot(r,-1,"../drawings/drawing"+(e+1)+".xml",xt.DRAW),s[s.length]=He("drawing",null,{"r:id":"rId"+k}),d["!drawing"]=p),d["!comments"].length>0&&(k=Ot(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",xt.VML),s[s.length]=He("legacyDrawing",null,{"r:id":"rId"+k}),d["!legacy"]=k),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function R7(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=r,i&7&&(n.level=i&7),i&16&&(n.hidden=!0),i&32&&(n.hpt=s/20),n}function I7(e,t,n){var r=Ae(145),s=(n["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var i=320;s.hpx?i=Xc(s.hpx)*20:s.hpt&&(i=s.hpt*20),r.write_shift(2,i),r.write_shift(1,0);var l=0;s.level&&(l|=s.level),s.hidden&&(l|=16),(s.hpx||s.hpt)&&(l|=32),r.write_shift(1,l),r.write_shift(1,0);var u=0,d=r.l;r.l+=4;for(var f={r:e,c:0},m=0;m<16;++m)if(!(t.s.c>m+1<<10||t.e.c<m<<10)){for(var p=-1,x=-1,v=m<<10;v<m+1<<10;++v){f.c=v;var k=Array.isArray(n)?(n[f.r]||[])[f.c]:n[it(f)];k&&(p<0&&(p=v),x=v)}p<0||(++u,r.write_shift(4,p),r.write_shift(4,x))}var y=r.l;return r.l=d,r.write_shift(4,u),r.l=y,r.length>r.l?r.slice(0,r.l):r}function P7(e,t,n,r){var s=I7(r,n,t);(s.length>17||(t["!rows"]||[])[r])&&Re(e,0,s)}var D7=co,O7=kl;function L7(){}function F7(e,t){var n={},r=e[e.l];return++e.l,n.above=!(r&64),n.left=!(r&128),e.l+=18,n.name=UL(e),n}function M7(e,t,n){n==null&&(n=Ae(84+4*e.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),n.write_shift(1,r);for(var s=1;s<3;++s)n.write_shift(1,0);return Eh({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),Z_(e,n),n.slice(0,n.l)}function B7(e){var t=pa(e);return[t]}function U7(e,t,n){return n==null&&(n=Ae(8)),io(t,n)}function z7(e){var t=oo(e);return[t]}function W7(e,t,n){return n==null&&(n=Ae(4)),lo(t,n)}function H7(e){var t=pa(e),n=e.read_shift(1);return[t,n,"b"]}function G7(e,t,n){return n==null&&(n=Ae(9)),io(t,n),n.write_shift(1,e.v?1:0),n}function $7(e){var t=oo(e),n=e.read_shift(1);return[t,n,"b"]}function V7(e,t,n){return n==null&&(n=Ae(5)),lo(t,n),n.write_shift(1,e.v?1:0),n}function q7(e){var t=pa(e),n=e.read_shift(1);return[t,n,"e"]}function K7(e,t,n){return n==null&&(n=Ae(9)),io(t,n),n.write_shift(1,e.v),n}function Y7(e){var t=oo(e),n=e.read_shift(1);return[t,n,"e"]}function X7(e,t,n){return n==null&&(n=Ae(8)),lo(t,n),n.write_shift(1,e.v),n.write_shift(2,0),n.write_shift(1,0),n}function Q7(e){var t=pa(e),n=e.read_shift(4);return[t,n,"s"]}function J7(e,t,n){return n==null&&(n=Ae(12)),io(t,n),n.write_shift(4,t.v),n}function Z7(e){var t=oo(e),n=e.read_shift(4);return[t,n,"s"]}function e9(e,t,n){return n==null&&(n=Ae(8)),lo(t,n),n.write_shift(4,t.v),n}function t9(e){var t=pa(e),n=dr(e);return[t,n,"n"]}function n9(e,t,n){return n==null&&(n=Ae(16)),io(t,n),Zi(e.v,n),n}function a2(e){var t=oo(e),n=dr(e);return[t,n,"n"]}function r9(e,t,n){return n==null&&(n=Ae(12)),lo(t,n),Zi(e.v,n),n}function a9(e){var t=pa(e),n=yg(e);return[t,n,"n"]}function s9(e,t,n){return n==null&&(n=Ae(12)),io(t,n),eC(e.v,n),n}function i9(e){var t=oo(e),n=yg(e);return[t,n,"n"]}function o9(e,t,n){return n==null&&(n=Ae(8)),lo(t,n),eC(e.v,n),n}function l9(e){var t=pa(e),n=gg(e);return[t,n,"is"]}function c9(e){var t=pa(e),n=fr(e);return[t,n,"str"]}function u9(e,t,n){return n==null&&(n=Ae(12+4*e.v.length)),io(t,n),qn(e.v,n),n.length>n.l?n.slice(0,n.l):n}function d9(e){var t=oo(e),n=fr(e);return[t,n,"str"]}function h9(e,t,n){return n==null&&(n=Ae(8+4*e.v.length)),lo(t,n),qn(e.v,n),n.length>n.l?n.slice(0,n.l):n}function f9(e,t,n){var r=e.l+t,s=pa(e);s.r=n["!row"];var i=e.read_shift(1),l=[s,i,"b"];if(n.cellFormula){e.l+=2;var u=Zh(e,r-e.l,n);l[3]=lr(u,null,s,n.supbooks,n)}else e.l=r;return l}function m9(e,t,n){var r=e.l+t,s=pa(e);s.r=n["!row"];var i=e.read_shift(1),l=[s,i,"e"];if(n.cellFormula){e.l+=2;var u=Zh(e,r-e.l,n);l[3]=lr(u,null,s,n.supbooks,n)}else e.l=r;return l}function p9(e,t,n){var r=e.l+t,s=pa(e);s.r=n["!row"];var i=dr(e),l=[s,i,"n"];if(n.cellFormula){e.l+=2;var u=Zh(e,r-e.l,n);l[3]=lr(u,null,s,n.supbooks,n)}else e.l=r;return l}function g9(e,t,n){var r=e.l+t,s=pa(e);s.r=n["!row"];var i=fr(e),l=[s,i,"str"];if(n.cellFormula){e.l+=2;var u=Zh(e,r-e.l,n);l[3]=lr(u,null,s,n.supbooks,n)}else e.l=r;return l}var x9=co,v9=kl;function y9(e,t){return t==null&&(t=Ae(4)),t.write_shift(4,e),t}function k9(e,t){var n=e.l+t,r=co(e),s=xg(e),i=fr(e),l=fr(e),u=fr(e);e.l=n;var d={rfx:r,relId:s,loc:i,display:u};return l&&(d.Tooltip=l),d}function w9(e,t){var n=Ae(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));kl({s:ln(e[0]),e:ln(e[0])},n),vg("rId"+t,n);var r=e[1].Target.indexOf("#"),s=r==-1?"":e[1].Target.slice(r+1);return qn(s||"",n),qn(e[1].Tooltip||"",n),qn("",n),n.slice(0,n.l)}function S9(){}function _9(e,t,n){var r=e.l+t,s=tC(e),i=e.read_shift(1),l=[s];if(l[2]=i,n.cellFormula){var u=qB(e,r-e.l,n);l[1]=u}else e.l=r;return l}function C9(e,t,n){var r=e.l+t,s=co(e),i=[s];if(n.cellFormula){var l=YB(e,r-e.l,n);i[1]=l,e.l=r}else e.l=r;return i}function N9(e,t,n){n==null&&(n=Ae(18));var r=ef(e,t);n.write_shift(-4,e),n.write_shift(-4,e),n.write_shift(4,(r.width||10)*256),n.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof r.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),n.write_shift(2,s),n}var s2=["left","right","top","bottom","header","footer"];function E9(e){var t={};return s2.forEach(function(n){t[n]=dr(e)}),t}function T9(e,t){return t==null&&(t=Ae(48)),Hi(e),s2.forEach(function(n){Zi(e[n],t)}),t}function b9(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function A9(e,t,n){n==null&&(n=Ae(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}function j9(e){var t=Ae(24);return t.write_shift(4,4),t.write_shift(4,1),kl(e,t),t}function R9(e,t){return t==null&&(t=Ae(66)),t.write_shift(2,e.password?Ng(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(n){n[1]?t.write_shift(4,e[n[0]]!=null&&!e[n[0]]?1:0):t.write_shift(4,e[n[0]]!=null&&e[n[0]]?0:1)}),t}function I9(){}function P9(){}function D9(e,t,n,r,s,i,l){if(!e)return e;var u=t||{};r||(r={"!id":{}});var d=u.dense?[]:{},f,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,x=!1,v,k,y,S,C,D,N,b,H,L=[];u.biff=12,u["!row"]=0;var R=0,q=!1,O=[],V={},X=u.supbooks||s.supbooks||[[]];if(X.sharedf=V,X.arrayf=O,X.SheetNames=s.SheetNames||s.Sheets.map(function(W){return W.name}),!u.supbooks&&(u.supbooks=X,s.Names))for(var M=0;M<s.Names.length;++M)X[0][M+1]=s.Names[M];var me=[],ae=[],ce=!1;Qc[16]={n:"BrtShortReal",f:a2};var ue;if(Ns(e,function(j,F,U){if(!x)switch(U){case 148:f=j;break;case 0:v=j,u.sheetRows&&u.sheetRows<=v.r&&(x=!0),b=Sn(S=v.r),u["!row"]=v.r,(j.hidden||j.hpt||j.level!=null)&&(j.hpt&&(j.hpx=cl(j.hpt)),ae[j.r]=j);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(k={t:j[2]},j[2]){case"n":k.v=j[1];break;case"s":N=Nc[j[1]],k.v=N.t,k.r=N.r;break;case"b":k.v=!!j[1];break;case"e":k.v=j[1],u.cellText!==!1&&(k.w=Es[k.v]);break;case"str":k.t="s",k.v=j[1];break;case"is":k.t="s",k.v=j[1].t;break}if((y=l.CellXf[j[0].iStyleRef])&&t2(k,y.numFmtId,null,u,i,l),C=j[0].c==-1?C+1:j[0].c,u.dense?(d[S]||(d[S]=[]),d[S][C]=k):d[on(C)+b]=k,u.cellFormula){for(q=!1,R=0;R<O.length;++R){var I=O[R];v.r>=I[0].s.r&&v.r<=I[0].e.r&&C>=I[0].s.c&&C<=I[0].e.c&&(k.F=ft(I[0]),q=!0)}!q&&j.length>3&&(k.f=j[3])}if(m.s.r>v.r&&(m.s.r=v.r),m.s.c>C&&(m.s.c=C),m.e.r<v.r&&(m.e.r=v.r),m.e.c<C&&(m.e.c=C),u.cellDates&&y&&k.t=="n"&&xl(st[y.numFmtId])){var Z=Bi(k.v);Z&&(k.t="d",k.v=new Date(Z.y,Z.m-1,Z.d,Z.H,Z.M,Z.S,Z.u))}ue&&(ue.type=="XLDAPR"&&(k.D=!0),ue=void 0);break;case 1:case 12:if(!u.sheetStubs||p)break;k={t:"z",v:void 0},C=j[0].c==-1?C+1:j[0].c,u.dense?(d[S]||(d[S]=[]),d[S][C]=k):d[on(C)+b]=k,m.s.r>v.r&&(m.s.r=v.r),m.s.c>C&&(m.s.c=C),m.e.r<v.r&&(m.e.r=v.r),m.e.c<C&&(m.e.c=C),ue&&(ue.type=="XLDAPR"&&(k.D=!0),ue=void 0);break;case 176:L.push(j);break;case 49:ue=((u.xlmeta||{}).Cell||[])[j-1];break;case 494:var Y=r["!id"][j.relId];for(Y?(j.Target=Y.Target,j.loc&&(j.Target+="#"+j.loc),j.Rel=Y):j.relId==""&&(j.Target="#"+j.loc),S=j.rfx.s.r;S<=j.rfx.e.r;++S)for(C=j.rfx.s.c;C<=j.rfx.e.c;++C)u.dense?(d[S]||(d[S]=[]),d[S][C]||(d[S][C]={t:"z",v:void 0}),d[S][C].l=j):(D=it({c:C,r:S}),d[D]||(d[D]={t:"z",v:void 0}),d[D].l=j);break;case 426:if(!u.cellFormula)break;O.push(j),H=u.dense?d[S][C]:d[on(C)+b],H.f=lr(j[1],m,{r:v.r,c:C},X,u),H.F=ft(j[0]);break;case 427:if(!u.cellFormula)break;V[it(j[0].s)]=j[1],H=u.dense?d[S][C]:d[on(C)+b],H.f=lr(j[1],m,{r:v.r,c:C},X,u);break;case 60:if(!u.cellStyles)break;for(;j.e>=j.s;)me[j.e--]={width:j.w/256,hidden:!!(j.flags&1),level:j.level},ce||(ce=!0,Eg(j.w/256)),ci(me[j.e+1]);break;case 161:d["!autofilter"]={ref:ft(j)};break;case 476:d["!margins"]=j;break;case 147:s.Sheets[n]||(s.Sheets[n]={}),j.name&&(s.Sheets[n].CodeName=j.name),(j.above||j.left)&&(d["!outline"]={above:j.above,left:j.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),j.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!F.T){if(!p||u.WTF)throw new Error("Unexpected record 0x"+U.toString(16))}}},u),delete u.supbooks,delete u["!row"],!d["!ref"]&&(m.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(d["!ref"]=ft(f||m)),u.sheetRows&&d["!ref"]){var K=Tt(d["!ref"]);u.sheetRows<=+K.e.r&&(K.e.r=u.sheetRows-1,K.e.r>m.e.r&&(K.e.r=m.e.r),K.e.r<K.s.r&&(K.s.r=K.e.r),K.e.c>m.e.c&&(K.e.c=m.e.c),K.e.c<K.s.c&&(K.s.c=K.e.c),d["!fullref"]=d["!ref"],d["!ref"]=ft(K))}return L.length>0&&(d["!merges"]=L),me.length>0&&(d["!cols"]=me),ae.length>0&&(d["!rows"]=ae),d}function O9(e,t,n,r,s,i,l){if(t.v===void 0)return!1;var u="";switch(t.t){case"b":u=t.v?"1":"0";break;case"d":t=Zt(t),t.z=t.z||st[14],t.v=Dn(Jt(t.v)),t.t="n";break;case"n":case"e":u=""+t.v;break;default:u=t.v;break}var d={r:n,c:r};switch(d.s=gi(s.cellXfs,t,s),t.l&&i["!links"].push([it(d),t.l]),t.c&&i["!comments"].push([it(d),t.c]),t.t){case"s":case"str":return s.bookSST?(u=Rg(s.Strings,t.v,s.revStrings),d.t="s",d.v=u,l?Re(e,18,e9(t,d)):Re(e,7,J7(t,d))):(d.t="str",l?Re(e,17,h9(t,d)):Re(e,6,u9(t,d))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?Re(e,13,o9(t,d)):Re(e,2,s9(t,d)):l?Re(e,16,r9(t,d)):Re(e,5,n9(t,d)),!0;case"b":return d.t="b",l?Re(e,15,V7(t,d)):Re(e,4,G7(t,d)),!0;case"e":return d.t="e",l?Re(e,14,X7(t,d)):Re(e,3,K7(t,d)),!0}return l?Re(e,12,W7(t,d)):Re(e,1,U7(t,d)),!0}function L9(e,t,n,r){var s=Tt(t["!ref"]||"A1"),i,l="",u=[];Re(e,145);var d=Array.isArray(t),f=s.e.r;t["!rows"]&&(f=Math.max(s.e.r,t["!rows"].length-1));for(var m=s.s.r;m<=f;++m){l=Sn(m),P7(e,t,s,m);var p=!1;if(m<=s.e.r)for(var x=s.s.c;x<=s.e.c;++x){m===s.s.r&&(u[x]=on(x)),i=u[x]+l;var v=d?(t[m]||[])[x]:t[i];if(!v){p=!1;continue}p=O9(e,v,m,x,r,t,p)}}Re(e,146)}function F9(e,t){!t||!t["!merges"]||(Re(e,177,y9(t["!merges"].length)),t["!merges"].forEach(function(n){Re(e,176,v9(n))}),Re(e,178))}function M9(e,t){!t||!t["!cols"]||(Re(e,390),t["!cols"].forEach(function(n,r){n&&Re(e,60,N9(r,n))}),Re(e,391))}function B9(e,t){!t||!t["!ref"]||(Re(e,648),Re(e,649,j9(Tt(t["!ref"]))),Re(e,650))}function U9(e,t,n){t["!links"].forEach(function(r){if(r[1].Target){var s=Ot(n,-1,r[1].Target.replace(/#.*$/,""),xt.HLINK);Re(e,494,w9(r,s))}}),delete t["!links"]}function z9(e,t,n,r){if(t["!comments"].length>0){var s=Ot(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",xt.VML);Re(e,551,vg("rId"+s)),t["!legacy"]=s}}function W9(e,t,n,r){if(t["!autofilter"]){var s=t["!autofilter"],i=typeof s.ref=="string"?s.ref:ft(s.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var l=n.Workbook.Names,u=Fr(i);u.s.r==u.e.r&&(u.e.r=Fr(t["!ref"]).e.r,i=ft(u));for(var d=0;d<l.length;++d){var f=l[d];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==r){f.Ref="'"+n.SheetNames[r]+"'!"+i;break}}d==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+i}),Re(e,161,kl(Tt(i))),Re(e,162)}}function H9(e,t,n){Re(e,133),Re(e,137,A9(t,n)),Re(e,138),Re(e,134)}function G9(e,t){t["!protect"]&&Re(e,535,R9(t["!protect"]))}function $9(e,t,n,r){var s=Or(),i=n.SheetNames[e],l=n.Sheets[i]||{},u=i;try{n&&n.Workbook&&(u=n.Workbook.Sheets[e].CodeName||u)}catch{}var d=Tt(l["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],Re(s,129),(n.vbaraw||l["!outline"])&&Re(s,147,M7(u,l["!outline"])),Re(s,148,O7(d)),H9(s,l,n.Workbook),M9(s,l),L9(s,l,e,t),G9(s,l),W9(s,l,n,e),F9(s,l),U9(s,l,r),l["!margins"]&&Re(s,476,T9(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&B9(s,l),z9(s,l,e,r),Re(s,130),s.end()}function V9(e){var t=[],n=e.match(/^<c:numCache>/),r;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var l=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=n?+l[2]:l[2])});var s=Et((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){r=i.replace(/<.*?>/g,"")}),[t,s,r]}function q9(e,t,n,r,s,i){var l=i||{"!type":"chart"};if(!e)return i;var u=0,d=0,f="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var x=V9(p);m.s.r=m.s.c=0,m.e.c=u,f=on(u),x[0].forEach(function(v,k){l[f+Sn(k)]={t:"n",v,z:x[1]},d=k}),m.e.r<d&&(m.e.r=d),++u}),u>0&&(l["!ref"]=ft(m)),l}function K9(e,t,n,r,s){if(!e)return e;r||(r={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l,u=e.match(n2);return u&&Ig(u[0],i,s,n),(l=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=l[1]),r["!id"][i["!rel"]]&&(i["!drawel"]=r["!id"][i["!rel"]]),i}function Y9(e,t){e.l+=10;var n=fr(e);return{name:n}}function X9(e,t,n,r,s){if(!e)return e;r||(r={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Ns(e,function(d,f,m){switch(m){case 550:i["!rel"]=d;break;case 651:s.Sheets[n]||(s.Sheets[n]={}),d.name&&(s.Sheets[n].CodeName=d.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},t),r["!id"][i["!rel"]]&&(i["!drawel"]=r["!id"][i["!rel"]]),i}var Pg=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Q9=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],J9=[],Z9=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function qk(e,t){for(var n=0;n!=e.length;++n)for(var r=e[n],s=0;s!=t.length;++s){var i=t[s];if(r[i[0]]==null)r[i[0]]=i[1];else switch(i[2]){case"bool":typeof r[i[0]]=="string"&&(r[i[0]]=Qt(r[i[0]]));break;case"int":typeof r[i[0]]=="string"&&(r[i[0]]=parseInt(r[i[0]],10));break}}}function Kk(e,t){for(var n=0;n!=t.length;++n){var r=t[n];if(e[r[0]]==null)e[r[0]]=r[1];else switch(r[2]){case"bool":typeof e[r[0]]=="string"&&(e[r[0]]=Qt(e[r[0]]));break;case"int":typeof e[r[0]]=="string"&&(e[r[0]]=parseInt(e[r[0]],10));break}}}function i2(e){Kk(e.WBProps,Pg),Kk(e.CalcPr,Z9),qk(e.WBView,Q9),qk(e.Sheets,J9),tl.date1904=Qt(e.WBProps.date1904)}function eU(e){return!e.Workbook||!e.Workbook.WBProps?"false":Qt(e.Workbook.WBProps.date1904)?"true":"false"}var tU="][*?/\\".split("");function o2(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return tU.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}function nU(e,t,n){e.forEach(function(r,s){o2(r);for(var i=0;i<s;++i)if(r==e[i])throw new Error("Duplicate Sheet Name: "+r);if(n){var l=t&&t[s]&&t[s].CodeName||r;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function rU(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];nU(e.SheetNames,t,!!e.vbaraw);for(var n=0;n<e.SheetNames.length;++n)e7(e.Sheets[e.SheetNames[n]],e.SheetNames[n],n)}var aU=/<\w+:workbook/;function sU(e,t){if(!e)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,s="xmlns",i={},l=0;if(e.replace(pr,function(d,f){var m=lt(d);switch(Ka(m[0])){case"<?xml":break;case"<workbook":d.match(aU)&&(s="xmlns"+d.match(/<(\w+):/)[1]),n.xmlns=m[s];break;case"</workbook>":break;case"<fileVersion":delete m[0],n.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Pg.forEach(function(p){if(m[p[0]]!=null)switch(p[2]){case"bool":n.WBProps[p[0]]=Qt(m[p[0]]);break;case"int":n.WBProps[p[0]]=parseInt(m[p[0]],10);break;default:n.WBProps[p[0]]=m[p[0]]}}),m.codeName&&(n.WBProps.CodeName=Bt(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],n.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=Et(Bt(m.name)),delete m[0],n.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":i={},i.Name=Bt(m.name),m.comment&&(i.Comment=m.comment),m.localSheetId&&(i.Sheet=+m.localSheetId),Qt(m.hidden||"0")&&(i.Hidden=!0),l=f+d.length;break;case"</definedName>":i.Ref=Et(Bt(e.slice(l,f))),n.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete m[0],n.CalcPr=m;break;case"<calcPr/>":delete m[0],n.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&t.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return d}),so.indexOf(n.xmlns)===-1)throw new Error("Unknown Namespace: "+n.xmlns);return i2(n),n}function l2(e){var t=[_n];t[t.length]=He("workbook",null,{xmlns:so[0],"xmlns:r":In.r});var n=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Pg.forEach(function(u){e.Workbook.WBProps[u[0]]!=null&&e.Workbook.WBProps[u[0]]!=u[1]&&(r[u[0]]=e.Workbook.WBProps[u[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=He("workbookPr",null,r);var s=e.Workbook&&e.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var l={name:Lt(e.SheetNames[i].slice(0,31))};if(l.sheetId=""+(i+1),l["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=He("sheet",null,l)}return t[t.length]="</sheets>",n&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(u){var d={name:u.Name};u.Comment&&(d.comment=u.Comment),u.Sheet!=null&&(d.localSheetId=""+u.Sheet),u.Hidden&&(d.hidden="1"),u.Ref&&(t[t.length]=He("definedName",Lt(u.Ref),d))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function iU(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=Km(e),n.name=fr(e),n}function oU(e,t){return t||(t=Ae(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),vg(e.strRelID,t),qn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function lU(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var s=t>8?fr(e):"";return s.length>0&&(n.CodeName=s),n.autoCompressPictures=!!(r&65536),n.backupFile=!!(r&64),n.checkCompatibility=!!(r&4096),n.date1904=!!(r&1),n.filterPrivacy=!!(r&8),n.hidePivotFieldList=!!(r&1024),n.promptedSolutions=!!(r&16),n.publishItems=!!(r&2048),n.refreshAllConnections=!!(r&262144),n.saveExternalLinkValues=!!(r&128),n.showBorderUnselectedTables=!!(r&4),n.showInkAnnotation=!!(r&32),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(r&32768),n.updateLinks=["userSet","never","always"][r>>8&3],n}function cU(e,t){t||(t=Ae(72));var n=0;return e&&e.filterPrivacy&&(n|=8),t.write_shift(4,n),t.write_shift(4,0),Z_(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function uU(e,t){var n={};return e.read_shift(4),n.ArchID=e.read_shift(4),e.l+=t-8,n}function dU(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),i=zL(e),l=KB(e,0,n),u=xg(e);e.l=r;var d={Name:i,Ptg:l};return s<268435455&&(d.Sheet=s),u&&(d.Comment=u),d}function hU(e,t){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],s=!1;t||(t={}),t.biff=12;var i=[],l=[[]];return l.SheetNames=[],l.XTI=[],Qc[16]={n:"BrtFRTArchID$",f:uU},Ns(e,function(d,f,m){switch(m){case 156:l.SheetNames.push(d.name),n.Sheets.push(d);break;case 153:n.WBProps=d;break;case 39:d.Sheet!=null&&(t.SID=d.Sheet),d.Ref=lr(d.Ptg,null,null,l,t),delete t.SID,delete d.Ptg,i.push(d);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([m,d]):l[0]=[m,d],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(d),l.XTI=l.XTI.concat(d);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(m),s=!0;break;case 36:r.pop(),s=!1;break;case 37:r.push(m),s=!0;break;case 38:r.pop(),s=!1;break;case 16:break;default:if(!f.T){if(!s||t.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},t),i2(n),n.Names=i,n.supbooks=l,n}function fU(e,t){Re(e,143);for(var n=0;n!=t.SheetNames.length;++n){var r=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n]&&t.Workbook.Sheets[n].Hidden||0,s={Hidden:r,iTabID:n+1,strRelID:"rId"+(n+1),name:t.SheetNames[n]};Re(e,156,oU(s))}Re(e,144)}function mU(e,t){t||(t=Ae(127));for(var n=0;n!=4;++n)t.write_shift(4,0);return qn("SheetJS",t),qn(yh.version,t),qn(yh.version,t),qn("7262",t),t.length>t.l?t.slice(0,t.l):t}function pU(e,t){t||(t=Ae(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var n=120;return t.write_shift(1,n),t.length>t.l?t.slice(0,t.l):t}function gU(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var n=t.Workbook.Sheets,r=0,s=-1,i=-1;r<n.length;++r)!n[r]||!n[r].Hidden&&s==-1?s=r:n[r].Hidden==1&&i==-1&&(i=r);i>s||(Re(e,135),Re(e,158,pU(s)),Re(e,136))}}function xU(e,t){var n=Or();return Re(n,131),Re(n,128,mU()),Re(n,153,cU(e.Workbook&&e.Workbook.WBProps||null)),gU(n,e),fU(n,e),Re(n,132),n.end()}function vU(e,t,n){return t.slice(-4)===".bin"?hU(e,n):sU(e,n)}function yU(e,t,n,r,s,i,l,u){return t.slice(-4)===".bin"?D9(e,r,n,s,i,l,u):d7(e,r,n,s,i,l,u)}function kU(e,t,n,r,s,i,l,u){return t.slice(-4)===".bin"?X9(e,r,n,s,i):K9(e,r,n,s,i)}function wU(e,t,n,r,s,i,l,u){return t.slice(-4)===".bin"?_5():C5()}function SU(e,t,n,r,s,i,l,u){return t.slice(-4)===".bin"?w5():S5()}function _U(e,t,n,r){return t.slice(-4)===".bin"?v8(e,n,r):i8(e,n,r)}function CU(e,t,n){return WC(e,n)}function NU(e,t,n){return t.slice(-4)===".bin"?NM(e,n):SM(e,n)}function EU(e,t,n){return t.slice(-4)===".bin"?g5(e,n):o5(e,n)}function TU(e,t,n){return t.slice(-4)===".bin"?a5(e):n5(e)}function bU(e,t,n,r){return n.slice(-4)===".bin"?s5(e,t,n,r):void 0}function AU(e,t,n){return t.slice(-4)===".bin"?Z8(e,t,n):t5(e,t,n)}function jU(e,t,n){return(t.slice(-4)===".bin"?xU:l2)(e)}function RU(e,t,n,r,s){return(t.slice(-4)===".bin"?$9:r2)(e,n,r,s)}function IU(e,t,n){return(t.slice(-4)===".bin"?b8:UC)(e,n)}function PU(e,t,n){return(t.slice(-4)===".bin"?bM:IC)(e,n)}function DU(e,t,n){return(t.slice(-4)===".bin"?x5:$C)(e)}function OU(e){return(e.slice(-4)===".bin"?e5:HC)()}var c2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,u2=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ca(e,t){var n=e.split(/\s+/),r=[];if(r[0]=n[0],n.length===1)return r;var s=e.match(c2),i,l,u,d;if(s)for(d=0;d!=s.length;++d)i=s[d].match(u2),(l=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?u="xmlns"+i[1].slice(6):u=i[1].slice(l+1),r[u]=i[2].slice(1,i[2].length-1));return r}function LU(e){var t=e.split(/\s+/),n={};if(t.length===1)return n;var r=e.match(c2),s,i,l,u;if(r)for(u=0;u!=r.length;++u)s=r[u].match(u2),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(i+1),n[l]=s[2].slice(1,s[2].length-1));return n}var Tc;function FU(e,t){var n=Tc[e]||Et(e);return n==="General"?Qi(t):da(n,t)}function MU(e,t,n,r){var s=r;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Qt(r);break;case"i2":case"int":s=parseInt(r,10);break;case"r4":case"float":s=parseFloat(r);break;case"date":case"dateTime.tz":s=Jt(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}e[Et(t)]=s}function BU(e,t,n){if(e.t!=="z"){if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||Es[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Wc(e.v):e.w=Qi(e.v):e.w=FU(t||"General",e.v)}catch(i){if(n.WTF)throw i}try{var r=Tc[t]||t||"General";if(n.cellNF&&(e.z=r),n.cellDates&&e.t=="n"&&xl(r)){var s=Bi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(n.WTF)throw i}}}function UU(e,t,n){if(n.cellStyles&&t.Interior){var r=t.Interior;r.Pattern&&(r.patternType=JM[r.Pattern]||r.Pattern)}e[t.ID]=t}function zU(e,t,n,r,s,i,l,u,d,f){var m="General",p=r.StyleID,x={};f=f||{};var v=[],k=0;for(p===void 0&&u&&(p=u.StyleID),p===void 0&&l&&(p=l.StyleID);i[p]!==void 0&&(i[p].nf&&(m=i[p].nf),i[p].Interior&&v.push(i[p].Interior),!!i[p].Parent);)p=i[p].Parent;switch(n.Type){case"Boolean":r.t="b",r.v=Qt(e);break;case"String":r.t="s",r.r=dk(Et(e)),r.v=e.indexOf("<")>-1?Et(t||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),r.v=(Jt(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),r.v!==r.v?r.v=Et(e):r.v<60&&(r.v=r.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=aC[e],f.cellText!==!1&&(r.w=e);break;default:e==""&&t==""?r.t="z":(r.t="s",r.v=dk(t||e));break}if(BU(r,m,f),f.cellFormula!==!1)if(r.Formula){var y=Et(r.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),r.f=el(y,s),delete r.Formula,r.ArrayRange=="RC"?r.F=el("RC:RC",s):r.ArrayRange&&(r.F=el(r.ArrayRange,s),d.push([Tt(r.F),r.F]))}else for(k=0;k<d.length;++k)s.r>=d[k][0].s.r&&s.r<=d[k][0].e.r&&s.c>=d[k][0].s.c&&s.c<=d[k][0].e.c&&(r.F=d[k][1]);f.cellStyles&&(v.forEach(function(S){!x.patternType&&S.patternType&&(x.patternType=S.patternType)}),r.s=x),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function WU(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function hm(e,t){var n=t||{};vl();var r=hc(dg(e));(n.type=="binary"||n.type=="array"||n.type=="base64")&&(r=Bt(r));var s=r.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var l=Zt(n);return l.type="string",ll.to_workbook(r,l)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(fe){s.indexOf("<"+fe)>=0&&(i=!0)}),i)return Tz(r,n);Tc={"General Number":"General","General Date":st[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":st[15],"Short Date":st[14],"Long Time":st[19],"Medium Time":st[18],"Short Time":st[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:st[2],Standard:st[4],Percent:st[10],Scientific:st[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,d=[],f,m={},p=[],x=n.dense?[]:{},v="",k={},y={},S=Ca('<Data ss:Type="String">'),C=0,D=0,N=0,b={s:{r:2e6,c:2e6},e:{r:0,c:0}},H={},L={},R="",q=0,O=[],V={},X={},M=0,me=[],ae=[],ce={},ue=[],K,W=!1,j=[],F=[],U={},I=0,Z=0,Y={Sheets:[],WBProps:{date1904:!1}},P={};$c.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var ne="";u=$c.exec(r);)switch(u[3]=(ne=u[3]).toLowerCase()){case"data":if(ne=="data"){if(u[1]==="/"){if((f=d.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break}if(d[d.length-1][1])break;u[1]==="/"?zU(r.slice(C,u.index),R,S,d[d.length-1][0]=="comment"?ce:k,{c:D,r:N},H,ue[D],y,j,n):(R="",S=Ca(u[0]),C=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(ae.length>0&&(k.c=ae),(!n.sheetRows||n.sheetRows>N)&&k.v!==void 0&&(n.dense?(x[N]||(x[N]=[]),x[N][D]=k):x[on(D)+Sn(N)]=k),k.HRef&&(k.l={Target:Et(k.HRef)},k.HRefScreenTip&&(k.l.Tooltip=k.HRefScreenTip),delete k.HRef,delete k.HRefScreenTip),(k.MergeAcross||k.MergeDown)&&(I=D+(parseInt(k.MergeAcross,10)|0),Z=N+(parseInt(k.MergeDown,10)|0),O.push({s:{c:D,r:N},e:{c:I,r:Z}})),!n.sheetStubs)k.MergeAcross?D=I+1:++D;else if(k.MergeAcross||k.MergeDown){for(var J=D;J<=I;++J)for(var de=N;de<=Z;++de)(J>D||de>N)&&(n.dense?(x[de]||(x[de]=[]),x[de][J]={t:"z"}):x[on(J)+Sn(de)]={t:"z"});D=I+1}else++D;else k=LU(u[0]),k.Index&&(D=+k.Index-1),D<b.s.c&&(b.s.c=D),D>b.e.c&&(b.e.c=D),u[0].slice(-2)==="/>"&&++D,ae=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(N<b.s.r&&(b.s.r=N),N>b.e.r&&(b.e.r=N),u[0].slice(-2)==="/>"&&(y=Ca(u[0]),y.Index&&(N=+y.Index-1)),D=0,++N):(y=Ca(u[0]),y.Index&&(N=+y.Index-1),U={},(y.AutoFitHeight=="0"||y.Height)&&(U.hpx=parseInt(y.Height,10),U.hpt=Xc(U.hpx),F[N]=U),y.Hidden=="1"&&(U.hidden=!0,F[N]=U));break;case"worksheet":if(u[1]==="/"){if((f=d.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"));p.push(v),b.s.r<=b.e.r&&b.s.c<=b.e.c&&(x["!ref"]=ft(b),n.sheetRows&&n.sheetRows<=b.e.r&&(x["!fullref"]=x["!ref"],b.e.r=n.sheetRows-1,x["!ref"]=ft(b))),O.length&&(x["!merges"]=O),ue.length>0&&(x["!cols"]=ue),F.length>0&&(x["!rows"]=F),m[v]=x}else b={s:{r:2e6,c:2e6},e:{r:0,c:0}},N=D=0,d.push([u[3],!1]),f=Ca(u[0]),v=Et(f.Name),x=n.dense?[]:{},O=[],j=[],F=[],P={name:v,Hidden:0},Y.Sheets.push(P);break;case"table":if(u[1]==="/"){if((f=d.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"))}else{if(u[0].slice(-2)=="/>")break;d.push([u[3],!1]),ue=[],W=!1}break;case"style":u[1]==="/"?UU(H,L,n):L=Ca(u[0]);break;case"numberformat":L.nf=Et(Ca(u[0]).Format||"General"),Tc[L.nf]&&(L.nf=Tc[L.nf]);for(var E=0;E!=392&&st[E]!=L.nf;++E);if(E==392){for(E=57;E!=392;++E)if(st[E]==null){ms(L.nf,E);break}}break;case"column":if(d[d.length-1][0]!=="table")break;if(K=Ca(u[0]),K.Hidden&&(K.hidden=!0,delete K.Hidden),K.Width&&(K.wpx=parseInt(K.Width,10)),!W&&K.wpx>10){W=!0,ur=MC;for(var A=0;A<ue.length;++A)ue[A]&&ci(ue[A])}W&&ci(K),ue[K.Index-1||ue.length]=K;for(var he=0;he<+K.Span;++he)ue[ue.length]=Zt(K);break;case"namedrange":if(u[1]==="/")break;Y.Names||(Y.Names=[]);var G=lt(u[0]),Ie={Name:G.Name,Ref:el(G.RefersTo.slice(1),{r:0,c:0})};Y.Sheets.length>0&&(Ie.Sheet=Y.Sheets.length-1),Y.Names.push(Ie);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?R+=r.slice(q,u.index):q=u.index+u[0].length;break;case"interior":if(!n.cellStyles)break;L.Interior=Ca(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?hF(V,ne,r.slice(M,u.index)):M=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((f=d.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"))}else d.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((f=d.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"));WU(ce),ae.push(ce)}else d.push([u[3],!1]),f=Ca(u[0]),ce={a:f.Author};break;case"autofilter":if(u[1]==="/"){if((f=d.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var oe=Ca(u[0]);x["!autofilter"]={ref:el(oe.Range).replace(/\$/g,"")},d.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((f=d.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((f=d.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break;case"null":break;default:if(d.length==0&&u[3]=="document"||d.length==0&&u[3]=="uof")return Zk(r,n);var Te=!0;switch(d[d.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Te=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Te=!1}break;case"excelworkbook":switch(u[3]){case"date1904":Y.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Te=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:Te=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(r.slice(M,u.index)){case"SheetHidden":P.Hidden=1;break;case"SheetVeryHidden":P.Hidden=2;break}else M=u.index+u[0].length;break;case"header":x["!margins"]||Hi(x["!margins"]={},"xlml"),isNaN(+lt(u[0]).Margin)||(x["!margins"].header=+lt(u[0]).Margin);break;case"footer":x["!margins"]||Hi(x["!margins"]={},"xlml"),isNaN(+lt(u[0]).Margin)||(x["!margins"].footer=+lt(u[0]).Margin);break;case"pagemargins":var xe=lt(u[0]);x["!margins"]||Hi(x["!margins"]={},"xlml"),isNaN(+xe.Top)||(x["!margins"].top=+xe.Top),isNaN(+xe.Left)||(x["!margins"].left=+xe.Left),isNaN(+xe.Right)||(x["!margins"].right=+xe.Right),isNaN(+xe.Bottom)||(x["!margins"].bottom=+xe.Bottom);break;case"displayrighttoleft":Y.Views||(Y.Views=[]),Y.Views[0]||(Y.Views[0]={}),Y.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Te=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Te=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Te=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Te=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Te=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Te=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Te=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Te=!1}break;case"smarttags":break;default:Te=!1;break}if(Te||u[3].match(/!\[CDATA/))break;if(!d[d.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+d.join("|");if(d[d.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?MU(X,ne,me,r.slice(M,u.index)):(me=u,M=u.index+u[0].length);break}if(n.WTF)throw"Unrecognized tag: "+u[3]+"|"+d.join("|")}var we={};return!n.bookSheets&&!n.bookProps&&(we.Sheets=m),we.SheetNames=p,we.Workbook=Y,we.SSF=Zt(st),we.Props=V,we.Custprops=X,we}function tp(e,t){switch(Og(t=t||{}),t.type||"base64"){case"base64":return hm(Qr(e),t);case"binary":case"buffer":case"file":return hm(e,t);case"array":return hm(mi(e),t)}}function HU(e,t){var n=[];return e.Props&&n.push(fF(e.Props,t)),e.Custprops&&n.push(mF(e.Props,e.Custprops)),n.join("")}function GU(){return""}function $U(e,t){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(r,s){var i=[];i.push(He("NumberFormat",null,{"ss:Format":Lt(st[r.numFmtId])}));var l={"ss:ID":"s"+(21+s)};n.push(He("Style",i.join(""),l))}),He("Styles",n.join(""))}function d2(e){return He("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Ag(e.Ref,{r:0,c:0})})}function VU(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],r=0;r<t.length;++r){var s=t[r];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||n.push(d2(s)))}return He("Names",n.join(""))}function qU(e,t,n,r){if(!e||!((r||{}).Workbook||{}).Names)return"";for(var s=r.Workbook.Names,i=[],l=0;l<s.length;++l){var u=s[l];u.Sheet==n&&(u.Name.match(/^_xlfn\./)||i.push(d2(u)))}return i.join("")}function KU(e,t,n,r){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(He("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(He("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(He("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)s.push(He("Visible",r.Workbook.Sheets[n].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<n&&!(r.Workbook.Sheets[i]&&!r.Workbook.Sheets[i].Hidden);++i);i==n&&s.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(er("ProtectContents","True")),e["!protect"].objects&&s.push(er("ProtectObjects","True")),e["!protect"].scenarios&&s.push(er("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(er("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(er("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&s.push("<"+l[1]+"/>")})),s.length==0?"":He("WorksheetOptions",s.join(""),{xmlns:Wr.x})}function YU(e){return e.map(function(t){var n=gL(t.t||""),r=He("ss:Data",n,{xmlns:"http://www.w3.org/TR/REC-html40"});return He("Comment",r,{"ss:Author":t.a})}).join("")}function XU(e,t,n,r,s,i,l){if(!e||e.v==null&&e.f==null)return"";var u={};if(e.f&&(u["ss:Formula"]="="+Lt(Ag(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var d=ln(e.F.slice(t.length+1));u["ss:ArrayRange"]="RC:R"+(d.r==l.r?"":"["+(d.r-l.r)+"]")+"C"+(d.c==l.c?"":"["+(d.c-l.c)+"]")}if(e.l&&e.l.Target&&(u["ss:HRef"]=Lt(e.l.Target),e.l.Tooltip&&(u["x:HRefScreenTip"]=Lt(e.l.Tooltip))),n["!merges"])for(var f=n["!merges"],m=0;m!=f.length;++m)f[m].s.c!=l.c||f[m].s.r!=l.r||(f[m].e.c>f[m].s.c&&(u["ss:MergeAcross"]=f[m].e.c-f[m].s.c),f[m].e.r>f[m].s.r&&(u["ss:MergeDown"]=f[m].e.r-f[m].s.r));var p="",x="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":p="Number",x=String(e.v);break;case"b":p="Boolean",x=e.v?"1":"0";break;case"e":p="Error",x=Es[e.v];break;case"d":p="DateTime",x=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||st[14]);break;case"s":p="String",x=pL(e.v||"");break}var v=gi(r.cellXfs,e,r);u["ss:StyleID"]="s"+(21+v),u["ss:Index"]=l.c+1;var k=e.v!=null?x:"",y=e.t=="z"?"":'<Data ss:Type="'+p+'">'+k+"</Data>";return(e.c||[]).length>0&&(y+=YU(e.c)),He("Cell",y,u)}function QU(e,t){var n='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=cl(t.hpt)),t.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(n+=' ss:Hidden="1"')),n+">"}function JU(e,t,n,r){if(!e["!ref"])return"";var s=Tt(e["!ref"]),i=e["!merges"]||[],l=0,u=[];e["!cols"]&&e["!cols"].forEach(function(S,C){ci(S);var D=!!S.width,N=ef(C,S),b={"ss:Index":C+1};D&&(b["ss:Width"]=Kc(N.width)),S.hidden&&(b["ss:Hidden"]="1"),u.push(He("Column",null,b))});for(var d=Array.isArray(e),f=s.s.r;f<=s.e.r;++f){for(var m=[QU(f,(e["!rows"]||[])[f])],p=s.s.c;p<=s.e.c;++p){var x=!1;for(l=0;l!=i.length;++l)if(!(i[l].s.c>p)&&!(i[l].s.r>f)&&!(i[l].e.c<p)&&!(i[l].e.r<f)){(i[l].s.c!=p||i[l].s.r!=f)&&(x=!0);break}if(!x){var v={r:f,c:p},k=it(v),y=d?(e[f]||[])[p]:e[k];m.push(XU(y,k,e,t,n,r,v))}}m.push("</Row>"),m.length>2&&u.push(m.join(""))}return u.join("")}function ZU(e,t,n){var r=[],s=n.SheetNames[e],i=n.Sheets[s],l=i?qU(i,t,e,n):"";return l.length>0&&r.push("<Names>"+l+"</Names>"),l=i?JU(i,t,e,n):"",l.length>0&&r.push("<Table>"+l+"</Table>"),r.push(KU(i,t,e,n)),r.join("")}function ez(e,t){t||(t={}),e.SSF||(e.SSF=Zt(st)),e.SSF&&(vl(),qh(e.SSF),t.revssf=Yh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],gi(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(HU(e,t)),n.push(GU()),n.push(""),n.push("");for(var r=0;r<e.SheetNames.length;++r)n.push(He("Worksheet",ZU(r,t,e),{"ss:Name":Lt(e.SheetNames[r])}));return n[2]=$U(e,t),n[3]=VU(e),_n+He("Workbook",n.join(""),{xmlns:Wr.ss,"xmlns:o":Wr.o,"xmlns:x":Wr.x,"xmlns:ss":Wr.ss,"xmlns:dt":Wr.dt,"xmlns:html":Wr.html})}function tz(e){var t={},n=e.content;if(n.l=28,t.AnsiUserType=n.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=VL(n),n.length-n.l<=4)return t;var r=n.read_shift(4);if(r==0||r>40||(n.l-=4,t.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4)||(r=n.read_shift(4),r!==1907505652)||(t.UnicodeClipboardFormat=qL(n),r=n.read_shift(4),r==0||r>40))return t;n.l-=4,t.Reserved2=n.read_shift(0,"lpwstr")}var nz=[60,1084,2066,2165,2175];function rz(e,t,n,r,s){var i=r,l=[],u=n.slice(n.l,n.l+i);if(s&&s.enc&&s.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(u)}l.push(u),n.l+=i;for(var d=cs(n,n.l),f=np[d],m=0;f!=null&&nz.indexOf(d)>-1;)i=cs(n,n.l+2),m=n.l+4,d==2066?m+=4:(d==2165||d==2175)&&(m+=12),u=n.slice(m,n.l+4+i),l.push(u),n.l+=4+i,f=np[d=cs(n,n.l)];var p=Vn(l);Qn(p,0);var x=0;p.lens=[];for(var v=0;v<l.length;++v)p.lens.push(x),x+=l[v].length;if(p.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+p.length+" < "+r;return t.f(p,p.length,s)}function Wa(e,t,n){if(e.t!=="z"&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=st[r])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Es[e.v]:r===0||r=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Wc(e.v):e.w=Qi(e.v):e.w=da(r,e.v,{date1904:!!n,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&r&&e.t=="n"&&xl(st[r]||String(r))){var s=Bi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function zd(e,t,n){return{v:e,ixfe:t,t:n}}function az(e,t){var n={opts:{}},r={},s=t.dense?[]:{},i={},l={},u=null,d=[],f="",m={},p,x="",v,k,y,S,C={},D=[],N,b,H=[],L=[],R={Sheets:[],WBProps:{date1904:!1},Views:[{}]},q={},O=function(qe){return qe<8?Ui[qe]:qe<64&&L[qe-8]||Ui[qe]},V=function(qe,ot,Mt){var Ct=ot.XF.data;if(!(!Ct||!Ct.patternType||!Mt||!Mt.cellStyles)){ot.s={},ot.s.patternType=Ct.patternType;var rn;(rn=qc(O(Ct.icvFore)))&&(ot.s.fgColor={rgb:rn}),(rn=qc(O(Ct.icvBack)))&&(ot.s.bgColor={rgb:rn})}},X=function(qe,ot,Mt){if(!(U>1)&&!(Mt.sheetRows&&qe.r>=Mt.sheetRows)){if(Mt.cellStyles&&ot.XF&&ot.XF.data&&V(qe,ot,Mt),delete ot.ixfe,delete ot.XF,p=qe,x=it(qe),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),qe.r<l.s.r&&(l.s.r=qe.r),qe.c<l.s.c&&(l.s.c=qe.c),qe.r+1>l.e.r&&(l.e.r=qe.r+1),qe.c+1>l.e.c&&(l.e.c=qe.c+1),Mt.cellFormula&&ot.f){for(var Ct=0;Ct<D.length;++Ct)if(!(D[Ct][0].s.c>qe.c||D[Ct][0].s.r>qe.r)&&!(D[Ct][0].e.c<qe.c||D[Ct][0].e.r<qe.r)){ot.F=ft(D[Ct][0]),(D[Ct][0].s.c!=qe.c||D[Ct][0].s.r!=qe.r)&&delete ot.f,ot.f&&(ot.f=""+lr(D[Ct][1],l,qe,j,M));break}}Mt.dense?(s[qe.r]||(s[qe.r]=[]),s[qe.r][qe.c]=ot):s[x]=ot}},M={enc:!1,sbcch:0,snames:[],sharedf:C,arrayf:D,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(M.password=t.password);var me,ae=[],ce=[],ue=[],K=[],W=!1,j=[];j.SheetNames=M.snames,j.sharedf=M.sharedf,j.arrayf=M.arrayf,j.names=[],j.XTI=[];var F=0,U=0,I=0,Z=[],Y=[],P;M.codepage=1200,ja(1200);for(var ne=!1;e.l<e.length-1;){var J=e.l,de=e.read_shift(2);if(de===0&&F===10)break;var E=e.l===e.length?0:e.read_shift(2),A=np[de];if(A&&A.f){if(t.bookSheets&&F===133&&de!==133)break;if(F=de,A.r===2||A.r==12){var he=e.read_shift(2);if(E-=2,!M.enc&&he!==de&&((he&255)<<8|he>>8)!==de)throw new Error("rt mismatch: "+he+"!="+de);A.r==12&&(e.l+=10,E-=10)}var G={};if(de===10?G=A.f(e,E,M):G=rz(de,A,e,E,M),U==0&&[9,521,1033,2057].indexOf(F)===-1)continue;switch(de){case 34:n.opts.Date1904=R.WBProps.date1904=G;break;case 134:n.opts.WriteProtect=!0;break;case 47:if(M.enc||(e.l=0),M.enc=G,!t.password)throw new Error("File is password-protected");if(G.valid==null)throw new Error("Encryption scheme unsupported");if(!G.valid)throw new Error("Password is incorrect");break;case 92:M.lastuser=G;break;case 66:var Ie=Number(G);switch(Ie){case 21010:Ie=1200;break;case 32768:Ie=1e4;break;case 32769:Ie=1252;break}ja(M.codepage=Ie),ne=!0;break;case 317:M.rrtabid=G;break;case 25:M.winlocked=G;break;case 439:n.opts.RefreshAll=G;break;case 12:n.opts.CalcCount=G;break;case 16:n.opts.CalcDelta=G;break;case 17:n.opts.CalcIter=G;break;case 13:n.opts.CalcMode=G;break;case 14:n.opts.CalcPrecision=G;break;case 95:n.opts.CalcSaveRecalc=G;break;case 15:M.CalcRefMode=G;break;case 2211:n.opts.FullCalc=G;break;case 129:G.fDialog&&(s["!type"]="dialog"),G.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),G.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:H.push(G);break;case 430:j.push([G]),j[j.length-1].XTI=[];break;case 35:case 547:j[j.length-1].push(G);break;case 24:case 536:P={Name:G.Name,Ref:lr(G.rgce,l,null,j,M)},G.itab>0&&(P.Sheet=G.itab-1),j.names.push(P),j[0]||(j[0]=[],j[0].XTI=[]),j[j.length-1].push(G),G.Name=="_xlnm._FilterDatabase"&&G.itab>0&&G.rgce&&G.rgce[0]&&G.rgce[0][0]&&G.rgce[0][0][0]=="PtgArea3d"&&(Y[G.itab-1]={ref:ft(G.rgce[0][0][1][2])});break;case 22:M.ExternCount=G;break;case 23:j.length==0&&(j[0]=[],j[0].XTI=[]),j[j.length-1].XTI=j[j.length-1].XTI.concat(G),j.XTI=j.XTI.concat(G);break;case 2196:if(M.biff<8)break;P!=null&&(P.Comment=G[1]);break;case 18:s["!protect"]=G;break;case 19:G!==0&&M.WTF&&console.error("Password verifier: "+G);break;case 133:i[G.pos]=G,M.snames.push(G.name);break;case 10:{if(--U)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,s["!ref"]=ft(l),t.sheetRows&&t.sheetRows<=l.e.r){var oe=l.e.r;l.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=ft(l),l.e.r=oe}l.e.r++,l.e.c++}ae.length>0&&(s["!merges"]=ae),ce.length>0&&(s["!objects"]=ce),ue.length>0&&(s["!cols"]=ue),K.length>0&&(s["!rows"]=K),R.Sheets.push(q)}f===""?m=s:r[f]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(M.biff===8&&(M.biff={9:2,521:3,1033:4}[de]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[G.BIFFVer]||8),M.biffguess=G.BIFFVer==0,G.BIFFVer==0&&G.dt==4096&&(M.biff=5,ne=!0,ja(M.codepage=28591)),M.biff==8&&G.BIFFVer==0&&G.dt==16&&(M.biff=2),U++)break;if(s=t.dense?[]:{},M.biff<8&&!ne&&(ne=!0,ja(M.codepage=t.codepage||1252)),M.biff<5||G.BIFFVer==0&&G.dt==4096){f===""&&(f="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var Te={pos:e.l-E,name:f};i[Te.pos]=Te,M.snames.push(f)}else f=(i[J]||{name:""}).name;G.dt==32&&(s["!type"]="chart"),G.dt==64&&(s["!type"]="macro"),ae=[],ce=[],M.arrayf=D=[],ue=[],K=[],W=!1,q={Hidden:(i[J]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[G.r]||[])[G.c]:s[it({c:G.c,r:G.r})])&&++G.c,N={ixfe:G.ixfe,XF:H[G.ixfe]||{},v:G.val,t:"n"},I>0&&(N.z=Z[N.ixfe>>8&63]),Wa(N,t,n.opts.Date1904),X({c:G.c,r:G.r},N,t);break;case 5:case 517:N={ixfe:G.ixfe,XF:H[G.ixfe],v:G.val,t:G.t},I>0&&(N.z=Z[N.ixfe>>8&63]),Wa(N,t,n.opts.Date1904),X({c:G.c,r:G.r},N,t);break;case 638:N={ixfe:G.ixfe,XF:H[G.ixfe],v:G.rknum,t:"n"},I>0&&(N.z=Z[N.ixfe>>8&63]),Wa(N,t,n.opts.Date1904),X({c:G.c,r:G.r},N,t);break;case 189:for(var xe=G.c;xe<=G.C;++xe){var we=G.rkrec[xe-G.c][0];N={ixfe:we,XF:H[we],v:G.rkrec[xe-G.c][1],t:"n"},I>0&&(N.z=Z[N.ixfe>>8&63]),Wa(N,t,n.opts.Date1904),X({c:xe,r:G.r},N,t)}break;case 6:case 518:case 1030:{if(G.val=="String"){u=G;break}if(N=zd(G.val,G.cell.ixfe,G.tt),N.XF=H[N.ixfe],t.cellFormula){var fe=G.formula;if(fe&&fe[0]&&fe[0][0]&&fe[0][0][0]=="PtgExp"){var ye=fe[0][0][1][0],ee=fe[0][0][1][1],Pe=it({r:ye,c:ee});C[Pe]?N.f=""+lr(G.formula,l,G.cell,j,M):N.F=((t.dense?(s[ye]||[])[ee]:s[Pe])||{}).F}else N.f=""+lr(G.formula,l,G.cell,j,M)}I>0&&(N.z=Z[N.ixfe>>8&63]),Wa(N,t,n.opts.Date1904),X(G.cell,N,t),u=G}break;case 7:case 519:if(u)u.val=G,N=zd(G,u.cell.ixfe,"s"),N.XF=H[N.ixfe],t.cellFormula&&(N.f=""+lr(u.formula,l,u.cell,j,M)),I>0&&(N.z=Z[N.ixfe>>8&63]),Wa(N,t,n.opts.Date1904),X(u.cell,N,t),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{D.push(G);var Fe=it(G[0].s);if(v=t.dense?(s[G[0].s.r]||[])[G[0].s.c]:s[Fe],t.cellFormula&&v){if(!u||!Fe||!v)break;v.f=""+lr(G[1],l,G[0],j,M),v.F=ft(G[0])}}break;case 1212:{if(!t.cellFormula)break;if(x){if(!u)break;C[it(u.cell)]=G[0],v=t.dense?(s[u.cell.r]||[])[u.cell.c]:s[it(u.cell)],(v||{}).f=""+lr(G[0],l,p,j,M)}}break;case 253:N=zd(d[G.isst].t,G.ixfe,"s"),d[G.isst].h&&(N.h=d[G.isst].h),N.XF=H[N.ixfe],I>0&&(N.z=Z[N.ixfe>>8&63]),Wa(N,t,n.opts.Date1904),X({c:G.c,r:G.r},N,t);break;case 513:t.sheetStubs&&(N={ixfe:G.ixfe,XF:H[G.ixfe],t:"z"},I>0&&(N.z=Z[N.ixfe>>8&63]),Wa(N,t,n.opts.Date1904),X({c:G.c,r:G.r},N,t));break;case 190:if(t.sheetStubs)for(var et=G.c;et<=G.C;++et){var dt=G.ixfe[et-G.c];N={ixfe:dt,XF:H[dt],t:"z"},I>0&&(N.z=Z[N.ixfe>>8&63]),Wa(N,t,n.opts.Date1904),X({c:et,r:G.r},N,t)}break;case 214:case 516:case 4:N=zd(G.val,G.ixfe,"s"),N.XF=H[N.ixfe],I>0&&(N.z=Z[N.ixfe>>8&63]),Wa(N,t,n.opts.Date1904),X({c:G.c,r:G.r},N,t);break;case 0:case 512:U===1&&(l=G);break;case 252:d=G;break;case 1054:if(M.biff==4){Z[I++]=G[1];for(var jt=0;jt<I+163&&st[jt]!=G[1];++jt);jt>=163&&ms(G[1],I+163)}else ms(G[1],G[0]);break;case 30:{Z[I++]=G;for(var un=0;un<I+163&&st[un]!=G;++un);un>=163&&ms(G,I+163)}break;case 229:ae=ae.concat(G);break;case 93:ce[G.cmo[0]]=M.lastobj=G;break;case 438:M.lastobj.TxO=G;break;case 127:M.lastobj.ImData=G;break;case 440:for(S=G[0].s.r;S<=G[0].e.r;++S)for(y=G[0].s.c;y<=G[0].e.c;++y)v=t.dense?(s[S]||[])[y]:s[it({c:y,r:S})],v&&(v.l=G[1]);break;case 2048:for(S=G[0].s.r;S<=G[0].e.r;++S)for(y=G[0].s.c;y<=G[0].e.c;++y)v=t.dense?(s[S]||[])[y]:s[it({c:y,r:S})],v&&v.l&&(v.l.Tooltip=G[1]);break;case 28:{if(M.biff<=5&&M.biff>=2)break;v=t.dense?(s[G[0].r]||[])[G[0].c]:s[it(G[0])];var gr=ce[G[2]];v||(t.dense?(s[G[0].r]||(s[G[0].r]=[]),v=s[G[0].r][G[0].c]={t:"z"}):v=s[it(G[0])]={t:"z"},l.e.r=Math.max(l.e.r,G[0].r),l.s.r=Math.min(l.s.r,G[0].r),l.e.c=Math.max(l.e.c,G[0].c),l.s.c=Math.min(l.s.c,G[0].c)),v.c||(v.c=[]),k={a:G[1],t:gr.TxO.t},v.c.push(k)}break;case 2173:$8(H[G.ixfe],G.ext);break;case 125:{if(!M.cellStyles)break;for(;G.e>=G.s;)ue[G.e--]={width:G.w/256,level:G.level||0,hidden:!!(G.flags&1)},W||(W=!0,Eg(G.w/256)),ci(ue[G.e+1])}break;case 520:{var ge={};G.level!=null&&(K[G.r]=ge,ge.level=G.level),G.hidden&&(K[G.r]=ge,ge.hidden=!0),G.hpt&&(K[G.r]=ge,ge.hpt=G.hpt,ge.hpx=cl(G.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Hi(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[de]]=G;break;case 161:s["!margins"]||Hi(s["!margins"]={}),s["!margins"].header=G.header,s["!margins"].footer=G.footer;break;case 574:G.RTL&&(R.Views[0].RTL=!0);break;case 146:L=G;break;case 2198:me=G;break;case 140:b=G;break;case 442:f?q.CodeName=G||q.name:R.WBProps.CodeName=G||"ThisWorkbook";break}}else A||console.error("Missing Info for XLS Record 0x"+de.toString(16)),e.l+=E}return n.SheetNames=pn(i).sort(function(Je,qe){return Number(Je)-Number(qe)}).map(function(Je){return i[Je].name}),t.bookSheets||(n.Sheets=r),!n.SheetNames.length&&m["!ref"]?(n.SheetNames.push("Sheet1"),n.Sheets&&(n.Sheets.Sheet1=m)):n.Preamble=m,n.Sheets&&Y.forEach(function(Je,qe){n.Sheets[n.SheetNames[qe]]["!autofilter"]=Je}),n.Strings=d,n.SSF=Zt(st),M.enc&&(n.Encryption=M.enc),me&&(n.Themes=me),n.Metadata={},b!==void 0&&(n.Metadata.Country=b),j.names.length>0&&(R.Names=j.names),n.Workbook=R,n}var bc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function sz(e,t,n){var r=nt.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var s=Ak(r,Ym,bc.DSI);for(var i in s)t[i]=s[i]}catch(f){if(n.WTF)throw f}var l=nt.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var u=Ak(l,Xm,bc.SI);for(var d in u)t[d]==null&&(t[d]=u[d])}catch(f){if(n.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(uC(t.HeadingPairs,t.TitlesOfParts,t,n),delete t.HeadingPairs,delete t.TitlesOfParts)}function iz(e,t){var n=[],r=[],s=[],i=0,l,u=sk(Ym,"n"),d=sk(Xm,"n");if(e.Props)for(l=pn(e.Props),i=0;i<l.length;++i)(Object.prototype.hasOwnProperty.call(u,l[i])?n:Object.prototype.hasOwnProperty.call(d,l[i])?r:s).push([l[i],e.Props[l[i]]]);if(e.Custprops)for(l=pn(e.Custprops),i=0;i<l.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},l[i])||(Object.prototype.hasOwnProperty.call(u,l[i])?n:Object.prototype.hasOwnProperty.call(d,l[i])?r:s).push([l[i],e.Custprops[l[i]]]);var f=[];for(i=0;i<s.length;++i)xC.indexOf(s[i][0])>-1||cC.indexOf(s[i][0])>-1||s[i][1]!=null&&f.push(s[i]);r.length&&nt.utils.cfb_add(t,"/SummaryInformation",jk(r,bc.SI,d,Xm)),(n.length||f.length)&&nt.utils.cfb_add(t,"/DocumentSummaryInformation",jk(n,bc.DSI,u,Ym,f.length?f:null,bc.UDI))}function h2(e,t){t||(t={}),Og(t),ng(),t.codepage&&tg(t.codepage);var n,r;if(e.FullPaths){if(nt.find(e,"/encryption"))throw new Error("File is password-protected");n=nt.find(e,"!CompObj"),r=nt.find(e,"/Workbook")||nt.find(e,"/Book")}else{switch(t.type){case"base64":e=$r(Qr(e));break;case"binary":e=$r(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Qn(e,0),r={content:e}}var s,i;if(n&&tz(n),t.bookProps&&!t.bookSheets)s={};else{var l=pt?"buffer":"array";if(r&&r.content)s=az(r.content,t);else if((i=nt.find(e,"PerfectOffice_MAIN"))&&i.content)s=Wi.to_workbook(i.content,(t.type=l,t));else if((i=nt.find(e,"NativeContent_MAIN"))&&i.content)s=Wi.to_workbook(i.content,(t.type=l,t));else throw(i=nt.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&nt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=y5(e))}var u={};return e.FullPaths&&sz(e,u,t),s.Props=s.Custprops=u,t.bookFiles&&(s.cfb=e),s}function oz(e,t){var n=t||{},r=nt.utils.cfb_new({root:"R"}),s="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":s="/Workbook",n.biff=8;break;case"biff5":s="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return nt.utils.cfb_add(r,s,f2(e,n)),n.biff==8&&(e.Props||e.Custprops)&&iz(e,r),n.biff==8&&e.vbaraw&&k5(r,nt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),r}var Qc={0:{f:R7},1:{f:B7},2:{f:a9},3:{f:q7},4:{f:H7},5:{f:t9},6:{f:c9},7:{f:Q7},8:{f:g9},9:{f:p9},10:{f:f9},11:{f:m9},12:{f:z7},13:{f:i9},14:{f:Y7},15:{f:$7},16:{f:a2},17:{f:d9},18:{f:Z7},19:{f:gg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:dU},40:{},42:{},43:{f:c8},44:{f:o8},45:{f:h8},46:{f:m8},47:{f:f8},48:{},49:{f:DL},50:{},51:{f:K8},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:bC},62:{f:l9},63:{f:r5},64:{f:I9},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:mr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:b9},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:F7},148:{f:D7,p:16},151:{f:S9},152:{},153:{f:lU},154:{},155:{},156:{f:iU},157:{},158:{},159:{T:1,f:CM},160:{T:-1},161:{T:1,f:co},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:x9},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:V8},336:{T:-1},337:{f:Q8,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Km},357:{},358:{},359:{},360:{T:1},361:{},362:{f:TC},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:_9},427:{f:C9},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:E9},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:L7},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:k9},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Km},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:m5},633:{T:1},634:{T:-1},635:{T:1,f:h5},636:{T:-1},637:{f:ML},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Y9},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:P9},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},np={6:{f:um},10:{f:Qs},12:{f:Tn},13:{f:Tn},14:{f:kn},15:{f:kn},16:{f:dr},17:{f:kn},18:{f:kn},19:{f:Tn},20:{f:Lk},21:{f:Lk},23:{f:TC},24:{f:Mk},25:{f:kn},26:{},27:{},28:{f:P6},29:{},34:{f:kn},35:{f:Fk},38:{f:dr},39:{f:dr},40:{f:dr},41:{f:dr},42:{f:kn},43:{f:kn},47:{f:$M},49:{f:i6},51:{f:Tn},60:{},61:{f:t6},64:{f:kn},65:{f:s6},66:{f:Tn},77:{},80:{},81:{},82:{},85:{f:Tn},89:{},90:{},91:{},92:{f:GF},93:{f:L6},94:{},95:{f:kn},96:{},97:{},99:{f:kn},125:{f:bC},128:{f:w6},129:{f:VF},130:{f:Tn},131:{f:kn},132:{f:kn},133:{f:qF},134:{},140:{f:G6},141:{f:Tn},144:{},146:{f:q6},151:{},152:{},153:{},154:{},155:{},156:{f:Tn},157:{},158:{},160:{f:eM},161:{f:X6},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:x6},190:{f:v6},193:{f:Qs},197:{},198:{},199:{},200:{},201:{},202:{f:kn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Tn},220:{},221:{f:kn},222:{},224:{f:k6},225:{f:HF},226:{f:Qs},227:{},229:{f:D6},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:YF},253:{f:l6},255:{f:QF},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:vC},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:kn},353:{f:Qs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:E6},431:{f:kn},432:{},433:{},434:{},437:{},438:{f:B6},439:{f:kn},440:{f:U6},441:{},442:{f:fu},443:{},444:{f:Tn},445:{},446:{},448:{f:Qs},449:{f:e6,r:2},450:{f:Qs},512:{f:Pk},513:{f:Z6},515:{f:C6},516:{f:u6},517:{f:Ok},519:{f:tM},520:{f:JF},523:{},545:{f:Bk},549:{f:Ik},566:{},574:{f:r6},638:{f:g6},659:{},1048:{},1054:{f:h6},1084:{},1212:{f:j6},2048:{f:W6},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Md},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Qs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:K6,r:12},2173:{f:G8,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:kn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:A6,r:12},2197:{},2198:{f:M8,r:12},2199:{},2200:{},2201:{},2202:{f:R6,r:12},2203:{f:Qs},2204:{},2205:{},2206:{},2207:{},2211:{f:ZF},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Tn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Q6},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:V6},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Pk},1:{},2:{f:iM},3:{f:aM},4:{f:rM},5:{f:Ok},7:{f:lM},8:{},9:{f:Md},11:{},22:{f:Tn},30:{f:m6},31:{},32:{},33:{f:Bk},36:{},37:{f:Ik},50:{f:cM},62:{},52:{},67:{},68:{f:Tn},69:{},86:{},126:{},127:{f:nM},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:uM},223:{},234:{},354:{},421:{},518:{f:um},521:{f:Md},536:{f:Mk},547:{f:Fk},561:{},579:{},1030:{f:um},1033:{f:Md},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ge(e,t,n,r){var s=t;if(!isNaN(s)){var i=r||(n||[]).length||0,l=e.next(4);l.write_shift(2,s),l.write_shift(2,i),i>0&&fg(n)&&e.push(n)}}function lz(e,t,n,r){var s=(n||[]).length||0;if(s<=8224)return Ge(e,t,n,s);var i=t;if(!isNaN(i)){for(var l=n.parts||[],u=0,d=0,f=0;f+(l[u]||8224)<=8224;)f+=l[u]||8224,u++;var m=e.next(4);for(m.write_shift(2,i),m.write_shift(2,f),e.push(n.slice(d,d+f)),d+=f;d<s;){for(m=e.next(4),m.write_shift(2,60),f=0;f+(l[u]||8224)<=8224;)f+=l[u]||8224,u++;m.write_shift(2,f),e.push(n.slice(d,d+f)),d+=f}}}function xu(e,t,n){return e||(e=Ae(7)),e.write_shift(2,t),e.write_shift(2,n),e.write_shift(2,0),e.write_shift(1,0),e}function cz(e,t,n,r){var s=Ae(9);return xu(s,e,t),yC(n,r||"b",s),s}function uz(e,t,n){var r=Ae(8+2*n.length);return xu(r,e,t),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function dz(e,t,n,r){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?Dn(Jt(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?Ge(e,2,oM(n,r,s)):Ge(e,3,sM(n,r,s));return;case"b":case"e":Ge(e,5,cz(n,r,t.v,t.t));return;case"s":case"str":Ge(e,4,uz(n,r,(t.v||"").slice(0,255)));return}Ge(e,1,xu(null,n,r))}function hz(e,t,n,r){var s=Array.isArray(t),i=Tt(t["!ref"]||"A1"),l,u="",d=[];if(i.e.c>255||i.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),l=ft(i)}for(var f=i.s.r;f<=i.e.r;++f){u=Sn(f);for(var m=i.s.c;m<=i.e.c;++m){f===i.s.r&&(d[m]=on(m)),l=d[m]+u;var p=s?(t[f]||[])[m]:t[l];p&&dz(e,p,f,m)}}}function fz(e,t){for(var n=t||{},r=Or(),s=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==n.sheet&&(s=i);if(s==0&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return Ge(r,n.biff==4?1033:n.biff==3?521:9,_g(e,16,n)),hz(r,e.Sheets[e.SheetNames[s]],s,n),Ge(r,10),r.end()}function mz(e,t,n){Ge(e,49,o6({sz:12,name:"Arial"},n))}function pz(e,t,n){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)t[s]!=null&&Ge(e,1054,f6(s,t[s],n))})}function gz(e,t){var n=Ae(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),Ge(e,2151,n),n=Ae(39),n.write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),CC(Tt(t["!ref"]||"A1"),n),n.write_shift(4,4),Ge(e,2152,n)}function xz(e,t){for(var n=0;n<16;++n)Ge(e,224,Dk({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(r){Ge(e,224,Dk(r,0,t))})}function vz(e,t){for(var n=0;n<t["!links"].length;++n){var r=t["!links"][n];Ge(e,440,z6(r)),r[1].Tooltip&&Ge(e,2048,H6(r))}delete t["!links"]}function yz(e,t){if(t){var n=0;t.forEach(function(r,s){++n<=256&&r&&Ge(e,125,Y6(ef(s,r),s))})}}function kz(e,t,n,r,s){var i=16+gi(s.cellXfs,t,s);if(t.v==null&&!t.bf){Ge(e,513,to(n,r,i));return}if(t.bf)Ge(e,6,VB(t,n,r,s,i));else switch(t.t){case"d":case"n":var l=t.t=="d"?Dn(Jt(t.v)):t.v;Ge(e,515,N6(n,r,l,i));break;case"b":case"e":Ge(e,517,_6(n,r,t.v,i,s,t.t));break;case"s":case"str":if(s.bookSST){var u=Rg(s.Strings,t.v,s.revStrings);Ge(e,253,c6(n,r,u,i))}else Ge(e,516,d6(n,r,(t.v||"").slice(0,255),i,s));break;default:Ge(e,513,to(n,r,i))}}function wz(e,t,n){var r=Or(),s=n.SheetNames[e],i=n.Sheets[s]||{},l=(n||{}).Workbook||{},u=(l.Sheets||[])[e]||{},d=Array.isArray(i),f=t.biff==8,m,p="",x=[],v=Tt(i["!ref"]||"A1"),k=f?65536:16384;if(v.e.c>255||v.e.r>=k){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");v.e.c=Math.min(v.e.c,255),v.e.r=Math.min(v.e.c,k-1)}Ge(r,2057,_g(n,16,t)),Ge(r,13,ca(1)),Ge(r,12,ca(100)),Ge(r,15,wr(!0)),Ge(r,17,wr(!1)),Ge(r,16,Zi(.001)),Ge(r,95,wr(!0)),Ge(r,42,wr(!1)),Ge(r,43,wr(!1)),Ge(r,130,ca(1)),Ge(r,128,S6()),Ge(r,131,wr(!1)),Ge(r,132,wr(!1)),f&&yz(r,i["!cols"]),Ge(r,512,p6(v,t)),f&&(i["!links"]=[]);for(var y=v.s.r;y<=v.e.r;++y){p=Sn(y);for(var S=v.s.c;S<=v.e.c;++S){y===v.s.r&&(x[S]=on(S)),m=x[S]+p;var C=d?(i[y]||[])[S]:i[m];C&&(kz(r,C,y,S,t),f&&C.l&&i["!links"].push([m,C.l]))}}var D=u.CodeName||u.name||s;return f&&Ge(r,574,a6((l.Views||[])[0])),f&&(i["!merges"]||[]).length&&Ge(r,229,O6(i["!merges"])),f&&vz(r,i),Ge(r,442,kC(D)),f&&gz(r,i),Ge(r,10),r.end()}function Sz(e,t,n){var r=Or(),s=(e||{}).Workbook||{},i=s.Sheets||[],l=s.WBProps||{},u=n.biff==8,d=n.biff==5;if(Ge(r,2057,_g(e,5,n)),n.bookType=="xla"&&Ge(r,135),Ge(r,225,u?ca(1200):null),Ge(r,193,_F(2)),d&&Ge(r,191),d&&Ge(r,192),Ge(r,226),Ge(r,92,$F("SheetJS",n)),Ge(r,66,ca(u?1200:1252)),u&&Ge(r,353,ca(0)),u&&Ge(r,448),Ge(r,317,J6(e.SheetNames.length)),u&&e.vbaraw&&Ge(r,211),u&&e.vbaraw){var f=l.CodeName||"ThisWorkbook";Ge(r,442,kC(f))}Ge(r,156,ca(17)),Ge(r,25,wr(!1)),Ge(r,18,wr(!1)),Ge(r,19,ca(0)),u&&Ge(r,431,wr(!1)),u&&Ge(r,444,ca(0)),Ge(r,61,n6()),Ge(r,64,wr(!1)),Ge(r,141,ca(0)),Ge(r,34,wr(eU(e)=="true")),Ge(r,14,wr(!0)),u&&Ge(r,439,wr(!1)),Ge(r,218,ca(0)),mz(r,e,n),pz(r,e.SSF,n),xz(r,n),u&&Ge(r,352,wr(!1));var m=r.end(),p=Or();u&&Ge(p,140,$6()),u&&n.Strings&&lz(p,252,XF(n.Strings)),Ge(p,10);var x=p.end(),v=Or(),k=0,y=0;for(y=0;y<e.SheetNames.length;++y)k+=(u?12:11)+(u?2:1)*e.SheetNames[y].length;var S=m.length+k+x.length;for(y=0;y<e.SheetNames.length;++y){var C=i[y]||{};Ge(v,133,KF({pos:S,hs:C.Hidden||0,dt:0,name:e.SheetNames[y]},n)),S+=t[y].length}var D=v.end();if(k!=D.length)throw new Error("BS8 "+k+" != "+D.length);var N=[];return m.length&&N.push(m),D.length&&N.push(D),x.length&&N.push(x),Vn(N)}function _z(e,t){var n=t||{},r=[];e&&!e.SSF&&(e.SSF=Zt(st)),e&&e.SSF&&(vl(),qh(e.SSF),n.revssf=Yh(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Lg(n),n.cellXfs=[],gi(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)r[r.length]=wz(s,n,e);return r.unshift(Sz(e,r,n)),Vn(r)}function f2(e,t){for(var n=0;n<=e.SheetNames.length;++n){var r=e.Sheets[e.SheetNames[n]];if(!(!r||!r["!ref"])){var s=Fr(r["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return _z(e,t);case 4:case 3:case 2:return fz(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function Yk(e,t){var n=t||{},r=n.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),l=s.index,u=i&&i.index||e.length,d=oL(e.slice(l,u),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,m=0,p=0,x=0,v={s:{r:1e7,c:1e7},e:{r:0,c:0}},k=[];for(l=0;l<d.length;++l){var y=d[l].trim(),S=y.slice(0,3).toLowerCase();if(S=="<tr"){if(++f,n.sheetRows&&n.sheetRows<=f){--f;break}m=0;continue}if(!(S!="<td"&&S!="<th")){var C=y.split(/<\/t[dh]>/i);for(u=0;u<C.length;++u){var D=C[u].trim();if(D.match(/<t[dh]/i)){for(var N=D,b=0;N.charAt(0)=="<"&&(b=N.indexOf(">"))>-1;)N=N.slice(b+1);for(var H=0;H<k.length;++H){var L=k[H];L.s.c==m&&L.s.r<f&&f<=L.e.r&&(m=L.e.c+1,H=-1)}var R=lt(D.slice(0,D.indexOf(">")));x=R.colspan?+R.colspan:1,((p=+R.rowspan)>1||x>1)&&k.push({s:{r:f,c:m},e:{r:f+(p||1)-1,c:m+x-1}});var q=R.t||R["data-t"]||"";if(!N.length){m+=x;continue}if(N=F_(N),v.s.r>f&&(v.s.r=f),v.e.r<f&&(v.e.r=f),v.s.c>m&&(v.s.c=m),v.e.c<m&&(v.e.c=m),!N.length){m+=x;continue}var O={t:"s",v:N};n.raw||!N.trim().length||q=="s"||(N==="TRUE"?O={t:"b",v:!0}:N==="FALSE"?O={t:"b",v:!1}:isNaN(Pa(N))?isNaN(ol(N).getDate())||(O={t:"d",v:Jt(N)},n.cellDates||(O={t:"n",v:Dn(O.v)}),O.z=n.dateNF||st[14]):O={t:"n",v:Pa(N)}),n.dense?(r[f]||(r[f]=[]),r[f][m]=O):r[it({r:f,c:m})]=O,m+=x}}}}return r["!ref"]=ft(v),k.length&&(r["!merges"]=k),r}function Cz(e,t,n,r){for(var s=e["!merges"]||[],i=[],l=t.s.c;l<=t.e.c;++l){for(var u=0,d=0,f=0;f<s.length;++f)if(!(s[f].s.r>n||s[f].s.c>l)&&!(s[f].e.r<n||s[f].e.c<l)){if(s[f].s.r<n||s[f].s.c<l){u=-1;break}u=s[f].e.r-s[f].s.r+1,d=s[f].e.c-s[f].s.c+1;break}if(!(u<0)){var m=it({r:n,c:l}),p=r.dense?(e[n]||[])[l]:e[m],x=p&&p.v!=null&&(p.h||ug(p.w||(ks(p),p.w)||""))||"",v={};u>1&&(v.rowspan=u),d>1&&(v.colspan=d),r.editable?x='<span contenteditable="true">'+x+"</span>":p&&(v["data-t"]=p&&p.t||"z",p.v!=null&&(v["data-v"]=p.v),p.z!=null&&(v["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+p.l.Target+'">'+x+"</a>")),v.id=(r.id||"sjs")+"-"+m,i.push(He("td",x,v))}}var k="<tr>";return k+i.join("")+"</tr>"}var Nz='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Ez="</body></html>";function Tz(e,t){var n=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||n.length==0)throw new Error("Invalid HTML: could not find <table>");if(n.length==1)return pi(Yk(n[0],t),t);var r=Bg();return n.forEach(function(s,i){Ug(r,Yk(s,t),"Sheet"+(i+1))}),r}function bz(e,t,n){var r=[];return r.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function m2(e,t){var n=t||{},r=n.header!=null?n.header:Nz,s=n.footer!=null?n.footer:Ez,i=[r],l=Fr(e["!ref"]);n.dense=Array.isArray(e),i.push(bz(e,l,n));for(var u=l.s.r;u<=l.e.r;++u)i.push(Cz(e,l,u,n));return i.push("</table>"+s),i.join("")}function p2(e,t,n){var r=n||{},s=0,i=0;if(r.origin!=null)if(typeof r.origin=="number")s=r.origin;else{var l=typeof r.origin=="string"?ln(r.origin):r.origin;s=l.r,i=l.c}var u=t.getElementsByTagName("tr"),d=Math.min(r.sheetRows||1e7,u.length),f={s:{r:0,c:0},e:{r:s,c:i}};if(e["!ref"]){var m=Fr(e["!ref"]);f.s.r=Math.min(f.s.r,m.s.r),f.s.c=Math.min(f.s.c,m.s.c),f.e.r=Math.max(f.e.r,m.e.r),f.e.c=Math.max(f.e.c,m.e.c),s==-1&&(f.e.r=s=m.e.r+1)}var p=[],x=0,v=e["!rows"]||(e["!rows"]=[]),k=0,y=0,S=0,C=0,D=0,N=0;for(e["!cols"]||(e["!cols"]=[]);k<u.length&&y<d;++k){var b=u[k];if(Xk(b)){if(r.display)continue;v[y]={hidden:!0}}var H=b.children;for(S=C=0;S<H.length;++S){var L=H[S];if(!(r.display&&Xk(L))){var R=L.hasAttribute("data-v")?L.getAttribute("data-v"):L.hasAttribute("v")?L.getAttribute("v"):F_(L.innerHTML),q=L.getAttribute("data-z")||L.getAttribute("z");for(x=0;x<p.length;++x){var O=p[x];O.s.c==C+i&&O.s.r<y+s&&y+s<=O.e.r&&(C=O.e.c+1-i,x=-1)}N=+L.getAttribute("colspan")||1,((D=+L.getAttribute("rowspan")||1)>1||N>1)&&p.push({s:{r:y+s,c:C+i},e:{r:y+s+(D||1)-1,c:C+i+(N||1)-1}});var V={t:"s",v:R},X=L.getAttribute("data-t")||L.getAttribute("t")||"";R!=null&&(R.length==0?V.t=X||"z":r.raw||R.trim().length==0||X=="s"||(R==="TRUE"?V={t:"b",v:!0}:R==="FALSE"?V={t:"b",v:!1}:isNaN(Pa(R))?isNaN(ol(R).getDate())||(V={t:"d",v:Jt(R)},r.cellDates||(V={t:"n",v:Dn(V.v)}),V.z=r.dateNF||st[14]):V={t:"n",v:Pa(R)})),V.z===void 0&&q!=null&&(V.z=q);var M="",me=L.getElementsByTagName("A");if(me&&me.length)for(var ae=0;ae<me.length&&!(me[ae].hasAttribute("href")&&(M=me[ae].getAttribute("href"),M.charAt(0)!="#"));++ae);M&&M.charAt(0)!="#"&&(V.l={Target:M}),r.dense?(e[y+s]||(e[y+s]=[]),e[y+s][C+i]=V):e[it({c:C+i,r:y+s})]=V,f.e.c<C+i&&(f.e.c=C+i),C+=N}}++y}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),f.e.r=Math.max(f.e.r,y-1+s),e["!ref"]=ft(f),y>=d&&(e["!fullref"]=ft((f.e.r=u.length-k+y-1+s,f))),e}function g2(e,t){var n=t||{},r=n.dense?[]:{};return p2(r,e,t)}function Az(e,t){return pi(g2(e,t),t)}function Xk(e){var t="",n=jz(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function jz(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Rz(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),n=Et(t.replace(/<[^>]*>/g,""));return[n]}var Qk={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function x2(e,t){var n=t||{},r=dg(e),s=[],i,l,u={name:""},d="",f=0,m,p,x={},v=[],k=n.dense?[]:{},y,S,C={value:""},D="",N=0,b=[],H=-1,L=-1,R={s:{r:1e6,c:1e7},e:{r:0,c:0}},q=0,O={},V=[],X={},M=0,me=0,ae=[],ce=1,ue=1,K=[],W={Names:[]},j={},F=["",""],U=[],I={},Z="",Y=0,P=!1,ne=!1,J=0;for($c.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=$c.exec(r);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(R.e.c>=R.s.c&&R.e.r>=R.s.r?k["!ref"]=ft(R):k["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=R.e.r&&(k["!fullref"]=k["!ref"],R.e.r=n.sheetRows-1,k["!ref"]=ft(R)),V.length&&(k["!merges"]=V),ae.length&&(k["!rows"]=ae),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),v.push(m.name),x[m.name]=k,ne=!1):y[0].charAt(y[0].length-2)!=="/"&&(m=lt(y[0],!1),H=L=-1,R.s.r=R.s.c=1e7,R.e.r=R.e.c=0,k=n.dense?[]:{},V=[],ae=[],ne=!0);break;case"table-row-group":y[1]==="/"?--q:++q;break;case"table-row":case"":if(y[1]==="/"){H+=ce,ce=1;break}if(p=lt(y[0],!1),p.?H=p.-1:H==-1&&(H=0),ce=+p["number-rows-repeated"]||1,ce<10)for(J=0;J<ce;++J)q>0&&(ae[H+J]={level:q});L=-1;break;case"covered-table-cell":y[1]!=="/"&&++L,n.sheetStubs&&(n.dense?(k[H]||(k[H]=[]),k[H][L]={t:"z"}):k[it({r:H,c:L})]={t:"z"}),D="",b=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++L,C=lt(y[0],!1),ue=parseInt(C["number-columns-repeated"]||"1",10),S={t:"z",v:null},C.formula&&n.cellFormula!=!1&&(S.f=Vk(Et(C.formula))),(C.||C["value-type"])=="string"&&(S.t="s",S.v=Et(C["string-value"]||""),n.dense?(k[H]||(k[H]=[]),k[H][L]=S):k[it({r:H,c:L})]=S),L+=ue-1;else if(y[1]!=="/"){++L,D="",N=0,b=[],ue=1;var de=ce?H+ce-1:H;if(L>R.e.c&&(R.e.c=L),L<R.s.c&&(R.s.c=L),H<R.s.r&&(R.s.r=H),de>R.e.r&&(R.e.r=de),C=lt(y[0],!1),U=[],I={},S={t:C.||C["value-type"],v:null},n.cellFormula)if(C.formula&&(C.formula=Et(C.formula)),C["number-matrix-columns-spanned"]&&C["number-matrix-rows-spanned"]&&(M=parseInt(C["number-matrix-rows-spanned"],10)||0,me=parseInt(C["number-matrix-columns-spanned"],10)||0,X={s:{r:H,c:L},e:{r:H+M-1,c:L+me-1}},S.F=ft(X),K.push([X,S.F])),C.formula)S.f=Vk(C.formula);else for(J=0;J<K.length;++J)H>=K[J][0].s.r&&H<=K[J][0].e.r&&L>=K[J][0].s.c&&L<=K[J][0].e.c&&(S.F=K[J][1]);switch((C["number-columns-spanned"]||C["number-rows-spanned"])&&(M=parseInt(C["number-rows-spanned"],10)||0,me=parseInt(C["number-columns-spanned"],10)||0,X={s:{r:H,c:L},e:{r:H+M-1,c:L+me-1}},V.push(X)),C["number-columns-repeated"]&&(ue=parseInt(C["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=Qt(C["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(C.value);break;case"percentage":S.t="n",S.v=parseFloat(C.value);break;case"currency":S.t="n",S.v=parseFloat(C.value);break;case"date":S.t="d",S.v=Jt(C["date-value"]),n.cellDates||(S.t="n",S.v=Dn(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=aL(C["time-value"])/86400,n.cellDates&&(S.t="d",S.v=Xh(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(C.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",C["string-value"]!=null&&(D=Et(C["string-value"]),b=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(P=!1,S.t==="s"&&(S.v=D||"",b.length&&(S.R=b),P=N==0),j.Target&&(S.l=j),U.length>0&&(S.c=U,U=[]),D&&n.cellText!==!1&&(S.w=D),P&&(S.t="z",delete S.v),(!P||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=H))for(var E=0;E<ce;++E){if(ue=parseInt(C["number-columns-repeated"]||"1",10),n.dense)for(k[H+E]||(k[H+E]=[]),k[H+E][L]=E==0?S:Zt(S);--ue>0;)k[H+E][L+ue]=Zt(S);else for(k[it({r:H+E,c:L})]=S;--ue>0;)k[it({r:H+E,c:L+ue})]=Zt(S);R.e.c<=L&&(R.e.c=L)}ue=parseInt(C["number-columns-repeated"]||"1",10),L+=ue-1,ue=0,S={},D="",b=[]}j={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((i=s.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((i=s.pop())[0]!==y[3])throw"Bad state: "+i;I.t=D,b.length&&(I.R=b),I.a=Z,U.push(I)}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);Z="",Y=0,D="",N=0,b=[];break;case"creator":y[1]==="/"?Z=r.slice(Y,y.index):Y=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((i=s.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);D="",N=0,b=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(O[u.name]=d,(i=s.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&(d="",u=lt(y[0],!1),s.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":l=lt(y[0],!1),d+=Qk[y[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":l=lt(y[0],!1),d+=Qk[y[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":d+=r.slice(f,y.index);break}else f=y.index+y[0].length;break;case"named-range":l=lt(y[0],!1),F=dm(l["cell-range-address"]);var A={Name:l.name,Ref:F[0]+"!"+F[1]};ne&&(A.Sheet=v.length),W.Names.push(A);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(y[1]==="/"&&(!C||!C["string-value"])){var he=Rz(r.slice(N,y.index));D=(D.length>0?D+`
`:"")+he[0]}else lt(y[0],!1),N=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{F=dm(lt(y[0])["target-range-address"]),x[F[0]]["!autofilter"]={ref:F[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(j=lt(y[0],!1),!j.href)break;j.Target=Et(j.href),delete j.href,j.Target.charAt(0)=="#"&&j.Target.indexOf(".")>-1?(F=dm(j.Target.slice(1)),j.Target="#"+F[0]+"!"+F[1]):j.Target.match(/^\.\.[\\\/]/)&&(j.Target=j.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(n.WTF)throw new Error(y)}}var G={Sheets:x,SheetNames:v,Workbook:W};return n.bookSheets&&delete G.Sheets,G}function Jk(e,t){t=t||{},la(e,"META-INF/manifest.xml")&&aF(En(e,"META-INF/manifest.xml"),t);var n=Vr(e,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var r=x2(Bt(n),t);return la(e,"meta.xml")&&(r.Props=oC(En(e,"meta.xml"))),r}function Zk(e,t){return x2(e,t)}var Iz=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Gc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return _n+t}})(),ew=(function(){var e=function(i){return Lt(i).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,n=`          <table:covered-table-cell/>
`,r=function(i,l,u){var d=[];d.push('      <table:table table:name="'+Lt(l.SheetNames[u])+`" table:style-name="ta1">
`);var f=0,m=0,p=Fr(i["!ref"]||"A1"),x=i["!merges"]||[],v=0,k=Array.isArray(i);if(i["!cols"])for(m=0;m<=p.e.c;++m)d.push("        <table:table-column"+(i["!cols"][m]?' table:style-name="co'+i["!cols"][m].ods+'"':"")+`></table:table-column>
`);var y="",S=i["!rows"]||[];for(f=0;f<p.s.r;++f)y=S[f]?' table:style-name="ro'+S[f].ods+'"':"",d.push("        <table:table-row"+y+`></table:table-row>
`);for(;f<=p.e.r;++f){for(y=S[f]?' table:style-name="ro'+S[f].ods+'"':"",d.push("        <table:table-row"+y+`>
`),m=0;m<p.s.c;++m)d.push(t);for(;m<=p.e.c;++m){var C=!1,D={},N="";for(v=0;v!=x.length;++v)if(!(x[v].s.c>m)&&!(x[v].s.r>f)&&!(x[v].e.c<m)&&!(x[v].e.r<f)){(x[v].s.c!=m||x[v].s.r!=f)&&(C=!0),D["table:number-columns-spanned"]=x[v].e.c-x[v].s.c+1,D["table:number-rows-spanned"]=x[v].e.r-x[v].s.r+1;break}if(C){d.push(n);continue}var b=it({r:f,c:m}),H=k?(i[f]||[])[m]:i[b];if(H&&H.f&&(D["table:formula"]=Lt(JB(H.f)),H.F&&H.F.slice(0,b.length)==b)){var L=Fr(H.F);D["table:number-matrix-columns-spanned"]=L.e.c-L.s.c+1,D["table:number-matrix-rows-spanned"]=L.e.r-L.s.r+1}if(!H){d.push(t);continue}switch(H.t){case"b":N=H.v?"TRUE":"FALSE",D["office:value-type"]="boolean",D["office:boolean-value"]=H.v?"true":"false";break;case"n":N=H.w||String(H.v||0),D["office:value-type"]="float",D["office:value"]=H.v||0;break;case"s":case"str":N=H.v==null?"":H.v,D["office:value-type"]="string";break;case"d":N=H.w||Jt(H.v).toISOString(),D["office:value-type"]="date",D["office:date-value"]=Jt(H.v).toISOString(),D["table:style-name"]="ce1";break;default:d.push(t);continue}var R=e(N);if(H.l&&H.l.Target){var q=H.l.Target;q=q.charAt(0)=="#"?"#"+ZB(q.slice(1)):q,q.charAt(0)!="#"&&!q.match(/^\w+:/)&&(q="../"+q),R=He("text:a",R,{"xlink:href":q.replace(/&/g,"&amp;")})}d.push("          "+He("table:table-cell",He("text:p",R,{}),D)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},s=function(i,l){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var u=0;l.SheetNames.map(function(f){return l.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var m=0;m<f["!cols"].length;++m)if(f["!cols"][m]){var p=f["!cols"][m];if(p.width==null&&p.wpx==null&&p.wch==null)continue;ci(p),p.ods=u;var x=f["!cols"][m].wpx+"px";i.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),i.push(`  </style:style>
`),++u}}});var d=0;l.SheetNames.map(function(f){return l.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var m=0;m<f["!rows"].length;++m)if(f["!rows"][m]){f["!rows"][m].ods=d;var p=f["!rows"][m].hpx+"px";i.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),i.push(`  </style:style>
`),++d}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(l,u){var d=[_n],f=Gc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=Gc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(d.push("<office:document"+f+m+`>
`),d.push(iC().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+f+`>
`),s(d,l),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var p=0;p!=l.SheetNames.length;++p)d.push(r(l.Sheets[l.SheetNames[p]],l,p));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),u.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}})();function v2(e,t){if(t.bookType=="fods")return ew(e,t);var n=og(),r="",s=[],i=[];return r="mimetype",mt(n,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",mt(n,r,ew(e,t)),s.push([r,"text/xml"]),i.push([r,"ContentFile"]),r="styles.xml",mt(n,r,Iz(e,t)),s.push([r,"text/xml"]),i.push([r,"StylesFile"]),r="meta.xml",mt(n,r,_n+iC()),s.push([r,"text/xml"]),i.push([r,"MetadataFile"]),r="manifest.rdf",mt(n,r,oF(i)),s.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",mt(n,r,sF(s)),n}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function no(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function rp(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Bt(mi(e))}function Pz(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):$r(qa(e))}function Dz(e,t){e:for(var n=0;n<=e.length-t.length;++n){for(var r=0;r<t.length;++r)if(e[n+r]!=t[r])continue e;return!0}return!1}function di(e){var t=e.reduce(function(s,i){return s+i.length},0),n=new Uint8Array(t),r=0;return e.forEach(function(s){n.set(s,r),r+=s.length}),n}function tw(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Oz(e,t){for(var n=(e[t+15]&127)<<7|e[t+14]>>1,r=e[t+14]&1,s=t+13;s>=t;--s)r=r*256+e[s];return(e[t+15]&128?-r:r)*Math.pow(10,n-6176)}function Lz(e,t,n){var r=Math.floor(n==0?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,s=n/Math.pow(10,r-6176);e[t+15]|=r>>7,e[t+14]|=(r&127)<<1;for(var i=0;s>=1;++i,s/=256)e[t+i]=s&255;e[t+15]|=n>=0?0:128}function Jc(e,t){var n=t?t[0]:0,r=e[n]&127;e:if(e[n++]>=128&&(r|=(e[n]&127)<<7,e[n++]<128||(r|=(e[n]&127)<<14,e[n++]<128)||(r|=(e[n]&127)<<21,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,28),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,35),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,42),++n,e[n++]<128)))break e;return t&&(t[0]=n),r}function Dt(e){var t=new Uint8Array(7);t[0]=e&127;var n=1;e:if(e>127){if(t[n-1]|=128,t[n]=e>>7&127,++n,e<=16383||(t[n-1]|=128,t[n]=e>>14&127,++n,e<=2097151)||(t[n-1]|=128,t[n]=e>>21&127,++n,e<=268435455)||(t[n-1]|=128,t[n]=e/256>>>21&127,++n,e<=34359738367)||(t[n-1]|=128,t[n]=e/65536>>>21&127,++n,e<=4398046511103))break e;t[n-1]|=128,t[n]=e/16777216>>>21&127,++n}return t.slice(0,n)}function mn(e){var t=0,n=e[t]&127;e:if(e[t++]>=128){if(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128))break e;n|=(e[t]&127)<<28}return n}function At(e){for(var t=[],n=[0];n[0]<e.length;){var r=n[0],s=Jc(e,n),i=s&7;s=Math.floor(s/8);var l=0,u;if(s==0)break;switch(i){case 0:{for(var d=n[0];e[n[0]++]>=128;);u=e.slice(d,n[0])}break;case 5:l=4,u=e.slice(n[0],n[0]+l),n[0]+=l;break;case 1:l=8,u=e.slice(n[0],n[0]+l),n[0]+=l;break;case 2:l=Jc(e,n),u=e.slice(n[0],n[0]+l),n[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(r))}var f={data:u,type:i};t[s]==null?t[s]=[f]:t[s].push(f)}return t}function Xn(e){var t=[];return e.forEach(function(n,r){n.forEach(function(s){s.data&&(t.push(Dt(r*8+s.type)),s.type==2&&t.push(Dt(s.data.length)),t.push(s.data))})}),di(t)}function Dg(e,t){return(e==null?void 0:e.map(function(n){return t(n.data)}))||[]}function ia(e){for(var t,n=[],r=[0];r[0]<e.length;){var s=Jc(e,r),i=At(e.slice(r[0],r[0]+s));r[0]+=s;var l={id:mn(i[1][0].data),messages:[]};i[2].forEach(function(u){var d=At(u.data),f=mn(d[3][0].data);l.messages.push({meta:d,data:e.slice(r[0],r[0]+f)}),r[0]+=f}),(t=i[3])!=null&&t[0]&&(l.merge=mn(i[3][0].data)>>>0>0),n.push(l)}return n}function Mo(e){var t=[];return e.forEach(function(n){var r=[];r[1]=[{data:Dt(n.id),type:0}],r[2]=[],n.merge!=null&&(r[3]=[{data:Dt(+!!n.merge),type:0}]);var s=[];n.messages.forEach(function(l){s.push(l.data),l.meta[3]=[{type:0,data:Dt(l.data.length)}],r[2].push({data:Xn(l.meta),type:2})});var i=Xn(r);t.push(Dt(i.length)),t.push(i),s.forEach(function(l){return t.push(l)})}),di(t)}function Fz(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=Jc(t,n),s=[];n[0]<t.length;){var i=t[n[0]]&3;if(i==0){var l=t[n[0]++]>>2;if(l<60)++l;else{var u=l-59;l=t[n[0]],u>1&&(l|=t[n[0]+1]<<8),u>2&&(l|=t[n[0]+2]<<16),u>3&&(l|=t[n[0]+3]<<24),l>>>=0,l++,n[0]+=u}s.push(t.slice(n[0],n[0]+l)),n[0]+=l;continue}else{var d=0,f=0;if(i==1?(f=(t[n[0]]>>2&7)+4,d=(t[n[0]++]&224)<<3,d|=t[n[0]++]):(f=(t[n[0]++]>>2)+1,i==2?(d=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(d=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),s=[di(s)],d==0)throw new Error("Invalid offset 0");if(d>s[0].length)throw new Error("Invalid offset beyond length");if(f>=d)for(s.push(s[0].slice(-d)),f-=d;f>=s[s.length-1].length;)s.push(s[s.length-1]),f-=s[s.length-1].length;s.push(s[0].slice(-d,-d+f))}}var m=di(s);if(m.length!=r)throw new Error("Unexpected length: ".concat(m.length," != ").concat(r));return m}function oa(e){for(var t=[],n=0;n<e.length;){var r=e[n++],s=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(Fz(r,e.slice(n,n+s))),n+=s}if(n!==e.length)throw new Error("data is not a valid framed stream!");return di(t)}function Bo(e){for(var t=[],n=0;n<e.length;){var r=Math.min(e.length-n,268435455),s=new Uint8Array(4);t.push(s);var i=Dt(r),l=i.length;t.push(i),r<=60?(l++,t.push(new Uint8Array([r-1<<2]))):r<=256?(l+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(l+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(l+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(l+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(e.slice(n,n+r)),l+=r,s[0]=0,s[1]=l&255,s[2]=l>>8&255,s[3]=l>>16&255,n+=r}return di(t)}function Mz(e,t,n,r){var s=no(e),i=s.getUint32(4,!0),l=(r>1?12:8)+tw(i&(r>1?3470:398))*4,u=-1,d=-1,f=NaN,m=new Date(2001,0,1);i&512&&(u=s.getUint32(l,!0),l+=4),l+=tw(i&(r>1?12288:4096))*4,i&16&&(d=s.getUint32(l,!0),l+=4),i&32&&(f=s.getFloat64(l,!0),l+=8),i&64&&(m.setTime(m.getTime()+s.getFloat64(l,!0)*1e3),l+=8);var p;switch(e[2]){case 0:break;case 2:p={t:"n",v:f};break;case 3:p={t:"s",v:t[d]};break;case 5:p={t:"d",v:m};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(u>-1)p={t:"s",v:n[u]};else if(d>-1)p={t:"s",v:t[d]};else if(!isNaN(f))p={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return p}function Bz(e,t,n){var r=no(e),s=r.getUint32(8,!0),i=12,l=-1,u=-1,d=NaN,f=NaN,m=new Date(2001,0,1);s&1&&(d=Oz(e,i),i+=16),s&2&&(f=r.getFloat64(i,!0),i+=8),s&4&&(m.setTime(m.getTime()+r.getFloat64(i,!0)*1e3),i+=8),s&8&&(u=r.getUint32(i,!0),i+=4),s&16&&(l=r.getUint32(i,!0),i+=4);var p;switch(e[1]){case 0:break;case 2:p={t:"n",v:d};break;case 3:p={t:"s",v:t[u]};break;case 5:p={t:"d",v:m};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(l>-1)p={t:"s",v:n[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:p={t:"n",v:d};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return p}function fm(e,t){var n=new Uint8Array(32),r=no(n),s=12,i=0;switch(n[0]=5,e.t){case"n":n[1]=2,Lz(n,s,e.v),i|=1,s+=16;break;case"b":n[1]=6,r.setFloat64(s,e.v?1:0,!0),i|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[1]=3,r.setUint32(s,t.indexOf(e.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,i,!0),n.slice(0,s)}function mm(e,t){var n=new Uint8Array(32),r=no(n),s=12,i=0;switch(n[0]=3,e.t){case"n":n[2]=2,r.setFloat64(s,e.v,!0),i|=32,s+=8;break;case"b":n[2]=6,r.setFloat64(s,e.v?1:0,!0),i|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[2]=3,r.setUint32(s,t.indexOf(e.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,i,!0),n.slice(0,s)}function Uz(e,t,n){switch(e[0]){case 0:case 1:case 2:case 3:return Mz(e,t,n,e[0]);case 5:return Bz(e,t,n);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function or(e){var t=At(e);return Jc(t[1][0].data)}function nw(e,t){var n=At(t.data),r=mn(n[1][0].data),s=n[3],i=[];return(s||[]).forEach(function(l){var u=At(l.data),d=mn(u[1][0].data)>>>0;switch(r){case 1:i[d]=rp(u[3][0].data);break;case 8:{var f=e[or(u[9][0].data)][0],m=At(f.data),p=e[or(m[1][0].data)][0],x=mn(p.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var v=At(p.data);i[d]=v[3].map(function(k){return rp(k.data)}).join("")}break}}),i}function zz(e,t){var n,r,s,i,l,u,d,f,m,p,x,v,k,y,S=At(e),C=mn(S[1][0].data)>>>0,D=mn(S[2][0].data)>>>0,N=((r=(n=S[8])==null?void 0:n[0])==null?void 0:r.data)&&mn(S[8][0].data)>0||!1,b,H;if((i=(s=S[7])==null?void 0:s[0])!=null&&i.data&&t!=0)b=(u=(l=S[7])==null?void 0:l[0])==null?void 0:u.data,H=(f=(d=S[6])==null?void 0:d[0])==null?void 0:f.data;else if((p=(m=S[4])==null?void 0:m[0])!=null&&p.data&&t!=1)b=(v=(x=S[4])==null?void 0:x[0])==null?void 0:v.data,H=(y=(k=S[3])==null?void 0:k[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var L=N?4:1,R=no(b),q=[],O=0;O<b.length/2;++O){var V=R.getUint16(O*2,!0);V<65535&&q.push([O,V])}if(q.length!=D)throw"Expected ".concat(D," cells, found ").concat(q.length);var X=[];for(O=0;O<q.length-1;++O)X[q[O][0]]=H.subarray(q[O][1]*L,q[O+1][1]*L);return q.length>=1&&(X[q[q.length-1][0]]=H.subarray(q[q.length-1][1]*L)),{R:C,cells:X}}function Wz(e,t){var n,r=At(t.data),s=(n=r==null?void 0:r[7])!=null&&n[0]?mn(r[7][0].data)>>>0>0?1:0:-1,i=Dg(r[5],function(l){return zz(l,s)});return{nrows:mn(r[4][0].data)>>>0,data:i.reduce(function(l,u){return l[u.R]||(l[u.R]=[]),u.cells.forEach(function(d,f){if(l[u.R][f])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(f));l[u.R][f]=d}),l},[])}}function Hz(e,t,n){var r,s=At(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(mn(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(mn(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));n["!ref"]=ft(i);var l=At(s[4][0].data),u=nw(e,e[or(l[4][0].data)][0]),d=(r=l[17])!=null&&r[0]?nw(e,e[or(l[17][0].data)][0]):[],f=At(l[3][0].data),m=0;f[1].forEach(function(p){var x=At(p.data),v=e[or(x[2][0].data)][0],k=mn(v.meta[1][0].data);if(k!=6002)throw new Error("6001 unexpected reference to ".concat(k));var y=Wz(e,v);y.data.forEach(function(S,C){S.forEach(function(D,N){var b=it({r:m+C,c:N}),H=Uz(D,u,d);H&&(n[b]=H)})}),m+=y.nrows})}function Gz(e,t){var n=At(t.data),r={"!ref":"A1"},s=e[or(n[2][0].data)],i=mn(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return Hz(e,s[0],r),r}function $z(e,t){var n,r=At(t.data),s={name:(n=r[1])!=null&&n[0]?rp(r[1][0].data):"",sheets:[]},i=Dg(r[2],or);return i.forEach(function(l){e[l].forEach(function(u){var d=mn(u.meta[1][0].data);d==6e3&&s.sheets.push(Gz(e,u))})}),s}function Vz(e,t){var n=Bg(),r=At(t.data),s=Dg(r[1],or);if(s.forEach(function(i){e[i].forEach(function(l){var u=mn(l.meta[1][0].data);if(u==2){var d=$z(e,l);d.sheets.forEach(function(f,m){Ug(n,f,m==0?d.name:d.name+"_"+m,!0)})}})}),n.SheetNames.length==0)throw new Error("Empty NUMBERS file");return n}function pm(e){var t,n,r,s,i={},l=[];if(e.FullPaths.forEach(function(d){if(d.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(d){if(d.name.match(/\.iwa$/)){var f;try{f=oa(d.content)}catch(p){return console.log("?? "+d.content.length+" "+(p.message||p))}var m;try{m=ia(f)}catch(p){return console.log("## "+(p.message||p))}m.forEach(function(p){i[p.id]=p.messages,l.push(p.id)})}}),!l.length)throw new Error("File has no messages");var u=((s=(r=(n=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:n.meta)==null?void 0:r[1])==null?void 0:s[0].data)&&mn(i[1][0].meta[1][0].data)==1&&i[1][0];if(u||l.forEach(function(d){i[d].forEach(function(f){var m=mn(f.meta[1][0].data)>>>0;if(m==1)if(!u)u=f;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return Vz(i,u)}function qz(e,t,n){var r,s,i,l;if(!((r=e[6])!=null&&r[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var u=((l=(i=e[8])==null?void 0:i[0])==null?void 0:l.data)&&mn(e[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var d=0,f=no(e[7][0].data),m=0,p=[],x=no(e[4][0].data),v=0,k=[],y=0;y<t.length;++y){if(t[y]==null){f.setUint16(y*2,65535,!0),x.setUint16(y*2,65535);continue}f.setUint16(y*2,m,!0),x.setUint16(y*2,v,!0);var S,C;switch(typeof t[y]){case"string":S=fm({t:"s",v:t[y]},n),C=mm({t:"s",v:t[y]},n);break;case"number":S=fm({t:"n",v:t[y]},n),C=mm({t:"n",v:t[y]},n);break;case"boolean":S=fm({t:"b",v:t[y]},n),C=mm({t:"b",v:t[y]},n);break;default:throw new Error("Unsupported value "+t[y])}p.push(S),m+=S.length,k.push(C),v+=C.length,++d}for(e[2][0].data=Dt(d);y<e[7][0].data.length/2;++y)f.setUint16(y*2,65535,!0),x.setUint16(y*2,65535,!0);return e[6][0].data=di(p),e[3][0].data=di(k),d}function Kz(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=Fr(n["!ref"]);r.s.r=r.s.c=0;var s=!1;r.e.c>9&&(s=!0,r.e.c=9),r.e.r>49&&(s=!0,r.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(ft(r)));var i=Rh(n,{range:r,header:1}),l=["~Sh33tJ5~"];i.forEach(function(Z){return Z.forEach(function(Y){typeof Y=="string"&&l.push(Y)})});var u={},d=[],f=nt.read(t.numbers,{type:"base64"});f.FileIndex.map(function(Z,Y){return[Z,f.FullPaths[Y]]}).forEach(function(Z){var Y=Z[0],P=Z[1];if(Y.type==2&&Y.name.match(/\.iwa/)){var ne=Y.content,J=oa(ne),de=ia(J);de.forEach(function(E){d.push(E.id),u[E.id]={deps:[],location:P,type:mn(E.messages[0].meta[1][0].data)}})}}),d.sort(function(Z,Y){return Z-Y});var m=d.filter(function(Z){return Z>1}).map(function(Z){return[Z,Dt(Z)]});f.FileIndex.map(function(Z,Y){return[Z,f.FullPaths[Y]]}).forEach(function(Z){var Y=Z[0];if(Z[1],!!Y.name.match(/\.iwa/)){var P=ia(oa(Y.content));P.forEach(function(ne){ne.messages.forEach(function(J){m.forEach(function(de){ne.messages.some(function(E){return mn(E.meta[1][0].data)!=11006&&Dz(E.data,de[1])})&&u[de[0]].deps.push(ne.id)})})})}});for(var p=nt.find(f,u[1].location),x=ia(oa(p.content)),v,k=0;k<x.length;++k){var y=x[k];y.id==1&&(v=y)}var S=or(At(v.messages[0].data)[1][0].data);for(p=nt.find(f,u[S].location),x=ia(oa(p.content)),k=0;k<x.length;++k)y=x[k],y.id==S&&(v=y);for(S=or(At(v.messages[0].data)[2][0].data),p=nt.find(f,u[S].location),x=ia(oa(p.content)),k=0;k<x.length;++k)y=x[k],y.id==S&&(v=y);for(S=or(At(v.messages[0].data)[2][0].data),p=nt.find(f,u[S].location),x=ia(oa(p.content)),k=0;k<x.length;++k)y=x[k],y.id==S&&(v=y);var C=At(v.messages[0].data);{C[6][0].data=Dt(r.e.r+1),C[7][0].data=Dt(r.e.c+1);var D=or(C[46][0].data),N=nt.find(f,u[D].location),b=ia(oa(N.content));{for(var H=0;H<b.length&&b[H].id!=D;++H);if(b[H].id!=D)throw"Bad ColumnRowUIDMapArchive";var L=At(b[H].messages[0].data);L[1]=[],L[2]=[],L[3]=[];for(var R=0;R<=r.e.c;++R){var q=[];q[1]=q[2]=[{type:0,data:Dt(R+420690)}],L[1].push({type:2,data:Xn(q)}),L[2].push({type:0,data:Dt(R)}),L[3].push({type:0,data:Dt(R)})}L[4]=[],L[5]=[],L[6]=[];for(var O=0;O<=r.e.r;++O)q=[],q[1]=q[2]=[{type:0,data:Dt(O+726270)}],L[4].push({type:2,data:Xn(q)}),L[5].push({type:0,data:Dt(O)}),L[6].push({type:0,data:Dt(O)});b[H].messages[0].data=Xn(L)}N.content=Bo(Mo(b)),N.size=N.content.length,delete C[46];var V=At(C[4][0].data);{V[7][0].data=Dt(r.e.r+1);var X=At(V[1][0].data),M=or(X[2][0].data);N=nt.find(f,u[M].location),b=ia(oa(N.content));{if(b[0].id!=M)throw"Bad HeaderStorageBucket";var me=At(b[0].messages[0].data);for(O=0;O<i.length;++O){var ae=At(me[2][0].data);ae[1][0].data=Dt(O),ae[4][0].data=Dt(i[O].length),me[2][O]={type:me[2][0].type,data:Xn(ae)}}b[0].messages[0].data=Xn(me)}N.content=Bo(Mo(b)),N.size=N.content.length;var ce=or(V[2][0].data);N=nt.find(f,u[ce].location),b=ia(oa(N.content));{if(b[0].id!=ce)throw"Bad HeaderStorageBucket";for(me=At(b[0].messages[0].data),R=0;R<=r.e.c;++R)ae=At(me[2][0].data),ae[1][0].data=Dt(R),ae[4][0].data=Dt(r.e.r+1),me[2][R]={type:me[2][0].type,data:Xn(ae)};b[0].messages[0].data=Xn(me)}N.content=Bo(Mo(b)),N.size=N.content.length;var ue=or(V[4][0].data);(function(){for(var Z=nt.find(f,u[ue].location),Y=ia(oa(Z.content)),P,ne=0;ne<Y.length;++ne){var J=Y[ne];J.id==ue&&(P=J)}var de=At(P.messages[0].data);{de[3]=[];var E=[];l.forEach(function(G,Ie){E[1]=[{type:0,data:Dt(Ie)}],E[2]=[{type:0,data:Dt(1)}],E[3]=[{type:2,data:Pz(G)}],de[3].push({type:2,data:Xn(E)})})}P.messages[0].data=Xn(de);var A=Mo(Y),he=Bo(A);Z.content=he,Z.size=Z.content.length})();var K=At(V[3][0].data);{var W=K[1][0];delete K[2];var j=At(W.data);{var F=or(j[2][0].data);(function(){for(var Z=nt.find(f,u[F].location),Y=ia(oa(Z.content)),P,ne=0;ne<Y.length;++ne){var J=Y[ne];J.id==F&&(P=J)}var de=At(P.messages[0].data);{delete de[6],delete K[7];var E=new Uint8Array(de[5][0].data);de[5]=[];for(var A=0,he=0;he<=r.e.r;++he){var G=At(E);A+=qz(G,i[he],l),G[1][0].data=Dt(he),de[5].push({data:Xn(G),type:2})}de[1]=[{type:0,data:Dt(r.e.c+1)}],de[2]=[{type:0,data:Dt(r.e.r+1)}],de[3]=[{type:0,data:Dt(A)}],de[4]=[{type:0,data:Dt(r.e.r+1)}]}P.messages[0].data=Xn(de);var Ie=Mo(Y),oe=Bo(Ie);Z.content=oe,Z.size=Z.content.length})()}W.data=Xn(j)}V[3][0].data=Xn(K)}C[4][0].data=Xn(V)}v.messages[0].data=Xn(C);var U=Mo(x),I=Bo(U);return p.content=I,p.size=p.content.length,f}function y2(e){return function(n){for(var r=0;r!=e.length;++r){var s=e[r];n[s[0]]===void 0&&(n[s[0]]=s[1]),s[2]==="n"&&(n[s[0]]=Number(n[s[0]]))}}}function Og(e){y2([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Lg(e){y2([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Yz(e){return xt.WS.indexOf(e)>-1?"sheet":e==xt.CS?"chart":e==xt.DS?"dialog":e==xt.MS?"macro":e&&e.length?e:"sheet"}function Xz(e,t){if(!e)return 0;try{e=t.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,Yz(e["!id"][r.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Qz(e,t,n,r,s,i,l,u,d,f,m,p){try{i[r]=Cc(Vr(e,n,!0),t);var x=En(e,t),v;switch(u){case"sheet":v=yU(x,t,s,d,i[r],f,m,p);break;case"chart":if(v=kU(x,t,s,d,i[r],f,m,p),!v||!v["!drawel"])break;var k=mc(v["!drawel"].Target,t),y=Vc(k),S=i5(Vr(e,k,!0),Cc(Vr(e,y,!0),k)),C=mc(S,k),D=Vc(C);v=q9(Vr(e,C,!0),C,d,Cc(Vr(e,D,!0),C),f,v);break;case"macro":v=wU(x,t,s,d,i[r],f,m,p);break;case"dialog":v=SU(x,t,s,d,i[r],f,m,p);break;default:throw new Error("Unrecognized sheet type "+u)}l[r]=v;var N=[];i&&i[r]&&pn(i[r]).forEach(function(b){var H="";if(i[r][b].Type==xt.CMNT){H=mc(i[r][b].Target,t);var L=EU(En(e,H,!0),H,d);if(!L||!L.length)return;zk(v,L,!1)}i[r][b].Type==xt.TCMNT&&(H=mc(i[r][b].Target,t),N=N.concat(l5(En(e,H,!0),d)))}),N&&N.length&&zk(v,N,!0,d.people||[])}catch(b){if(d.WTF)throw b}}function aa(e){return e.charAt(0)=="/"?e.slice(1):e}function Jz(e,t){if(vl(),t=t||{},Og(t),la(e,"META-INF/manifest.xml")||la(e,"objectdata.xml"))return Jk(e,t);if(la(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof pm<"u"){if(e.FileIndex)return pm(e);var n=nt.utils.cfb_new();return lk(e).forEach(function(ae){mt(n,ae,cL(e,ae))}),pm(n)}throw new Error("Unsupported NUMBERS file")}if(!la(e,"[Content_Types].xml"))throw la(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):la(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=lk(e),s=nF(Vr(e,"[Content_Types].xml")),i=!1,l,u;if(s.workbooks.length===0&&(u="xl/workbook.xml",En(e,u,!0)&&s.workbooks.push(u)),s.workbooks.length===0){if(u="xl/workbook.bin",!En(e,u,!0))throw new Error("Could not find workbook");s.workbooks.push(u),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var d={},f={};if(!t.bookSheets&&!t.bookProps){if(Nc=[],s.sst)try{Nc=NU(En(e,aa(s.sst)),s.sst,t)}catch(ae){if(t.WTF)throw ae}t.cellStyles&&s.themes.length&&(d=CU(Vr(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(f=_U(En(e,aa(s.style)),s.style,d,t))}s.links.map(function(ae){try{var ce=Cc(Vr(e,Vc(aa(ae))),ae);return bU(En(e,aa(ae)),ce,ae,t)}catch{}});var m=vU(En(e,aa(s.workbooks[0])),s.workbooks[0],t),p={},x="";s.coreprops.length&&(x=En(e,aa(s.coreprops[0]),!0),x&&(p=oC(x)),s.extprops.length!==0&&(x=En(e,aa(s.extprops[0]),!0),x&&cF(x,p,t)));var v={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(x=Vr(e,aa(s.custprops[0]),!0),x&&(v=dF(x,t)));var k={};if((t.bookSheets||t.bookProps)&&(m.Sheets?l=m.Sheets.map(function(ce){return ce.name}):p.Worksheets&&p.SheetNames.length>0&&(l=p.SheetNames),t.bookProps&&(k.Props=p,k.Custprops=v),t.bookSheets&&typeof l<"u"&&(k.SheetNames=l),t.bookSheets?k.SheetNames:t.bookProps))return k;l={};var y={};t.bookDeps&&s.calcchain&&(y=TU(En(e,aa(s.calcchain)),s.calcchain));var S=0,C={},D,N;{var b=m.Sheets;p.Worksheets=b.length,p.SheetNames=[];for(var H=0;H!=b.length;++H)p.SheetNames[H]=b[H].name}var L=i?"bin":"xml",R=s.workbooks[0].lastIndexOf("/"),q=(s.workbooks[0].slice(0,R+1)+"_rels/"+s.workbooks[0].slice(R+1)+".rels").replace(/^\//,"");la(e,q)||(q="xl/_rels/workbook."+L+".rels");var O=Cc(Vr(e,q,!0),q.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=AU(En(e,aa(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=u5(En(e,aa(s.people[0])),t)),O&&(O=Xz(O,m.Sheets));var V=En(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=p.Worksheets;++S){var X="sheet";if(O&&O[S]?(D="xl/"+O[S][1].replace(/[\/]?xl\//,""),la(e,D)||(D=O[S][1]),la(e,D)||(D=q.replace(/_rels\/.*$/,"")+O[S][1]),X=O[S][2]):(D="xl/worksheets/sheet"+(S+1-V)+"."+L,D=D.replace(/sheet0\./,"sheet.")),N=D.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(S!=t.sheets)continue e;break;case"string":if(p.SheetNames[S].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var M=!1,me=0;me!=t.sheets.length;++me)typeof t.sheets[me]=="number"&&t.sheets[me]==S&&(M=1),typeof t.sheets[me]=="string"&&t.sheets[me].toLowerCase()==p.SheetNames[S].toLowerCase()&&(M=1);if(!M)continue e}}Qz(e,D,N,p.SheetNames[S],S,C,l,X,t,m,d,f)}return k={Directory:s,Workbook:m,Props:p,Custprops:v,Deps:y,Sheets:l,SheetNames:p.SheetNames,Strings:Nc,Styles:f,Themes:d,SSF:Zt(st)},t&&t.bookFiles&&(e.files?(k.keys=r,k.files=e.files):(k.keys=[],k.files={},e.FullPaths.forEach(function(ae,ce){ae=ae.replace(/^Root Entry[\/]/,""),k.keys.push(ae),k.files[ae]=e.FileIndex[ce]}))),t&&t.bookVBA&&(s.vba.length>0?k.vbaraw=En(e,aa(s.vba[0]),!0):s.defaults&&s.defaults.bin===v5&&(k.vbaraw=En(e,"xl/vbaProject.bin",!0))),k}function Zz(e,t){var n=t||{},r="Workbook",s=nt.find(e,r);try{if(r="/!DataSpaces/Version",s=nt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(AM(s.content),r="/!DataSpaces/DataSpaceMap",s=nt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);var i=RM(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=nt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=IM(s.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=nt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);DM(s.content)}catch{}if(r="/EncryptionInfo",s=nt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);var u=OM(s.content);if(r="/EncryptedPackage",s=nt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],s.content,n.password||"",n);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],s.content,n.password||"",n);throw new Error("File is password-protected")}function eW(e,t){return t.bookType=="ods"?v2(e,t):t.bookType=="numbers"?Kz(e,t):t.bookType=="xlsb"?tW(e,t):nW(e,t)}function tW(e,t){Go=1024,e&&!e.SSF&&(e.SSF=Zt(st)),e&&e.SSF&&(vl(),qh(e.SSF),t.revssf=Yh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ec?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n=t.bookType=="xlsb"?"bin":"xml",r=VC.indexOf(t.bookType)>-1,s=wg();Lg(t=t||{});var i=og(),l="",u=0;if(t.cellXfs=[],gi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",mt(i,l,lC(e.Props,t)),s.coreprops.push(l),Ot(t.rels,2,l,xt.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&d.push(e.SheetNames[f]);e.Props.SheetNames=d}for(e.Props.Worksheets=e.Props.SheetNames.length,mt(i,l,dC(e.Props)),s.extprops.push(l),Ot(t.rels,3,l,xt.EXT_PROPS),e.Custprops!==e.Props&&pn(e.Custprops||{}).length>0&&(l="docProps/custom.xml",mt(i,l,hC(e.Custprops)),s.custprops.push(l),Ot(t.rels,4,l,xt.CUST_PROPS)),u=1;u<=e.SheetNames.length;++u){var m={"!id":{}},p=e.Sheets[e.SheetNames[u-1]],x=(p||{})["!type"]||"sheet";switch(x){case"chart":default:l="xl/worksheets/sheet"+u+"."+n,mt(i,l,RU(u-1,l,t,e,m)),s.sheets.push(l),Ot(t.wbrels,-1,"worksheets/sheet"+u+"."+n,xt.WS[0])}if(p){var v=p["!comments"],k=!1,y="";v&&v.length>0&&(y="xl/comments"+u+"."+n,mt(i,y,DU(v,y)),s.comments.push(y),Ot(m,-1,"../comments"+u+"."+n,xt.CMNT),k=!0),p["!legacy"]&&k&&mt(i,"xl/drawings/vmlDrawing"+u+".vml",GC(u,p["!comments"])),delete p["!comments"],delete p["!legacy"]}m["!id"].rId1&&mt(i,Vc(l),Zo(m))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+n,mt(i,l,PU(t.Strings,l,t)),s.strs.push(l),Ot(t.wbrels,-1,"sharedStrings."+n,xt.SST)),l="xl/workbook."+n,mt(i,l,jU(e,l)),s.workbooks.push(l),Ot(t.rels,1,l,xt.WB),l="xl/theme/theme1.xml",mt(i,l,Tg(e.Themes,t)),s.themes.push(l),Ot(t.wbrels,-1,"theme/theme1.xml",xt.THEME),l="xl/styles."+n,mt(i,l,IU(e,l,t)),s.styles.push(l),Ot(t.wbrels,-1,"styles."+n,xt.STY),e.vbaraw&&r&&(l="xl/vbaProject.bin",mt(i,l,e.vbaraw),s.vba.push(l),Ot(t.wbrels,-1,"vbaProject.bin",xt.VBA)),l="xl/metadata."+n,mt(i,l,OU(l)),s.metadata.push(l),Ot(t.wbrels,-1,"metadata."+n,xt.XLMETA),mt(i,"[Content_Types].xml",sC(s,t)),mt(i,"_rels/.rels",Zo(t.rels)),mt(i,"xl/_rels/workbook."+n+".rels",Zo(t.wbrels)),delete t.revssf,delete t.ssf,i}function nW(e,t){Go=1024,e&&!e.SSF&&(e.SSF=Zt(st)),e&&e.SSF&&(vl(),qh(e.SSF),t.revssf=Yh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ec?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xml",r=VC.indexOf(t.bookType)>-1,s=wg();Lg(t=t||{});var i=og(),l="",u=0;if(t.cellXfs=[],gi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",mt(i,l,lC(e.Props,t)),s.coreprops.push(l),Ot(t.rels,2,l,xt.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&d.push(e.SheetNames[f]);e.Props.SheetNames=d}e.Props.Worksheets=e.Props.SheetNames.length,mt(i,l,dC(e.Props)),s.extprops.push(l),Ot(t.rels,3,l,xt.EXT_PROPS),e.Custprops!==e.Props&&pn(e.Custprops||{}).length>0&&(l="docProps/custom.xml",mt(i,l,hC(e.Custprops)),s.custprops.push(l),Ot(t.rels,4,l,xt.CUST_PROPS));var m=["SheetJ5"];for(t.tcid=0,u=1;u<=e.SheetNames.length;++u){var p={"!id":{}},x=e.Sheets[e.SheetNames[u-1]],v=(x||{})["!type"]||"sheet";switch(v){case"chart":default:l="xl/worksheets/sheet"+u+"."+n,mt(i,l,r2(u-1,t,e,p)),s.sheets.push(l),Ot(t.wbrels,-1,"worksheets/sheet"+u+"."+n,xt.WS[0])}if(x){var k=x["!comments"],y=!1,S="";if(k&&k.length>0){var C=!1;k.forEach(function(D){D[1].forEach(function(N){N.T==!0&&(C=!0)})}),C&&(S="xl/threadedComments/threadedComment"+u+"."+n,mt(i,S,c5(k,m,t)),s.threadedcomments.push(S),Ot(p,-1,"../threadedComments/threadedComment"+u+"."+n,xt.TCMNT)),S="xl/comments"+u+"."+n,mt(i,S,$C(k)),s.comments.push(S),Ot(p,-1,"../comments"+u+"."+n,xt.CMNT),y=!0}x["!legacy"]&&y&&mt(i,"xl/drawings/vmlDrawing"+u+".vml",GC(u,x["!comments"])),delete x["!comments"],delete x["!legacy"]}p["!id"].rId1&&mt(i,Vc(l),Zo(p))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+n,mt(i,l,IC(t.Strings,t)),s.strs.push(l),Ot(t.wbrels,-1,"sharedStrings."+n,xt.SST)),l="xl/workbook."+n,mt(i,l,l2(e)),s.workbooks.push(l),Ot(t.rels,1,l,xt.WB),l="xl/theme/theme1.xml",mt(i,l,Tg(e.Themes,t)),s.themes.push(l),Ot(t.wbrels,-1,"theme/theme1.xml",xt.THEME),l="xl/styles."+n,mt(i,l,UC(e,t)),s.styles.push(l),Ot(t.wbrels,-1,"styles."+n,xt.STY),e.vbaraw&&r&&(l="xl/vbaProject.bin",mt(i,l,e.vbaraw),s.vba.push(l),Ot(t.wbrels,-1,"vbaProject.bin",xt.VBA)),l="xl/metadata."+n,mt(i,l,HC()),s.metadata.push(l),Ot(t.wbrels,-1,"metadata."+n,xt.XLMETA),m.length>1&&(l="xl/persons/person.xml",mt(i,l,d5(m)),s.people.push(l),Ot(t.wbrels,-1,"persons/person.xml",xt.PEOPLE)),mt(i,"[Content_Types].xml",sC(s,t)),mt(i,"_rels/.rels",Zo(t.rels)),mt(i,"xl/_rels/workbook."+n+".rels",Zo(t.wbrels)),delete t.revssf,delete t.ssf,i}function Fg(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=Qr(e.slice(0,12));break;case"binary":n=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function rW(e,t){return nt.find(e,"EncryptedPackage")?Zz(e,t):h2(e,t)}function aW(e,t){var n,r=e,s=t||{};return s.type||(s.type=pt&&Buffer.isBuffer(e)?"buffer":"base64"),n=D_(r,s),Jz(n,s)}function k2(e,t){var n=0;e:for(;n<e.length;)switch(e.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return tp(e.slice(n),t);default:break e}return ll.to_workbook(e,t)}function sW(e,t){var n="",r=Fg(e,t);switch(t.type){case"base64":n=Qr(e);break;case"binary":n=e;break;case"buffer":n=e.toString("binary");break;case"array":n=Ji(e);break;default:throw new Error("Unrecognized type "+t.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(n=Bt(n)),t.type="binary",k2(n,t)}function iW(e,t){var n=e;return t.type=="base64"&&(n=Qr(n)),n=Uc.utils.decode(1200,n.slice(2),"str"),t.type="binary",k2(n,t)}function oW(e){return e.match(/[^\x00-\x7F]/)?qa(e):e}function gm(e,t,n,r){return r?(n.type="string",ll.to_workbook(e,n)):ll.to_workbook(t,n)}function ap(e,t){ng();var n=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return ap(new Uint8Array(e),(n=Zt(n),n.type="array",n));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!n.type&&(n.type=typeof Deno<"u"?"buffer":"array");var r=e,s=[0,0,0,0],i=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),tl={},n.dateNF&&(tl.dateNF=n.dateNF),n.type||(n.type=pt&&Buffer.isBuffer(e)?"buffer":"base64"),n.type=="file"&&(n.type=pt?"buffer":"binary",r=tL(e),typeof Uint8Array<"u"&&!pt&&(n.type="array")),n.type=="string"&&(i=!0,n.type="binary",n.codepage=65001,r=oW(e)),n.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),u=new Uint8Array(l);if(u.foo="bar",!u.foo)return n=Zt(n),n.type="array",ap(rg(r),n)}switch((s=Fg(r,n))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return rW(nt.read(r,n),n);break;case 9:if(s[1]<=8)return h2(r,n);break;case 60:return tp(r,n);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return hM(r,n);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return jC.to_workbook(r,n);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?aW(r,n):gm(e,r,n,i);case 239:return s[3]===60?tp(r,n):gm(e,r,n,i);case 255:if(s[1]===254)return iW(r,n);if(s[1]===0&&s[2]===2&&s[3]===0)return Wi.to_workbook(r,n);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Wi.to_workbook(r,n);break;case 3:case 131:case 139:case 140:return ep.to_workbook(r,n);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return FC.to_workbook(r,n);break;case 10:case 13:case 32:return sW(r,n);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return dM.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?ep.to_workbook(r,n):gm(e,r,n,i)}function w2(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return uu(t.file,nt.write(e,{type:pt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return nt.write(e,t)}function lW(e,t){var n=Zt(t||{}),r=eW(e,n);return cW(r,n)}function cW(e,t){var n={},r=pt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(n.compression="DEFLATE"),t.password)n.type=r;else switch(t.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?nt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!t.compression}):e.generate(n);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(Vh(s))}return t.password&&typeof encrypt_agile<"u"?w2(encrypt_agile(s,t.password),t):t.type==="file"?uu(t.file,s):t.type=="string"?Bt(s):s}function uW(e,t){var n=t||{},r=oz(e,n);return w2(r,n)}function Ga(e,t,n){n||(n="");var r=n+e;switch(t.type){case"base64":return zc(qa(r));case"binary":return qa(r);case"string":return e;case"file":return uu(t.file,r,"utf8");case"buffer":return pt?Cs(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):Ga(r,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function dW(e,t){switch(t.type){case"base64":return zc(e);case"binary":return e;case"string":return e;case"file":return uu(t.file,e,"binary");case"buffer":return pt?Cs(e,"binary"):e.split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Wd(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",r=0;r<e.length;++r)n+=String.fromCharCode(e[r]);return t.type=="base64"?zc(n):t.type=="string"?Bt(n):n;case"file":return uu(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function S2(e,t){ng(),rU(e);var n=Zt(t||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),n.type=="array"){n.type="binary";var r=S2(e,n);return n.type="array",Vh(r)}var s=0;if(n.sheet&&(typeof n.sheet=="number"?s=n.sheet:s=e.SheetNames.indexOf(n.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return Ga(ez(e,n),n);case"slk":case"sylk":return Ga(AC.from_sheet(e.Sheets[e.SheetNames[s]],n),n);case"htm":case"html":return Ga(m2(e.Sheets[e.SheetNames[s]],n),n);case"txt":return dW(_2(e.Sheets[e.SheetNames[s]],n),n);case"csv":return Ga(Mg(e.Sheets[e.SheetNames[s]],n),n,"\uFEFF");case"dif":return Ga(jC.from_sheet(e.Sheets[e.SheetNames[s]],n),n);case"dbf":return Wd(ep.from_sheet(e.Sheets[e.SheetNames[s]],n),n);case"prn":return Ga(ll.from_sheet(e.Sheets[e.SheetNames[s]],n),n);case"rtf":return Ga(FC.from_sheet(e.Sheets[e.SheetNames[s]],n),n);case"eth":return Ga(RC.from_sheet(e.Sheets[e.SheetNames[s]],n),n);case"fods":return Ga(v2(e,n),n);case"wk1":return Wd(Wi.sheet_to_wk1(e.Sheets[e.SheetNames[s]],n),n);case"wk3":return Wd(Wi.book_to_wk3(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),Wd(f2(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),uW(e,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return lW(e,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function hW(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},n=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();n.match(/^\.[a-z]+$/)&&(e.bookType=n.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function fW(e,t,n){var r={};return r.type="file",r.file=t,hW(r),S2(e,r)}function mW(e,t,n,r,s,i,l,u){var d=Sn(n),f=u.defval,m=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),p=!0,x=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:n,enumerable:!1})}catch{x.__rowNum__=n}else x.__rowNum__=n;if(!l||e[n])for(var v=t.s.c;v<=t.e.c;++v){var k=l?e[n][v]:e[r[v]+d];if(k===void 0||k.t===void 0){if(f===void 0)continue;i[v]!=null&&(x[i[v]]=f);continue}var y=k.v;switch(k.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+k.t)}if(i[v]!=null){if(y==null)if(k.t=="e"&&y===null)x[i[v]]=null;else if(f!==void 0)x[i[v]]=f;else if(m&&y===null)x[i[v]]=null;else continue;else x[i[v]]=m&&(k.t!=="n"||k.t==="n"&&u.rawNumbers!==!1)?y:ks(k,y,u);y!=null&&(p=!1)}}return{row:x,isempty:p}}function Rh(e,t){if(e==null||e["!ref"]==null)return[];var n={t:"n",v:0},r=0,s=1,i=[],l=0,u="",d={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},m=f.range!=null?f.range:e["!ref"];switch(f.header===1?r=1:f.header==="A"?r=2:Array.isArray(f.header)?r=3:f.header==null&&(r=0),typeof m){case"string":d=Tt(m);break;case"number":d=Tt(e["!ref"]),d.s.r=m;break;default:d=m}r>0&&(s=0);var p=Sn(d.s.r),x=[],v=[],k=0,y=0,S=Array.isArray(e),C=d.s.r,D=0,N={};S&&!e[C]&&(e[C]=[]);var b=f.skipHidden&&e["!cols"]||[],H=f.skipHidden&&e["!rows"]||[];for(D=d.s.c;D<=d.e.c;++D)if(!(b[D]||{}).hidden)switch(x[D]=on(D),n=S?e[C][D]:e[x[D]+p],r){case 1:i[D]=D-d.s.c;break;case 2:i[D]=x[D];break;case 3:i[D]=f.header[D-d.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),u=l=ks(n,null,f),y=N[l]||0,!y)N[l]=1;else{do u=l+"_"+y++;while(N[u]);N[l]=y,N[u]=1}i[D]=u}for(C=d.s.r+s;C<=d.e.r;++C)if(!(H[C]||{}).hidden){var L=mW(e,d,C,x,r,i,S,f);(L.isempty===!1||(r===1?f.blankrows!==!1:f.blankrows))&&(v[k++]=L.row)}return v.length=k,v}var rw=/"/g;function pW(e,t,n,r,s,i,l,u){for(var d=!0,f=[],m="",p=Sn(n),x=t.s.c;x<=t.e.c;++x)if(r[x]){var v=u.dense?(e[n]||[])[x]:e[r[x]+p];if(v==null)m="";else if(v.v!=null){d=!1,m=""+(u.rawNumbers&&v.t=="n"?v.v:ks(v,null,u));for(var k=0,y=0;k!==m.length;++k)if((y=m.charCodeAt(k))===s||y===i||y===34||u.forceQuotes){m='"'+m.replace(rw,'""')+'"';break}m=="ID"&&(m='"ID"')}else v.f!=null&&!v.F?(d=!1,m="="+v.f,m.indexOf(",")>=0&&(m='"'+m.replace(rw,'""')+'"')):m="";f.push(m)}return u.blankrows===!1&&d?null:f.join(l)}function Mg(e,t){var n=[],r=t??{};if(e==null||e["!ref"]==null)return"";var s=Tt(e["!ref"]),i=r.FS!==void 0?r.FS:",",l=i.charCodeAt(0),u=r.RS!==void 0?r.RS:`
`,d=u.charCodeAt(0),f=new RegExp((i=="|"?"\\|":i)+"+$"),m="",p=[];r.dense=Array.isArray(e);for(var x=r.skipHidden&&e["!cols"]||[],v=r.skipHidden&&e["!rows"]||[],k=s.s.c;k<=s.e.c;++k)(x[k]||{}).hidden||(p[k]=on(k));for(var y=0,S=s.s.r;S<=s.e.r;++S)(v[S]||{}).hidden||(m=pW(e,s,S,p,l,d,i,r),m!=null&&(r.strip&&(m=m.replace(f,"")),(m||r.blankrows!==!1)&&n.push((y++?u:"")+m)));return delete r.dense,n.join("")}function _2(e,t){t||(t={}),t.FS="	",t.RS=`
`;var n=Mg(e,t);return n}function gW(e){var t="",n,r="";if(e==null||e["!ref"]==null)return[];var s=Tt(e["!ref"]),i="",l=[],u,d=[],f=Array.isArray(e);for(u=s.s.c;u<=s.e.c;++u)l[u]=on(u);for(var m=s.s.r;m<=s.e.r;++m)for(i=Sn(m),u=s.s.c;u<=s.e.c;++u)if(t=l[u]+i,n=f?(e[m]||[])[u]:e[t],r="",n!==void 0){if(n.F!=null){if(t=n.F,!n.f)continue;r=n.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(n.f!=null)r=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)r=""+n.v;else if(n.t=="b")r=n.v?"TRUE":"FALSE";else if(n.w!==void 0)r="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?r="'"+n.v:r=""+n.v}}d[d.length]=t+"="+r}return d}function C2(e,t,n){var r=n||{},s=+!r.skipHeader,i=e||{},l=0,u=0;if(i&&r.origin!=null)if(typeof r.origin=="number")l=r.origin;else{var d=typeof r.origin=="string"?ln(r.origin):r.origin;l=d.r,u=d.c}var f,m={s:{c:0,r:0},e:{c:u,r:l+t.length-1+s}};if(i["!ref"]){var p=Tt(i["!ref"]);m.e.c=Math.max(m.e.c,p.e.c),m.e.r=Math.max(m.e.r,p.e.r),l==-1&&(l=p.e.r+1,m.e.r=l+t.length-1+s)}else l==-1&&(l=0,m.e.r=t.length-1+s);var x=r.header||[],v=0;t.forEach(function(y,S){pn(y).forEach(function(C){(v=x.indexOf(C))==-1&&(x[v=x.length]=C);var D=y[C],N="z",b="",H=it({c:u+v,r:l+S+s});f=Zc(i,H),D&&typeof D=="object"&&!(D instanceof Date)?i[H]=D:(typeof D=="number"?N="n":typeof D=="boolean"?N="b":typeof D=="string"?N="s":D instanceof Date?(N="d",r.cellDates||(N="n",D=Dn(D)),b=r.dateNF||st[14]):D===null&&r.nullError&&(N="e",D=0),f?(f.t=N,f.v=D,delete f.w,delete f.R,b&&(f.z=b)):i[H]=f={t:N,v:D},b&&(f.z=b))})}),m.e.c=Math.max(m.e.c,u+x.length-1);var k=Sn(l);if(s)for(v=0;v<x.length;++v)i[on(v+u)+k]={t:"s",v:x[v]};return i["!ref"]=ft(m),i}function xW(e,t){return C2(null,e,t)}function Zc(e,t,n){if(typeof t=="string"){if(Array.isArray(e)){var r=ln(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Zc(e,it(t)):Zc(e,it({r:t,c:n||0}))}function vW(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Bg(){return{SheetNames:[],Sheets:{}}}function Ug(e,t,n,r){var s=1;if(!n)for(;s<=65535&&e.SheetNames.indexOf(n="Sheet"+s)!=-1;++s,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var i=n.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var l=i&&i[1]||n;for(++s;s<=65535&&e.SheetNames.indexOf(n=l+s)!=-1;++s);}if(o2(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function yW(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=vW(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n}function kW(e,t){return e.z=t,e}function N2(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}function wW(e,t,n){return N2(e,"#"+t,n)}function SW(e,t,n){e.c||(e.c=[]),e.c.push({t,a:n||"SheetJS"})}function _W(e,t,n,r){for(var s=typeof t!="string"?t:Tt(t),i=typeof t=="string"?t:ft(t),l=s.s.r;l<=s.e.r;++l)for(var u=s.s.c;u<=s.e.c;++u){var d=Zc(e,l,u);d.t="n",d.F=i,delete d.v,l==s.s.r&&u==s.s.c&&(d.f=n,r&&(d.D=!0))}return e}var Hd={encode_col:on,encode_row:Sn,encode_cell:it,encode_range:ft,decode_col:pg,decode_row:mg,split_cell:PL,decode_cell:ln,decode_range:Fr,format_cell:ks,sheet_add_aoa:J_,sheet_add_json:C2,sheet_add_dom:p2,aoa_to_sheet:yl,json_to_sheet:xW,table_to_sheet:g2,table_to_book:Az,sheet_to_csv:Mg,sheet_to_txt:_2,sheet_to_json:Rh,sheet_to_html:m2,sheet_to_formulae:gW,sheet_to_row_object_array:Rh,sheet_get_cell:Zc,book_new:Bg,book_append_sheet:Ug,book_set_sheet_visibility:yW,cell_set_number_format:kW,cell_set_hyperlink:N2,cell_set_internal_link:wW,cell_add_comment:SW,sheet_set_array_formula:_W,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const aw=e=>/^[A-Z]{4}[0-9]{7}$/.test(e==null?void 0:e.toUpperCase());function CW(){cn();const{registerContainer:e,containers:t}=qt(),{user:n}=Ft(),{getCodeList:r}=On(),s=en(),i=r("LINERS"),l=r("CONTAINER_SIZES"),u=r("CONTAINER_TYPES"),[d,f]=T.useState("manual"),[m,p]=T.useState({containerNumber:"",liner:"",size:"40",type:"DRY",status:"STACKING",requiresWashing:!1,initialConditionNotes:""}),[x,v]=T.useState({}),[k,y]=T.useState([]),[S,C]=T.useState([]),[D,N]=T.useState(!1),b=()=>{const O={};return m.containerNumber?aw(m.containerNumber)||(O.containerNumber="Invalid format (e.g., MSCU1234567)"):O.containerNumber="Container number is required",t.find(X=>X.containerNumber===m.containerNumber.toUpperCase())&&(O.containerNumber="Container already exists"),m.liner||(O.liner="Liner is required"),v(O),Object.keys(O).length===0},H=O=>{if(O.preventDefault(),!b())return;const V=e({containerNumber:m.containerNumber.toUpperCase(),liner:m.liner,size:m.size,type:m.type,status:m.requiresWashing?"PENDING_WASH":m.status,requiresWashing:m.requiresWashing,initialConditionNotes:m.initialConditionNotes,gateInTime:new Date().toISOString()},n.username);s.success(`Container ${V.containerNumber} registered!`),p({containerNumber:"",liner:"",size:"40",type:"DRY",status:"STACKING",requiresWashing:!1,initialConditionNotes:""})},L=()=>{const O=[{containerNumber:"MSCU1234567",liner:"MSC",size:"40",type:"DRY",status:"DM",location:"A-01-1",gateInDate:"2024-12-01"},{containerNumber:"MAEU7654321",liner:"MAERSK",size:"20",type:"REEFER",status:"STACKING",location:"B-02-2",gateInDate:"2024-12-02"}],V=Hd.json_to_sheet(O),X=Hd.book_new();Hd.book_append_sheet(X,V,"Containers"),V["!cols"]=[{wch:15},{wch:12},{wch:8},{wch:10},{wch:10}],fW(X,"container_template.xlsx"),s.info("Template downloaded")},R=T.useCallback(O=>{var M,me,ae;O.preventDefault(),N(!1);const V=((M=O.dataTransfer)==null?void 0:M.files[0])||((ae=(me=O.target)==null?void 0:me.files)==null?void 0:ae[0]);if(!V)return;if(!V.name.endsWith(".xlsx")&&!V.name.endsWith(".xls")){s.error("Please upload an Excel file (.xlsx or .xls)");return}const X=new FileReader;X.onload=ce=>{try{const ue=new Uint8Array(ce.target.result),K=ap(ue,{type:"array"}),W=K.SheetNames[0],j=K.Sheets[W],F=Hd.sheet_to_json(j),U=F.map((I,Z)=>{var J;const Y=[];return I.containerNumber?aw(I.containerNumber)||Y.push("Invalid container number format"):Y.push("Missing container number"),t.find(de=>{var E;return de.containerNumber===((E=I.containerNumber)==null?void 0:E.toUpperCase())})&&Y.push("Already exists in system"),F.slice(0,Z).find(de=>{var E,A;return((E=de.containerNumber)==null?void 0:E.toUpperCase())===((A=I.containerNumber)==null?void 0:A.toUpperCase())})&&Y.push("Duplicate in file"),I.liner||Y.push("Missing liner"),{...I,containerNumber:(J=I.containerNumber)==null?void 0:J.toUpperCase(),size:I.size||"40",type:I.type||"DRY",status:I.status||"DM",errors:Y,isValid:Y.length===0}});y(U),C(U.filter(I=>!I.isValid)),U.length===0?s.error("No data found in file"):s.info(`Found ${U.length} containers`)}catch(ue){s.error("Failed to read Excel file"),console.error(ue)}},X.readAsArrayBuffer(V)},[t,s]),q=()=>{const O=k.filter(X=>X.isValid);if(O.length===0){s.error("No valid containers to import");return}let V=0;for(const X of O)e({containerNumber:X.containerNumber,liner:X.liner,size:X.size,type:X.type,status:X.status,gateInTime:new Date().toISOString()},n.username),V++;s.success(`Imported ${V} containers!`),y([]),C([])};return a.jsxs("div",{className:"page",children:[a.jsx("div",{className:"page-header",children:a.jsxs("div",{children:[a.jsx("h2",{children:"Container Registration"}),a.jsx("p",{className:"text-muted",children:"Register new containers for survey"})]})}),a.jsxs("div",{className:"registration-tabs",children:[a.jsxs("button",{className:`registration-tab ${d==="manual"?"active":""}`,onClick:()=>f("manual"),children:[a.jsx(Xr,{size:18})," Manual Entry"]}),a.jsxs("button",{className:`registration-tab ${d==="excel"?"active":""}`,onClick:()=>f("excel"),children:[a.jsx(O3,{size:18})," Excel Upload"]})]}),d==="manual"&&a.jsx("div",{className:"card",children:a.jsxs("form",{onSubmit:H,children:[a.jsxs("div",{className:"grid grid-cols-2",style:{gap:"var(--space-4)"},children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"containerNumber",className:"form-label required",children:"Container Number"}),a.jsx("input",{id:"containerNumber",type:"text",className:`form-input ${x.containerNumber?"error":""}`,placeholder:"MSCU1234567",value:m.containerNumber,onChange:O=>p(V=>({...V,containerNumber:O.target.value.toUpperCase()})),maxLength:11}),x.containerNumber&&a.jsx("span",{className:"error-text",children:x.containerNumber}),a.jsx("span",{className:"form-hint",children:"Format: 4 letters + 7 digits"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"liner",className:"form-label required",children:"Liner"}),a.jsxs("select",{id:"liner",className:`form-input ${x.liner?"error":""}`,value:m.liner,onChange:O=>p(V=>({...V,liner:O.target.value})),children:[a.jsx("option",{value:"",children:"Select liner..."}),i.map(O=>a.jsxs("option",{value:O.code,children:[O.code," - ",O.name]},O.code))]}),x.liner&&a.jsx("span",{className:"error-text",children:x.liner})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:"Size"}),a.jsx("select",{className:"form-input",value:m.size,onChange:O=>p(V=>({...V,size:O.target.value})),children:l.map(O=>a.jsxs("option",{value:O.code,children:[O.code,"ft"]},O.code))})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:"Type"}),a.jsx("select",{className:"form-input",value:m.type,onChange:O=>p(V=>({...V,type:O.target.value})),children:u.map(O=>a.jsx("option",{value:O.code,children:O.name},O.code))})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:"Initial Status"}),a.jsxs("select",{className:"form-input",value:m.status,onChange:O=>p(V=>({...V,status:O.target.value})),children:[a.jsx("option",{value:"STACKING",children:"STACKING - In Storage"}),a.jsx("option",{value:"DM",children:"DM - Damaged"})]})]})]}),a.jsxs("div",{className:"form-section mt-4",children:[a.jsxs("h4",{className:"form-section-title",children:[a.jsx(hs,{size:18})," Initial Assessment"]}),a.jsx("p",{className:"text-muted mb-3",children:"Quick visual inspection to determine if container needs washing before survey"}),a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{className:"checkbox-label",children:[a.jsx("input",{type:"checkbox",checked:m.requiresWashing,onChange:O=>p(V=>({...V,requiresWashing:O.target.checked}))}),a.jsx(Zn,{size:16}),a.jsx("span",{children:"Requires Washing Before Survey"})]}),a.jsx("span",{className:"form-hint",children:"Check if container is dirty, has cargo residue, odor, or contamination"})]}),m.requiresWashing&&a.jsxs("div",{className:"form-group mt-3 washing-notice",children:[a.jsx(Dr,{size:16}),a.jsx("span",{children:"Container will be sent to Washing Station before Survey"})]}),a.jsxs("div",{className:"form-group mt-3",children:[a.jsx("label",{className:"form-label",children:"Initial Condition Notes"}),a.jsx("textarea",{className:"form-input",rows:2,placeholder:"Describe initial condition: visible damage, dirt level, odor, cargo residue...",value:m.initialConditionNotes,onChange:O=>p(V=>({...V,initialConditionNotes:O.target.value}))})]})]}),a.jsx("div",{className:"form-actions mt-4",children:a.jsxs("button",{type:"submit",className:"btn btn-primary btn-lg",children:[a.jsx(il,{size:18})," Register Container"]})})]})}),d==="excel"&&a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"excel-header",children:[a.jsx("p",{children:"Upload an Excel file with container data. Download the template first."}),a.jsxs("button",{className:"btn btn-secondary",onClick:L,children:[a.jsx(cu,{size:16})," Download Template"]})]}),a.jsxs("div",{className:`excel-dropzone ${D?"dragging":""}`,onDragOver:O=>{O.preventDefault(),N(!0)},onDragLeave:()=>N(!1),onDrop:R,onClick:()=>document.getElementById("excelInput").click(),children:[a.jsx(vh,{size:40}),a.jsx("p",{children:"Drag & drop Excel file here"}),a.jsx("span",{children:"or click to browse"}),a.jsx("input",{id:"excelInput",type:"file",accept:".xlsx,.xls",style:{display:"none"},onChange:R})]}),k.length>0&&a.jsxs("div",{className:"excel-preview",children:[a.jsxs("div",{className:"excel-preview-header",children:[a.jsxs("h4",{children:["Preview (",k.length," containers)"]}),S.length>0&&a.jsxs("span",{className:"badge badge-dm",children:[a.jsx(Dr,{size:14})," ",S.length," errors"]})]}),a.jsx("div",{className:"table-container",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Status"}),a.jsx("th",{children:"Container Number"}),a.jsx("th",{children:"Liner"}),a.jsx("th",{children:"Size"}),a.jsx("th",{children:"Type"}),a.jsx("th",{children:"Errors"})]})}),a.jsx("tbody",{children:k.map((O,V)=>{var X;return a.jsxs("tr",{className:O.isValid?"":"row-error",children:[a.jsx("td",{children:O.isValid?a.jsx(A3,{size:18,className:"text-success"}):a.jsx(Pn,{size:18,className:"text-error"})}),a.jsx("td",{children:a.jsx("span",{className:"container-number",children:O.containerNumber})}),a.jsx("td",{children:O.liner}),a.jsxs("td",{children:[O.size,"ft"]}),a.jsx("td",{children:O.type}),a.jsx("td",{children:(X=O.errors)==null?void 0:X.map((M,me)=>a.jsx("span",{className:"error-tag",children:M},me))})]},V)})})]})}),a.jsxs("div",{className:"excel-actions",children:[a.jsx("button",{className:"btn btn-secondary",onClick:()=>{y([]),C([])},children:"Clear"}),a.jsxs("button",{className:"btn btn-primary",onClick:q,disabled:k.filter(O=>O.isValid).length===0,children:[a.jsx(vh,{size:16})," Import ",k.filter(O=>O.isValid).length," Valid Containers"]})]})]})]})]})}function NW(){const{containers:e,eors:t}=qt(),[n,r]=T.useState(""),[s,i]=T.useState(""),l=cn(),u=e.filter(d=>d.status==="AR").filter(d=>{const f=!n||d.containerNumber.toLowerCase().includes(n.toLowerCase()),m=!s||d.liner===s;return f&&m}).map(d=>{const m=t.filter(x=>x.containerId===d.id)[0],p=d.arStartTime?Math.floor((Date.now()-new Date(d.arStartTime).getTime())/(1e3*60*60*24)):0;return{...d,latestEOR:m,arAging:p}}).sort((d,f)=>f.arAging-d.arAging);return a.jsxs("div",{className:"page-list-layout",children:[a.jsxs("div",{className:"page-list-header",children:[a.jsxs("div",{className:"page-header",children:[a.jsxs("div",{children:[a.jsx("h2",{children:"AR Containers"}),a.jsx("p",{className:"text-muted",children:"Containers awaiting repair - sorted by AR aging"})]}),a.jsxs("div",{className:"badge badge-ar",style:{fontSize:"1rem",padding:"8px 16px"},children:[u.length," containers"]})]}),a.jsxs("div",{className:"filters",children:[a.jsxs("div",{className:"search-box",children:[a.jsx(bn,{size:18}),a.jsx("input",{type:"text",className:"form-input",placeholder:"Search container...",value:n,onChange:d=>r(d.target.value)})]}),a.jsxs("select",{className:"form-input",style:{width:180},value:s,onChange:d=>i(d.target.value),children:[a.jsx("option",{value:"",children:"All Liners"}),Ea.map(d=>a.jsx("option",{value:d.code,children:d.code},d.code))]})]})]}),a.jsxs("div",{className:"page-list-content",children:[a.jsx("div",{className:"table-container",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Container"}),a.jsx("th",{children:"Liner"}),a.jsx("th",{children:"Location"}),a.jsx("th",{children:"AR Start"}),a.jsx("th",{children:"AR Aging"}),a.jsx("th",{children:"EOR Status"}),a.jsx("th",{children:"EOR Amount"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:u.map(d=>a.jsxs("tr",{onDoubleClick:()=>l(`/containers/${d.id}`),style:{cursor:"pointer"},children:[a.jsx("td",{children:a.jsx("span",{className:"container-number",children:d.containerNumber})}),a.jsx("td",{children:d.liner}),a.jsx("td",{children:d.yardLocation?`${d.yardLocation.block}-${d.yardLocation.row}-${d.yardLocation.tier}`:"-"}),a.jsx("td",{children:d.arStartTime?new Date(d.arStartTime).toLocaleDateString():"-"}),a.jsx("td",{children:a.jsxs("span",{className:`badge ${d.arAging>5?"badge-dm":"badge-ar"}`,children:[d.arAging," days"]})}),a.jsx("td",{children:d.latestEOR?a.jsx("span",{className:`badge badge-${d.latestEOR.status.toLowerCase().replace("_","-")}`,children:d.latestEOR.status.replace("_"," ")}):"-"}),a.jsx("td",{children:d.latestEOR?`RM ${d.latestEOR.totalCost}`:"-"}),a.jsx("td",{children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(vt,{to:`/containers/${d.id}`,className:"btn btn-ghost btn-sm",children:"View"}),d.latestEOR&&a.jsxs(vt,{to:`/eor/${d.latestEOR.id}`,className:"btn btn-secondary btn-sm",children:[a.jsx(wn,{size:14})," EOR"]})]})})]},d.id))})]})}),u.length===0&&a.jsxs("div",{className:"empty-state",children:[a.jsx(tr,{size:48}),a.jsx("h3",{children:"No AR containers"}),a.jsx("p",{children:"All containers are either available or being processed"})]})]})]})}function EW(){const{surveys:e}=qt(),{user:t}=Ft(),{t:n}=Wt(),r=cn(),s=(t==null?void 0:t.userType)==="EXTERNAL",[i]=hi(),l=i.get("workflow_filter"),[u,d]=T.useState(""),[f,m]=T.useState(""),[p,x]=T.useState(""),[v,k]=T.useState(""),[y,S]=T.useState(""),[C,D]=T.useState(""),[N,b]=T.useState(1),H=Gi.CONTAINERS_PER_PAGE,L=e.filter(M=>{if(l==="active"&&M.status!=="DRAFT"&&M.status!=="IN_PROGRESS")return!1;const me=!u||M.containerNumber.toLowerCase().includes(u.toLowerCase())||M.id.toLowerCase().includes(u.toLowerCase()),ae=!f||M.status===f,ce=!p||M.surveyType===p,ue=!v||M.liner===v;let K=!0;return y&&(K=K&&new Date(M.createdAt)>=new Date(y)),C&&(K=K&&new Date(M.createdAt)<=new Date(C+"T23:59:59")),me&&ae&&ce&&ue&&K}),R=Math.ceil(L.length/H),q=L.slice((N-1)*H,N*H),O=(M,me)=>{M(me),b(1)},V=M=>{var me;return((me=M.damages)==null?void 0:me.length)||0},X=M=>{var me;return((me=M.photos)==null?void 0:me.length)||0};return a.jsxs("div",{className:"page-list-layout",children:[a.jsxs("div",{className:"page-list-header",children:[a.jsxs("div",{className:"page-header",children:[a.jsxs("div",{children:[a.jsx("h2",{children:n("survey.surveyList")}),a.jsx("p",{className:"text-muted",children:n("survey.title")})]}),a.jsx("div",{className:"header-actions",children:a.jsxs("div",{className:"header-stats",children:[a.jsxs("div",{className:"header-stat",children:[a.jsx("span",{className:"header-stat-value",children:e.filter(M=>M.status==="DRAFT").length}),a.jsx("span",{className:"header-stat-label",children:n("common.inProgress")||"In Progress"})]}),a.jsxs("div",{className:"header-stat",children:[a.jsx("span",{className:"header-stat-value",children:e.filter(M=>M.status==="COMPLETED").length}),a.jsx("span",{className:"header-stat-label",children:n("common.completed")||"Completed"})]}),a.jsx(_s,{screenId:"survey_list"}),a.jsxs(vt,{to:"/surveys/search",className:"btn btn-primary",children:[a.jsx(Xr,{size:16})," ",n("survey.newSurvey")]})]})})]}),a.jsxs("div",{className:"filters",children:[a.jsxs("div",{className:"search-box",children:[a.jsx(bn,{size:18}),a.jsx("input",{type:"text",className:"form-input",placeholder:n("common.search")+"...",value:u,onChange:M=>O(d,M.target.value)})]}),a.jsxs("select",{className:"form-input",style:{width:160},value:f,onChange:M=>O(m,M.target.value),children:[a.jsx("option",{value:"",children:n("common.allStatuses")||"All Statuses"}),Object.entries(b1).map(([M,me])=>a.jsx("option",{value:M,children:me},M))]}),a.jsxs("select",{className:"form-input",style:{width:150},value:p,onChange:M=>O(x,M.target.value),children:[a.jsx("option",{value:"",children:n("survey.allTypes")||"All Types"}),Object.entries(_m).map(([M,me])=>a.jsx("option",{value:M,children:me},M))]}),a.jsxs("select",{className:"form-input",style:{width:140},value:v,onChange:M=>O(k,M.target.value),children:[a.jsx("option",{value:"",children:n("common.allLiners")||"All Liners"}),Ea.map(M=>a.jsx("option",{value:M.code,children:M.code},M.code))]})]}),a.jsx("div",{className:"filters date-filters",children:a.jsxs("div",{className:"date-filter-group",children:[a.jsx(ls,{size:16}),a.jsxs("label",{children:[n("common.from")||"From",":"]}),a.jsx("input",{type:"date",className:"form-input",value:y,onChange:M=>O(S,M.target.value)}),a.jsxs("label",{children:[n("common.to")||"To",":"]}),a.jsx("input",{type:"date",className:"form-input",value:C,onChange:M=>O(D,M.target.value)}),(y||C)&&a.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>{S(""),D(""),b(1)},children:n("common.clearDates")||"Clear"})]})})]}),a.jsxs("div",{className:"page-list-content",children:[a.jsx("div",{className:"table-container",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:n("columns.transactionId")}),a.jsx("th",{children:n("columns.containerNumber")}),a.jsx("th",{children:n("columns.liner")}),a.jsx("th",{children:n("columns.surveyType")}),a.jsx("th",{children:n("columns.damageCount")||"Damages"}),a.jsx("th",{children:n("columns.initialCondition")}),a.jsx("th",{children:n("columns.surveyStatus")}),a.jsx("th",{children:n("columns.createdAt")}),a.jsx("th",{children:n("columns.actions")})]})}),a.jsx("tbody",{children:q.map(M=>a.jsxs("tr",{onDoubleClick:()=>r(`/surveys/${M.id}`),style:{cursor:"pointer"},children:[a.jsx("td",{children:a.jsx("span",{style:{fontWeight:500},children:M.id})}),a.jsx("td",{children:a.jsx("span",{className:"container-number",children:M.containerNumber})}),a.jsx("td",{children:M.liner}),a.jsx("td",{children:_m[M.surveyType]}),a.jsx("td",{children:a.jsxs("span",{className:"inline-summary",children:[a.jsxs("span",{className:`count-badge ${V(M)>0?"has-items":""}`,children:[V(M)," ",n("survey.damage")||"damage"]}),X(M)>0&&a.jsxs("span",{className:"photo-count",children:[" ",X(M)]})]})}),a.jsx("td",{children:a.jsx("span",{className:`badge ${M.initialCondition==="DAMAGED"?"badge-dm":"badge-av"}`,children:M.initialCondition==="DAMAGED"?n("survey.damaged")||"Damaged":n("survey.noDamage")||"No Damage"})}),a.jsx("td",{children:a.jsx("span",{className:`badge badge-${M.status.toLowerCase()}`,children:b1[M.status]})}),a.jsx("td",{children:new Date(M.createdAt).toLocaleDateString()}),a.jsx("td",{children:a.jsxs("div",{className:"action-buttons",children:[a.jsxs(vt,{to:`/surveys/${M.id}`,className:"btn btn-ghost btn-sm",children:[a.jsx(qr,{size:16})," ",n("common.view")||"View"]}),!s&&M.status==="COMPLETED"&&M.initialCondition==="DAMAGED"&&a.jsxs(vt,{to:`/eor/new/${M.id}`,className:"btn btn-primary btn-sm",title:n("survey.createEOR")||"Create EOR",children:[a.jsx(wn,{size:14})," ",n("survey.createEOR")||"Create EOR"]})]})})]},M.id))})]})}),L.length===0&&a.jsxs("div",{className:"empty-state",children:[a.jsx(jr,{size:48}),a.jsx("h3",{children:n("survey.noSurveysFound")||"No surveys found"}),a.jsx("p",{children:n("survey.createNewSurvey")||"Create a new survey to get started"}),a.jsxs(vt,{to:"/surveys/search",className:"btn btn-primary mt-4",children:[a.jsx(Xr,{size:16})," ",n("survey.newSurvey")||"New Survey"]})]})]}),R>1&&a.jsx("div",{className:"page-list-footer",children:a.jsxs("div",{className:"pagination",children:[a.jsxs("button",{className:"btn btn-ghost btn-sm",onClick:()=>b(M=>Math.max(1,M-1)),disabled:N===1,children:[a.jsx(ao,{size:16})," ",n("common.previous")||"Previous"]}),a.jsxs("span",{className:"pagination-info",children:[n("common.page")||"Page"," ",N," ",n("common.of")||"of"," ",R,a.jsxs("span",{className:"pagination-total",children:["(",L.length," ",n("common.total")||"total",")"]})]}),a.jsxs("button",{className:"btn btn-ghost btn-sm",onClick:()=>b(M=>Math.min(R,M+1)),disabled:N===R,children:[n("common.next")||"Next"," ",a.jsx(Gn,{size:16})]})]})})]})}function TW({value:e,onChange:t,locationCodes:n=[],disabled:r=!1,damageHistory:s={}}){var v,k,y;const[i,l]=T.useState("manual"),[u,d]=T.useState(null),f=[{code:"ROOF",name:"Roof",x:50,y:10,width:300,height:30},{code:"FREN",name:"Front End",x:10,y:50,width:30,height:100},{code:"REEN",name:"Rear End",x:360,y:50,width:30,height:100},{code:"LSP",name:"Left Side Panel",x:50,y:40,width:300,height:20},{code:"RSP",name:"Right Side Panel",x:50,y:140,width:300,height:20},{code:"FLR",name:"Floor",x:50,y:160,width:300,height:25},{code:"DOOR",name:"Door",x:360,y:60,width:25,height:80},{code:"UR",name:"Under Rail",x:50,y:185,width:300,height:10},{code:"CCR",name:"Corner Casting",corners:!0},{code:"CFT",name:"Corner Fitting",corners:!0},{code:"FORK",name:"Forklift Pocket",x:120,y:190,width:40,height:8},{code:"SEAL",name:"Door Seal",x:355,y:55,width:5,height:90},{code:"LOCK",name:"Lock Rod",x:385,y:70,width:8,height:60}],m=S=>{r||t(S)},p=S=>e===S?"#10B981":u===S?"#3B82F6":s[S]>0?"#EF4444":"#64748B",x=S=>s[S]||0;return a.jsxs("div",{className:"container-visual-selector",children:[a.jsxs("div",{className:"cvs-mode-toggle",children:[a.jsxs("button",{type:"button",className:`cvs-toggle-btn ${i==="manual"?"active":""}`,onClick:()=>l("manual"),children:[a.jsx(W3,{size:14}),a.jsx("span",{children:"Manual"})]}),a.jsxs("button",{type:"button",className:`cvs-toggle-btn ${i==="visual"?"active":""}`,onClick:()=>l("visual"),children:[a.jsx(qr,{size:14}),a.jsx("span",{children:"Visual"})]})]}),i==="manual"?a.jsxs("select",{className:"form-input cvs-dropdown",value:e,onChange:S=>t(S.target.value),disabled:r,children:[a.jsx("option",{value:"",children:"Select location..."}),n.map(S=>a.jsxs("option",{value:S.code,children:[S.code," - ",S.name,s[S.code]>0?` (${s[S.code]} previous damages)`:""]},S.code))]}):a.jsxs("div",{className:"cvs-visual-container",children:[a.jsxs("div",{className:"cvs-diagram-wrapper",children:[a.jsxs("svg",{viewBox:"0 0 420 220",className:"cvs-diagram",style:{opacity:r?.5:1},children:[a.jsx("rect",{x:"40",y:"35",width:"340",height:"165",fill:"none",stroke:"#334155",strokeWidth:"2",rx:"4"}),a.jsx("rect",{x:"50",y:"40",width:"300",height:"25",fill:p("ROOF"),fillOpacity:"0.3",stroke:p("ROOF"),strokeWidth:"2",rx:"2",className:"cvs-part",onMouseEnter:()=>d("ROOF"),onMouseLeave:()=>d(null),onClick:()=>m("ROOF"),style:{cursor:r?"not-allowed":"pointer"}}),a.jsx("text",{x:"200",y:"57",textAnchor:"middle",className:"cvs-label",children:"ROOF"}),a.jsx("rect",{x:"45",y:"70",width:"25",height:"90",fill:p("FREN"),fillOpacity:"0.3",stroke:p("FREN"),strokeWidth:"2",rx:"2",className:"cvs-part",onMouseEnter:()=>d("FREN"),onMouseLeave:()=>d(null),onClick:()=>m("FREN"),style:{cursor:r?"not-allowed":"pointer"}}),a.jsx("text",{x:"57",y:"120",textAnchor:"middle",className:"cvs-label cvs-label-vertical",children:"FREN"}),a.jsx("rect",{x:"330",y:"70",width:"25",height:"90",fill:p("REEN"),fillOpacity:"0.3",stroke:p("REEN"),strokeWidth:"2",rx:"2",className:"cvs-part",onMouseEnter:()=>d("REEN"),onMouseLeave:()=>d(null),onClick:()=>m("REEN"),style:{cursor:r?"not-allowed":"pointer"}}),a.jsx("text",{x:"342",y:"120",textAnchor:"middle",className:"cvs-label cvs-label-vertical",children:"REEN"}),a.jsx("rect",{x:"360",y:"75",width:"15",height:"80",fill:p("DOOR"),fillOpacity:"0.4",stroke:p("DOOR"),strokeWidth:"2",rx:"2",className:"cvs-part",onMouseEnter:()=>d("DOOR"),onMouseLeave:()=>d(null),onClick:()=>m("DOOR"),style:{cursor:r?"not-allowed":"pointer"}}),a.jsx("text",{x:"368",y:"120",textAnchor:"middle",className:"cvs-label cvs-label-small",children:"DOOR"}),a.jsx("rect",{x:"75",y:"70",width:"250",height:"15",fill:p("LSP"),fillOpacity:"0.3",stroke:p("LSP"),strokeWidth:"2",rx:"2",className:"cvs-part",onMouseEnter:()=>d("LSP"),onMouseLeave:()=>d(null),onClick:()=>m("LSP"),style:{cursor:r?"not-allowed":"pointer"}}),a.jsx("text",{x:"200",y:"82",textAnchor:"middle",className:"cvs-label",children:"LSP (Left Side)"}),a.jsx("rect",{x:"75",y:"90",width:"250",height:"55",fill:"#1E293B",fillOpacity:"0.5",stroke:"none",rx:"2"}),a.jsx("text",{x:"200",y:"122",textAnchor:"middle",className:"cvs-interior-label",children:"INTERIOR"}),a.jsx("rect",{x:"75",y:"150",width:"250",height:"15",fill:p("RSP"),fillOpacity:"0.3",stroke:p("RSP"),strokeWidth:"2",rx:"2",className:"cvs-part",onMouseEnter:()=>d("RSP"),onMouseLeave:()=>d(null),onClick:()=>m("RSP"),style:{cursor:r?"not-allowed":"pointer"}}),a.jsx("text",{x:"200",y:"162",textAnchor:"middle",className:"cvs-label",children:"RSP (Right Side)"}),a.jsx("rect",{x:"50",y:"170",width:"300",height:"20",fill:p("FLR"),fillOpacity:"0.3",stroke:p("FLR"),strokeWidth:"2",rx:"2",className:"cvs-part",onMouseEnter:()=>d("FLR"),onMouseLeave:()=>d(null),onClick:()=>m("FLR"),style:{cursor:r?"not-allowed":"pointer"}}),a.jsx("text",{x:"200",y:"184",textAnchor:"middle",className:"cvs-label",children:"FLOOR"}),[{x:42,y:37,label:"TL"},{x:348,y:37,label:"TR"},{x:42,y:178,label:"BL"},{x:348,y:178,label:"BR"}].map((S,C)=>a.jsx("g",{children:a.jsx("rect",{x:S.x,y:S.y,width:"12",height:"12",fill:p("CCR"),fillOpacity:"0.5",stroke:p("CCR"),strokeWidth:"1",className:"cvs-part",onMouseEnter:()=>d("CCR"),onMouseLeave:()=>d(null),onClick:()=>m("CCR"),style:{cursor:r?"not-allowed":"pointer"}})},`ccr-${C}`)),a.jsx("rect",{x:"50",y:"193",width:"300",height:"8",fill:p("UR"),fillOpacity:"0.4",stroke:p("UR"),strokeWidth:"1",className:"cvs-part",onMouseEnter:()=>d("UR"),onMouseLeave:()=>d(null),onClick:()=>m("UR"),style:{cursor:r?"not-allowed":"pointer"}}),[{x:100},{x:280}].map((S,C)=>a.jsx("rect",{x:S.x,y:"195",width:"40",height:"10",fill:p("FORK"),fillOpacity:"0.5",stroke:p("FORK"),strokeWidth:"1",rx:"2",className:"cvs-part",onMouseEnter:()=>d("FORK"),onMouseLeave:()=>d(null),onClick:()=>m("FORK"),style:{cursor:r?"not-allowed":"pointer"}},`fork-${C}`)),a.jsx("rect",{x:"378",y:"85",width:"6",height:"60",fill:p("LOCK"),fillOpacity:"0.5",stroke:p("LOCK"),strokeWidth:"1",rx:"2",className:"cvs-part",onMouseEnter:()=>d("LOCK"),onMouseLeave:()=>d(null),onClick:()=>m("LOCK"),style:{cursor:r?"not-allowed":"pointer"}}),a.jsx("rect",{x:"355",y:"72",width:"4",height:"86",fill:p("SEAL"),fillOpacity:"0.5",stroke:p("SEAL"),strokeWidth:"1",className:"cvs-part",onMouseEnter:()=>d("SEAL"),onMouseLeave:()=>d(null),onClick:()=>m("SEAL"),style:{cursor:r?"not-allowed":"pointer"}})]}),u&&a.jsxs("div",{className:"cvs-tooltip",children:[a.jsx("strong",{children:u}),a.jsx("span",{children:(v=f.find(S=>S.code===u))==null?void 0:v.name}),x(u)>0&&a.jsxs("span",{className:"cvs-damage-count",children:[x(u)," previous damage(s)"]})]})]}),a.jsxs("div",{className:"cvs-info-panel",children:[a.jsxs("div",{className:"cvs-selected",children:[a.jsx("span",{className:"cvs-selected-label",children:"Selected:"}),e?a.jsxs("span",{className:"cvs-selected-value",children:[e," - ",((k=f.find(S=>S.code===e))==null?void 0:k.name)||((y=n.find(S=>S.code===e))==null?void 0:y.name)]}):a.jsx("span",{className:"cvs-selected-none",children:"Click on a part to select"}),e&&!r&&a.jsx("button",{type:"button",className:"cvs-clear-btn",onClick:()=>t(""),children:a.jsx(Qp,{size:12})})]}),a.jsxs("div",{className:"cvs-legend",children:[a.jsxs("div",{className:"cvs-legend-item",children:[a.jsx("span",{className:"cvs-legend-dot",style:{background:"#10B981"}}),a.jsx("span",{children:"Selected"})]}),a.jsxs("div",{className:"cvs-legend-item",children:[a.jsx("span",{className:"cvs-legend-dot",style:{background:"#EF4444"}}),a.jsx("span",{children:"Has damage history"})]}),a.jsxs("div",{className:"cvs-legend-item",children:[a.jsx("span",{className:"cvs-legend-dot",style:{background:"#64748B"}}),a.jsx("span",{children:"Available"})]})]})]})]})]})}function sw(){const{id:e,containerId:t}=ws(),n=cn(),{user:r}=Ft(),{getContainer:s,getSurvey:i,getSurveysByContainer:l,createSurvey:u,updateSurvey:d,completeSurvey:f}=qt(),{getCodeList:m}=On(),p=en(),x=(r==null?void 0:r.userType)==="EXTERNAL",v=m("DAMAGE_LOCATIONS"),k=m("DAMAGE_TYPES"),y=m("COMPONENTS"),S=m("SEVERITY_LEVELS"),C=m("REPAIR_METHODS"),D=m("INITIAL_CONDITIONS"),N=!!e&&e!=="new",b=N?i(e):null,H=t?s(t):b?s(b.containerId):null,[L,R]=T.useState({surveyType:"",initialCondition:"",notes:"",damageItems:[],images:[]}),[q,O]=T.useState(!1),[V,X]=T.useState(!1),[M,me]=T.useState(null),ae=T.useRef(null);T.useRef(null);const ce=T.useRef(null),ue=T.useRef(null);if(T.useEffect(()=>{b&&R({surveyType:b.surveyType||"",initialCondition:b.initialCondition||"",notes:b.notes||"",damageItems:b.damageItems||[],images:b.images||[]})},[b]),!H)return a.jsx("div",{className:"page",children:a.jsxs("div",{className:"empty-state",children:[a.jsx("h3",{children:"Container not found"}),a.jsxs(vt,{to:"/surveys/search",className:"btn btn-primary mt-4",children:[a.jsx(hr,{size:16})," Search Containers"]})]})});const K=(E,A)=>{R(he=>({...he,[E]:A}))},W=()=>{const E={id:`d${Date.now()}`,location:"",damageType:"",component:"",severity:"M",size:"",quantity:1,repairMethod:"",estimatedCost:0};R(A=>({...A,damageItems:[...A.damageItems,E]}))},j=(E,A,he)=>{R(G=>{const Ie=[...G.damageItems];if(Ie[E]={...Ie[E],[A]:he},A==="estimatedCost"&&(Ie[E].isManualCost=!0),["component","quantity","severity"].includes(A)&&!Ie[E].isManualCost){const oe=y.find(xe=>xe.code===Ie[E].component),Te=S.find(xe=>xe.code===Ie[E].severity);oe&&Te&&(Ie[E].estimatedCost=Math.round(oe.unitPrice*(Ie[E].quantity||1)*Te.multiplier))}return{...G,damageItems:Ie}})},F=E=>{R(A=>({...A,damageItems:A.damageItems.filter((he,G)=>G!==E)}))},U=E=>{const A=Array.from(E.target.files);A.length!==0&&(A.forEach(he=>{if(!he.type.startsWith("image/")){p.error("Please select only image files");return}if(he.size>5*1024*1024){p.error("Image size must be less than 5MB");return}const G=new FileReader;G.onload=Ie=>{const oe={id:`img${Date.now()}_${Math.random().toString(36).substr(2,9)}`,dataUrl:Ie.target.result,name:he.name,capturedAt:new Date().toISOString(),type:"upload"};R(Te=>({...Te,images:[...Te.images,oe]}))},G.readAsDataURL(he)}),E.target.value="")},I=async()=>{try{const E=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}}});me(E),X(!0),setTimeout(()=>{ce.current&&(ce.current.srcObject=E)},100)}catch(E){console.error("Camera error:",E),E.name==="NotAllowedError"?p.error("Quyn truy cp camera b t chi. Vui lng cho php truy cp camera trong ci t trnh duyt."):E.name==="NotFoundError"?p.error("Khng tm thy camera. Vui lng kim tra camera ca bn."):p.error("Khng th m camera: "+E.message)}},Z=()=>{if(!ce.current||!ue.current)return;const E=ce.current,A=ue.current;A.width=E.videoWidth,A.height=E.videoHeight,A.getContext("2d").drawImage(E,0,0);const G=A.toDataURL("image/jpeg",.8),Ie={id:`img${Date.now()}_${Math.random().toString(36).substr(2,9)}`,dataUrl:G,name:`Photo_${new Date().toISOString().replace(/[:.]/g,"-")}.jpg`,capturedAt:new Date().toISOString(),type:"camera"};R(oe=>({...oe,images:[...oe.images,Ie]})),p.success(" chp nh!")},Y=()=>{M&&(M.getTracks().forEach(E=>E.stop()),me(null)),X(!1)},P=E=>{R(A=>({...A,images:A.images.filter(he=>he.id!==E)})),p.info("Image removed")},ne=async(E=!1)=>{O(!0);try{if(!L.surveyType){p.error("Survey type is required"),O(!1);return}if(!L.initialCondition){p.error("Initial condition is required"),O(!1);return}if(L.initialCondition==="DAMAGED"&&L.damageItems.length===0){p.error('At least one damage item is required when condition is "Damaged"'),O(!1);return}if(N)if(d(e,L,r.username),E){const A=f(e,r.username);if(!A.success){p.error(A.error),O(!1);return}p.success("Survey completed successfully!")}else p.success("Survey updated!");else if(E){const A={...L,containerId:H.id,containerNumber:H.containerNumber,sequence:H.sequence,liner:H.liner,status:"COMPLETED",completedBy:r.username,completedAt:new Date().toISOString()};u(A,r.username),p.success("Survey completed successfully!")}else u({...L,containerId:H.id,containerNumber:H.containerNumber,sequence:H.sequence,liner:H.liner},r.username),p.success("Survey saved as draft!");n("/surveys")}catch{p.error("Failed to save survey")}finally{O(!1)}},J=(b==null?void 0:b.status)==="COMPLETED",de=!J||(b==null?void 0:b.status)==="DRAFT";return a.jsxs("div",{className:"page",children:[a.jsxs("div",{className:"page-header",children:[a.jsxs(vt,{to:"/surveys",className:"btn btn-ghost",children:[a.jsx(hr,{size:16})," Back"]}),a.jsxs("div",{className:"flex gap-3",children:[de&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"btn btn-secondary",onClick:()=>ne(!1),disabled:q,children:[a.jsx(Oa,{size:16})," Save Draft"]}),a.jsxs("button",{className:"btn btn-primary",onClick:()=>ne(!0),disabled:q,children:[a.jsx(St,{size:16})," Complete Survey"]})]}),!x&&J&&b&&a.jsxs(vt,{to:`/eor/new/${b.id}`,className:"btn btn-primary",children:[a.jsx(wn,{size:16})," Create EOR"]})]})]}),a.jsx("div",{className:"card",children:a.jsxs("div",{className:"grid grid-cols-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Container"}),a.jsx("p",{className:"container-number",style:{margin:0,fontSize:"1.2rem"},children:H.containerNumber})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Size/Type"}),a.jsx("p",{style:{margin:0,fontWeight:500},children:H.size})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Liner"}),a.jsx("p",{style:{margin:0,fontWeight:500},children:H.liner})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Sequence"}),a.jsx("p",{style:{margin:0,fontWeight:500},children:H.sequence})]})]})}),a.jsxs("div",{className:"card mt-4",children:[a.jsx("h3",{className:"card-title",style:{marginBottom:"var(--space-4)"},children:"Survey Details"}),a.jsxs("div",{className:"grid grid-cols-2",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label required",children:"Survey Type"}),a.jsxs("select",{className:"form-input",value:L.surveyType,onChange:E=>K("surveyType",E.target.value),disabled:!de,children:[a.jsx("option",{value:"",children:"Select type..."}),Object.entries(_m).map(([E,A])=>a.jsx("option",{value:E,children:A},E))]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label required",children:"Initial Condition"}),a.jsxs("select",{className:"form-input",value:L.initialCondition,onChange:E=>K("initialCondition",E.target.value),disabled:!de,children:[a.jsx("option",{value:"",children:"Select condition..."}),D.map(E=>a.jsx("option",{value:E.code,children:E.name},E.code))]})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:"Notes"}),a.jsx("textarea",{className:"form-input",rows:3,placeholder:"Enter survey notes...",value:L.notes,onChange:E=>K("notes",E.target.value),disabled:!de})]})]}),a.jsxs("div",{className:"card mt-4",children:[a.jsxs("div",{className:"card-header",children:[a.jsxs("h3",{className:"card-title",children:[a.jsx(Rd,{size:20})," Photo Documentation (",L.images.length,")"]}),de&&a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{type:"button",className:"btn btn-primary",onClick:I,children:[a.jsx(Rd,{size:16})," Chp nh"]}),a.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:()=>{var E;return(E=ae.current)==null?void 0:E.click()},children:[a.jsx(B3,{size:16})," Upload"]})]})]}),a.jsx("input",{type:"file",ref:ae,onChange:U,accept:"image/*",multiple:!0,style:{display:"none"}}),a.jsx("canvas",{ref:ue,style:{display:"none"}}),L.images.length===0?a.jsxs("div",{className:"empty-state",style:{padding:"var(--space-6)"},children:[a.jsx(Rd,{size:40,style:{opacity:.3}}),a.jsx("p",{style:{marginTop:"var(--space-2)"},children:"No photos yet. Take photos or upload images to document the container condition."})]}):a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(150px, 1fr))",gap:"var(--space-3)",padding:"var(--space-4)"},children:L.images.map(E=>a.jsxs("div",{style:{position:"relative",borderRadius:"var(--radius-lg)",overflow:"hidden",border:"1px solid var(--border-color)",background:"var(--bg-tertiary)"},children:[a.jsx("img",{src:E.dataUrl,alt:E.name,style:{width:"100%",height:"120px",objectFit:"cover",display:"block"}}),a.jsxs("div",{style:{padding:"var(--space-2)",fontSize:"var(--font-size-xs)",color:"var(--text-secondary)"},children:[a.jsx("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:E.name}),a.jsx("div",{style:{marginTop:"2px"},children:new Date(E.capturedAt).toLocaleString()})]}),de&&a.jsx("button",{type:"button",onClick:()=>P(E.id),style:{position:"absolute",top:"8px",right:"8px",background:"rgba(0,0,0,0.6)",border:"none",borderRadius:"50%",width:"28px",height:"28px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"white"},children:a.jsx(Pn,{size:14})})]},E.id))})]}),L.initialCondition==="DAMAGED"&&a.jsxs("div",{className:"card mt-4",children:[a.jsxs("div",{className:"card-header",children:[a.jsxs("h3",{className:"card-title",children:["Damage Items (",L.damageItems.length,")"]}),de&&a.jsxs("button",{className:"btn btn-secondary",onClick:W,children:[a.jsx(Xr,{size:16})," Add Item"]})]}),L.damageItems.length===0?a.jsx("div",{className:"empty-state",style:{padding:"var(--space-6)"},children:a.jsx("p",{children:'No damage items added yet. Click "Add Item" to record damage.'})}):a.jsx("div",{className:"damage-items",children:L.damageItems.map((E,A)=>a.jsxs("div",{className:"damage-item",children:[a.jsxs("div",{className:"damage-item-header",children:[a.jsxs("span",{className:"damage-item-number",children:["Item #",A+1]}),de&&a.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>F(A),children:a.jsx(La,{size:14})})]}),a.jsxs("div",{className:"grid grid-cols-4",style:{gap:"var(--space-3)"},children:[a.jsxs("div",{className:"form-group",style:{marginBottom:0,gridColumn:"span 2"},children:[a.jsx("label",{className:"form-label",children:"Location"}),a.jsx(TW,{value:E.location,onChange:he=>j(A,"location",he),locationCodes:v,disabled:!de,damageHistory:(()=>{if(!H)return{};const he=l(H.id).filter(Ie=>Ie.id!==e&&Ie.status==="COMPLETED"),G={};return he.forEach(Ie=>{(Ie.damageItems||[]).forEach(oe=>{oe.location&&(G[oe.location]=(G[oe.location]||0)+1)})}),G})()})]}),a.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[a.jsx("label",{className:"form-label",children:"Damage Type"}),a.jsxs("select",{className:"form-input",value:E.damageType,onChange:he=>j(A,"damageType",he.target.value),disabled:!de,children:[a.jsx("option",{value:"",children:"Select..."}),k.map(he=>a.jsxs("option",{value:he.code,children:[he.code," - ",he.name]},he.code))]})]}),a.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[a.jsx("label",{className:"form-label",children:"Component"}),a.jsxs("select",{className:"form-input",value:E.component,onChange:he=>j(A,"component",he.target.value),disabled:!de,children:[a.jsx("option",{value:"",children:"Select..."}),y.map(he=>a.jsxs("option",{value:he.code,children:[he.code," - ",he.name]},he.code))]})]}),a.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[a.jsx("label",{className:"form-label",children:"Severity"}),a.jsx("select",{className:"form-input",value:E.severity,onChange:he=>j(A,"severity",he.target.value),disabled:!de,children:S.map(he=>a.jsx("option",{value:he.code,children:he.name},he.code))})]}),a.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[a.jsx("label",{className:"form-label",children:"Size (cm)"}),a.jsx("input",{type:"number",className:"form-input",value:E.size,onChange:he=>j(A,"size",he.target.value),disabled:!de})]}),a.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[a.jsx("label",{className:"form-label",children:"Quantity"}),a.jsx("input",{type:"number",className:"form-input",min:"1",value:E.quantity,onChange:he=>j(A,"quantity",parseInt(he.target.value)||1),disabled:!de})]}),a.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[a.jsx("label",{className:"form-label",children:"Repair Method"}),a.jsxs("select",{className:"form-input",value:E.repairMethod,onChange:he=>j(A,"repairMethod",he.target.value),disabled:!de,children:[a.jsx("option",{value:"",children:"Select..."}),C.map(he=>a.jsxs("option",{value:he.code,children:[he.code," - ",he.name]},he.code))]})]}),a.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[a.jsxs("label",{className:"form-label",children:["Est. Cost (RM)",E.isManualCost&&a.jsx("span",{className:"badge badge-warning",style:{marginLeft:"8px",fontSize:"10px"},children:"Manual"})]}),a.jsx("input",{type:"number",className:"form-input",value:E.estimatedCost,onChange:he=>j(A,"estimatedCost",parseFloat(he.target.value)||0),disabled:!de,min:"0",step:"0.01"})]})]})]},E.id))}),L.damageItems.length>0&&a.jsxs("div",{className:"damage-total",children:[a.jsx("span",{children:"Total Estimated Cost:"}),a.jsxs("span",{className:"damage-total-value",children:["RM ",L.damageItems.reduce((E,A)=>E+(A.estimatedCost||0),0)]})]})]}),V&&a.jsx("div",{className:"modal-overlay",style:{zIndex:1e3},children:a.jsxs("div",{style:{background:"#000",borderRadius:"var(--radius-xl)",overflow:"hidden",maxWidth:"90vw",maxHeight:"90vh",display:"flex",flexDirection:"column"},children:[a.jsxs("div",{style:{padding:"var(--space-3) var(--space-4)",background:"rgba(0,0,0,0.8)",display:"flex",justifyContent:"space-between",alignItems:"center",color:"white"},children:[a.jsx("h3",{style:{margin:0,fontSize:"var(--font-size-lg)"},children:" Chp nh Container"}),a.jsx("button",{type:"button",onClick:Y,style:{background:"rgba(255,255,255,0.2)",border:"none",borderRadius:"50%",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"white"},children:a.jsx(Pn,{size:20})})]}),a.jsxs("div",{style:{position:"relative",background:"#000",minHeight:"300px"},children:[a.jsx("video",{ref:ce,autoPlay:!0,playsInline:!0,muted:!0,style:{width:"100%",maxHeight:"60vh",objectFit:"contain"}}),a.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"80%",height:"80%",border:"2px solid rgba(255,255,255,0.3)",borderRadius:"var(--radius-lg)",pointerEvents:"none"}})]}),a.jsx("div",{style:{padding:"var(--space-4)",background:"rgba(0,0,0,0.8)",display:"flex",justifyContent:"center",gap:"var(--space-4)"},children:a.jsx("button",{type:"button",onClick:Z,style:{background:"white",border:"none",borderRadius:"50%",width:"70px",height:"70px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:"0 0 0 4px rgba(255,255,255,0.3)",transition:"transform 0.1s"},onMouseDown:E=>E.currentTarget.style.transform="scale(0.95)",onMouseUp:E=>E.currentTarget.style.transform="scale(1)",children:a.jsx(Rd,{size:32,color:"#000"})})}),a.jsxs("div",{style:{padding:"var(--space-2)",background:"rgba(0,0,0,0.6)",textAlign:"center",color:"white",fontSize:"var(--font-size-sm)"},children:[" chp: ",L.images.filter(E=>E.type==="camera").length," nh"]})]})})]})}function bW(){const{containers:e,getSurveysByContainer:t}=qt(),[n,r]=T.useState(""),s=cn(),l=e.filter(d=>{const m=t(d.id).some(p=>p.status==="COMPLETED"&&p.sequence===d.sequence);return d.status===yn.DM&&!m}).filter(d=>{if(!n)return!0;const f=n.toLowerCase();return d.containerNumber.toLowerCase().includes(f)||d.booking&&d.booking.toLowerCase().includes(f)||d.yardLocation&&`${d.yardLocation.block}${d.yardLocation.row}`.toLowerCase().includes(f)}),u=d=>{s(`/surveys/new/${d}`)};return a.jsxs("div",{className:"page",children:[a.jsx("div",{className:"page-header",children:a.jsxs("div",{children:[a.jsx("h2",{children:"Search Container for Survey"}),a.jsx("p",{className:"text-muted",children:"Find a container to create a new survey"})]})}),a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label required",children:"Container Number"}),a.jsxs("div",{className:"search-box",style:{maxWidth:500},children:[a.jsx(bn,{size:18}),a.jsx("input",{type:"text",className:"form-input",placeholder:"Enter container number, booking, or location (e.g., A5)...",value:n,onChange:d=>r(d.target.value),autoFocus:!0})]}),a.jsx("p",{className:"form-hint",children:"You can also filter by booking reference or bay/row location"})]}),a.jsxs("div",{className:"mt-4",children:[a.jsxs("h4",{style:{marginBottom:"var(--space-3)"},children:["Available Containers (",l.length,")"]}),l.length===0?a.jsxs("div",{className:"empty-state",style:{padding:"var(--space-8)"},children:[a.jsx(il,{size:48}),a.jsx("h3",{children:"No eligible containers found"}),a.jsx("p",{children:n?"Try a different search term":"All containers have completed surveys or are not in DM status"})]}):a.jsx("div",{className:"container-search-results",children:l.map(d=>{const m=t(d.id).find(p=>p.status==="DRAFT");return a.jsxs("div",{className:"container-search-item",onClick:()=>u(d.id),children:[a.jsxs("div",{className:"container-search-main",children:[a.jsx("span",{className:"container-number",style:{fontSize:"1.1rem"},children:d.containerNumber}),a.jsx("span",{className:"badge badge-dm",children:Oi[d.status]})]}),a.jsxs("div",{className:"container-search-details",children:[a.jsx("span",{children:d.size}),a.jsx("span",{children:""}),a.jsx("span",{children:d.liner}),a.jsx("span",{children:""}),a.jsx("span",{children:d.yardLocation?`${d.yardLocation.block}-${d.yardLocation.row}-${d.yardLocation.tier}`:"No location"})]}),m&&a.jsxs("div",{className:"container-search-warning",children:[a.jsx(s_,{size:14}),a.jsxs("span",{children:["Has draft survey: ",m.id]})]}),a.jsx($a,{size:20,className:"container-search-arrow"})]},d.id)})})]})]})]})}function AW(){const{eors:e,syncApprovedEORsToAR:t,updateEOR:n}=qt(),{user:r,hasScreenPermission:s,canPerform:i}=Ft(),{t:l}=Wt(),u=en(),d=cn(),[f]=hi(),m=f.get("workflow_filter"),[p,x]=T.useState("all"),[v,k]=T.useState(""),[y,S]=T.useState(""),[C,D]=T.useState(()=>(r==null?void 0:r.userType)==="EXTERNAL"&&(r!=null&&r.shippingLineCode)?r.shippingLineCode:""),[N,b]=T.useState([]),[H,L]=T.useState(!1),[R,q]=T.useState(""),[O,V]=T.useState(""),[X,M]=T.useState(1),me=Gi.CONTAINERS_PER_PAGE,[ae,ce]=T.useState(!0),K=(()=>{switch(p){case"pending":return e.filter(A=>A.status==="PENDING"||A.status==="SENT");case"approved":return e.filter(A=>A.status==="APPROVED"||A.status==="AUTO_APPROVED");case"rejected":return e.filter(A=>A.status==="REJECTED");default:return e}})().filter(A=>{if((r==null?void 0:r.userType)==="EXTERNAL"&&(r!=null&&r.shippingLineCode)&&A.liner!==r.shippingLineCode)return!1;if(m==="draft_sent"){if(A.status!=="DRAFT"&&A.status!=="SENT")return!1}else if(m==="pending_approval"&&A.status!=="PENDING"&&A.status!=="SENT")return!1;const he=!v||A.containerNumber.toLowerCase().includes(v.toLowerCase())||A.id.toLowerCase().includes(v.toLowerCase()),G=!y||A.status===y,Ie=!C||A.liner===C;return he&&G&&Ie}),W=Math.ceil(K.length/me),j=K.slice((X-1)*me,X*me),F={all:e.length,pending:e.filter(A=>A.status==="PENDING"||A.status==="SENT").length,approved:e.filter(A=>A.status==="APPROVED"||A.status==="AUTO_APPROVED").length,rejected:e.filter(A=>A.status==="REJECTED").length},U={totalValue:e.reduce((A,he)=>A+(he.totalCost||0),0),pendingValue:e.filter(A=>A.status==="PENDING"||A.status==="SENT").reduce((A,he)=>A+(he.totalCost||0),0),approvedValue:e.filter(A=>A.status==="APPROVED"||A.status==="AUTO_APPROVED").reduce((A,he)=>A+(he.totalCost||0),0),avgValue:e.length>0?Math.round(e.reduce((A,he)=>A+(he.totalCost||0),0)/e.length):0},I=(A,he)=>{A(he),M(1)},Z=A=>{x(A),S(""),M(1),b([])},Y=A=>A.includes("APPROVED")?"badge-approved":A==="REJECTED"?"badge-rejected":A==="PENDING"||A==="SENT"?"badge-pending":"badge-draft",P=()=>{const A=t();A>0?u.success(`Synced ${A} containers to AR status`):u.info("All approved EORs are already synced")},ne=A=>{b(he=>he.includes(A)?he.filter(G=>G!==A):[...he,A])},J=()=>{const A=j.filter(he=>he.status==="PENDING"||he.status==="SENT").map(he=>he.id);A.every(he=>N.includes(he))?b(he=>he.filter(G=>!A.includes(G))):b(he=>[...new Set([...he,...A])])},de=A=>{q(A),V(""),L(!0)},E=()=>{const A=N.map(he=>n(he,{status:R==="approve"?"APPROVED":"REJECTED",approvalNotes:O,approvedAt:new Date().toISOString(),approvedBy:r==null?void 0:r.username},r==null?void 0:r.id));Promise.all(A).then(()=>{u.success(`${N.length} EORs ${R==="approve"?"approved":"rejected"}`),b([]),L(!1),V("")})};return a.jsxs("div",{className:"page-list-layout",children:[a.jsxs("div",{className:"page-list-header",children:[a.jsxs("div",{className:"page-header",children:[a.jsxs("div",{children:[a.jsx("h2",{children:l("eor.eorList")}),a.jsx("p",{className:"text-muted",children:l("eor.title")})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(_s,{screenId:"eor_list"}),a.jsxs("button",{className:"btn btn-secondary",onClick:P,children:[a.jsx(Xi,{size:16})," ",l("eor.syncToAR")||"Sync to AR"]})]})]}),a.jsxs("div",{className:"cost-summary-row",children:[a.jsxs("div",{className:"cost-card",children:[a.jsx(o_,{size:20}),a.jsxs("div",{className:"cost-card-content",children:[a.jsxs("div",{className:"cost-card-value",children:["RM ",U.totalValue.toLocaleString()]}),a.jsx("div",{className:"cost-card-label",children:l("eor.totalValue")||"Total Value"})]})]}),a.jsxs("div",{className:"cost-card pending",children:[a.jsx(tr,{size:20}),a.jsxs("div",{className:"cost-card-content",children:[a.jsxs("div",{className:"cost-card-value",children:["RM ",U.pendingValue.toLocaleString()]}),a.jsx("div",{className:"cost-card-label",children:l("eor.pendingAmount")||"Pending Approval"})]})]}),a.jsxs("div",{className:"cost-card approved",children:[a.jsx(St,{size:20}),a.jsxs("div",{className:"cost-card-content",children:[a.jsxs("div",{className:"cost-card-value",children:["RM ",U.approvedValue.toLocaleString()]}),a.jsx("div",{className:"cost-card-label",children:l("eor.approvedAmount")||"Approved"})]})]}),a.jsxs("div",{className:"cost-card",children:[a.jsx(wn,{size:20}),a.jsxs("div",{className:"cost-card-content",children:[a.jsxs("div",{className:"cost-card-value",children:["RM ",U.avgValue.toLocaleString()]}),a.jsx("div",{className:"cost-card-label",children:l("eor.avgValue")||"Average EOR"})]})]})]}),a.jsxs("div",{className:"flex justify-between align-center mb-2",children:[a.jsxs("div",{className:"eor-tabs",children:[a.jsxs("button",{className:`tab-btn ${p==="all"?"active":""}`,onClick:()=>Z("all"),children:[l("common.all")||"All"," ",a.jsx("span",{className:"tab-count",children:F.all})]}),a.jsxs("button",{className:`tab-btn pending ${p==="pending"?"active":""}`,onClick:()=>Z("pending"),children:[l("eor.pendingApproval")||"Pending Approval"," ",a.jsx("span",{className:"tab-count",children:F.pending})]}),a.jsxs("button",{className:`tab-btn approved ${p==="approved"?"active":""}`,onClick:()=>Z("approved"),children:[l("common.approved")||"Approved"," ",a.jsx("span",{className:"tab-count",children:F.approved})]}),a.jsxs("button",{className:`tab-btn rejected ${p==="rejected"?"active":""}`,onClick:()=>Z("rejected"),children:[l("common.rejected")||"Rejected"," ",a.jsx("span",{className:"tab-count",children:F.rejected})]})]}),a.jsxs("button",{className:`filter-toggle-btn ${ae?"":"collapsed"}`,onClick:()=>ce(!ae),title:ae?"Hide Filters":"Show Filters",children:[a.jsx(Xp,{size:14}),ae?a.jsx(gh,{size:14}):a.jsx(Yi,{size:14})]})]}),a.jsx("div",{className:`filters-wrapper ${ae?"":"collapsed"}`,children:a.jsxs("div",{className:"filters",children:[a.jsxs("div",{className:"search-box",children:[a.jsx(bn,{size:18}),a.jsx("input",{type:"text",className:"form-input",placeholder:l("common.search")+"...",value:v,onChange:A=>I(k,A.target.value)})]}),p==="all"&&a.jsxs("select",{className:"form-input",style:{width:200},value:y,onChange:A=>I(S,A.target.value),children:[a.jsx("option",{value:"",children:l("common.allStatuses")||"All Statuses"}),Object.entries(Xd).map(([A,he])=>a.jsx("option",{value:A,children:he},A))]}),a.jsxs("select",{className:"form-input",style:{width:150},value:C,onChange:A=>I(D,A.target.value),disabled:(r==null?void 0:r.userType)==="EXTERNAL",title:(r==null?void 0:r.userType)==="EXTERNAL"?"Restricted to your shipping line":"Filter by shipping line",children:[a.jsx("option",{value:"",children:l("common.allLiners")||"All Liners"}),Ea.map(A=>a.jsx("option",{value:A.code,children:A.code},A.code))]}),N.length>0&&a.jsxs("div",{className:"bulk-actions",children:[a.jsxs("span",{className:"selected-count",children:[N.length," ",l("common.selected")||"selected"]}),a.jsxs("button",{className:"btn btn-success btn-sm",onClick:()=>de("approve"),children:[a.jsx(St,{size:14})," ",l("eor.approveSelected")||"Approve"]}),a.jsxs("button",{className:"btn btn-error btn-sm",onClick:()=>de("reject"),children:[a.jsx(Gr,{size:14})," ",l("eor.rejectSelected")||"Reject"]}),a.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>b([]),children:l("common.clearSelection")||"Clear"})]})]})})]}),a.jsxs("div",{className:"page-list-content",children:[a.jsx("div",{className:"table-container",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[(p==="pending"||p==="all")&&a.jsx("th",{style:{width:40},children:a.jsx("input",{type:"checkbox",onChange:J,checked:j.filter(A=>A.status==="PENDING"||A.status==="SENT").length>0&&j.filter(A=>A.status==="PENDING"||A.status==="SENT").every(A=>N.includes(A.id))})}),a.jsx("th",{children:l("columns.transactionId")}),a.jsx("th",{children:l("columns.containerNumber")}),a.jsx("th",{children:l("columns.liner")}),a.jsx("th",{children:l("columns.totalCost")}),a.jsx("th",{children:l("columns.approval")}),a.jsx("th",{children:l("columns.eorStatus")}),a.jsx("th",{children:l("columns.createdAt")}),a.jsx("th",{children:l("columns.actions")})]})}),a.jsx("tbody",{children:j.map(A=>{const he=r.userType==="EXTERNAL",G=he?A.liner===r.shippingLineCode:!0,Ie=he?G:s("eor_list","approve")||s("eor_detail","approve")||i("approve"),oe=he?G:s("eor_list","reject")||s("eor_detail","reject")||i("approve"),Te=(A.status==="PENDING"||A.status==="SENT")&&Ie,xe=(A.status==="PENDING"||A.status==="SENT")&&oe;return a.jsxs("tr",{onDoubleClick:()=>d(`/eor/${A.id}`),style:{cursor:"pointer"},children:[(p==="pending"||p==="all")&&a.jsx("td",{onClick:we=>we.stopPropagation(),children:(A.status==="PENDING"||A.status==="SENT")&&G&&a.jsx("input",{type:"checkbox",checked:N.includes(A.id),onChange:()=>ne(A.id)})}),a.jsx("td",{children:a.jsx("span",{style:{fontWeight:500},children:A.surveyId||A.id})}),a.jsx("td",{children:a.jsx("span",{className:"container-number",children:A.containerNumber})}),a.jsx("td",{children:A.liner}),a.jsx("td",{children:a.jsxs("span",{style:{fontWeight:600},children:["RM ",A.totalCost]})}),a.jsx("td",{children:A.autoApproved?a.jsx("span",{className:"badge badge-av",children:"Auto"}):A.status==="APPROVED"?a.jsx("span",{className:"badge badge-av",children:"Manual"}):A.needApproval?a.jsx("span",{className:"badge badge-ar",children:"Required"}):a.jsx("span",{className:"badge badge-draft",children:"N/A"})}),a.jsx("td",{children:a.jsx("span",{className:`badge ${Y(A.status)}`,children:Xd[A.status]})}),a.jsx("td",{children:new Date(A.createdAt).toLocaleDateString()}),a.jsx("td",{children:a.jsxs("div",{className:"flex gap-2",children:[Te&&a.jsx("button",{className:"btn btn-success btn-xs",onClick:we=>{we.stopPropagation(),n(A.id,{status:"APPROVED",approvedAt:new Date().toISOString(),approvedBy:r==null?void 0:r.username},r==null?void 0:r.id),u.success(l("eor.approved")||"EOR Approved")},title:l("eor.approve"),children:a.jsx(St,{size:14})}),xe&&a.jsx("button",{className:"btn btn-error btn-xs",onClick:we=>{we.stopPropagation(),n(A.id,{status:"REJECTED"},r==null?void 0:r.id),u.success(l("eor.rejected")||"EOR Rejected")},title:l("eor.reject"),children:a.jsx(Gr,{size:14})}),a.jsx(vt,{to:`/eor/${A.id}`,className:"btn btn-ghost btn-sm",children:a.jsx(qr,{size:16})})]})})]},A.id)})})]})}),K.length===0&&a.jsxs("div",{className:"empty-state",children:[a.jsx(wn,{size:48}),a.jsx("h3",{children:l("eor.noEORsFound")||"No EORs found"}),a.jsx("p",{children:l("eor.createFromSurvey")||"Create an EOR from a completed survey"})]})]}),W>1&&a.jsx("div",{className:"page-list-footer",children:a.jsxs("div",{className:"pagination",children:[a.jsxs("button",{className:"btn btn-ghost btn-sm",onClick:()=>M(A=>Math.max(1,A-1)),disabled:X===1,children:[a.jsx(ao,{size:16})," ",l("common.previous")||"Previous"]}),a.jsxs("span",{className:"pagination-info",children:[l("common.page")||"Page"," ",X," ",l("common.of")||"of"," ",W,a.jsxs("span",{className:"pagination-total",children:["(",K.length," ",l("common.total")||"total",")"]})]}),a.jsxs("button",{className:"btn btn-ghost btn-sm",onClick:()=>M(A=>Math.min(W,A+1)),disabled:X===W,children:[l("common.next")||"Next"," ",a.jsx(Gn,{size:16})]})]})}),H&&a.jsx("div",{className:"modal-overlay",onClick:()=>L(!1),children:a.jsxs("div",{className:"modal",onClick:A=>A.stopPropagation(),children:[a.jsx("div",{className:"modal-header",children:a.jsx("h3",{children:R==="approve"?l("eor.bulkApprove")||"Bulk Approve":l("eor.bulkReject")||"Bulk Reject"})}),a.jsxs("div",{className:"modal-body",children:[a.jsx("p",{className:"mb-4",children:R==="approve"?l("eor.bulkApproveConfirm")||`Are you sure you want to approve ${N.length} EOR(s)?`:l("eor.bulkRejectConfirm")||`Are you sure you want to reject ${N.length} EOR(s)?`}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:l("eor.approvalNotes")||"Notes (optional)"}),a.jsx("textarea",{className:"form-input",rows:3,value:O,onChange:A=>V(A.target.value),placeholder:l("eor.enterNotes")||"Enter any notes for this action..."})]})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{className:"btn btn-ghost",onClick:()=>L(!1),children:l("common.cancel")||"Cancel"}),a.jsx("button",{className:`btn ${R==="approve"?"btn-success":"btn-error"}`,onClick:E,children:R==="approve"?a.jsxs(a.Fragment,{children:[a.jsx(St,{size:16})," ",l("eor.approve")||"Approve"]}):a.jsxs(a.Fragment,{children:[a.jsx(Gr,{size:16})," ",l("eor.reject")||"Reject"]})})]})]})})]})}function xm(){var Y;const{id:e,surveyId:t}=ws(),[n]=hi(),r=n.get("containerId"),s=cn(),{user:i}=Ft(),{getSurvey:l,getEOR:u,getContainer:d,createEOR:f,updateEOR:m,surveys:p}=qt(),{getCodeList:x,getSetting:v}=On(),k=en();if((i==null?void 0:i.userType)==="EXTERNAL")return a.jsx("div",{className:"page",children:a.jsxs("div",{className:"empty-state",children:[a.jsx("h3",{children:"Access Denied"}),a.jsx("p",{className:"text-muted",children:"External users cannot create or edit EORs. You can view and approve/reject EORs from the EOR List."}),a.jsxs(vt,{to:"/eor",className:"btn btn-primary mt-4",children:[a.jsx(hr,{size:16})," Back to EOR List"]})]})});const S=x("DAMAGE_LOCATIONS"),C=x("DAMAGE_TYPES"),D=x("COMPONENTS"),N=x("REPAIR_METHODS"),b=!!e&&e!=="new",H=b?u(e):null,L=T.useMemo(()=>{if(t)return l(t);if(H)return l(H.surveyId);if(r)try{return JSON.parse(localStorage.getItem("mnr_surveys")||"[]").find(ne=>ne.containerId===r&&ne.status==="COMPLETED")}catch{return null}return null},[t,H,r,l]),R=L?d(L.containerId):null,[q,O]=T.useState([]),[V,X]=T.useState(""),[M,me]=T.useState(0);if(T.useEffect(()=>{if(H)O(H.repairItems||[]),X(H.notes||""),me(H.discount||0);else if(L&&L.damageItems){const P=L.damageItems.map((ne,J)=>({id:`r${Date.now()}-${J}`,location:ne.location,damageType:ne.damageType,repairCode:ne.repairMethod,component:ne.component,baseCost:ne.estimatedCost||0,quantity:ne.quantity||1,severity:ne.severity||"M",size:ne.size||"",lineTotal:ne.estimatedCost||0,isManuallyAdjusted:!1}));O(P)}},[H,L]),!L||!R)return a.jsx("div",{className:"page",children:a.jsxs("div",{className:"empty-state",children:[a.jsx("h3",{children:"Survey not found"}),a.jsx("p",{className:"text-muted",children:r?"No completed survey found for this container. Please complete a survey first.":"Please select a completed survey to create an EOR."}),a.jsxs(vt,{to:"/surveys",className:"btn btn-primary mt-4",children:[a.jsx(hr,{size:16})," Back to Surveys"]})]})});const ae=q.reduce((P,ne)=>P+(ne.lineTotal||0),0),ce=Math.max(0,ae-M),ue=v("autoApprovalThreshold"),K=ce>ue,W=((Y=L.damageItems)==null?void 0:Y.reduce((P,ne)=>P+(ne.estimatedCost||0),0))||0,j=()=>{O(P=>[...P,{id:`r${Date.now()}`,location:"",damageType:"",repairCode:"",component:"",baseCost:0,quantity:1,lineTotal:0,isManuallyAdjusted:!1}])},F=(P,ne,J)=>{O(de=>{const E=[...de];if(E[P]={...E[P],[ne]:J},ne==="lineTotal"&&(E[P].isManuallyAdjusted=!0),!E[P].isManuallyAdjusted&&["baseCost","quantity"].includes(ne)&&(E[P].lineTotal=Math.round((E[P].baseCost||0)*(E[P].quantity||1))),ne==="component"&&!E[P].isManuallyAdjusted){const A=D.find(he=>he.code===J);A&&(E[P].baseCost=A.unitPrice||0,E[P].lineTotal=Math.round((A.unitPrice||0)*(E[P].quantity||1)))}return E})},U=P=>{O(ne=>{const J=[...ne];return J[P].isManuallyAdjusted=!1,J[P].lineTotal=Math.round((J[P].baseCost||0)*(J[P].quantity||1)),J})},I=P=>{O(ne=>ne.filter((J,de)=>de!==P))},Z=()=>{if(q.length===0){k.error("At least one repair item is required");return}if(b)m(e,{repairItems:q,notes:V,discount:M},i.username),k.success("EOR updated successfully!");else{const P=f({surveyId:L.id,containerId:R.id,containerNumber:R.containerNumber,sequence:R.sequence,liner:R.liner,repairItems:q,notes:V,discount:M,surveyTotal:W},i.username);P.autoApproved?k.success(`EOR created and auto-approved! (Total RM ${P.totalCost}  ${ue})`):k.success("EOR created! Approval required.")}s("/eor")};return a.jsxs("div",{className:"page",children:[a.jsxs("div",{className:"page-header",children:[a.jsxs(vt,{to:"/eor",className:"btn btn-ghost",children:[a.jsx(hr,{size:16})," Back"]}),a.jsxs("button",{className:"btn btn-primary",onClick:Z,children:[a.jsx(Oa,{size:16})," ",b?"Update EOR":"Create EOR"]})]}),a.jsx("div",{className:"card",children:a.jsxs("div",{className:"grid grid-cols-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Container"}),a.jsx("p",{className:"container-number",style:{margin:0,fontSize:"1.1rem"},children:R.containerNumber})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Liner"}),a.jsx("p",{style:{margin:0,fontWeight:500},children:R.liner})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Survey Estimate"}),a.jsxs("p",{style:{margin:0,fontWeight:500,color:"var(--info-500)"},children:["RM ",W]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Approval Status"}),a.jsx("p",{style:{margin:0},children:K?a.jsxs("span",{className:"badge badge-ar",children:["Required (> ",ue," RM)"]}):a.jsx("span",{className:"badge badge-av",children:"Auto-Approved"})})]})]})}),a.jsxs("div",{className:"card mt-4",children:[a.jsxs("div",{className:"card-header",children:[a.jsxs("h3",{className:"card-title",children:["Repair Items (",q.length,")"]}),a.jsxs("button",{className:"btn btn-secondary",onClick:j,children:[a.jsx(Xr,{size:16})," Add Item"]})]}),q.map((P,ne)=>a.jsxs("div",{className:"repair-item",children:[a.jsxs("div",{className:"repair-item-header",children:[a.jsxs("span",{children:["Item #",ne+1,P.isManuallyAdjusted&&a.jsx("span",{className:"badge badge-warning",style:{marginLeft:"8px",fontSize:"10px"},children:"Adjusted"})]}),a.jsxs("div",{className:"flex gap-2",children:[P.isManuallyAdjusted&&a.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>U(ne),title:"Reset to auto-calculation",children:"Reset"}),a.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>I(ne),children:a.jsx(La,{size:14})})]})]}),a.jsxs("div",{className:"grid grid-cols-4",style:{gap:"var(--space-3)"},children:[a.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[a.jsx("label",{className:"form-label",children:"Location"}),a.jsxs("select",{className:"form-input",value:P.location,onChange:J=>F(ne,"location",J.target.value),children:[a.jsx("option",{value:"",children:"Select..."}),S.map(J=>a.jsxs("option",{value:J.code,children:[J.code," - ",J.name]},J.code))]})]}),a.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[a.jsx("label",{className:"form-label",children:"Damage"}),a.jsxs("select",{className:"form-input",value:P.damageType,onChange:J=>F(ne,"damageType",J.target.value),children:[a.jsx("option",{value:"",children:"Select..."}),C.map(J=>a.jsxs("option",{value:J.code,children:[J.code," - ",J.name]},J.code))]})]}),a.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[a.jsx("label",{className:"form-label",children:"Repair Code"}),a.jsxs("select",{className:"form-input",value:P.repairCode,onChange:J=>F(ne,"repairCode",J.target.value),children:[a.jsx("option",{value:"",children:"Select..."}),N.map(J=>a.jsxs("option",{value:J.code,children:[J.code," - ",J.name]},J.code))]})]}),a.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[a.jsx("label",{className:"form-label",children:"Component"}),a.jsxs("select",{className:"form-input",value:P.component,onChange:J=>F(ne,"component",J.target.value),children:[a.jsx("option",{value:"",children:"Select..."}),D.map(J=>a.jsxs("option",{value:J.code,children:[J.code," - ",J.name]},J.code))]})]}),a.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[a.jsx("label",{className:"form-label",children:"Base Cost (RM)"}),a.jsx("input",{type:"number",className:"form-input",value:P.baseCost,onChange:J=>F(ne,"baseCost",parseFloat(J.target.value)||0)})]}),a.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[a.jsx("label",{className:"form-label",children:"Quantity"}),a.jsx("input",{type:"number",className:"form-input",min:"1",value:P.quantity,onChange:J=>F(ne,"quantity",parseInt(J.target.value)||1)})]}),a.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[a.jsx("label",{className:"form-label",children:"Size"}),a.jsx("input",{type:"text",className:"form-input",value:P.size||"",onChange:J=>F(ne,"size",J.target.value),placeholder:"e.g. 10x20cm"})]}),a.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[a.jsxs("label",{className:"form-label",children:["Line Total (RM)",a.jsx(J3,{size:12,style:{marginLeft:"4px",opacity:.6},title:"Editable - adjust price as needed"})]}),a.jsx("input",{type:"number",className:"form-input",value:P.lineTotal,onChange:J=>F(ne,"lineTotal",parseFloat(J.target.value)||0),style:{fontWeight:600,borderColor:P.isManuallyAdjusted?"var(--warning-500)":void 0}})]})]})]},P.id)),a.jsxs("div",{className:"eor-summary",style:{marginTop:"var(--space-4)",padding:"var(--space-4)",background:"var(--bg-tertiary)",borderRadius:"var(--radius-md)"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"var(--space-2)"},children:[a.jsx("span",{children:"Subtotal:"}),a.jsxs("span",{style:{fontWeight:500},children:["RM ",ae]})]}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"var(--space-2)"},children:[a.jsx("label",{className:"form-label",style:{margin:0},children:"Discount/Adjustment (RM):"}),a.jsx("input",{type:"number",className:"form-input",style:{width:"120px",textAlign:"right"},value:M,onChange:P=>me(parseFloat(P.target.value)||0),placeholder:"0"})]}),a.jsxs("div",{className:"eor-total",style:{marginTop:"var(--space-3)",paddingTop:"var(--space-3)",borderTop:"2px solid var(--border-color)"},children:[a.jsx("span",{children:"Total Cost:"}),a.jsxs("span",{className:"eor-total-value",children:["RM ",ce]})]}),W!==ae&&a.jsxs("div",{style:{fontSize:"var(--font-size-xs)",color:"var(--text-tertiary)",marginTop:"var(--space-2)"},children:["Original Survey Estimate: RM ",W,ae>W?` (+${ae-W})`:` (${ae-W})`]})]})]}),a.jsx("div",{className:"card mt-4",children:a.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[a.jsx("label",{className:"form-label",children:"Notes (for liner negotiation, price adjustments, etc.)"}),a.jsx("textarea",{className:"form-input",rows:3,value:V,onChange:P=>X(P.target.value),placeholder:"Add notes about price adjustments, negotiation with liner, etc..."})]})})]})}function jW(){const{id:e}=ws(),t=cn(),{getEOR:n,sendEOR:r,approveEOR:s,createRepairOrder:i,getContainer:l}=qt(),{user:u,hasScreenPermission:d,canPerform:f}=Ft(),{getSetting:m}=On(),p=en(),x=m("autoApprovalThreshold"),v=n(e);if(!v)return a.jsx("div",{className:"page",children:a.jsxs("div",{className:"empty-state",children:[a.jsx("h3",{children:"EOR not found"}),a.jsxs(vt,{to:"/eor",className:"btn btn-primary mt-4",children:[a.jsx(hr,{size:16})," Back to List"]})]})});l(v.containerId);const k=(u==null?void 0:u.userType)==="EXTERNAL",y=k?(u==null?void 0:u.shippingLineCode)&&(v==null?void 0:v.liner)===u.shippingLineCode:!0,S=k?y:d("eor_detail","approve")||f("approve"),C=k?y:d("eor_detail","reject")||f("approve"),D=v.status==="DRAFT"&&!k,N=v.status==="DRAFT"&&v.needApproval&&!k,b=(v.status==="PENDING"||v.status==="SENT")&&S,H=(v.status==="PENDING"||v.status==="SENT")&&C,[L,R]=T.useState(!1),q=()=>{const ue=JSON.parse(localStorage.getItem("mnr_shunting")||"[]").some(K=>K.containerId===v.containerId||K.containerNumber===v.containerNumber);R(ue)};T.useEffect(()=>{q();const ce=()=>q();return window.addEventListener("focus",ce),()=>window.removeEventListener("focus",ce)},[v.containerId,v.containerNumber]);const O=v.status.includes("APPROVED")&&L,V=v.status.includes("APPROVED")&&!L,X=()=>{const ce=v.liner,ue=r(e,`mnr@${ce.toLowerCase()}.com`,"EMAIL",u.username);ue.success?p.success("EOR sent successfully!"):p.error(ue.error)},M=ce=>{s(e,{status:ce},u.username).success&&p.success(`EOR ${ce.toLowerCase()}!`)},me=()=>{const ce=i({eorId:v.id,surveyId:v.surveyId,containerId:v.containerId,containerNumber:v.containerNumber,liner:v.liner,workItems:v.repairItems.map(ue=>({repairItemId:ue.id,status:"NEW"}))},u.username);ce.success?p.success(`Repair Order ${ce.ro.id} created!`):p.error(ce.error)},ae=()=>{const ce=window.open("","_blank");if(ce){const ue=v.repairItems.map((K,W)=>`
                <tr>
                    <td>${W+1}</td>
                    <td>${Xs($y,K.location)}</td>
                    <td>${Xs(Vy,K.damageType)}</td>
                    <td>${Xs(qy,K.repairCode)}</td>
                    <td>${Xs(Ky,K.component)}</td>
                    <td>${K.quantity}</td>
                    <td>RM ${K.unitPrice}</td>
                    <td>${K.laborHours}h</td>
                    <td style="font-weight: 600;">RM ${K.lineTotal}</td>
                </tr>
            `).join("");ce.document.write(`
                <html>
                <head>
                    <title>EOR - ${v.id}</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 40px; color: #333; }
                        .header { text-align: center; border-bottom: 2px solid #333; padding-bottom: 20px; margin-bottom: 30px; }
                        .header h1 { margin: 0 0 10px 0; color: #1a56db; }
                        .header .subtitle { color: #666; font-size: 14px; }
                        .section { margin-bottom: 30px; }
                        .section-title { font-size: 16px; font-weight: bold; border-bottom: 1px solid #ddd; padding-bottom: 8px; margin-bottom: 15px; }
                        .info-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; }
                        .info-item label { display: block; font-size: 12px; color: #666; margin-bottom: 4px; }
                        .info-item p { margin: 0; font-weight: 500; }
                        table { width: 100%; border-collapse: collapse; font-size: 12px; }
                        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                        th { background: #f5f5f5; font-weight: 600; }
                        .total-row td { font-weight: bold; background: #f0f8ff; }
                        .status-badge { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 11px; font-weight: 600; background: #e8f5e9; color: #2e7d32; }
                        .total-cost { font-size: 24px; font-weight: bold; color: #1a56db; }
                        .footer { margin-top: 50px; text-align: center; font-size: 12px; color: #999; }
                        @media print { body { padding: 20px; } }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>Estimate of Repair (EOR)</h1>
                        <div class="subtitle">M&R Container Management System</div>
                    </div>
                    
                    <div class="section">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h2 style="margin: 0 0 8px 0;">${v.id}</h2>
                                <span class="status-badge">${Xd[v.status]}</span>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-size: 12px; color: #666;">Total Cost</div>
                                <div class="total-cost">RM ${v.totalCost}</div>
                                ${v.autoApproved?'<div style="font-size: 11px; color: #2e7d32;">Auto-Approved</div>':""}
                            </div>
                        </div>
                    </div>

                    <div class="section">
                        <div class="section-title">Container Information</div>
                        <div class="info-grid">
                            <div class="info-item">
                                <label>Container Number</label>
                                <p>${v.containerNumber}</p>
                            </div>
                            <div class="info-item">
                                <label>Liner</label>
                                <p>${v.liner}</p>
                            </div>
                            <div class="info-item">
                                <label>Survey ID</label>
                                <p>${v.surveyId||"N/A"}</p>
                            </div>
                            <div class="info-item">
                                <label>Version</label>
                                <p>v${v.version}</p>
                            </div>
                        </div>
                    </div>

                    <div class="section">
                        <div class="section-title">Repair Items (${v.repairItems.length})</div>
                        <table>
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Location</th>
                                    <th>Damage</th>
                                    <th>Repair</th>
                                    <th>Component</th>
                                    <th>Qty</th>
                                    <th>Unit Price</th>
                                    <th>Labor</th>
                                    <th>Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${ue}
                            </tbody>
                            <tfoot>
                                <tr class="total-row">
                                    <td colspan="8" style="text-align: right;">Total:</td>
                                    <td>RM ${v.totalCost}</td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>

                    <div class="section">
                        <div class="section-title">Document History</div>
                        <p><strong>Created:</strong> ${new Date(v.createdAt).toLocaleString()} by ${v.createdBy}</p>
                        ${v.sentAt?`<p><strong>Sent to Liner:</strong> ${new Date(v.sentAt).toLocaleString()} by ${v.sentBy}</p>`:""}
                        ${v.approvedAt?`<p><strong>${v.status.includes("APPROVED")?"Approved":"Rejected"}:</strong> ${new Date(v.approvedAt).toLocaleString()} by ${v.approvedBy}</p>`:""}
                    </div>

                    <div class="footer">
                        <p>Generated on ${new Date().toLocaleString()}</p>
                        <p>M&R Container Management System</p>
                    </div>
                </body>
                </html>
            `),ce.document.close(),ce.print(),p.success('PDF export opened. Use "Save as PDF" in print dialog.')}else p.error("Could not open print window. Please check popup blocker.")};return a.jsxs("div",{className:"page",children:[a.jsxs("div",{className:"page-header",children:[a.jsxs(vt,{to:"/eor",className:"btn btn-ghost",children:[a.jsx(hr,{size:16})," Back"]}),a.jsxs("div",{className:"flex gap-3",children:[D&&a.jsxs(vt,{to:`/eor/${e}/edit`,className:"btn btn-secondary",children:[a.jsx(tO,{size:16})," Edit"]}),N&&a.jsxs("button",{className:"btn btn-primary",onClick:X,children:[a.jsx(Jp,{size:16})," Send to Liner"]}),b&&a.jsxs("button",{className:"btn btn-success",onClick:()=>M("APPROVED"),children:[a.jsx(St,{size:16})," Approve"]}),H&&a.jsx("button",{className:"btn btn-danger",onClick:()=>M("REJECTED"),children:"Reject"}),O&&a.jsxs("button",{className:"btn btn-primary",onClick:me,children:[a.jsx(Aa,{size:16})," Create Repair Order"]}),V&&a.jsxs("button",{className:"btn btn-warning",onClick:()=>t("/shunting"),children:[a.jsx(Va,{size:16})," Request Shunting"]}),a.jsxs("button",{className:"btn btn-secondary",onClick:ae,children:[a.jsx(cu,{size:16})," Export PDF"]})]})]}),a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("div",{children:[a.jsx("h2",{style:{marginBottom:"var(--space-2)"},children:v.id}),a.jsx("span",{className:`badge badge-${v.status.toLowerCase().replace("_","-")}`,style:{fontSize:"0.9rem"},children:Xd[v.status]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"text-muted text-sm",children:"Total Cost"}),a.jsxs("div",{style:{fontSize:"2rem",fontWeight:700,color:"var(--primary-500)"},children:["RM ",v.totalCost]}),v.autoApproved&&a.jsx("span",{className:"badge badge-av",children:"Auto-Approved"}),v.needApproval&&!v.autoApproved&&a.jsxs("span",{className:"badge badge-ar",children:["Approval Required (> ",x," RM)"]})]})]}),a.jsxs("div",{className:"grid grid-cols-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Container"}),a.jsx("p",{className:"container-number",style:{margin:0},children:v.containerNumber})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Liner"}),a.jsx("p",{style:{margin:0,fontWeight:500},children:v.liner})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Survey ID"}),a.jsx(vt,{to:`/surveys/${v.surveyId}`,style:{fontWeight:500},children:v.surveyId})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Version"}),a.jsxs("p",{style:{margin:0,fontWeight:500},children:["v",v.version]})]})]})]}),a.jsxs("div",{className:"card mt-4",children:[a.jsxs("h3",{className:"card-title",style:{marginBottom:"var(--space-4)"},children:["Repair Items (",v.repairItems.length,")"]}),a.jsx("div",{className:"table-container",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"#"}),a.jsx("th",{children:"Location"}),a.jsx("th",{children:"Damage"}),a.jsx("th",{children:"Repair"}),a.jsx("th",{children:"Component"}),a.jsx("th",{children:"Qty"}),a.jsx("th",{children:"Unit Price"}),a.jsx("th",{children:"Labor"}),a.jsx("th",{children:"Total"})]})}),a.jsx("tbody",{children:v.repairItems.map((ce,ue)=>a.jsxs("tr",{children:[a.jsx("td",{children:ue+1}),a.jsx("td",{children:Xs($y,ce.location)}),a.jsx("td",{children:Xs(Vy,ce.damageType)}),a.jsx("td",{children:Xs(qy,ce.repairCode)}),a.jsx("td",{children:Xs(Ky,ce.component)}),a.jsx("td",{children:ce.quantity}),a.jsxs("td",{children:["RM ",ce.unitPrice]}),a.jsxs("td",{children:[ce.laborHours,"h"]}),a.jsxs("td",{style:{fontWeight:600},children:["RM ",ce.lineTotal]})]},ce.id))}),a.jsx("tfoot",{children:a.jsxs("tr",{children:[a.jsx("td",{colSpan:"8",style:{textAlign:"right",fontWeight:600},children:"Total:"}),a.jsxs("td",{style:{fontWeight:700,fontSize:"1.1rem"},children:["RM ",v.totalCost]})]})})]})})]}),a.jsxs("div",{className:"card mt-4",children:[a.jsx("h3",{className:"card-title",style:{marginBottom:"var(--space-4)"},children:"Timeline"}),a.jsxs("div",{className:"timeline",children:[a.jsxs("div",{className:"timeline-item",children:[a.jsx("div",{className:"timeline-dot"}),a.jsxs("div",{className:"timeline-content",children:[a.jsx("strong",{children:"Created"}),a.jsxs("p",{children:[new Date(v.createdAt).toLocaleString()," by ",v.createdBy]})]})]}),v.sentAt&&a.jsxs("div",{className:"timeline-item",children:[a.jsx("div",{className:"timeline-dot"}),a.jsxs("div",{className:"timeline-content",children:[a.jsx("strong",{children:"Sent to Liner"}),a.jsxs("p",{children:[new Date(v.sentAt).toLocaleString()," by ",v.sentBy]})]})]}),v.approvedAt&&a.jsxs("div",{className:"timeline-item",children:[a.jsx("div",{className:"timeline-dot",style:{background:"var(--success-500)"}}),a.jsxs("div",{className:"timeline-content",children:[a.jsx("strong",{children:v.status.includes("APPROVED")?"Approved":"Rejected"}),a.jsxs("p",{children:[new Date(v.approvedAt).toLocaleString()," by ",v.approvedBy]})]})]})]})]})]})}const Gd=[{id:"team_a",name:"Team A - Structural"},{id:"team_b",name:"Team B - Welding"},{id:"team_c",name:"Team C - Painting"},{id:"team_d",name:"Team D - General"}];function RW(){const{repairOrders:e,updateRepairOrder:t}=qt(),{t:n}=Wt(),{user:r}=Ft(),s=en(),i=cn(),[l]=hi(),u=l.get("workflow_filter"),[d,f]=T.useState(""),[m,p]=T.useState(""),[x,v]=T.useState(""),[k,y]=T.useState(""),[S,C]=T.useState(!1),[D,N]=T.useState(null),[b,H]=T.useState(""),[L,R]=T.useState(1),q=Gi.CONTAINERS_PER_PAGE,O=e.filter(j=>{var Y,P,ne;if(u==="active"&&j.status!=="NEW"&&j.status!=="PENDING"&&j.status!=="IN_PROGRESS")return!1;const F=!d||((Y=j.containerNumber)==null?void 0:Y.toLowerCase().includes(d.toLowerCase()))||((P=j.id)==null?void 0:P.toLowerCase().includes(d.toLowerCase()))||((ne=j.surveyId)==null?void 0:ne.toLowerCase().includes(d.toLowerCase())),U=!m||j.status===m,I=!x||j.liner===x,Z=!k||j.assignedTeam===k;return F&&U&&I&&Z}),V=Math.ceil(O.length/q),X=O.slice((L-1)*q,L*q),M=(j,F)=>{j(F),R(1)},me=j=>{j.status==="PENDING"&&(t(j.id,{status:"IN_PROGRESS",startedAt:new Date().toISOString(),startedBy:r==null?void 0:r.username},r==null?void 0:r.id),s.success(`Repair started for ${j.containerNumber}`))},ae=j=>{j.status==="IN_PROGRESS"&&(t(j.id,{status:"COMPLETED",completedAt:new Date().toISOString(),completedBy:r==null?void 0:r.username},r==null?void 0:r.id),s.success(`Repair completed for ${j.containerNumber}`))},ce=j=>{N(j),H(j.assignedTeam||""),C(!0)},ue=()=>{var j;D&&b&&(t(D.id,{assignedTeam:b,assignedAt:new Date().toISOString(),assignedBy:r==null?void 0:r.username},r==null?void 0:r.id),s.success(`${D.containerNumber} assigned to ${(j=Gd.find(F=>F.id===b))==null?void 0:j.name}`),C(!1),N(null),H(""))},K=j=>{switch(j){case"PENDING":return 0;case"IN_PROGRESS":return 50;case"COMPLETED":return 100;default:return 0}},W=j=>{switch(j){case"PENDING":return"badge-pending";case"IN_PROGRESS":return"badge-in-progress";case"COMPLETED":return"badge-completed";default:return"badge-draft"}};return a.jsxs("div",{className:"page-list-layout",children:[a.jsxs("div",{className:"page-list-header",children:[a.jsxs("div",{className:"page-header",children:[a.jsxs("div",{children:[a.jsx("h2",{children:n("repairOrder.title")}),a.jsx("p",{className:"text-muted",children:n("repairOrder.roList")})]}),a.jsxs("div",{className:"header-stats",children:[a.jsxs("div",{className:"header-stat",children:[a.jsx("span",{className:"header-stat-value",children:e.filter(j=>j.status==="PENDING").length}),a.jsx("span",{className:"header-stat-label",children:n("common.pending")||"Pending"})]}),a.jsxs("div",{className:"header-stat",children:[a.jsx("span",{className:"header-stat-value",children:e.filter(j=>j.status==="IN_PROGRESS").length}),a.jsx("span",{className:"header-stat-label",children:n("common.inProgress")||"In Progress"})]}),a.jsxs("div",{className:"header-stat",children:[a.jsx("span",{className:"header-stat-value",children:e.filter(j=>j.status==="COMPLETED").length}),a.jsx("span",{className:"header-stat-label",children:n("common.completed")||"Completed"})]}),a.jsx(_s,{screenId:"repair_orders"})]})]}),a.jsxs("div",{className:"filters",children:[a.jsxs("div",{className:"search-box",children:[a.jsx(bn,{size:18}),a.jsx("input",{type:"text",className:"form-input",placeholder:n("common.search")+"...",value:d,onChange:j=>M(f,j.target.value)})]}),a.jsxs("select",{className:"form-input",style:{width:160},value:m,onChange:j=>M(p,j.target.value),children:[a.jsx("option",{value:"",children:n("common.allStatuses")||"All Statuses"}),Object.entries(Cm).map(([j,F])=>a.jsx("option",{value:j,children:F},j))]}),a.jsxs("select",{className:"form-input",style:{width:150},value:x,onChange:j=>M(v,j.target.value),children:[a.jsx("option",{value:"",children:n("common.allLiners")||"All Liners"}),Ea.map(j=>a.jsx("option",{value:j.code,children:j.code},j.code))]}),a.jsxs("select",{className:"form-input",style:{width:180},value:k,onChange:j=>M(y,j.target.value),children:[a.jsx("option",{value:"",children:n("repairOrder.allTeams")||"All Teams"}),Gd.map(j=>a.jsx("option",{value:j.id,children:j.name},j.id))]})]})]}),a.jsx("div",{className:"page-list-content",children:O.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx(Aa,{size:48}),a.jsx("h3",{children:n("repairOrder.noRepairOrders")||"No repair orders"}),a.jsx("p",{children:n("repairOrder.noRepairOrdersDesc")||"Repair orders are created from approved EORs"})]}):a.jsx("div",{className:"table-container",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:n("columns.transactionId")}),a.jsx("th",{children:n("columns.containerNumber")}),a.jsx("th",{children:n("columns.liner")}),a.jsx("th",{children:n("columns.progress")||"Progress"}),a.jsx("th",{children:n("columns.roStatus")}),a.jsx("th",{children:n("columns.assignedTeam")}),a.jsx("th",{children:n("columns.createdAt")}),a.jsx("th",{children:n("columns.actions")})]})}),a.jsx("tbody",{children:X.map(j=>{var F;return a.jsxs("tr",{onDoubleClick:()=>i(`/repair-orders/${j.id}`),style:{cursor:"pointer"},children:[a.jsx("td",{children:a.jsx("span",{style:{fontWeight:500},children:j.surveyId||j.id})}),a.jsx("td",{children:a.jsx("span",{className:"container-number",children:j.containerNumber})}),a.jsx("td",{children:j.liner}),a.jsxs("td",{children:[a.jsx("div",{className:"progress-bar-container",children:a.jsx("div",{className:"progress-bar",style:{width:`${K(j.status)}%`,backgroundColor:j.status==="COMPLETED"?"var(--success-500)":j.status==="IN_PROGRESS"?"var(--warning-500)":"var(--neutral-400)"}})}),a.jsxs("span",{className:"progress-text",children:[K(j.status),"%"]})]}),a.jsx("td",{children:a.jsx("span",{className:`badge ${W(j.status)}`,children:Cm[j.status]})}),a.jsx("td",{children:j.assignedTeam?a.jsxs("span",{className:"team-badge",children:[a.jsx(si,{size:12}),((F=Gd.find(U=>U.id===j.assignedTeam))==null?void 0:F.name)||j.assignedTeam]}):a.jsxs("button",{className:"btn btn-ghost btn-sm",onClick:U=>{U.stopPropagation(),ce(j)},children:[a.jsx(si,{size:14})," ",n("repairOrder.assign")||"Assign"]})}),a.jsx("td",{children:new Date(j.createdAt).toLocaleDateString()}),a.jsx("td",{children:a.jsxs("div",{className:"action-buttons",children:[j.status==="PENDING"&&a.jsxs("button",{className:"btn btn-success btn-sm",onClick:U=>{U.stopPropagation(),me(j)},title:"Start Repair",children:[a.jsx(ai,{size:14})," ",n("repairOrder.start")||"Start"]}),j.status==="IN_PROGRESS"&&a.jsxs("button",{className:"btn btn-primary btn-sm",onClick:U=>{U.stopPropagation(),ae(j)},title:"Complete Repair",children:[a.jsx(St,{size:14})," ",n("repairOrder.complete")||"Complete"]}),a.jsxs(vt,{to:`/repair-orders/${j.id}`,className:"btn btn-ghost btn-sm",children:[a.jsx(qr,{size:16})," ",n("common.view")||"View"]})]})})]},j.id)})})]})})}),O.length>0&&V>1&&a.jsx("div",{className:"page-list-footer",children:a.jsxs("div",{className:"pagination",children:[a.jsxs("button",{className:"btn btn-ghost btn-sm",onClick:()=>R(j=>Math.max(1,j-1)),disabled:L===1,children:[a.jsx(ao,{size:16})," ",n("common.previous")||"Previous"]}),a.jsxs("span",{className:"pagination-info",children:[n("common.page")||"Page"," ",L," ",n("common.of")||"of"," ",V,a.jsxs("span",{className:"pagination-total",children:["(",O.length," ",n("common.total")||"total",")"]})]}),a.jsxs("button",{className:"btn btn-ghost btn-sm",onClick:()=>R(j=>Math.min(V,j+1)),disabled:L===V,children:[n("common.next")||"Next"," ",a.jsx(Gn,{size:16})]})]})}),S&&a.jsx("div",{className:"modal-overlay",onClick:()=>C(!1),children:a.jsxs("div",{className:"modal",onClick:j=>j.stopPropagation(),children:[a.jsx("div",{className:"modal-header",children:a.jsx("h3",{children:n("repairOrder.assignTeam")||"Assign Repair Team"})}),a.jsxs("div",{className:"modal-body",children:[a.jsx("p",{className:"text-muted mb-4",children:n("repairOrder.assignTeamDesc")||"Select a team to assign this repair order to:"}),a.jsxs("div",{className:"container-info mb-4",children:[a.jsx("strong",{children:D==null?void 0:D.containerNumber}),a.jsxs("span",{className:"text-muted",children:[" - ",D==null?void 0:D.liner]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:n("repairOrder.selectTeam")||"Select Team"}),a.jsxs("select",{className:"form-input",value:b,onChange:j=>H(j.target.value),children:[a.jsx("option",{value:"",children:n("repairOrder.selectTeamPlaceholder")||"-- Select a team --"}),Gd.map(j=>a.jsx("option",{value:j.id,children:j.name},j.id))]})]})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{className:"btn btn-ghost",onClick:()=>C(!1),children:n("common.cancel")||"Cancel"}),a.jsxs("button",{className:"btn btn-primary",onClick:ue,disabled:!b,children:[a.jsx(si,{size:16})," ",n("repairOrder.assignTeam")||"Assign Team"]})]})]})})]})}function IW(){var H;const{id:e}=ws(),{getRepairOrder:t,getEOR:n,updateRepairOrder:r,updateContainer:s,getContainer:i}=qt(),{user:l}=Ft(),u=en(),d=t(e),f=d?n(d.eorId):null,m=d?i(d.containerId):null,[p,x]=T.useState(""),[v,k]=T.useState((d==null?void 0:d.assignedTeam)||"");if(!d)return a.jsx("div",{className:"page",children:a.jsxs("div",{className:"empty-state",children:[a.jsx("h3",{children:"Repair Order not found"}),a.jsxs(vt,{to:"/repair-orders",className:"btn btn-primary mt-4",children:[a.jsx(hr,{size:16})," Back to List"]})]})});const y=()=>{if(!v){u.error("Please assign a technician/team first");return}r(e,{status:"IN_PROGRESS",assignedTeam:v,startTime:new Date().toISOString()},l.username),m&&s(m.id,{status:"REPAIR",repairStartTime:new Date().toISOString()},l.username),u.success("Repair work started!")},S=()=>{var L;(L=d.workItems)==null||L.every(R=>R.status==="COMPLETED"),r(e,{status:"COMPLETED",endTime:new Date().toISOString(),workLog:p||d.workLog},l.username),m&&s(m.id,{status:"COMPLETED",repairEndTime:new Date().toISOString()},l.username),u.success("Repair completed! Ready for pre-inspection.")},C=()=>{if(!p.trim())return;const L=d.workLogs||[];L.push({id:Date.now(),text:p,user:l.username,timestamp:new Date().toISOString()}),r(e,{workLogs:L},l.username),x(""),u.success("Work log added")},D=d.status==="NEW"||d.status==="PLANNED",N=d.status==="IN_PROGRESS",b=d.status==="IN_PROGRESS";return a.jsxs("div",{className:"page",children:[a.jsxs("div",{className:"page-header",children:[a.jsxs(vt,{to:"/repair-orders",className:"btn btn-ghost",children:[a.jsx(hr,{size:16})," Back"]}),a.jsxs("div",{className:"flex gap-3",children:[D&&a.jsxs("button",{className:"btn btn-primary",onClick:y,children:[a.jsx(ai,{size:16})," Start Repair"]}),N&&a.jsxs("button",{className:"btn btn-success",onClick:S,children:[a.jsx(St,{size:16})," Complete Repair"]})]})]}),a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h2",{style:{marginBottom:"var(--space-2)"},children:d.id}),a.jsx("span",{className:`badge badge-${d.status.toLowerCase().replace("_","-")}`,style:{fontSize:"0.9rem"},children:Cm[d.status]})]}),b&&a.jsxs("div",{className:"repair-timer",children:[a.jsx(tr,{size:20}),a.jsxs("span",{children:["In Progress since ",new Date(d.startTime).toLocaleString()]})]})]}),a.jsxs("div",{className:"grid grid-cols-4 mt-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Container"}),a.jsx("p",{className:"container-number",style:{margin:0},children:d.containerNumber})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Liner"}),a.jsx("p",{style:{margin:0,fontWeight:500},children:d.liner})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"EOR Reference"}),a.jsx(vt,{to:`/eor/${d.eorId}`,style:{fontWeight:500},children:d.eorId})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Assigned Team"}),D?a.jsxs("select",{className:"form-input",value:v,onChange:L=>k(L.target.value),children:[a.jsx("option",{value:"",children:"Select team..."}),a.jsx("option",{value:"Team A",children:"Team A - General Repairs"}),a.jsx("option",{value:"Team B",children:"Team B - Welding"}),a.jsx("option",{value:"Team C",children:"Team C - Reefer"})]}):a.jsx("p",{style:{margin:0,fontWeight:500},children:d.assignedTeam||"-"})]})]})]}),a.jsxs("div",{className:"card mt-4",children:[a.jsxs("h3",{className:"card-title",style:{marginBottom:"var(--space-4)"},children:[a.jsx(Aa,{size:18})," Repair Tasks"]}),((H=f==null?void 0:f.repairItems)==null?void 0:H.length)>0?a.jsx("div",{className:"repair-tasks",children:f.repairItems.map((L,R)=>a.jsxs("div",{className:"repair-task",children:[a.jsxs("div",{className:"repair-task-header",children:[a.jsxs("span",{className:"repair-task-num",children:["#",R+1]}),a.jsx("span",{className:"repair-task-loc",children:L.location}),a.jsx("span",{className:"repair-task-type",children:L.repairCode})]}),a.jsxs("div",{className:"repair-task-desc",children:[L.damageType," - ",L.component," (Qty: ",L.quantity,")"]})]},L.id))}):a.jsx("p",{className:"text-muted",children:"No repair tasks defined"})]}),(b||d.status==="COMPLETED")&&a.jsxs("div",{className:"card mt-4",children:[a.jsx("h3",{className:"card-title",style:{marginBottom:"var(--space-4)"},children:"Work Log"}),b&&a.jsxs("div",{className:"flex gap-3 mb-4",children:[a.jsx("input",{type:"text",className:"form-input",placeholder:"Add work log entry...",value:p,onChange:L=>x(L.target.value),onKeyDown:L=>L.key==="Enter"&&C()}),a.jsxs("button",{className:"btn btn-secondary",onClick:C,children:[a.jsx(Xr,{size:16})," Add"]})]}),a.jsx("div",{className:"work-logs",children:(d.workLogs||[]).length===0?a.jsx("p",{className:"text-muted",children:"No work logs recorded yet"}):d.workLogs.map(L=>a.jsxs("div",{className:"work-log-item",children:[a.jsxs("div",{className:"work-log-header",children:[a.jsx(Js,{size:14}),a.jsx("span",{children:L.user}),a.jsx("span",{className:"work-log-time",children:new Date(L.timestamp).toLocaleString()})]}),a.jsx("p",{children:L.text})]},L.id))})]})]})}function PW(){const{containers:e,repairOrders:t,surveys:n,updateContainer:r}=qt(),{user:s}=Ft(),{getCodeList:i}=On(),l=i("DRIVERS"),{t:u}=Wt(),d=en(),[f]=hi(),m=f.get("workflow_filter"),[p,x]=T.useState(()=>{const E=localStorage.getItem("mnr_shunting");return E?JSON.parse(E):[]}),[v,k]=T.useState(!1),[y,S]=T.useState(null),[C,D]=T.useState({fromBlock:"",toBlock:"",priority:"NORMAL",notes:"",driver:""}),[N,b]=T.useState(""),[H,L]=T.useState(""),[R,q]=T.useState(""),[O,V]=T.useState(1),X=50,[M,me]=T.useState(!1),[ae,ce]=T.useState(null),[ue,K]=T.useState(""),W=e.filter(E=>E.status==="AR"&&!p.some(A=>A.containerId===E.id&&A.status!=="COMPLETED")),j=p.filter(E=>{if(m==="active"&&E.status==="COMPLETED")return!1;const A=!N||E.containerNumber.toLowerCase().includes(N.toLowerCase())||E.id.toLowerCase().includes(N.toLowerCase()),he=!H||E.status===H,G=!R||E.priority===R;return A&&he&&G}),F=Math.ceil(j.length/X),U=j.slice((O-1)*X,O*X),I={total:p.length,new:p.filter(E=>E.status==="NEW").length,dispatched:p.filter(E=>E.status==="DISPATCHED").length,inProgress:p.filter(E=>E.status==="IN_PROGRESS").length,completed:p.filter(E=>E.status==="COMPLETED").length,urgent:p.filter(E=>E.priority==="URGENT"&&E.status!=="COMPLETED").length},Z=l.reduce((E,A)=>(E[A.code]=p.filter(he=>he.assignedDriver===A.code&&he.status!=="COMPLETED").length,E),{}),Y=E=>{x(E),localStorage.setItem("mnr_shunting",JSON.stringify(E))},P=()=>{if(!y||!C.toBlock){d.error("Please select container and destination block");return}const E=n.find(G=>G.containerId===y.id&&G.status==="COMPLETED"),A=(E==null?void 0:E.id)||y.lastSurveyId||null,he={id:`${y.containerNumber}-${new Date().toISOString().replace(/[-:TZ.]/g,"").slice(2,14)}`,containerId:y.id,containerNumber:y.containerNumber,liner:y.liner,surveyTransactionId:A,fromLocation:y.yardLocation,toBlock:C.toBlock,priority:C.priority,status:C.driver?"DISPATCHED":"NEW",assignedDriver:C.driver||null,notes:C.notes,createdBy:s.username,createdAt:new Date().toISOString(),dispatchedAt:C.driver?new Date().toISOString():null};Y([he,...p]),d.success("Shunting request created!"),k(!1),S(null),D({fromBlock:"",toBlock:"",priority:"NORMAL",notes:"",driver:""})},ne=E=>{ce(E),K(E.assignedDriver||""),me(!0)},J=()=>{if(!ue){d.error("Please select a driver");return}const E=p.map(he=>he.id===ae.id?{...he,status:"DISPATCHED",assignedDriver:ue,dispatchedAt:new Date().toISOString(),dispatchedBy:s.username}:he);Y(E);const A=l.find(he=>he.code===ue);d.success(`Dispatched to ${A==null?void 0:A.name}`),me(!1),ce(null)},de=(E,A)=>{const he=p.find(Ie=>Ie.id===E),G=p.map(Ie=>{if(Ie.id===E){const oe={...Ie,status:A,[`${A.toLowerCase()}At`]:new Date().toISOString(),[`${A.toLowerCase()}By`]:s.username};return A==="IN_PROGRESS"&&Ie.dispatchedAt&&(oe.responseTimeMinutes=Math.floor((Date.now()-new Date(Ie.dispatchedAt).getTime())/6e4)),A==="COMPLETED"&&Ie.createdAt&&(oe.totalWaitTimeMinutes=Math.floor((Date.now()-new Date(Ie.createdAt).getTime())/6e4),Ie.in_progressAt&&(oe.processingTimeMinutes=Math.floor((Date.now()-new Date(Ie.in_progressAt).getTime())/6e4))),oe}return Ie});Y(G),A==="COMPLETED"&&he?(r(he.containerId,{status:"REPAIR",yardLocation:{block:he.toBlock,row:1,tier:1},shuntedAt:new Date().toISOString()},s.id),d.success(`${he.containerNumber} moved to ${he.toBlock} - Status: REPAIR`)):d.success(`Request ${A.toLowerCase().replace("_"," ")}`)};return a.jsxs("div",{className:"page-list-layout",children:[a.jsxs("div",{className:"page-list-header",children:[a.jsxs("div",{className:"page-header",children:[a.jsxs("div",{children:[a.jsx("h2",{children:u("shunting.title")}),a.jsx("p",{className:"text-muted",children:u("shunting.moveContainers")||"Move containers to repair bays"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(_s,{screenId:"shunting"}),a.jsxs("button",{className:"btn btn-primary",onClick:()=>k(!0),children:[a.jsx(Xr,{size:16})," ",u("shunting.newRequest")]})]})]}),a.jsxs("div",{className:"compact-stats",children:[a.jsxs("div",{className:"compact-stat",children:[a.jsx("span",{className:"compact-stat-value",children:I.total}),a.jsx("span",{className:"compact-stat-label",children:u("shunting.totalRequests")||"Total"})]}),a.jsxs("div",{className:"compact-stat",children:[a.jsx("span",{className:"compact-stat-value",style:{color:"var(--warning-500)"},children:I.new}),a.jsx("span",{className:"compact-stat-label",children:u("shunting.pending")||"Pending"})]}),a.jsxs("div",{className:"compact-stat",children:[a.jsx("span",{className:"compact-stat-value",style:{color:"var(--secondary-500)"},children:I.dispatched}),a.jsx("span",{className:"compact-stat-label",children:u("shunting.dispatched")||"Dispatched"})]}),a.jsxs("div",{className:"compact-stat",children:[a.jsx("span",{className:"compact-stat-value",style:{color:"var(--primary-500)"},children:I.inProgress}),a.jsx("span",{className:"compact-stat-label",children:u("shunting.inProgress")||"In Progress"})]}),a.jsxs("div",{className:"compact-stat",children:[a.jsx("span",{className:"compact-stat-value",style:{color:"var(--error-500)"},children:I.urgent}),a.jsxs("span",{className:"compact-stat-label",children:[a.jsx(Dr,{size:12})," ",u("shunting.urgent")||"Urgent"]})]})]}),a.jsxs("div",{className:"filters",children:[a.jsxs("div",{className:"search-box",children:[a.jsx(bn,{size:18}),a.jsx("input",{type:"text",className:"form-input",placeholder:u("common.search")+"...",value:N,onChange:E=>{b(E.target.value),V(1)}})]}),a.jsxs("select",{className:"form-input",style:{width:140},value:H,onChange:E=>{L(E.target.value),V(1)},children:[a.jsx("option",{value:"",children:u("common.allStatuses")||"All Statuses"}),a.jsx("option",{value:"NEW",children:u("shunting.new")||"New"}),a.jsx("option",{value:"DISPATCHED",children:u("shunting.dispatched")||"Dispatched"}),a.jsx("option",{value:"IN_PROGRESS",children:u("common.inProgress")||"In Progress"}),a.jsx("option",{value:"COMPLETED",children:u("common.completed")||"Completed"})]}),a.jsxs("select",{className:"form-input",style:{width:130},value:R,onChange:E=>{q(E.target.value),V(1)},children:[a.jsx("option",{value:"",children:u("shunting.allPriorities")||"All Priorities"}),a.jsx("option",{value:"NORMAL",children:u("shunting.normal")||"Normal"}),a.jsx("option",{value:"URGENT",children:u("shunting.urgent")||"Urgent"})]})]})]}),a.jsxs("div",{className:"page-list-content",children:[I.new+I.dispatched+I.inProgress>0&&a.jsxs("div",{className:"card mb-4 driver-workload",children:[a.jsxs("h4",{className:"card-title mb-3",children:[a.jsx(si,{size:18})," ",u("shunting.driverWorkload")||"Driver Workload"]}),a.jsx("div",{className:"driver-grid",children:l.map(E=>a.jsxs("div",{className:"driver-card",children:[a.jsx("div",{className:"driver-name",children:E.name}),a.jsxs("div",{className:"driver-tasks",children:[a.jsx("span",{className:"task-count",children:Z[E.code]}),a.jsx("span",{className:"task-label",children:u("driver.activeTasks")||"cng vic ang lm"})]})]},E.code))})]}),j.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx(Va,{size:48}),a.jsx("h3",{children:u("shunting.noRequests")||"No shunting requests"}),a.jsx("p",{children:u("shunting.createRequest")||"Create a request to move containers to repair bays"})]}):a.jsx("div",{className:"table-container",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:u("columns.transactionId")}),a.jsx("th",{children:u("columns.containerNumber")}),a.jsx("th",{children:u("columns.liner")}),a.jsx("th",{children:u("columns.route")||"Route"}),a.jsx("th",{children:u("columns.driver")||"Driver"}),a.jsx("th",{children:u("columns.priority")}),a.jsx("th",{children:u("columns.shuntingStatus")}),a.jsx("th",{children:u("columns.waitTime")||"Wait Time"}),a.jsx("th",{children:u("columns.actions")})]})}),a.jsx("tbody",{children:U.map(E=>{var G;const A=Math.floor((Date.now()-new Date(E.createdAt).getTime())/6e4),he=A<60?`${A}m`:`${Math.floor(A/60)}h ${A%60}m`;return a.jsxs("tr",{className:E.priority==="URGENT"?"urgent-row":"",children:[a.jsx("td",{style:{fontWeight:500},children:E.surveyTransactionId||E.id}),a.jsx("td",{children:a.jsx("span",{className:"container-number",children:E.containerNumber})}),a.jsx("td",{children:E.liner}),a.jsx("td",{children:a.jsxs("div",{className:"route-display",children:[a.jsx("span",{className:"from-location",children:E.fromLocation?`${E.fromLocation.block}-${E.fromLocation.row}-${E.fromLocation.tier}`:"-"}),a.jsx($a,{size:14}),a.jsx("span",{className:"to-location",children:E.toBlock})]})}),a.jsx("td",{children:E.assignedDriver?a.jsxs("span",{className:"driver-badge",children:[a.jsx(si,{size:12}),(G=l.find(Ie=>Ie.code===E.assignedDriver))==null?void 0:G.name]}):a.jsxs("button",{className:"btn btn-ghost btn-sm",onClick:()=>ne(E),children:[a.jsx(si,{size:14})," ",u("shunting.assign")||"Assign"]})}),a.jsx("td",{children:a.jsxs("span",{className:`badge ${E.priority==="URGENT"?"badge-dm":"badge-draft"}`,children:[E.priority==="URGENT"&&a.jsx(L3,{size:10}),E.priority]})}),a.jsx("td",{children:a.jsx("span",{className:`badge badge-${E.status.toLowerCase().replace("_","-")}`,children:E.status.replace("_"," ")})}),a.jsx("td",{children:E.status!=="COMPLETED"&&a.jsxs("span",{className:`wait-time ${A>60?"overdue":""}`,children:[a.jsx(tr,{size:12})," ",he]})}),a.jsx("td",{children:a.jsxs("div",{className:"action-buttons",children:[E.status==="NEW"&&a.jsx(a.Fragment,{children:a.jsxs("button",{className:"btn btn-secondary btn-sm",onClick:()=>ne(E),title:u("shunting.dispatch")||"Dispatch",children:[a.jsx(Va,{size:14})," ",u("shunting.dispatch")||"Dispatch"]})}),E.status==="DISPATCHED"&&a.jsxs("button",{className:"btn btn-primary btn-sm",onClick:()=>de(E.id,"IN_PROGRESS"),children:[a.jsx(ai,{size:14})," ",u("shunting.start")||"Start"]}),E.status==="IN_PROGRESS"&&a.jsxs("button",{className:"btn btn-success btn-sm",onClick:()=>de(E.id,"COMPLETED"),children:[a.jsx(St,{size:14})," ",u("shunting.complete")||"Complete"]})]})})]},E.id)})})]})})]}),F>1&&a.jsx("div",{className:"page-list-footer",children:a.jsxs("div",{className:"pagination",children:[a.jsxs("button",{className:"btn btn-ghost btn-sm",onClick:()=>V(E=>Math.max(1,E-1)),disabled:O===1,children:[a.jsx(ao,{size:16})," ",u("common.previous")||"Previous"]}),a.jsxs("span",{className:"pagination-info",children:[u("common.page")||"Page"," ",O," ",u("common.of")||"of"," ",F]}),a.jsxs("button",{className:"btn btn-ghost btn-sm",onClick:()=>V(E=>Math.min(F,E+1)),disabled:O===F,children:[u("common.next")||"Next"," ",a.jsx(Gn,{size:16})]})]})}),v&&a.jsx("div",{className:"modal-overlay",onClick:()=>k(!1),children:a.jsxs("div",{className:"modal",onClick:E=>E.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h3",{className:"modal-title",children:u("shunting.newShuntingRequest")||"New Shunting Request"}),a.jsx("button",{className:"btn btn-ghost btn-icon",onClick:()=>k(!1),children:""})]}),a.jsxs("div",{className:"modal-body",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label required",children:u("common.selectContainer")||"Select Container"}),a.jsxs("select",{className:"form-input",value:(y==null?void 0:y.id)||"",onChange:E=>S(e.find(A=>A.id===E.target.value)),children:[a.jsx("option",{value:"",children:u("shunting.chooseContainer")||"Choose container..."}),W.map(E=>a.jsxs("option",{value:E.id,children:[E.containerNumber," - ",E.liner," - ",E.yardLocation?`${E.yardLocation.block}-${E.yardLocation.row}`:"No location"]},E.id))]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label required",children:u("shunting.destinationBlock")||"Destination Block"}),a.jsxs("select",{className:"form-input",value:C.toBlock,onChange:E=>D(A=>({...A,toBlock:E.target.value})),children:[a.jsx("option",{value:"",children:u("shunting.selectBlock")||"Select block..."}),dc.filter(E=>E.type==="REPAIR").map(E=>a.jsxs("option",{value:E.code,children:[E.code," - ",u("shunting.repairBay")||"Repair Bay"]},E.code))]})]}),a.jsxs("div",{className:"grid grid-cols-2",style:{gap:"var(--space-3)"},children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:u("columns.priority")||"Priority"}),a.jsxs("select",{className:"form-input",value:C.priority,onChange:E=>D(A=>({...A,priority:E.target.value})),children:[a.jsx("option",{value:"NORMAL",children:u("shunting.normal")||"Normal"}),a.jsx("option",{value:"URGENT",children:u("shunting.urgent")||"Urgent"})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:u("shunting.assignDriver")||"Assign Driver"}),a.jsxs("select",{className:"form-input",value:C.driver,onChange:E=>D(A=>({...A,driver:E.target.value})),children:[a.jsx("option",{value:"",children:u("shunting.assignLater")||"Assign later..."}),l.map(E=>a.jsxs("option",{value:E.code,children:[E.name," (",Z[E.code]," ",u("driver.activeTasks")||"cng vic ang lm",")"]},E.code))]})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:u("common.notes")||"Notes"}),a.jsx("textarea",{className:"form-input",rows:2,value:C.notes,onChange:E=>D(A=>({...A,notes:E.target.value}))})]})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{className:"btn btn-secondary",onClick:()=>k(!1),children:u("common.cancel")||"Cancel"}),a.jsxs("button",{className:"btn btn-primary",onClick:P,children:[a.jsx(Va,{size:16})," ",u("shunting.createRequest")||"Create Request"]})]})]})}),M&&ae&&a.jsx("div",{className:"modal-overlay",onClick:()=>me(!1),children:a.jsxs("div",{className:"modal",onClick:E=>E.stopPropagation(),children:[a.jsx("div",{className:"modal-header",children:a.jsx("h3",{className:"modal-title",children:u("shunting.dispatchToDriver")||"Dispatch to Driver"})}),a.jsxs("div",{className:"modal-body",children:[a.jsxs("div",{className:"dispatch-info mb-4",children:[a.jsx("div",{className:"container-number",children:ae.containerNumber}),a.jsxs("div",{className:"route-display",children:[a.jsx("span",{children:ae.fromLocation?`${ae.fromLocation.block}-${ae.fromLocation.row}`:"-"}),a.jsx($a,{size:14}),a.jsx("span",{children:ae.toBlock})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label required",children:u("shunting.selectDriver")||"Select Driver"}),a.jsx("div",{className:"driver-selection",children:l.map(E=>a.jsxs("button",{className:`driver-option ${ue===E.code?"selected":""}`,onClick:()=>K(E.code),children:[a.jsx("span",{className:"driver-name",children:E.name}),a.jsxs("span",{className:"driver-workload",children:[Z[E.code]," ",u("driver.activeTasks")||"cng vic ang lm"]})]},E.code))})]})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{className:"btn btn-secondary",onClick:()=>me(!1),children:u("common.cancel")||"Cancel"}),a.jsxs("button",{className:"btn btn-primary",onClick:J,disabled:!ue,children:[a.jsx(Va,{size:16})," ",u("shunting.dispatch")||"Dispatch"]})]})]})})]})}function DW(){const{containers:e,repairOrders:t,surveys:n,updateContainer:r,updateRepairOrder:s}=qt(),{user:i}=Ft(),{getCodeList:l}=On(),{t:u}=Wt(),d=en(),[f]=hi(),m=f.get("workflow_filter"),p=l("INSPECTION_CHECKLIST"),[x,v]=T.useState(()=>{const ge=localStorage.getItem("mnr_preinspections");return ge?JSON.parse(ge):[]}),[k,y]=T.useState(!1),[S,C]=T.useState(null),[D,N]=T.useState(""),[b,H]=T.useState(""),[L,R]=T.useState(""),[q,O]=T.useState(""),[V,X]=T.useState(""),[M,me]=T.useState(""),[ae,ce]=T.useState(1),ue=50,[K,W]=T.useState(!1),[j,F]=T.useState(null),[U,I]=T.useState({}),[Z,Y]=T.useState(""),[P,ne]=T.useState([]),[J,de]=T.useState([]),[E,A]=T.useState({}),he=e.filter(ge=>ge.status==="COMPLETED"&&!x.some(Je=>Je.containerId===ge.id&&(Je.status==="PLANNED"||Je.status==="CONFIRMED"||Je.status==="IN_PROGRESS")));x.filter(ge=>{const Je=e.find(qe=>qe.id===ge.containerId);return ge.status==="PENDING_REWORK"&&(Je==null?void 0:Je.status)==="COMPLETED"});const G=x.filter(ge=>{if(m==="pending"&&ge.result!=="PENDING")return!1;const Je=!L||ge.containerNumber.toLowerCase().includes(L.toLowerCase())||ge.id.toLowerCase().includes(L.toLowerCase()),qe=!q||ge.status===q,ot=!V||ge.liner===V,Mt=!M||ge.result===M;return Je&&qe&&ot&&Mt}),Ie=Math.ceil(G.length/ue),oe=G.slice((ae-1)*ue,ae*ue),Te={totalReworks:x.filter(ge=>ge.result==="REWORK").length,reworkByReason:p.reduce((ge,Je)=>(ge[Je.id]=x.filter(qe=>{var ot;return(ot=qe.failedChecks)==null?void 0:ot.includes(Je.id)}).length,ge),{})},xe=ge=>{v(ge),localStorage.setItem("mnr_preinspections",JSON.stringify(ge))},we=()=>{var ot;if(!S||!D){d.error("Please select container and scheduled date");return}const ge=n.find(Mt=>Mt.containerId===S.id&&Mt.status==="COMPLETED"),Je=(ge==null?void 0:ge.id)||S.lastSurveyId||null,qe={id:`${S.containerNumber}-${new Date().toISOString().replace(/[-:TZ.]/g,"").slice(2,14)}`,containerId:S.id,containerNumber:S.containerNumber,surveyTransactionId:Je,liner:S.liner,scheduledDate:D,status:"PLANNED",notes:b,createdBy:i.username,createdAt:new Date().toISOString(),reworkCount:((ot=e.find(Mt=>Mt.id===S.id))==null?void 0:ot.reworkCount)||0};xe([qe,...x]),d.success("Pre-inspection scheduled!"),y(!1),C(null),N(""),H("")},fe=ge=>{F(ge),I(p.reduce((qe,ot)=>({...qe,[ot.id]:null}),{})),Y(""),ne([]);const Je=n.find(qe=>qe.id===ge.surveyTransactionId||qe.containerId===ge.containerId);if(Je&&Je.damageItems&&Je.damageItems.length>0){de(Je.damageItems);const qe=Je.damageItems.reduce((ot,Mt,Ct)=>({...ot,[`damage_${Ct}`]:null}),{});A(qe)}else de([]),A({});W(!0)},ye=(ge,Je)=>{I(qe=>({...qe,[ge]:Je}))},ee=(ge,Je)=>{A(qe=>({...qe,[ge]:Je}))},Pe=()=>{var ga;const ge=Object.entries(U).filter(([,Rt])=>Rt===!1).map(([Rt])=>Rt),Je=Object.entries(E).filter(([,Rt])=>Rt===!1).map(([Rt])=>{const xa=parseInt(Rt.replace("damage_",""));return J[xa]}),qe=ge.length===0&&Object.values(U).every(Rt=>Rt===!0),ot=J.length===0||Object.values(E).every(Rt=>Rt===!0)&&Je.length===0,Ct=qe&&ot?"ACCEPTED":"REWORK",rn=x.map(Rt=>Rt.id===j.id?{...Rt,status:Ct==="ACCEPTED"?"COMPLETED":"PENDING_REWORK",result:Ct,checklistResults:U,failedChecks:ge,damageItemResults:E,failedDamageItems:Je.map(Ln=>({location:Ln.location,component:Ln.component,damageType:Ln.damageType})),inspectionNotes:Z,photos:P,lastInspectedAt:new Date().toISOString(),lastInspectedBy:i.username,...Ct==="ACCEPTED"?{completedAt:new Date().toISOString(),completedBy:i.username}:{}}:Rt);if(xe(rn),Ct==="ACCEPTED")r(j.containerId,{status:"AV",qcPassedAt:new Date().toISOString(),qcPassedBy:i.username},i.id),d.success("Container accepted! Status changed to Available (AV).");else{const Rt=(((ga=e.find(Ln=>Ln.id===j.containerId))==null?void 0:ga.reworkCount)||0)+1;r(j.containerId,{status:"REPAIR",reworkRequired:!0,reworkCount:Rt,reworkNotes:Z,failedChecks:ge,reworkRequestedAt:new Date().toISOString(),reworkRequestedBy:i.username},i.id);const xa=t.find(Ln=>Ln.containerId===j.containerId&&(Ln.status==="COMPLETED"||Ln.status==="QC_PENDING"));xa&&s&&s(xa.id,{status:"IN_PROGRESS",reworkRequired:!0,reworkCount:Rt,reworkNotes:Z,failedChecks:ge,reworkRequestedAt:new Date().toISOString(),reworkRequestedBy:i.username}),d.warning(`Rework required (Attempt #${Rt}). Failed: ${ge.map(Ln=>{var Xa;return(Xa=p.find(Ts=>Ts.id===Ln))==null?void 0:Xa.label}).join(", ")}`)}W(!1),F(null)},Fe=(ge,Je,qe="")=>{var Ct;const ot=x.find(rn=>rn.id===ge),Mt=x.map(rn=>rn.id===ge?{...rn,status:Je==="ACCEPTED"?"COMPLETED":"PENDING_REWORK",result:Je,reworkNotes:qe,lastInspectedAt:new Date().toISOString(),lastInspectedBy:i.username,...Je==="ACCEPTED"?{completedAt:new Date().toISOString(),completedBy:i.username}:{}}:rn);if(xe(Mt),Je==="ACCEPTED")r(ot.containerId,{status:"AV",qcPassedAt:new Date().toISOString(),qcPassedBy:i.username},i.id),d.success("Container accepted! Status changed to Available (AV).");else if(Je==="REWORK"){const rn=(((Ct=e.find(Rt=>Rt.id===ot.containerId))==null?void 0:Ct.reworkCount)||0)+1;r(ot.containerId,{status:"REPAIR",reworkRequired:!0,reworkCount:rn,reworkNotes:qe,reworkRequestedAt:new Date().toISOString(),reworkRequestedBy:i.username},i.id);const ga=t.find(Rt=>Rt.containerId===ot.containerId&&(Rt.status==="COMPLETED"||Rt.status==="QC_PENDING"));ga&&s?(s(ga.id,{status:"IN_PROGRESS",reworkRequired:!0,reworkCount:rn,reworkNotes:qe,reworkRequestedAt:new Date().toISOString(),reworkRequestedBy:i.username}),d.warning(`Rework required (Attempt #${rn}). Repair Order reactivated.`)):d.warning(`Rework required (Attempt #${rn}). Container status changed to REPAIR.`)}},[et,dt]=T.useState(null),[jt,un]=T.useState("");x.filter(ge=>ge.status==="PLANNED"||ge.status==="IN_PROGRESS");const gr=x.filter(ge=>ge.status==="COMPLETED"?!1:new Date(ge.scheduledDate).toDateString()===new Date().toDateString());return a.jsxs("div",{className:"page-list-layout",children:[a.jsxs("div",{className:"page-list-header",children:[a.jsxs("div",{className:"page-header",children:[a.jsxs("div",{children:[a.jsx("h2",{children:u("inspection.title")}),a.jsx("p",{className:"text-muted",children:u("inspection.schedule")})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(_s,{screenId:"pre_inspection"}),a.jsxs("button",{className:"btn btn-primary",onClick:()=>y(!0),children:[a.jsx(Xr,{size:16})," ",u("inspection.schedule")]})]})]}),a.jsxs("div",{className:"grid grid-cols-5 mb-4",children:[a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-card-value",children:x.length}),a.jsx("div",{className:"stat-card-label",children:u("inspection.total")||"Total Inspections"})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-card-value",style:{color:"var(--primary-500)"},children:gr.length}),a.jsx("div",{className:"stat-card-label",children:u("inspection.today")||"Today's"})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-card-value",style:{color:"var(--success-500)"},children:x.filter(ge=>ge.result==="ACCEPTED").length}),a.jsx("div",{className:"stat-card-label",children:u("inspection.accepted")||"Accepted"})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-card-value",style:{color:"var(--warning-500)"},children:Te.totalReworks}),a.jsx("div",{className:"stat-card-label",children:u("inspection.reworkRequired")||"Rework Required"})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-card-value",style:{color:"var(--error-500)"},children:e.filter(ge=>(ge.reworkCount||0)>1).length}),a.jsx("div",{className:"stat-card-label",children:u("inspection.multipleReworks")||"Multiple Reworks"})]})]}),a.jsxs("div",{className:"filters",children:[a.jsxs("div",{className:"search-box",children:[a.jsx(bn,{size:18}),a.jsx("input",{type:"text",className:"form-input",placeholder:u("common.search")+"...",value:L,onChange:ge=>{R(ge.target.value),ce(1)}})]}),a.jsxs("select",{className:"form-input",style:{width:130},value:q,onChange:ge=>{O(ge.target.value),ce(1)},children:[a.jsx("option",{value:"",children:u("common.allStatuses")||"All Statuses"}),a.jsx("option",{value:"PLANNED",children:u("inspection.planned")||"Planned"}),a.jsx("option",{value:"COMPLETED",children:u("inspection.completed")||"Completed"})]}),a.jsxs("select",{className:"form-input",style:{width:130},value:M,onChange:ge=>{me(ge.target.value),ce(1)},children:[a.jsx("option",{value:"",children:u("inspection.allResults")||"All Results"}),a.jsx("option",{value:"ACCEPTED",children:u("inspection.accepted")||"Accepted"}),a.jsx("option",{value:"REWORK",children:u("inspection.rework")||"Rework"})]}),a.jsxs("select",{className:"form-input",style:{width:120},value:V,onChange:ge=>{X(ge.target.value),ce(1)},children:[a.jsx("option",{value:"",children:u("common.allLiners")||"All Liners"}),Ea.map(ge=>a.jsx("option",{value:ge.code,children:ge.code},ge.code))]})]})]}),a.jsxs("div",{className:"page-list-content",children:[Te.totalReworks>0&&a.jsxs("div",{className:"card mb-4 rework-analysis",children:[a.jsxs("h3",{className:"card-title mb-4",children:[a.jsx(Qp,{size:18})," ",u("inspection.reworkAnalysis")||"Rework Analysis by Category"]}),a.jsx("div",{className:"rework-bars",children:p.filter(ge=>Te.reworkByReason[ge.id]>0).sort((ge,Je)=>Te.reworkByReason[Je.id]-Te.reworkByReason[ge.id]).map(ge=>a.jsxs("div",{className:"rework-bar-item",children:[a.jsx("span",{className:"rework-bar-label",children:ge.label}),a.jsx("div",{className:"rework-bar",children:a.jsx("div",{className:"rework-bar-fill",style:{width:`${Math.min(100,Te.reworkByReason[ge.id]/Te.totalReworks*100)}%`}})}),a.jsx("span",{className:"rework-bar-count",children:Te.reworkByReason[ge.id]})]},ge.id))})]}),G.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx(hs,{size:48}),a.jsx("h3",{children:u("inspection.noInspectionsFound")||"No inspections scheduled"}),a.jsx("p",{children:u("inspection.scheduleInspection")||"Schedule a pre-inspection for completed repairs"})]}):a.jsx("div",{className:"table-container",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:u("columns.transactionId")}),a.jsx("th",{children:u("columns.containerNumber")}),a.jsx("th",{children:u("columns.liner")}),a.jsx("th",{children:u("inspection.scheduledDate")}),a.jsx("th",{children:u("inspection.reworkCount")||"Rework #"}),a.jsx("th",{children:u("columns.inspectionStatus")}),a.jsx("th",{children:u("columns.result")}),a.jsx("th",{children:u("columns.actions")})]})}),a.jsx("tbody",{children:oe.map(ge=>a.jsxs("tr",{children:[a.jsx("td",{style:{fontWeight:500},children:ge.surveyTransactionId||ge.id}),a.jsx("td",{children:a.jsx("span",{className:"container-number",children:ge.containerNumber})}),a.jsx("td",{children:ge.liner}),a.jsx("td",{children:new Date(ge.scheduledDate).toLocaleDateString()}),a.jsx("td",{children:(ge.reworkCount||0)>0?a.jsxs("span",{className:`badge ${ge.reworkCount>1?"badge-dm":"badge-ar"}`,children:["#",ge.reworkCount]}):"-"}),a.jsx("td",{children:a.jsx("span",{className:`badge badge-${ge.status.toLowerCase()}`,children:ge.status})}),a.jsx("td",{children:ge.result?a.jsx("span",{className:`badge ${ge.result==="ACCEPTED"?"badge-av":"badge-dm"}`,children:ge.result}):"-"}),a.jsx("td",{children:(()=>{var qe;return ge.status!=="COMPLETED"||ge.status==="PENDING_REWORK"||ge.result==="REWORK"?a.jsxs("div",{className:"action-buttons",children:[a.jsxs("button",{className:"btn btn-primary btn-sm",onClick:()=>fe(ge),title:ge.result==="REWORK"?"Re-Inspect after rework":"Start Full Inspection",children:[a.jsx(zy,{size:14})," ",ge.result==="REWORK"?"Re-Inspect":"Inspect"]}),a.jsx("button",{className:"btn btn-success btn-sm",onClick:()=>Fe(ge.id,"ACCEPTED"),title:u("inspection.quickAccept")||"Quick Accept",children:a.jsx(St,{size:14})}),a.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>dt(ge),title:u("inspection.quickRework")||"Quick Rework",children:a.jsx(Gr,{size:14})})]}):((qe=ge.failedChecks)==null?void 0:qe.length)>0&&a.jsxs("span",{className:"failed-checks-tooltip",title:ge.failedChecks.map(ot=>{var Mt;return(Mt=p.find(Ct=>Ct.id===ot))==null?void 0:Mt.label}).join(", "),children:[ge.failedChecks.length," ",u("inspection.itemsFailed")||"items failed"]})})()})]},ge.id))})]})})]}),Ie>1&&a.jsx("div",{className:"page-list-footer",children:a.jsxs("div",{className:"pagination",children:[a.jsxs("button",{className:"btn btn-ghost btn-sm",onClick:()=>ce(ge=>Math.max(1,ge-1)),disabled:ae===1,children:[a.jsx(ao,{size:16})," ",u("common.previous")||"Previous"]}),a.jsxs("span",{className:"pagination-info",children:[u("common.page")||"Page"," ",ae," ",u("common.of")||"of"," ",Ie]}),a.jsxs("button",{className:"btn btn-ghost btn-sm",onClick:()=>ce(ge=>Math.min(Ie,ge+1)),disabled:ae===Ie,children:[u("common.next")||"Next"," ",a.jsx(Gn,{size:16})]})]})}),k&&a.jsx("div",{className:"modal-overlay",onClick:()=>y(!1),children:a.jsxs("div",{className:"modal",onClick:ge=>ge.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h3",{className:"modal-title",children:u("inspection.scheduleInspection")||"Schedule Pre-Inspection"}),a.jsx("button",{className:"btn btn-ghost btn-icon",onClick:()=>y(!1),children:""})]}),a.jsxs("div",{className:"modal-body",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label required",children:u("common.container")||"Container"}),a.jsxs("select",{className:"form-input",value:(S==null?void 0:S.id)||"",onChange:ge=>C(e.find(Je=>Je.id===ge.target.value)),children:[a.jsx("option",{value:"",children:u("common.selectContainer")||"Select container..."}),he.map(ge=>a.jsx("option",{value:ge.id,children:ge.containerNumber},ge.id))]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label required",children:u("inspection.scheduledDate")||"Scheduled Date"}),a.jsx("input",{type:"date",className:"form-input",value:D,onChange:ge=>N(ge.target.value),min:new Date().toISOString().split("T")[0]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:u("common.notes")||"Notes"}),a.jsx("textarea",{className:"form-input",rows:2,value:b,onChange:ge=>H(ge.target.value)})]})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{className:"btn btn-secondary",onClick:()=>y(!1),children:u("common.cancel")||"Cancel"}),a.jsxs("button",{className:"btn btn-primary",onClick:we,children:[a.jsx(ls,{size:16})," ",u("inspection.schedule")||"Schedule"]})]})]})}),K&&j&&a.jsx("div",{className:"modal-overlay",onClick:()=>W(!1),children:a.jsxs("div",{className:"modal modal-lg",onClick:ge=>ge.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsxs("h3",{className:"modal-title",children:[a.jsx(zy,{size:20})," ",u("inspection.inspectionChecklist")||"QC Inspection"]}),a.jsxs("div",{className:"modal-container-info",children:[a.jsx("span",{className:"container-number",children:j.containerNumber}),a.jsx("span",{className:"text-muted",children:j.liner})]})]}),a.jsxs("div",{className:"modal-body",style:{maxHeight:"70vh",overflowY:"auto"},children:[J.length>0&&a.jsxs("div",{className:"inspection-section",children:[a.jsxs("h4",{className:"inspection-section-title",style:{color:"var(--warning-600)",borderBottom:"2px solid var(--warning-200)",paddingBottom:"8px",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:[a.jsx(Dr,{size:18}),u("inspection.damageVerification")||"Damage Items Verification"," (",J.length,")"]}),a.jsx("p",{className:"text-muted",style:{fontSize:"13px",marginBottom:"12px"},children:u("inspection.damageVerificationDesc")||"Verify that each damage item from the survey has been properly repaired."}),a.jsx("div",{className:"inspection-checklist",children:J.map((ge,Je)=>a.jsxs("div",{className:`checklist-item ${E[`damage_${Je}`]===!0?"passed":E[`damage_${Je}`]===!1?"failed":""}`,children:[a.jsxs("div",{className:"checklist-item-info",children:[a.jsxs("span",{className:"checklist-item-label",children:[ge.location," - ",ge.component]}),a.jsxs("span",{className:"checklist-item-desc",children:[ge.damageType," | ",ge.repairMethod||"Repair required",ge.estimatedCost?` | RM ${ge.estimatedCost}`:""]})]}),a.jsxs("div",{className:"checklist-item-actions",children:[a.jsxs("button",{className:`btn btn-sm ${E[`damage_${Je}`]===!0?"btn-success":"btn-ghost"}`,onClick:()=>ee(`damage_${Je}`,!0),children:[a.jsx(St,{size:16})," ",u("inspection.repaired")||"Repaired"]}),a.jsxs("button",{className:`btn btn-sm ${E[`damage_${Je}`]===!1?"btn-danger":"btn-ghost"}`,onClick:()=>ee(`damage_${Je}`,!1),children:[a.jsx(Gr,{size:16})," ",u("inspection.notRepaired")||"Not Fixed"]})]})]},`damage_${Je}`))})]}),a.jsxs("div",{className:"inspection-section",style:{marginTop:J.length>0?"24px":0},children:[a.jsxs("h4",{className:"inspection-section-title",style:{color:"var(--primary-600)",borderBottom:"2px solid var(--primary-200)",paddingBottom:"8px",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:[a.jsx(hs,{size:18}),u("inspection.generalChecklist")||"General Inspection Checklist"]}),a.jsx("div",{className:"inspection-checklist",children:p.filter(ge=>!ge.category).map(ge=>a.jsxs("div",{className:`checklist-item ${U[ge.id]===!0?"passed":U[ge.id]===!1?"failed":""}`,children:[a.jsxs("div",{className:"checklist-item-info",children:[a.jsx("span",{className:"checklist-item-label",children:ge.label}),a.jsx("span",{className:"checklist-item-desc",children:ge.description})]}),a.jsxs("div",{className:"checklist-item-actions",children:[a.jsxs("button",{className:`btn btn-sm ${U[ge.id]===!0?"btn-success":"btn-ghost"}`,onClick:()=>ye(ge.id,!0),children:[a.jsx(St,{size:16})," ",u("inspection.pass")||"Pass"]}),a.jsxs("button",{className:`btn btn-sm ${U[ge.id]===!1?"btn-danger":"btn-ghost"}`,onClick:()=>ye(ge.id,!1),children:[a.jsx(Gr,{size:16})," ",u("inspection.fail")||"Fail"]})]})]},ge.id))})]}),p.filter(ge=>ge.category==="POST_REPAIR_CLEAN").length>0&&a.jsxs("div",{className:"inspection-section",style:{marginTop:"24px"},children:[a.jsxs("h4",{className:"inspection-section-title",style:{color:"var(--secondary-600)",borderBottom:"2px solid var(--secondary-200)",paddingBottom:"8px",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:[a.jsx(Zn,{size:18}),u("inspection.postRepairCleaning")||"Post-Repair Cleaning"]}),a.jsx("div",{className:"inspection-checklist",children:p.filter(ge=>ge.category==="POST_REPAIR_CLEAN").map(ge=>a.jsxs("div",{className:`checklist-item ${U[ge.id]===!0?"passed":U[ge.id]===!1?"failed":""}`,children:[a.jsxs("div",{className:"checklist-item-info",children:[a.jsx("span",{className:"checklist-item-label",children:ge.label}),a.jsx("span",{className:"checklist-item-desc",children:ge.description})]}),a.jsxs("div",{className:"checklist-item-actions",children:[a.jsxs("button",{className:`btn btn-sm ${U[ge.id]===!0?"btn-success":"btn-ghost"}`,onClick:()=>ye(ge.id,!0),children:[a.jsx(St,{size:16})," ",u("inspection.pass")||"Pass"]}),a.jsxs("button",{className:`btn btn-sm ${U[ge.id]===!1?"btn-danger":"btn-ghost"}`,onClick:()=>ye(ge.id,!1),children:[a.jsx(Gr,{size:16})," ",u("inspection.fail")||"Fail"]})]})]},ge.id))})]}),a.jsxs("div",{className:"form-group mt-4",children:[a.jsx("label",{className:"form-label",children:u("inspection.inspectorNotes")||"Inspector Notes"}),a.jsx("textarea",{className:"form-input",rows:3,value:Z,onChange:ge=>Y(ge.target.value),placeholder:u("inspection.notesPlaceholder")||"Add any observations or comments..."})]})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsxs("div",{className:"inspection-summary",children:[J.length>0&&a.jsxs("span",{className:"summary-damage",style:{marginRight:"12px",color:"var(--warning-600)"},children:[a.jsx(Dr,{size:14}),Object.values(E).filter(ge=>ge===!0).length,"/",J.length," ",u("inspection.repairsVerified")||"Repairs Verified"]}),a.jsxs("span",{className:"summary-passed",children:[a.jsx(St,{size:14}),Object.values(U).filter(ge=>ge===!0).length," ",u("inspection.passed")||"Passed"]}),a.jsxs("span",{className:"summary-failed",children:[a.jsx(Gr,{size:14}),Object.values(U).filter(ge=>ge===!1).length," ",u("inspection.failed")||"Failed"]}),a.jsxs("span",{className:"summary-pending",children:[Object.values(U).filter(ge=>ge===null).length+Object.values(E).filter(ge=>ge===null).length," ",u("inspection.remaining")||"Remaining"]})]}),a.jsx("button",{className:"btn btn-secondary",onClick:()=>W(!1),children:u("common.cancel")||"Cancel"}),a.jsxs("button",{className:"btn btn-primary",onClick:Pe,disabled:Object.values(U).some(ge=>ge===null)||J.length>0&&Object.values(E).some(ge=>ge===null),children:[a.jsx(hs,{size:16})," ",u("inspection.completeInspection")||"Complete Inspection"]})]})]})}),et&&a.jsx("div",{className:"modal-overlay",onClick:()=>dt(null),children:a.jsxs("div",{className:"modal",onClick:ge=>ge.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h3",{className:"modal-title",children:u("inspection.recordRework")||"Record Rework Required"}),a.jsx("button",{className:"btn btn-ghost btn-icon",onClick:()=>dt(null),children:""})]}),a.jsx("div",{className:"modal-body",children:a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label required",children:u("inspection.reworkDetails")||"Rework Details"}),a.jsx("textarea",{className:"form-input",rows:4,placeholder:u("inspection.describeIssues")||"Describe issues found and required rework...",value:jt,onChange:ge=>un(ge.target.value)})]})}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{className:"btn btn-secondary",onClick:()=>dt(null),children:u("common.cancel")||"Cancel"}),a.jsxs("button",{className:"btn btn-danger",onClick:()=>{Fe(et.id,"REWORK",jt),dt(null),un("")},children:[a.jsx(Dr,{size:16})," ",u("inspection.requireRework")||"Require Rework"]})]})]})})]})}function OW(){const{containers:e,surveys:t,updateContainer:n}=qt(),{user:r}=Ft(),{t:s}=Wt(),i=en(),[l]=hi(),u=l.get("workflow_filter"),[d,f]=T.useState(()=>{const ee=localStorage.getItem("mnr_stacking");return ee?JSON.parse(ee):[]}),[m,p]=T.useState(!1),[x,v]=T.useState(null),[k,y]=T.useState(""),[S,C]=T.useState(""),[D,N]=T.useState(""),[b,H]=T.useState(""),[L,R]=T.useState(""),[q,O]=T.useState(""),[V,X]=T.useState(!1),[M,me]=T.useState(null),[ae,ce]=T.useState(!1),[ue,K]=T.useState(""),[W,j]=T.useState(1),F=50,I=JSON.parse(localStorage.getItem("mnr_preinspections")||"[]").filter(ee=>ee.result==="ACCEPTED").map(ee=>ee.containerId),Z=d.map(ee=>ee.containerId),Y=e.filter(ee=>(ee.status==="COMPLETED"||ee.status==="AV")&&I.includes(ee.id)&&!Z.includes(ee.id)),P=d.filter(ee=>{if(u==="completed"&&ee.status!=="COMPLETED")return!1;const Pe=!b||ee.containerNumber.toLowerCase().includes(b.toLowerCase())||ee.id.toLowerCase().includes(b.toLowerCase()),Fe=!L||ee.status===L,et=!q||ee.liner===q;return Pe&&Fe&&et}),ne=Math.ceil(P.length/F),J=P.slice((W-1)*F,W*F),de=Ea.reduce((ee,Pe)=>(ee[Pe.code]=e.filter(Fe=>Fe.liner===Pe.code&&Fe.status==="AV").length,ee),{}),E=dc.filter(ee=>!ee.type||ee.type==="STORAGE").reduce((ee,Pe)=>(ee[Pe.code]=e.filter(Fe=>{var et;return((et=Fe.yardLocation)==null?void 0:et.block)===Pe.code&&Fe.status==="AV"}).length,ee),{}),A=ue?e.filter(ee=>ee.containerNumber.toLowerCase().includes(ue.toLowerCase())||ee.yardLocation&&`${ee.yardLocation.block}-${ee.yardLocation.row}-${ee.yardLocation.tier}`.includes(ue)).slice(0,10):[],he=ee=>{f(ee),localStorage.setItem("mnr_stacking",JSON.stringify(ee))},G=()=>{if(!x||!k){i.error("Please select container and target location");return}const ee=t.find(et=>et.containerId===x.id&&et.status==="COMPLETED"),Pe=(ee==null?void 0:ee.id)||x.lastSurveyId||null,Fe={id:`${x.containerNumber}-${new Date().toISOString().replace(/[-:TZ.]/g,"").slice(2,14)}`,containerId:x.id,containerNumber:x.containerNumber,surveyTransactionId:Pe,liner:x.liner,fromLocation:x.yardLocation,targetLocation:{block:k,row:parseInt(S)||1,tier:parseInt(D)||1},status:"NEW",createdBy:r.username,createdAt:new Date().toISOString()};he([Fe,...d]),i.success("Stacking request created!"),p(!1),fe()},Ie=ee=>{me(ee),X(!0)},oe=ee=>{const Pe={gatePassNumber:`GP-${Date.now().toString().slice(-8)}`,containerNumber:ee.containerNumber,liner:ee.liner,location:`${ee.targetLocation.block}-${ee.targetLocation.row}-${ee.targetLocation.tier}`,releasedAt:new Date().toISOString(),releasedBy:r.username,surveyTransactionId:ee.surveyTransactionId},Fe=d.map(et=>et.id===ee.id?{...et,status:"COMPLETED",completedAt:new Date().toISOString(),completedBy:r.username,gatePassNumber:Pe.gatePassNumber}:et);return he(Fe),n(ee.containerId,{status:"AV",yardLocation:ee.targetLocation,releasedAt:new Date().toISOString(),gatePassNumber:Pe.gatePassNumber},r.username),Pe},Te=()=>{if(!M)return;const ee=oe(M);i.success(`${M.containerNumber} released with Gate Pass: ${ee.gatePassNumber}`),X(!1),me(null)},xe=()=>{if(!M)return;const ee=Ea.find(Pe=>Pe.code===M.liner);oe(M),console.log(`Notifying ${(ee==null?void 0:ee.name)||M.liner} about container ${M.containerNumber}`),i.success(`Release notification sent to ${(ee==null?void 0:ee.name)||M.liner} for ${M.containerNumber}`),X(!1),me(null)},we=ee=>{const Pe=window.open("","_blank"),Fe=d.find(et=>et.gatePassNumber===ee);Pe&&Fe&&(Pe.document.write(`
                <html>
                <head><title>Gate Pass - ${ee}</title>
                <style>
                    body { font-family: Arial, sans-serif; padding: 40px; }
                    .header { text-align: center; border-bottom: 2px solid #000; padding-bottom: 20px; }
                    .details { margin-top: 30px; }
                    .row { display: flex; justify-content: space-between; margin: 10px 0; }
                    .label { font-weight: bold; }
                    .footer { margin-top: 50px; text-align: center; }
                </style>
                </head>
                <body>
                    <div class="header">
                        <h1>CONTAINER RELEASE GATE PASS</h1>
                        <h2>${ee}</h2>
                    </div>
                    <div class="details">
                        <div class="row"><span class="label">Container Number:</span><span>${Fe.containerNumber}</span></div>
                        <div class="row"><span class="label">Liner:</span><span>${Fe.liner}</span></div>
                        <div class="row"><span class="label">Location:</span><span>${Fe.targetLocation.block}-${Fe.targetLocation.row}-${Fe.targetLocation.tier}</span></div>
                        <div class="row"><span class="label">Released By:</span><span>${Fe.completedBy}</span></div>
                        <div class="row"><span class="label">Released At:</span><span>${new Date(Fe.completedAt).toLocaleString()}</span></div>
                    </div>
                    <div class="footer">
                        <p>___________________________</p>
                        <p>Authorized Signature</p>
                    </div>
                </body>
                </html>
            `),Pe.document.close(),Pe.print())},fe=()=>{v(null),y(""),C(""),N("")},ye=dc.filter(ee=>!ee.type||ee.type==="STORAGE");return a.jsxs("div",{className:"page",children:[a.jsxs("div",{className:"page-sticky-header",children:[a.jsxs("div",{className:"page-header",children:[a.jsxs("div",{children:[a.jsx("h2",{children:s("stacking.title")}),a.jsx("p",{className:"text-muted",children:s("stacking.readyToStack")})]}),a.jsxs("div",{className:"header-actions",children:[a.jsx(_s,{screenId:"stacking"}),a.jsxs("button",{className:"btn btn-secondary",onClick:()=>ce(!ae),children:[a.jsx(Gm,{size:16})," ",s("stacking.stockReport")||"Stock Report"]}),a.jsxs("button",{className:"btn btn-primary",onClick:()=>p(!0),children:[a.jsx(Xr,{size:16})," ",s("stacking.newRequest")]})]})]}),a.jsx("div",{className:"card mb-3",children:a.jsxs("div",{className:"location-search",children:[a.jsxs("div",{className:"search-box",style:{flex:1},children:[a.jsx(Ho,{size:18}),a.jsx("input",{type:"text",className:"form-input",placeholder:s("stacking.searchLocation")||"Search container by number or location (e.g., A-1-1)...",value:ue,onChange:ee=>K(ee.target.value)})]}),A.length>0&&a.jsx("div",{className:"location-results",children:A.map(ee=>a.jsxs("div",{className:"location-result-item",children:[a.jsx("span",{className:"container-number",children:ee.containerNumber}),a.jsxs("span",{className:"location-badge",children:[a.jsx(Ho,{size:12}),ee.yardLocation?`${ee.yardLocation.block}-${ee.yardLocation.row}-${ee.yardLocation.tier}`:s("stacking.noLocation")||"No location"]}),a.jsx("span",{className:`badge badge-${ee.status.toLowerCase()}`,children:ee.status}),a.jsx("span",{className:"text-muted",children:ee.liner})]},ee.id))})]})}),a.jsxs("div",{className:"grid grid-cols-4",children:[a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-card-value",children:Y.length}),a.jsx("div",{className:"stat-card-label",children:s("stacking.readyToStackLabel")||"Ready to Stack"})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-card-value",style:{color:"var(--warning-500)"},children:d.filter(ee=>ee.status==="NEW").length}),a.jsx("div",{className:"stat-card-label",children:s("common.pending")||"Pending"})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-card-value",style:{color:"var(--primary-500)"},children:d.filter(ee=>ee.status==="IN_PROGRESS").length}),a.jsx("div",{className:"stat-card-label",children:s("common.inProgress")||"In Progress"})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-card-value",style:{color:"var(--success-500)"},children:d.filter(ee=>ee.status==="COMPLETED").length}),a.jsx("div",{className:"stat-card-label",children:s("stacking.released")||"Released"})]})]})]}),Y.length>0&&a.jsxs("div",{className:"card mb-4",children:[a.jsxs("h3",{className:"card-title",style:{marginBottom:"var(--space-3)"},children:[a.jsx(St,{size:18,style:{color:"var(--success-500)"}})," ",s("stacking.readyForStacking")||"Ready for Stacking"]}),a.jsxs("div",{className:"grid grid-cols-4",children:[Y.slice(0,8).map(ee=>a.jsxs("div",{className:"ready-container-card",children:[a.jsx("span",{className:"container-number",children:ee.containerNumber}),a.jsx("span",{className:"text-sm text-muted",children:ee.liner}),a.jsxs("button",{className:"btn btn-success btn-sm mt-2",onClick:()=>{v(ee),p(!0)},children:[a.jsx(Kr,{size:14})," ",s("stacking.stackNow")||"Stack Now"]})]},ee.id)),Y.length>8&&a.jsxs("div",{className:"ready-container-card more-card",children:[a.jsxs("span",{className:"more-count",children:["+",Y.length-8]}),a.jsx("span",{className:"text-muted",children:s("common.more")||"more"})]})]})]}),a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"card-header",children:[a.jsx("h3",{className:"card-title",children:s("stacking.stackingRequests")||"Stacking Requests"}),a.jsxs("div",{className:"filters",children:[a.jsxs("div",{className:"search-box",children:[a.jsx(bn,{size:18}),a.jsx("input",{type:"text",className:"form-input",placeholder:s("common.search")+"...",value:b,onChange:ee=>{H(ee.target.value),j(1)}})]}),a.jsxs("select",{className:"form-input",style:{width:140},value:L,onChange:ee=>{R(ee.target.value),j(1)},children:[a.jsx("option",{value:"",children:s("common.allStatuses")||"All Statuses"}),a.jsx("option",{value:"NEW",children:s("stacking.new")||"New"}),a.jsx("option",{value:"IN_PROGRESS",children:s("common.inProgress")||"In Progress"}),a.jsx("option",{value:"COMPLETED",children:s("stacking.released")||"Released"})]}),a.jsxs("select",{className:"form-input",style:{width:130},value:q,onChange:ee=>{O(ee.target.value),j(1)},children:[a.jsx("option",{value:"",children:s("common.allLiners")||"All Liners"}),Ea.map(ee=>a.jsx("option",{value:ee.code,children:ee.code},ee.code))]})]})]}),P.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx(Kr,{size:48}),a.jsx("h3",{children:s("stacking.noStackingRequests")||"No stacking requests"}),a.jsx("p",{children:s("stacking.createRequests")||"Create requests to stack accepted containers"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"table-container",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:s("columns.transactionId")}),a.jsx("th",{children:s("columns.containerNumber")}),a.jsx("th",{children:s("columns.liner")}),a.jsx("th",{children:s("columns.source")}),a.jsx("th",{children:s("columns.targetLocation")}),a.jsx("th",{children:s("columns.stackingStatus")}),a.jsx("th",{children:s("columns.gatePass")||"Gate Pass"}),a.jsx("th",{children:s("columns.actions")})]})}),a.jsx("tbody",{children:J.map(ee=>a.jsxs("tr",{children:[a.jsx("td",{style:{fontWeight:500},children:ee.surveyTransactionId||ee.id}),a.jsx("td",{children:a.jsx("span",{className:"container-number",children:ee.containerNumber})}),a.jsx("td",{children:ee.liner}),a.jsx("td",{children:ee.fromLocation?`${ee.fromLocation.block}-${ee.fromLocation.row}-${ee.fromLocation.tier}`:s("stacking.repairBay")||"Repair Bay"}),a.jsx("td",{children:a.jsxs("span",{className:"location-badge",children:[a.jsx(Ho,{size:12}),ee.targetLocation.block,"-",ee.targetLocation.row,"-",ee.targetLocation.tier]})}),a.jsx("td",{children:a.jsx("span",{className:`badge badge-${ee.status==="COMPLETED"?"av":ee.status.toLowerCase().replace("_","-")}`,children:ee.status==="COMPLETED"?s("stacking.released")||"Released":ee.status.replace("_"," ")})}),a.jsx("td",{children:ee.gatePassNumber?a.jsxs("button",{className:"btn btn-ghost btn-sm",onClick:()=>we(ee.gatePassNumber),children:[a.jsx(d_,{size:14})," ",ee.gatePassNumber]}):"-"}),a.jsx("td",{children:ee.status!=="COMPLETED"&&a.jsxs("button",{className:"btn btn-success btn-sm",onClick:()=>Ie(ee),children:[a.jsx(St,{size:14})," ",s("stacking.completeRelease")||"Complete & Release"]})})]},ee.id))})]})}),ne>1&&a.jsxs("div",{className:"pagination",children:[a.jsxs("button",{className:"btn btn-ghost btn-sm",onClick:()=>j(ee=>Math.max(1,ee-1)),disabled:W===1,children:[a.jsx(ao,{size:16})," ",s("common.previous")||"Previous"]}),a.jsxs("span",{className:"pagination-info",children:[s("common.page")||"Page"," ",W," ",s("common.of")||"of"," ",ne]}),a.jsxs("button",{className:"btn btn-ghost btn-sm",onClick:()=>j(ee=>Math.min(ne,ee+1)),disabled:W===ne,children:[s("common.next")||"Next"," ",a.jsx(Gn,{size:16})]})]})]})]}),m&&a.jsx("div",{className:"modal-overlay",onClick:()=>{p(!1),fe()},children:a.jsxs("div",{className:"modal",onClick:ee=>ee.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h3",{className:"modal-title",children:s("stacking.newStackingRequest")||"New Stacking Request"}),a.jsx("button",{className:"btn btn-ghost btn-icon",onClick:()=>{p(!1),fe()},children:""})]}),a.jsxs("div",{className:"modal-body",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label required",children:s("common.container")||"Container"}),a.jsxs("select",{className:"form-input",value:(x==null?void 0:x.id)||"",onChange:ee=>v(e.find(Pe=>Pe.id===ee.target.value)),children:[a.jsx("option",{value:"",children:s("stacking.selectContainer")||"Select container..."}),Y.map(ee=>a.jsxs("option",{value:ee.id,children:[ee.containerNumber," - ",ee.liner]},ee.id))]})]}),a.jsxs("div",{className:"grid grid-cols-3",style:{gap:"var(--space-3)"},children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label required",children:s("stacking.block")||"Block"}),a.jsxs("select",{className:"form-input",value:k,onChange:ee=>y(ee.target.value),children:[a.jsx("option",{value:"",children:s("common.select")||"Select..."}),ye.map(ee=>a.jsx("option",{value:ee.code,children:ee.code},ee.code))]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:s("stacking.row")||"Row"}),a.jsx("input",{type:"number",className:"form-input",min:"1",max:"20",value:S,onChange:ee=>C(ee.target.value),placeholder:"1-20"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:s("stacking.tier")||"Tier"}),a.jsx("input",{type:"number",className:"form-input",min:"1",max:"5",value:D,onChange:ee=>N(ee.target.value),placeholder:"1-5"})]})]})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{className:"btn btn-secondary",onClick:()=>{p(!1),fe()},children:s("common.cancel")||"Cancel"}),a.jsxs("button",{className:"btn btn-primary",onClick:G,children:[a.jsx(Kr,{size:16})," ",s("stacking.createRequest")||"Create Request"]})]})]})}),V&&M&&a.jsx("div",{className:"modal-overlay",onClick:()=>X(!1),children:a.jsxs("div",{className:"modal",onClick:ee=>ee.stopPropagation(),children:[a.jsx("div",{className:"modal-header",children:a.jsx("h3",{className:"modal-title",children:s("stacking.releaseContainer")||"Release Container"})}),a.jsxs("div",{className:"modal-body",children:[a.jsxs("div",{className:"release-info",children:[a.jsx("div",{className:"release-container-number",children:M.containerNumber}),a.jsxs("div",{className:"release-details",children:[a.jsxs("span",{children:[a.jsxs("strong",{children:[s("columns.liner")||"Liner",":"]})," ",M.liner]}),a.jsxs("span",{children:[a.jsxs("strong",{children:[s("columns.location")||"Location",":"]}),M.targetLocation.block,"-",M.targetLocation.row,"-",M.targetLocation.tier]})]})]}),a.jsx("p",{className:"text-muted mt-4",children:s("stacking.releaseOptions")||"Choose how you want to release this container:"})]}),a.jsxs("div",{className:"modal-footer release-footer",children:[a.jsx("button",{className:"btn btn-ghost",onClick:()=>X(!1),children:s("common.cancel")||"Cancel"}),a.jsxs("button",{className:"btn btn-secondary",onClick:Te,children:[a.jsx(wn,{size:16})," ",s("stacking.generateGatePass")||"Generate Gate Pass"]}),a.jsxs("button",{className:"btn btn-primary",onClick:xe,children:[a.jsx($h,{size:16})," ",s("stacking.notifyAndRelease")||"Notify Liner & Release"]})]})]})}),ae&&a.jsx("div",{className:"modal-overlay",onClick:()=>ce(!1),children:a.jsxs("div",{className:"modal modal-lg",onClick:ee=>ee.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsxs("h3",{className:"modal-title",children:[a.jsx(Gm,{size:20})," ",s("stacking.stockReport")||"Stock Report"]}),a.jsx("button",{className:"btn btn-ghost btn-icon",onClick:()=>ce(!1),children:""})]}),a.jsxs("div",{className:"modal-body",children:[a.jsxs("div",{className:"stock-section",children:[a.jsx("h4",{className:"stock-section-title",children:s("stacking.stockByLiner")||"Available Stock by Liner"}),a.jsx("div",{className:"stock-grid",children:Ea.map(ee=>a.jsxs("div",{className:"stock-item",children:[a.jsx("div",{className:"stock-item-label",children:ee.code}),a.jsx("div",{className:"stock-item-value",style:{color:de[ee.code]>0?"var(--success-500)":"var(--gray-400)"},children:de[ee.code]||0}),a.jsx("div",{className:"stock-item-sublabel",children:s("common.containers")||"containers"})]},ee.code))})]}),a.jsxs("div",{className:"stock-section mt-4",children:[a.jsx("h4",{className:"stock-section-title",children:s("stacking.stockByBlock")||"Available Stock by Yard Block"}),a.jsx("div",{className:"stock-grid",children:dc.filter(ee=>!ee.type||ee.type==="STORAGE").map(ee=>a.jsxs("div",{className:"stock-item",children:[a.jsxs("div",{className:"stock-item-label",children:[a.jsx(Ho,{size:12})," ",ee.code]}),a.jsx("div",{className:"stock-item-value",style:{color:E[ee.code]>0?"var(--primary-500)":"var(--gray-400)"},children:E[ee.code]||0}),a.jsx("div",{className:"stock-item-sublabel",children:ee.name})]},ee.code))})]}),a.jsx("div",{className:"stock-summary mt-4",children:a.jsxs("div",{className:"stock-summary-item",children:[a.jsx("span",{className:"stock-summary-label",children:s("stacking.totalAvailable")||"Total Available"}),a.jsx("span",{className:"stock-summary-value",children:e.filter(ee=>ee.status==="AV").length})]})})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsxs("button",{className:"btn btn-secondary",onClick:()=>{const ee=["Type,Code,Count",...Ea.map(dt=>`Liner,${dt.code},${de[dt.code]||0}`),...dc.filter(dt=>!dt.type||dt.type==="STORAGE").map(dt=>`Block,${dt.code},${E[dt.code]||0}`)].join(`
`),Pe=new Blob([ee],{type:"text/csv"}),Fe=URL.createObjectURL(Pe),et=document.createElement("a");et.href=Fe,et.download=`stock-report-${new Date().toISOString().split("T")[0]}.csv`,et.click(),URL.revokeObjectURL(Fe),i.success(s("stacking.reportExported")||"Stock report exported")},children:[a.jsx(cu,{size:16})," ",s("common.exportCSV")||"Export CSV"]}),a.jsx("button",{className:"btn btn-primary",onClick:()=>ce(!1),children:s("common.close")||"Close"})]})]})})]})}const LW=[{key:"LINERS",label:"Liners / Shipping Lines",category:"CONTAINER"},{key:"CONTAINER_SIZES",label:"Container Sizes",category:"CONTAINER"},{key:"CONTAINER_TYPES",label:"Container Types",category:"CONTAINER"},{key:"CONTAINER_STATUSES",label:"Container Statuses",category:"CONTAINER"},{key:"INITIAL_CONDITIONS",label:"Initial Conditions",category:"SURVEY"},{key:"SURVEY_TYPES",label:"Survey Types",category:"SURVEY"},{key:"DAMAGE_LOCATIONS",label:"Damage Locations",category:"REPAIR"},{key:"DAMAGE_TYPES",label:"Damage Types",category:"REPAIR"},{key:"COMPONENTS",label:"Container Components",category:"REPAIR"},{key:"REPAIR_METHODS",label:"Repair Methods",category:"REPAIR"},{key:"SEVERITY_LEVELS",label:"Severity Levels",category:"REPAIR"},{key:"INSPECTION_CHECKLIST",label:"Inspection Checklist",category:"REPAIR"},{key:"WASH_BAYS",label:"Washing Bays",category:"WASHING"},{key:"CLEANING_PROGRAMS",label:"Cleaning Programs",category:"WASHING"},{key:"WASHING_TEAMS",label:"Washing Teams",category:"WASHING"},{key:"CONTAMINATION_LEVELS",label:"Contamination Levels",category:"WASHING"},{key:"INTERIOR_CONDITIONS",label:"Interior Conditions",category:"WASHING"},{key:"EXTERIOR_CONDITIONS",label:"Exterior Conditions",category:"WASHING"},{key:"QC_CHECKLIST",label:"QC Checklist Items",category:"WASHING"},{key:"DRIVERS",label:"Shunting Drivers",category:"OPERATIONS"}];function FW(){const{codes:e,updateCodeList:t,addCode:n,updateCode:r,deleteCode:s}=On(),{t:i}=Wt(),l=en();T.useRef(null);const[u,d]=T.useState("LINERS"),[f,m]=T.useState(""),[p,x]=T.useState(null),[v,k]=T.useState(!1),[y,S]=T.useState({code:"",name:"",active:!0}),[C,D]=T.useState(!1),[N,b]=T.useState(!1),[H,L]=T.useState(""),R=e[u]||[],q=R.filter(j=>{const F=j.code.toLowerCase().includes(f.toLowerCase())||j.name.toLowerCase().includes(f.toLowerCase()),U=C||j.active!==!1;return F&&U}),O={total:R.length,active:R.filter(j=>j.active!==!1).length,inactive:R.filter(j=>j.active===!1).length},V=()=>{if(!y.code||!y.name){l.error(i("admin.codeNameRequired")||"Code and Name are required");return}if(R.some(j=>j.code===y.code)){l.error(i("admin.codeExists")||"Code already exists");return}n(u,y),S({code:"",name:"",active:!0}),k(!1),l.success(i("admin.codeAdded")||"Code added successfully")},X=(j,F,U)=>{r(u,j,{[F]:U}),l.success(i("admin.codeUpdated")||"Code updated")},M=(j,F)=>{r(u,j,{active:!F}),l.info(`Code ${F?i("admin.deactivated")||"deactivated":i("admin.activated")||"activated"}`)},me=j=>{confirm(i("admin.confirmDeactivate")||"Deactivate this code?")&&(s(u,j),l.success(i("admin.codeDeactivated")||"Code deactivated"))},ae=()=>{const j={type:u,codes:R,exportedAt:new Date().toISOString()},F=new Blob([JSON.stringify(j,null,2)],{type:"application/json"}),U=URL.createObjectURL(F),I=document.createElement("a");I.href=U,I.download=`${u.toLowerCase()}_codes.json`,I.click(),URL.revokeObjectURL(U),l.success(i("admin.exportSuccess")||"Codes exported successfully")},ce=()=>{try{const j=JSON.parse(H);if(!j.codes||!Array.isArray(j.codes)){l.error(i("admin.invalidFormat")||"Invalid import format");return}let F=0,U=0;j.codes.forEach(I=>{I.code&&I.name&&(R.some(Z=>Z.code===I.code)?U++:(n(u,{...I,active:!0}),F++))}),l.success(`${i("admin.imported")||"Imported"}: ${F}, ${i("admin.skipped")||"Skipped"}: ${U}`),b(!1),L("")}catch{l.error(i("admin.invalidJSON")||"Invalid JSON format")}},ue=j=>{navigator.clipboard.writeText(j),l.info(i("admin.copied")||"Code copied to clipboard")},W=(()=>{switch(u){case"LINERS":return["email","address"];case"REPAIR_METHODS":return["unitPrice"];case"SEVERITY_LEVELS":return["multiplier"];case"CONTAINER_STATUSES":return["color"];case"INSPECTION_CHECKLIST":return["label","description"];case"WASH_BAYS":return["capacity","specialType"];case"CLEANING_PROGRAMS":return["duration","defaultCost"];case"WASHING_TEAMS":return["members"];case"CONTAMINATION_LEVELS":return["suggestedProgram","safetyAlert"];case"INTERIOR_CONDITIONS":case"EXTERIOR_CONDITIONS":return["description"];case"QC_CHECKLIST":return["description","required"];case"DRIVERS":return["phone"];default:return[]}})();return a.jsxs("div",{className:"admin-page-layout",children:[a.jsx("div",{className:"admin-page-header",children:a.jsxs("div",{className:"page-header",children:[a.jsxs("div",{children:[a.jsxs("h2",{children:[a.jsx(Zp,{size:24})," ",i("nav.masterCodes")||"Master Codes Configuration"]}),a.jsx("p",{className:"text-muted",children:i("admin.masterCodesDesc")||"Manage dropdown values and system codes"})]}),a.jsxs("div",{className:"header-actions",children:[a.jsxs("button",{className:"btn btn-ghost",onClick:ae,children:[a.jsx(cu,{size:16})," ",i("common.export")||"Export"]}),a.jsxs("button",{className:"btn btn-ghost",onClick:()=>b(!0),children:[a.jsx(vh,{size:16})," ",i("common.import")||"Import"]})]})]})}),a.jsxs("div",{className:"admin-layout",children:[a.jsxs("div",{className:"admin-sidebar",children:[a.jsx("h4",{children:i("admin.codeTypes")||"Code Types"}),a.jsx("ul",{className:"code-type-list",children:LW.map(j=>a.jsxs("li",{className:u===j.key?"active":"",onClick:()=>{d(j.key),m(""),k(!1)},children:[u===j.key?a.jsx(Gn,{size:16}):a.jsx(Yi,{size:16}),j.label,a.jsx("span",{className:"code-count",children:(e[j.key]||[]).filter(F=>F.active!==!1).length})]},j.key))})]}),a.jsxs("div",{className:"admin-content",children:[a.jsxs("div",{className:"code-stats-bar mb-4",children:[a.jsxs("div",{className:"code-stat",children:[a.jsx("span",{className:"code-stat-value",children:O.total}),a.jsx("span",{className:"code-stat-label",children:i("admin.totalCodes")||"Total"})]}),a.jsxs("div",{className:"code-stat active",children:[a.jsx("span",{className:"code-stat-value",children:O.active}),a.jsx("span",{className:"code-stat-label",children:i("common.active")||"Active"})]}),a.jsxs("div",{className:"code-stat inactive",children:[a.jsx("span",{className:"code-stat-value",children:O.inactive}),a.jsx("span",{className:"code-stat-label",children:i("common.inactive")||"Inactive"})]})]}),a.jsxs("div",{className:"admin-toolbar",children:[a.jsxs("div",{className:"search-box",children:[a.jsx(bn,{size:18}),a.jsx("input",{type:"text",placeholder:i("admin.searchCodes")||"Search codes...",value:f,onChange:j=>m(j.target.value)})]}),a.jsxs("label",{className:"checkbox-label",children:[a.jsx("input",{type:"checkbox",checked:C,onChange:j=>D(j.target.checked)}),i("admin.showInactive")||"Show Inactive"]}),a.jsxs("button",{className:"btn btn-primary",onClick:()=>k(!0),children:[a.jsx(Xr,{size:16})," ",i("admin.addCode")||"Add Code"]})]}),a.jsx("div",{className:"card",children:a.jsx("div",{className:"table-container",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:i("admin.code")||"Code"}),a.jsx("th",{children:i("admin.name")||"Name"}),W.map(j=>a.jsx("th",{children:j.charAt(0).toUpperCase()+j.slice(1)},j)),a.jsx("th",{children:i("common.active")||"Active"}),a.jsx("th",{style:{width:120},children:i("columns.actions")||"Actions"})]})}),a.jsxs("tbody",{children:[v&&a.jsxs("tr",{className:"editing-row",children:[a.jsx("td",{children:a.jsx("input",{type:"text",className:"form-input",value:y.code,onChange:j=>S(F=>({...F,code:j.target.value.toUpperCase()})),placeholder:i("admin.code")||"Code",autoFocus:!0})}),a.jsx("td",{children:a.jsx("input",{type:"text",className:"form-input",value:y.name,onChange:j=>S(F=>({...F,name:j.target.value})),placeholder:i("admin.name")||"Name"})}),W.map(j=>a.jsx("td",{children:a.jsx("input",{type:j==="color"?"color":j==="unitPrice"||j==="multiplier"?"number":"text",className:"form-input",value:y[j]||"",onChange:F=>S(U=>({...U,[j]:F.target.value}))})},j)),a.jsx("td",{children:"-"}),a.jsx("td",{children:a.jsxs("div",{className:"action-buttons",children:[a.jsx("button",{className:"btn-icon btn-success",onClick:V,title:i("common.save")||"Save",children:a.jsx(Oa,{size:16})}),a.jsx("button",{className:"btn-icon btn-secondary",onClick:()=>k(!1),title:i("common.cancel")||"Cancel",children:a.jsx(Pn,{size:16})})]})})]}),q.map(j=>a.jsxs("tr",{className:j.active===!1?"inactive-row":"",children:[a.jsx("td",{children:a.jsxs("div",{className:"code-cell",children:[a.jsx("code",{className:"code-badge",children:j.code}),a.jsx("button",{className:"btn-icon-mini",onClick:()=>ue(j.code),title:i("admin.copyCode")||"Copy code",children:a.jsx(i_,{size:12})})]})}),a.jsx("td",{children:p===j.code?a.jsx("input",{type:"text",className:"form-input",defaultValue:j.name,onBlur:F=>{X(j.code,"name",F.target.value),x(null)},onKeyDown:F=>{F.key==="Enter"&&(X(j.code,"name",F.target.value),x(null)),F.key==="Escape"&&x(null)},autoFocus:!0}):j.name}),W.map(F=>a.jsx("td",{children:F==="color"?a.jsx("input",{type:"color",value:j[F]||"#000000",onChange:U=>X(j.code,F,U.target.value),style:{width:40,height:30,padding:0,border:"none"}}):F==="unitPrice"?a.jsxs("span",{children:["RM ",j[F]||0]}):j[F]||"-"},F)),a.jsx("td",{children:a.jsx("button",{className:`btn-icon ${j.active!==!1?"text-success":"text-muted"}`,onClick:()=>M(j.code,j.active!==!1),children:j.active!==!1?a.jsx(f_,{size:20}):a.jsx(h_,{size:20})})}),a.jsx("td",{children:a.jsxs("div",{className:"action-buttons",children:[a.jsx("button",{className:"btn-icon",onClick:()=>x(j.code),title:i("common.edit")||"Edit",children:a.jsx(Vm,{size:16})}),j.active!==!1&&a.jsx("button",{className:"btn-icon text-error",onClick:()=>me(j.code),title:i("admin.deactivate")||"Deactivate",children:a.jsx(La,{size:16})})]})})]},j.code)),q.length===0&&!v&&a.jsx("tr",{children:a.jsx("td",{colSpan:4+W.length,className:"text-center text-muted",children:i("admin.noCodesFound")||"No codes found"})})]})]})})})]}),N&&a.jsx("div",{className:"modal-overlay",onClick:()=>b(!1),children:a.jsxs("div",{className:"modal",onClick:j=>j.stopPropagation(),children:[a.jsx("div",{className:"modal-header",children:a.jsxs("h3",{className:"modal-title",children:[a.jsx(vh,{size:20})," ",i("admin.importCodes")||"Import Codes"]})}),a.jsxs("div",{className:"modal-body",children:[a.jsx("p",{className:"mb-3",children:i("admin.importInstructions")||"Paste JSON data to import codes. Existing codes will be skipped."}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:i("admin.jsonData")||"JSON Data"}),a.jsx("textarea",{className:"form-input",rows:10,value:H,onChange:j=>L(j.target.value),placeholder:'{ "codes": [{ "code": "ABC", "name": "Example" }] }'})]})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{className:"btn btn-ghost",onClick:()=>b(!1),children:i("common.cancel")||"Cancel"}),a.jsxs("button",{className:"btn btn-primary",onClick:ce,children:[a.jsx(St,{size:16})," ",i("common.import")||"Import"]})]})]})})]})]})}const MW=({screen:e,selectedGroup:t,setSelectedGroup:n,toggleScreenPermission:r,PERMISSION_TEMPLATES:s,PERMISSION_TYPES:i})=>{var v;const l=((v=t.screenPermissions)==null?void 0:v[e.id])||{},[u,d]=T.useState(!1);let f="custom";const p=Object.keys(l).filter(k=>l[k]).length;if(p===0)f="none";else{const k=y=>{const S=s.find(D=>D.id===y);if(!S)return!1;const C=S.perms;return C.length!==p?!1:C.every(D=>l[D])};k("readonly")?f="readonly":k("standard")?f="standard":k("full")?f="full":k("admin")&&(f="admin")}const x=k=>{if(k==="custom"){d(!0);return}let y={};if(k!=="none"){const S=s.find(C=>C.id===k);S&&S.perms.forEach(C=>y[C]=!0)}n(S=>{const C={...S.screenPermissions};return C[e.id]={},Object.assign(C[e.id],y),{...S,screenPermissions:C}})};return a.jsxs("div",{className:`permission-item ${u?"expanded":""}`,children:[a.jsxs("div",{className:"permission-row",children:[a.jsxs("div",{className:"perm-info",children:[a.jsx("span",{className:"perm-name",children:e.name}),a.jsx("span",{className:"perm-id",children:e.id})]}),a.jsxs("div",{className:"perm-controls",children:[a.jsxs("select",{className:"perm-select",value:f,onChange:k=>x(k.target.value),disabled:t.id==="admin",children:[a.jsx("option",{value:"none",children:"No Access"}),a.jsx("option",{value:"readonly",children:"Viewer"}),a.jsx("option",{value:"standard",children:"Operator"}),a.jsx("option",{value:"full",children:"Manager"}),a.jsx("option",{value:"custom",children:"Custom..."})]}),a.jsx("button",{className:`btn-expand ${u?"active":""}`,onClick:()=>d(!u),title:"Customize",children:a.jsx(Gn,{size:16,className:`transform transition-transform ${u?"rotate-90":""}`})})]})]}),u&&a.jsx("div",{className:"granular-permissions",children:i.map(k=>a.jsxs("label",{className:"granular-checkbox",children:[a.jsx("input",{type:"checkbox",checked:l[k.key]||!1,onChange:()=>r(e.id,k.key),disabled:t.id==="admin"}),a.jsx("span",{children:k.label})]},k.key))})]})},Uo=[{key:"use",label:"Use"},{key:"retrieve",label:"Retrieve"},{key:"clear",label:"Clear"},{key:"create",label:"Create"},{key:"save",label:"Save"},{key:"delete",label:"Delete"},{key:"approve",label:"Approve"},{key:"reject",label:"Reject"},{key:"download",label:"Download"},{key:"preview",label:"Preview"},{key:"print",label:"Print"},{key:"history",label:"History"}],vm=[{id:"readonly",name:"Read Only",desc:"View and retrieve only",perms:["use","retrieve","preview"]},{id:"standard",name:"Standard User",desc:"Basic CRUD operations",perms:["use","retrieve","create","save","preview"]},{id:"full",name:"Full Access",desc:"All permissions except delete",perms:["use","retrieve","clear","create","save","download","preview","print","history"]},{id:"admin",name:"Administrator",desc:"All permissions",perms:["use","retrieve","clear","create","save","delete","download","preview","print","history"]}];function BW(){var j;const{screens:e,groups:t,createGroup:n,updateGroup:r,deleteGroup:s}=On(),{t:i}=Wt(),l=en(),[u,d]=T.useState(""),[f,m]=T.useState(null),[p,x]=T.useState(!1),[v,k]=T.useState("screens"),[y,S]=T.useState(null),[C,D]=T.useState("matrix"),[N,b]=T.useState({name:"",code:"",description:"",level:1,usage:!0,grant:!0,screens:[],screenPermissions:{},functions:[]}),[H,L]=T.useState(!0),R=[{id:"screens",label:i("admin.screens")||"Screens",icon:F3},{id:"overview",label:i("admin.overview")||"Overview",icon:Gm},{id:"functions",label:i("admin.functions")||"Functions",icon:iO},{id:"settings",label:i("common.settings")||"Settings",icon:null}],q=t.filter(F=>F.name.toLowerCase().includes(u.toLowerCase())||(F.description||"").toLowerCase().includes(u.toLowerCase())),O={core:{label:"Core",screens:e.filter(F=>F.group==="core")},container:{label:"Container",screens:e.filter(F=>F.group==="container")},survey:{label:"Survey",screens:e.filter(F=>F.group==="survey")},eor:{label:"EOR",screens:e.filter(F=>F.group==="eor")},repair:{label:"Repair",screens:e.filter(F=>F.group==="repair")},operations:{label:"Operations",screens:e.filter(F=>F.group==="operations")},admin:{label:"Admin",screens:e.filter(F=>F.group==="admin")}},V=T.useMemo(()=>{if(!(f!=null&&f.screenPermissions))return null;const F=f.screenPermissions,U={};let I=0,Z=e.length*Uo.length;Object.entries(F).forEach(([P,ne])=>{const J=Object.values(ne).filter(Boolean).length;U[P]=J,I+=J});const Y={};return Uo.forEach(P=>{Y[P.key]=Object.values(F).filter(ne=>ne[P.key]).length}),{totalScreens:e.length,activeScreens:Object.keys(F).filter(P=>{var ne;return(ne=F[P])==null?void 0:ne.use}).length,totalEnabled:I,totalPossible:Z,percentage:Math.round(I/Z*100),screenCounts:U,permTypeCounts:Y}},[f==null?void 0:f.screenPermissions,e]),X=F=>{F.screenPermissions||(F.screenPermissions={},F.screens.forEach(U=>{var I,Z,Y,P;F.screenPermissions[U]={use:!0,retrieve:!0,create:((I=F.functions)==null?void 0:I.includes("create"))||!1,save:((Z=F.functions)==null?void 0:Z.includes("update"))||!1,delete:((Y=F.functions)==null?void 0:Y.includes("delete"))||!1,download:((P=F.functions)==null?void 0:P.includes("export"))||!1,preview:!0,print:!0,history:!0,clear:!0}})),m({...F}),k("screens"),window.innerWidth<768&&L(!1)},M=()=>{if(!N.name){l.error(i("admin.nameRequired")||"Group name is required");return}if(!N.code){l.error(i("admin.codeRequired")||"Group code is required");return}const F=n({...N,id:N.code.toLowerCase().replace(/\s+/g,"_")});b({name:"",code:"",description:"",level:1,usage:!0,grant:!0,screens:[],screenPermissions:{},functions:[]}),x(!1),l.success(i("admin.groupCreated")||"Group created successfully"),X(F)},me=()=>{f&&(r(f.id,{...f,screens:Object.keys(f.screenPermissions||{}).filter(F=>{var U;return(U=f.screenPermissions[F])==null?void 0:U.use})}),l.success(i("admin.groupSaved")||"Group saved successfully"))},ae=(F,U)=>{!f||f.id==="admin"||m(I=>{const Z={...I.screenPermissions};return Z[F]||(Z[F]={}),Z[F]={...Z[F],[U]:!Z[F][U]},U==="use"&&!Z[F].use&&Uo.forEach(Y=>{Z[F][Y.key]=!1}),U!=="use"&&Z[F][U]&&(Z[F].use=!0),{...I,screenPermissions:Z}})},ce=F=>{!f||f.id==="admin"||(m(U=>{const I={};return e.forEach(Z=>{I[Z.id]={},Uo.forEach(Y=>{I[Z.id][Y.key]=F.perms.includes(Y.key)})}),{...U,screenPermissions:I}}),l.info(`Applied "${F.name}" template to all screens`))},ue=F=>{const U=`${F.name} (Copy)`,I=`${F.code||F.id}_COPY`,Z=n({...F,id:I.toLowerCase().replace(/\s+/g,"_"),name:U,code:I});l.success(i("admin.groupDuplicated")||"Group duplicated"),X(Z)},K=F=>{if(["admin","viewer"].includes(F)){l.error(i("admin.cannotDeleteCore")||"Cannot delete core groups");return}S(F)},W=()=>{y&&(s(y),(f==null?void 0:f.id)===y&&m(null),l.success(i("admin.groupDeleted")||"Group deleted successfully"),S(null))};return a.jsxs("div",{className:"page",children:[a.jsxs("div",{className:"page-header",children:[a.jsxs("div",{children:[a.jsxs("h2",{children:[a.jsx(Bc,{size:24})," ",i("nav.permissionGroups")]}),a.jsx("p",{className:"text-muted",children:i("admin.permissionGroupsDesc")||"Configure granular permissions for each group"})]}),a.jsx("div",{className:"header-stats",children:a.jsxs("div",{className:"header-stat",children:[a.jsx("span",{className:"header-stat-value",children:t.length}),a.jsx("span",{className:"header-stat-label",children:i("admin.groups")||"Groups"})]})})]}),a.jsxs("div",{className:`master-detail-layout ${H?"":"expanded"}`,children:[H&&a.jsxs("div",{className:"master-panel",children:[a.jsxs("div",{className:"master-toolbar",children:[a.jsxs("div",{className:"search-box",children:[a.jsx(bn,{size:16}),a.jsx("input",{type:"text",placeholder:i("common.search")||"Search...",value:u,onChange:F=>d(F.target.value)})]}),a.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>x(!0),children:a.jsx(Xr,{size:14})})]}),a.jsx("div",{className:"master-list",children:q.map(F=>{var U;return a.jsxs("div",{className:`master-item ${(f==null?void 0:f.id)===F.id?"active":""}`,onClick:()=>X(F),children:[a.jsxs("div",{className:"master-item-content",children:[a.jsxs("div",{className:"master-item-title",children:[a.jsx(si,{size:16}),a.jsx("span",{children:F.name}),["admin","viewer"].includes(F.id)&&a.jsx("span",{className:"badge badge-primary",style:{marginLeft:"4px",fontSize:"9px"},children:"Core"})]}),a.jsx("div",{className:"master-item-subtitle",children:F.description}),a.jsx("div",{className:"master-item-meta",children:a.jsxs("span",{children:[((U=F.screens)==null?void 0:U.length)||0," ",i("admin.screens")||"screens"]})})]}),a.jsx(Gn,{size:16,className:"master-item-arrow"})]},F.id)})})]}),a.jsx("div",{className:"detail-panel",children:p?a.jsxs("div",{className:"detail-content",children:[a.jsxs("div",{className:"detail-header",children:[a.jsx("h3",{children:i("admin.newGroup")||"New Permission Group"}),a.jsxs("div",{className:"detail-actions",children:[a.jsxs("button",{className:"btn btn-secondary btn-sm",onClick:()=>x(!1),children:[a.jsx(Pn,{size:14})," ",i("common.cancel")||"Cancel"]}),a.jsxs("button",{className:"btn btn-primary btn-sm",onClick:M,children:[a.jsx(Oa,{size:14})," ",i("common.create")||"Create"]})]})]}),a.jsxs("div",{className:"detail-body",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label required",children:i("admin.groupCode")}),a.jsx("input",{type:"text",className:"form-input",value:N.code,onChange:F=>b(U=>({...U,code:F.target.value.toUpperCase()})),placeholder:"e.g., SUPERVISOR"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label required",children:i("admin.groupName")}),a.jsx("input",{type:"text",className:"form-input",value:N.name,onChange:F=>b(U=>({...U,name:F.target.value})),placeholder:"e.g., Supervisor"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:i("admin.description")}),a.jsx("input",{type:"text",className:"form-input",value:N.description,onChange:F=>b(U=>({...U,description:F.target.value})),placeholder:"Group description"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:i("admin.groupLevel")}),a.jsx("input",{type:"number",className:"form-input",value:N.level,onChange:F=>b(U=>({...U,level:parseInt(F.target.value)||1})),min:"1",max:"10"})]})]}),a.jsxs("div",{className:"mt-6",children:[a.jsx("h4",{className:"mb-3",children:i("admin.quickTemplates")||"Quick Start Templates"}),a.jsx("div",{className:"template-grid",children:vm.map(F=>a.jsxs("div",{className:"template-card",onClick:()=>{const U={};e.forEach(I=>{U[I.id]={},Uo.forEach(Z=>{U[I.id][Z.key]=F.perms.includes(Z.key)})}),b(I=>({...I,screenPermissions:U,screens:e.map(Z=>Z.id)})),l.info(`Selected "${F.name}" template`)},children:[a.jsx("div",{className:"template-name",children:F.name}),a.jsx("div",{className:"template-desc",children:F.desc})]},F.id))})]})]})]}):f?a.jsxs("div",{className:"detail-content",children:[a.jsxs("div",{className:"detail-header",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("button",{className:"sidebar-toggle-btn",onClick:()=>L(!H),title:H?"Maximize View (Hide Group List)":"Restore View (Show Group List)",children:H?a.jsxs(a.Fragment,{children:[a.jsx($3,{size:16}),a.jsx("span",{children:i("admin.hideGroups")||"Hide Groups"})]}):a.jsxs(a.Fragment,{children:[a.jsx(V3,{size:16}),a.jsx("span",{children:i("admin.showGroups")||"Show Groups"})]})}),a.jsx("div",{className:"border-l h-8 border-gray-300 mx-2"}),a.jsxs("div",{children:[a.jsxs("h3",{className:"m-0 flex items-center gap-2",children:[f.name,["admin","viewer"].includes(f.id)&&a.jsx("span",{className:"badge badge-primary text-xs",children:"Core"})]}),a.jsx("p",{className:"text-muted text-xs m-0 mt-1",children:f.description})]})]}),a.jsx("div",{className:"detail-actions",children:!["admin"].includes(f.id)&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>ue(f),title:i("admin.duplicate")||"Duplicate",children:a.jsx(i_,{size:16})}),a.jsxs("button",{className:"btn btn-secondary btn-sm",onClick:()=>K(f.id),children:[a.jsx(La,{size:16})," ",i("common.delete")||"Delete"]}),a.jsxs("button",{className:"btn btn-primary btn-sm",onClick:me,children:[a.jsx(Oa,{size:16})," ",i("common.save")||"Save"]})]})})]}),a.jsx("div",{className:"detail-tabs",children:R.map(F=>a.jsxs("button",{className:`detail-tab ${v===F.id?"active":""}`,onClick:()=>k(F.id),children:[F.icon&&a.jsx(F.icon,{size:14}),F.label]},F.id))}),a.jsxs("div",{className:"detail-body",children:[v==="screens"&&a.jsxs(a.Fragment,{children:[f.id!=="admin"&&a.jsxs("div",{className:"template-bar mb-4",children:[a.jsxs("span",{className:"template-bar-label",children:[i("admin.applyTemplate")||"Apply template",":"]}),vm.map(F=>a.jsx("button",{className:"btn btn-ghost btn-xs",onClick:()=>ce(F),title:F.desc,children:F.name},F.id))]}),a.jsxs("div",{className:"permission-summary-card mb-4 p-3 bg-blue-50 rounded-lg flex justify-between items-center text-sm border border-blue-100",children:[a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("span",{className:"text-blue-800 font-medium",children:[i("admin.activeScreens")||"Active Screens",":",a.jsx("span",{className:"ml-1 font-bold",children:(V==null?void 0:V.activeScreens)||0}),a.jsx("span",{className:"mx-1 text-blue-400",children:"/"}),e.length]}),a.jsxs("span",{className:"text-blue-800 font-medium",children:[i("admin.completion")||"Completion",":",a.jsxs("span",{className:"ml-1 font-bold",children:[(V==null?void 0:V.percentage)||0,"%"]})]})]}),a.jsx("div",{className:"text-xs text-blue-600 italic",children:"* Scroll down to see all screens"})]}),a.jsx("div",{className:"permission-list-container",children:Object.entries(O).map(([F,U])=>U.screens.length===0?null:a.jsxs("div",{className:"category-section",children:[a.jsx("div",{className:"category-header",children:a.jsx("span",{children:U.label})}),a.jsx("div",{className:"category-screens",children:U.screens.map(I=>a.jsx(MW,{screen:I,selectedGroup:f,setSelectedGroup:m,toggleScreenPermission:ae,PERMISSION_TEMPLATES:vm,PERMISSION_TYPES:Uo},I.id))})]},F))})]}),v==="overview"&&a.jsx("div",{className:"overview-stats",children:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6"})}),v==="functions"&&a.jsxs("div",{className:"function-permissions",children:[a.jsx("p",{className:"text-muted mb-4",children:i("admin.legacyFunctions")||"Legacy function-based permissions (for compatibility)"}),a.jsx("div",{className:"function-grid",children:["create","read","update","delete","approve","export"].map(F=>{var U;return a.jsxs("label",{className:"function-checkbox",children:[a.jsx("input",{type:"checkbox",checked:(U=f.functions)==null?void 0:U.includes(F),onChange:()=>{var Z;const I=(Z=f.functions)!=null&&Z.includes(F)?f.functions.filter(Y=>Y!==F):[...f.functions||[],F];m(Y=>({...Y,functions:I}))},disabled:f.id==="admin"}),a.jsx("span",{children:F.charAt(0).toUpperCase()+F.slice(1)})]},F)})})]}),v==="settings"&&a.jsx("div",{className:"group-settings",children:a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:i("admin.groupName")}),a.jsx("input",{type:"text",className:"form-input",value:f.name,onChange:F=>m(U=>({...U,name:F.target.value})),disabled:["admin","viewer"].includes(f.id)})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:i("admin.description")}),a.jsx("input",{type:"text",className:"form-input",value:f.description||"",onChange:F=>m(U=>({...U,description:F.target.value}))})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:i("admin.groupLevel")}),a.jsx("input",{type:"number",className:"form-input",value:f.level||1,onChange:F=>m(U=>({...U,level:parseInt(F.target.value)||1})),min:"1",max:"10",disabled:["admin"].includes(f.id)})]})]})})]})]}):a.jsxs("div",{className:"detail-empty",children:[a.jsx(Bc,{size:48}),a.jsx("h4",{children:i("admin.selectGroup")||"Select a Group"}),a.jsx("p",{children:i("admin.selectGroupDesc")||"Choose a permission group from the list to view and edit its settings"})]})})]}),y&&a.jsx("div",{className:"modal-overlay",onClick:()=>S(null),children:a.jsxs("div",{className:"modal",onClick:F=>F.stopPropagation(),style:{maxWidth:"400px"},children:[a.jsxs("div",{className:"modal-header",children:[a.jsxs("h3",{className:"modal-title",style:{display:"flex",alignItems:"center",gap:"var(--space-2)",color:"var(--error-600)"},children:[a.jsx(Dr,{size:20})," ",i("admin.deleteGroup")||"Delete Group"]}),a.jsx("button",{className:"btn btn-ghost btn-icon",onClick:()=>S(null),children:""})]}),a.jsxs("div",{className:"modal-body",children:[a.jsxs("p",{children:[i("admin.deleteGroupConfirm")||"Are you sure you want to delete the group"," ",a.jsxs("strong",{children:['"',(j=t.find(F=>F.id===y))==null?void 0:j.name,'"']}),"?"]}),a.jsx("p",{className:"text-muted",style:{fontSize:"var(--font-size-sm)",marginTop:"var(--space-2)"},children:i("admin.deleteGroupWarning")||"This action cannot be undone. Users assigned to this group will lose these permissions."})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{className:"btn btn-secondary",onClick:()=>S(null),children:i("common.cancel")||"Cancel"}),a.jsxs("button",{className:"btn btn-danger",onClick:W,children:[a.jsx(La,{size:14})," ",i("admin.deleteGroup")||"Delete Group"]})]})]})})]})}function UW(){const{users:e,groups:t,createUser:n,updateUser:r,deactivateUser:s,updateUserPassword:i,getCodeList:l}=On(),{t:u}=Wt(),d=en(),f=l("LINERS"),[m,p]=T.useState(""),[x,v]=T.useState(!1),[k,y]=T.useState(""),[S,C]=T.useState(""),[D,N]=T.useState(!1),[b,H]=T.useState(null),[L,R]=T.useState({}),[q,O]=T.useState({newPassword:"",show:!1}),[V,X]=T.useState("details"),[M,me]=T.useState({username:"",password:"",fullName:"",email:"",groups:[],userType:"INTERNAL",shippingLineCode:null}),ae=P=>JSON.parse(localStorage.getItem("mnr_audit_log")||"[]").filter(J=>{var de;return J.userId===P||J.username===((de=e.find(E=>E.id===P))==null?void 0:de.username)}).slice(0,20),ce=T.useMemo(()=>({total:e.length,active:e.filter(P=>P.active).length,inactive:e.filter(P=>!P.active).length,internal:e.filter(P=>(P.userType||"INTERNAL")==="INTERNAL").length,external:e.filter(P=>P.userType==="EXTERNAL").length}),[e]),ue=e.filter(P=>{if(!x&&!P.active)return!1;const ne=m.toLowerCase(),J=P.username.toLowerCase().includes(ne)||P.fullName.toLowerCase().includes(ne)||P.email.toLowerCase().includes(ne),de=!k||P.groups.includes(k),E=!S||(P.userType||"INTERNAL")===S;return J&&de&&E}),K=()=>{if(!M.username||!M.password||!M.fullName){d.error(u("admin.requiredFields")||"Username, Password, and Full Name are required");return}if(e.some(P=>P.username.toUpperCase()===M.username.toUpperCase())){d.error(u("admin.usernameExists")||"Username already exists");return}if(M.groups.length===0){d.error(u("admin.groupRequired")||"At least one group is required");return}n({...M,createdAt:new Date().toISOString(),lastLogin:null}),me({username:"",password:"",fullName:"",email:"",groups:[],userType:"INTERNAL",shippingLineCode:null}),N(!1),d.success(u("admin.userCreated")||"User created successfully")},W=(P,ne)=>{r(P,ne),d.success(u("admin.userUpdated")||"User updated")},j=()=>{if(b){if(b.groups.length===0){d.error(u("admin.groupRequired")||"At least one group is required");return}W(b.id,{fullName:b.fullName,email:b.email,groups:b.groups,userType:b.userType||"INTERNAL",shippingLineCode:b.shippingLineCode}),H(null)}},F=(P,ne)=>{ne?(s(P),d.info(u("admin.userDeactivated")||"User deactivated")):(r(P,{active:!0}),d.success(u("admin.userActivated")||"User activated"))},U=()=>{if(!b||!q.newPassword){d.error(u("auth.passwordRequired")||"New password is required");return}if(q.newPassword.length<6){d.error(u("auth.passwordTooShort")||"Password must be at least 6 characters");return}r(b.id,{password:q.newPassword}),O({newPassword:"",show:!1}),d.success(u("auth.passwordChanged")||"Password reset successfully")},I=P=>{me(ne=>({...ne,groups:ne.groups.includes(P)?ne.groups.filter(J=>J!==P):[...ne.groups,P]}))},Z=P=>{b&&H(ne=>({...ne,groups:ne.groups.includes(P)?ne.groups.filter(J=>J!==P):[...ne.groups,P]}))},Y=P=>{if(!P)return u("admin.never")||"Never";const ne=Date.now()-new Date(P).getTime(),J=Math.floor(ne/6e4),de=Math.floor(ne/36e5),E=Math.floor(ne/864e5);return J<1?u("admin.justNow")||"Just now":J<60?`${J}m ago`:de<24?`${de}h ago`:E<7?`${E}d ago`:new Date(P).toLocaleDateString()};return a.jsxs("div",{className:"page",children:[a.jsxs("div",{className:"page-header",children:[a.jsxs("div",{children:[a.jsxs("h2",{children:[a.jsx(nm,{size:24})," ",u("nav.userManagement")]}),a.jsx("p",{className:"text-muted",children:u("admin.userManagementDesc")||"Register and manage user accounts and group assignments"})]}),a.jsxs("div",{className:"header-stats",children:[a.jsxs("div",{className:"header-stat",children:[a.jsx("span",{className:"header-stat-value",children:ce.active}),a.jsx("span",{className:"header-stat-label",children:u("common.active")||"Active"})]}),a.jsxs("div",{className:"header-stat",children:[a.jsx("span",{className:"header-stat-value",children:ce.inactive}),a.jsx("span",{className:"header-stat-label",children:u("common.inactive")||"Inactive"})]}),a.jsxs("div",{className:"header-stat",children:[a.jsx("span",{className:"header-stat-value",children:ce.internal}),a.jsx("span",{className:"header-stat-label",children:u("admin.internal")||"Internal"})]}),a.jsxs("div",{className:"header-stat",children:[a.jsx("span",{className:"header-stat-value",children:ce.external}),a.jsx("span",{className:"header-stat-label",children:u("admin.external")||"External"})]})]})]}),a.jsxs("div",{className:"master-detail-layout",children:[a.jsxs("div",{className:"master-panel",children:[a.jsxs("div",{className:"master-toolbar",children:[a.jsxs("div",{className:"search-box",children:[a.jsx(bn,{size:16}),a.jsx("input",{type:"text",placeholder:u("common.search")+"...",value:m,onChange:P=>p(P.target.value)})]}),a.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>{N(!0),H(null)},children:a.jsx(nm,{size:14})})]}),a.jsxs("div",{className:"master-filters",children:[a.jsxs("select",{className:"form-input form-input-sm",value:k,onChange:P=>y(P.target.value),children:[a.jsx("option",{value:"",children:u("admin.allGroups")||"All Groups"}),t.map(P=>a.jsx("option",{value:P.id,children:P.name},P.id))]}),a.jsxs("select",{className:"form-input form-input-sm",value:S,onChange:P=>C(P.target.value),children:[a.jsx("option",{value:"",children:u("admin.allTypes")||"All Types"}),a.jsx("option",{value:"INTERNAL",children:u("admin.internal")||"Internal"}),a.jsx("option",{value:"EXTERNAL",children:u("admin.external")||"External"})]}),a.jsxs("label",{className:"checkbox-label",style:{fontSize:"var(--font-size-xs)"},children:[a.jsx("input",{type:"checkbox",checked:x,onChange:P=>v(P.target.checked)}),u("admin.showInactive")||"Inactive"]})]}),a.jsxs("div",{className:"master-list",children:[ue.map(P=>a.jsxs("div",{className:`master-item ${(b==null?void 0:b.id)===P.id?"active":""} ${P.active?"":"inactive"}`,onClick:()=>{H({...P}),N(!1),X("details")},style:{opacity:P.active?1:.5},children:[a.jsxs("div",{className:"master-item-content",children:[a.jsxs("div",{className:"master-item-title",children:[a.jsx(Js,{size:16}),a.jsx("span",{children:P.username}),P.userType==="EXTERNAL"&&a.jsx(Hy,{size:12,style:{color:"var(--secondary-500)"}}),!P.active&&a.jsx("span",{className:"badge badge-secondary",style:{marginLeft:"4px",fontSize:"9px"},children:"Inactive"})]}),a.jsx("div",{className:"master-item-subtitle",children:P.fullName}),a.jsx("div",{className:"master-item-meta",children:a.jsx("span",{children:P.groups.map(ne=>{var J;return(J=t.find(de=>de.id===ne))==null?void 0:J.name}).filter(Boolean).join(", ")})})]}),a.jsx(Gn,{size:16,className:"master-item-arrow"})]},P.id)),ue.length===0&&a.jsxs("div",{className:"empty-state",style:{padding:"var(--space-6)"},children:[a.jsx(Js,{size:32}),a.jsx("p",{children:u("admin.noUsersFound")||"No users found"})]})]})]}),a.jsx("div",{className:"detail-panel",children:D?a.jsxs("div",{className:"detail-content",children:[a.jsxs("div",{className:"detail-header",children:[a.jsxs("h3",{children:[a.jsx(nm,{size:20})," ",u("admin.registerUser")||"Register New User"]}),a.jsxs("div",{className:"detail-actions",children:[a.jsxs("button",{className:"btn btn-secondary btn-sm",onClick:()=>N(!1),children:[a.jsx(Pn,{size:14})," ",u("common.cancel")]}),a.jsxs("button",{className:"btn btn-primary btn-sm",onClick:K,children:[a.jsx(Oa,{size:14})," ",u("common.save")]})]})]}),a.jsxs("div",{className:"detail-body",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label required",children:u("admin.username")}),a.jsxs("div",{className:"input-with-icon",children:[a.jsx(Js,{size:18}),a.jsx("input",{type:"text",className:"form-input",value:M.username,onChange:P=>me(ne=>({...ne,username:P.target.value.toUpperCase()})),placeholder:"JOHN"})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label required",children:u("admin.password")}),a.jsxs("div",{className:"input-with-icon",children:[a.jsx("input",{type:L.new?"text":"password",className:"form-input",value:M.password,onChange:P=>me(ne=>({...ne,password:P.target.value})),placeholder:""}),a.jsx("button",{type:"button",className:"btn-icon",onClick:()=>R(P=>({...P,new:!P.new})),children:L.new?a.jsx(Fy,{size:18}):a.jsx(qr,{size:18})})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label required",children:u("admin.fullName")}),a.jsx("input",{type:"text",className:"form-input",value:M.fullName,onChange:P=>me(ne=>({...ne,fullName:P.target.value})),placeholder:"John Doe"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:u("admin.email")}),a.jsxs("div",{className:"input-with-icon",children:[a.jsx($h,{size:18}),a.jsx("input",{type:"email",className:"form-input",value:M.email,onChange:P=>me(ne=>({...ne,email:P.target.value})),placeholder:"john@depot.com"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label required",children:u("admin.userType")||"User Type"}),a.jsxs("select",{className:"form-input",value:M.userType,onChange:P=>me(ne=>({...ne,userType:P.target.value,shippingLineCode:P.target.value==="INTERNAL"?null:ne.shippingLineCode})),children:[a.jsx("option",{value:"INTERNAL",children:u("admin.internal")||"Internal"}),a.jsx("option",{value:"EXTERNAL",children:u("admin.external")||"External"})]})]}),M.userType==="EXTERNAL"&&a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label required",children:u("admin.shippingLine")||"Shipping Line"}),a.jsxs("select",{className:"form-input",value:M.shippingLineCode||"",onChange:P=>me(ne=>({...ne,shippingLineCode:P.target.value||null})),children:[a.jsx("option",{value:"",children:u("common.select")||"Select..."}),f.map(P=>a.jsxs("option",{value:P.code,children:[P.code," - ",P.name]},P.code))]})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label required",children:u("admin.assignGroups")||"Assign Groups"}),a.jsx("div",{className:"group-checkboxes",children:t.map(P=>a.jsxs("label",{className:"checkbox-card",children:[a.jsx("input",{type:"checkbox",checked:M.groups.includes(P.id),onChange:()=>I(P.id)}),a.jsxs("div",{children:[a.jsx("strong",{children:P.name}),a.jsx("span",{children:P.description})]})]},P.id))})]})]})]}):b?a.jsxs("div",{className:"detail-content",children:[a.jsxs("div",{className:"detail-header",children:[a.jsxs("div",{children:[a.jsxs("h3",{children:[a.jsx("code",{className:"username-badge",children:b.username}),b.userType==="EXTERNAL"&&a.jsxs("span",{className:"badge badge-secondary",style:{marginLeft:"8px"},children:[a.jsx(Hy,{size:10})," External"]}),!b.active&&a.jsx("span",{className:"badge badge-secondary",style:{marginLeft:"8px"},children:"Inactive"})]}),a.jsx("p",{className:"text-muted",children:b.email||"No email"})]}),a.jsxs("div",{className:"detail-actions",children:[a.jsxs("button",{className:`btn btn-sm ${b.active?"btn-secondary":"btn-primary"}`,onClick:()=>{F(b.id,b.active),H(P=>({...P,active:!P.active}))},disabled:b.id==="user_admin",children:[b.active?a.jsx(h_,{size:14}):a.jsx(f_,{size:14}),b.active?u("admin.deactivate")||"Deactivate":u("admin.activate")||"Activate"]}),a.jsxs("button",{className:"btn btn-primary btn-sm",onClick:j,children:[a.jsx(Oa,{size:14})," ",u("common.save")]})]})]}),a.jsxs("div",{className:"detail-tabs",children:[a.jsxs("button",{className:`detail-tab ${V==="details"?"active":""}`,onClick:()=>X("details"),children:[a.jsx(Js,{size:14})," ",u("admin.details")||"Details"]}),a.jsxs("button",{className:`detail-tab ${V==="activity"?"active":""}`,onClick:()=>X("activity"),children:[a.jsx(Yo,{size:14})," ",u("admin.activity")||"Activity"]}),a.jsxs("button",{className:`detail-tab ${V==="security"?"active":""}`,onClick:()=>X("security"),children:[a.jsx(Kd,{size:14})," ",u("admin.security")||"Security"]})]}),a.jsxs("div",{className:"detail-body",children:[V==="details"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"user-info-summary mb-4",children:[a.jsxs("div",{className:"user-info-item",children:[a.jsx(tr,{size:14}),a.jsxs("span",{className:"user-info-label",children:[u("admin.lastLogin")||"Last Login",":"]}),a.jsx("span",{children:Y(b.lastLogin)})]}),a.jsxs("div",{className:"user-info-item",children:[a.jsx(ls,{size:14}),a.jsxs("span",{className:"user-info-label",children:[u("admin.createdAt")||"Created",":"]}),a.jsx("span",{children:b.createdAt?new Date(b.createdAt).toLocaleDateString():"N/A"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:u("admin.fullName")}),a.jsx("input",{type:"text",className:"form-input",value:b.fullName,onChange:P=>H(ne=>({...ne,fullName:P.target.value}))})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:u("admin.email")}),a.jsx("input",{type:"email",className:"form-input",value:b.email||"",onChange:P=>H(ne=>({...ne,email:P.target.value}))})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:u("admin.userType")||"User Type"}),a.jsxs("select",{className:"form-input",value:b.userType||"INTERNAL",onChange:P=>H(ne=>({...ne,userType:P.target.value,shippingLineCode:P.target.value==="INTERNAL"?null:ne.shippingLineCode})),children:[a.jsx("option",{value:"INTERNAL",children:u("admin.internal")||"Internal"}),a.jsx("option",{value:"EXTERNAL",children:u("admin.external")||"External"})]})]}),(b.userType||"INTERNAL")==="EXTERNAL"&&a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:u("admin.shippingLine")||"Shipping Line"}),a.jsxs("select",{className:"form-input",value:b.shippingLineCode||"",onChange:P=>H(ne=>({...ne,shippingLineCode:P.target.value||null})),children:[a.jsx("option",{value:"",children:u("common.select")||"Select..."}),f.map(P=>a.jsxs("option",{value:P.code,children:[P.code," - ",P.name]},P.code))]})]})]}),a.jsxs("div",{className:"form-group mb-4",children:[a.jsx("label",{className:"form-label",children:u("admin.assignGroups")||"Assigned Groups"}),a.jsx("div",{className:"group-checkboxes",children:t.map(P=>a.jsxs("label",{className:"checkbox-card",children:[a.jsx("input",{type:"checkbox",checked:b.groups.includes(P.id),onChange:()=>Z(P.id)}),a.jsxs("div",{children:[a.jsx("strong",{children:P.name}),a.jsx("span",{children:P.description})]})]},P.id))})]})]}),V==="activity"&&a.jsxs("div",{className:"activity-log",children:[a.jsx("div",{className:"activity-log-header",children:a.jsxs("h4",{children:[a.jsx(Yo,{size:16})," ",u("admin.recentActivity")||"Recent Activity"]})}),a.jsx("div",{className:"activity-log-list",children:ae(b.id).length>0?ae(b.id).map((P,ne)=>a.jsxs("div",{className:"activity-log-item",children:[a.jsx("div",{className:"activity-log-icon",children:a.jsx(Yo,{size:14})}),a.jsxs("div",{className:"activity-log-content",children:[a.jsx("div",{className:"activity-log-action",children:P.action||"Activity"}),a.jsx("div",{className:"activity-log-details",children:P.details||"No details"})]}),a.jsx("div",{className:"activity-log-time",children:Y(P.timestamp)})]},ne)):a.jsxs("div",{className:"empty-state",style:{padding:"var(--space-6)"},children:[a.jsx(tr,{size:32}),a.jsx("p",{children:u("admin.noActivityYet")||"No activity recorded yet"})]})})]}),V==="security"&&a.jsxs("div",{className:"security-settings",children:[a.jsxs("div",{className:"card",style:{background:"var(--bg-tertiary)"},children:[a.jsxs("h4",{style:{marginBottom:"var(--space-3)",display:"flex",alignItems:"center",gap:"var(--space-2)"},children:[a.jsx(Kd,{size:16})," ",u("admin.resetPassword")||"Reset Password"]}),a.jsxs("div",{className:"flex gap-3",style:{alignItems:"flex-end"},children:[a.jsxs("div",{className:"form-group",style:{flex:1,marginBottom:0},children:[a.jsx("label",{className:"form-label",children:u("auth.newPassword")}),a.jsxs("div",{className:"input-with-icon",children:[a.jsx("input",{type:q.show?"text":"password",className:"form-input",value:q.newPassword,onChange:P=>O(ne=>({...ne,newPassword:P.target.value})),placeholder:""}),a.jsx("button",{type:"button",className:"btn-icon",onClick:()=>O(P=>({...P,show:!P.show})),children:q.show?a.jsx(Fy,{size:18}):a.jsx(qr,{size:18})})]})]}),a.jsxs("button",{className:"btn btn-secondary",onClick:U,children:[a.jsx(Kd,{size:14})," ",u("admin.resetPassword")||"Reset"]})]})]}),a.jsxs("div",{className:"card mt-4",style:{background:"var(--bg-tertiary)"},children:[a.jsxs("h4",{style:{marginBottom:"var(--space-3)",display:"flex",alignItems:"center",gap:"var(--space-2)"},children:[a.jsx(Bc,{size:16})," ",u("admin.sessionInfo")||"Session Information"]}),a.jsxs("div",{className:"user-info-grid",children:[a.jsxs("div",{className:"user-info-row",children:[a.jsx("span",{className:"user-info-label",children:u("admin.lastLogin")||"Last Login"}),a.jsx("span",{children:b.lastLogin?new Date(b.lastLogin).toLocaleString():"Never"})]}),a.jsxs("div",{className:"user-info-row",children:[a.jsx("span",{className:"user-info-label",children:u("admin.accountStatus")||"Account Status"}),a.jsx("span",{className:`badge ${b.active?"badge-success":"badge-secondary"}`,children:b.active?"Active":"Inactive"})]})]})]})]})]})]}):a.jsxs("div",{className:"detail-empty",children:[a.jsx(Js,{size:48}),a.jsx("h4",{children:u("admin.selectUser")||"Select a User"}),a.jsx("p",{children:u("admin.selectUserDesc")||"Choose a user from the list to view and edit their details"})]})})]})]})}function zW(){const{settings:e,updateSettings:t,DEFAULT_SETTINGS:n}=On(),{t:r,language:s,setLanguage:i}=Wt(),l=en(),[u,d]=T.useState({autoApprovalThreshold:e.autoApprovalThreshold??100,defaultCurrency:e.defaultCurrency??"RM",containersPerPage:e.containersPerPage??200,enableNotifications:e.enableNotifications??!0,sessionTimeout:e.sessionTimeout??30,dateFormat:e.dateFormat??"DD/MM/YYYY",timeFormat:e.timeFormat??"24h",enableAutoLogout:e.enableAutoLogout??!0,defaultSurveyType:e.defaultSurveyType??"DAMAGE",requirePhotoForSurvey:e.requirePhotoForSurvey??!0,showCostInList:e.showCostInList??!0,enableQuickActions:e.enableQuickActions??!0}),[f,m]=T.useState(!1),[p,x]=T.useState("eor"),v=[{id:"eor",label:r("admin.eorSettings")||"EOR / Approval",icon:wn},{id:"display",label:r("admin.displaySettings")||"Display",icon:Kr},{id:"notifications",label:r("admin.notifications")||"Notifications",icon:ph},{id:"localization",label:r("admin.localization")||"Localization",icon:Xo},{id:"workflow",label:r("admin.workflowSettings")||"Workflow",icon:tr}],k=(C,D)=>{d(N=>({...N,[C]:D})),m(!0)},y=()=>{t(u),m(!1),l.success(r("admin.settingsSaved")||"Settings saved successfully!")},S=()=>{d({autoApprovalThreshold:n.autoApprovalThreshold,defaultCurrency:n.defaultCurrency,containersPerPage:n.containersPerPage,enableNotifications:!0,sessionTimeout:30,dateFormat:"DD/MM/YYYY",timeFormat:"24h",enableAutoLogout:!0,defaultSurveyType:"DAMAGE",requirePhotoForSurvey:!0,showCostInList:!0,enableQuickActions:!0}),m(!0),l.info(r("admin.settingsReset")||"Settings reset to defaults")};return a.jsxs("div",{className:"page",children:[a.jsxs("div",{className:"page-header",children:[a.jsxs("div",{className:"page-title",children:[a.jsx(Zp,{size:24}),a.jsx("h1",{children:r("nav.systemSettings")||"System Settings"})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{className:"btn btn-secondary",onClick:S,title:r("admin.resetDefaults")||"Reset to default values",children:[a.jsx(Qp,{size:16})," ",r("admin.resetDefaults")||"Reset Defaults"]}),a.jsxs("button",{className:"btn btn-primary",onClick:y,disabled:!f,children:[a.jsx(Oa,{size:16})," ",r("common.save")||"Save Changes"]})]})]}),a.jsxs("div",{className:"settings-layout",children:[a.jsx("div",{className:"settings-sidebar",children:v.map(C=>a.jsxs("button",{className:`settings-nav-item ${p===C.id?"active":""}`,onClick:()=>x(C.id),children:[a.jsx(C.icon,{size:18}),a.jsx("span",{children:C.label})]},C.id))}),a.jsxs("div",{className:"settings-content",children:[p==="eor"&&a.jsxs("div",{className:"settings-section-content",children:[a.jsxs("h3",{children:[a.jsx(wn,{size:20})," ",r("admin.eorSettings")||"EOR / Approval Settings"]}),a.jsxs("div",{className:"setting-item",children:[a.jsxs("div",{className:"setting-info",children:[a.jsx("label",{className:"setting-label",children:r("admin.autoApprovalThreshold")||"Auto-Approval Threshold"}),a.jsx("p",{className:"setting-description",children:r("admin.autoApprovalDesc")||"EORs with total cost at or below this amount will be automatically approved without requiring liner confirmation."})]}),a.jsx("div",{className:"setting-control",children:a.jsxs("div",{className:"input-with-prefix",children:[a.jsx("span",{className:"input-prefix",children:"RM"}),a.jsx("input",{type:"number",className:"form-input",value:u.autoApprovalThreshold,onChange:C=>k("autoApprovalThreshold",parseInt(C.target.value)||0),min:"0",step:"10"})]})})]}),a.jsxs("div",{className:"setting-item",children:[a.jsxs("div",{className:"setting-info",children:[a.jsx("label",{className:"setting-label",children:r("admin.defaultCurrency")||"Default Currency"}),a.jsx("p",{className:"setting-description",children:r("admin.currencyDesc")||"Currency used for all cost calculations and displays."})]}),a.jsx("div",{className:"setting-control",children:a.jsxs("select",{className:"form-input",value:u.defaultCurrency,onChange:C=>k("defaultCurrency",C.target.value),children:[a.jsx("option",{value:"RM",children:"RM (Malaysian Ringgit)"}),a.jsx("option",{value:"USD",children:"USD (US Dollar)"}),a.jsx("option",{value:"SGD",children:"SGD (Singapore Dollar)"}),a.jsx("option",{value:"EUR",children:"EUR (Euro)"})]})})]}),a.jsxs("div",{className:"setting-item",children:[a.jsxs("div",{className:"setting-info",children:[a.jsx("label",{className:"setting-label",children:r("admin.showCostInList")||"Show Cost in List Views"}),a.jsx("p",{className:"setting-description",children:r("admin.showCostDesc")||"Display cost information in list views for EORs and repair orders."})]}),a.jsx("div",{className:"setting-control",children:a.jsxs("label",{className:"toggle-switch",children:[a.jsx("input",{type:"checkbox",checked:u.showCostInList,onChange:C=>k("showCostInList",C.target.checked)}),a.jsx("span",{className:"toggle-slider"})]})})]})]}),p==="display"&&a.jsxs("div",{className:"settings-section-content",children:[a.jsxs("h3",{children:[a.jsx(Kr,{size:20})," ",r("admin.displaySettings")||"Display Settings"]}),a.jsxs("div",{className:"setting-item",children:[a.jsxs("div",{className:"setting-info",children:[a.jsx("label",{className:"setting-label",children:r("admin.containersPerPage")||"Containers Per Page"}),a.jsx("p",{className:"setting-description",children:r("admin.containersDesc")||"Number of containers to display per page in the container list."})]}),a.jsx("div",{className:"setting-control",children:a.jsxs("select",{className:"form-input",value:u.containersPerPage,onChange:C=>k("containersPerPage",parseInt(C.target.value)),children:[a.jsx("option",{value:25,children:"25"}),a.jsx("option",{value:50,children:"50"}),a.jsx("option",{value:100,children:"100"}),a.jsx("option",{value:200,children:"200"}),a.jsx("option",{value:500,children:"500"})]})})]}),a.jsxs("div",{className:"setting-item",children:[a.jsxs("div",{className:"setting-info",children:[a.jsx("label",{className:"setting-label",children:r("admin.enableQuickActions")||"Enable Quick Actions"}),a.jsx("p",{className:"setting-description",children:r("admin.quickActionsDesc")||"Show quick action buttons in list views for faster operations."})]}),a.jsx("div",{className:"setting-control",children:a.jsxs("label",{className:"toggle-switch",children:[a.jsx("input",{type:"checkbox",checked:u.enableQuickActions,onChange:C=>k("enableQuickActions",C.target.checked)}),a.jsx("span",{className:"toggle-slider"})]})})]})]}),p==="notifications"&&a.jsxs("div",{className:"settings-section-content",children:[a.jsxs("h3",{children:[a.jsx(ph,{size:20})," ",r("admin.notifications")||"Notification Settings"]}),a.jsxs("div",{className:"setting-item",children:[a.jsxs("div",{className:"setting-info",children:[a.jsx("label",{className:"setting-label",children:r("admin.enableNotifications")||"Enable Notifications"}),a.jsx("p",{className:"setting-description",children:r("admin.notificationsDesc")||"Show in-app notifications for important events."})]}),a.jsx("div",{className:"setting-control",children:a.jsxs("label",{className:"toggle-switch",children:[a.jsx("input",{type:"checkbox",checked:u.enableNotifications,onChange:C=>k("enableNotifications",C.target.checked)}),a.jsx("span",{className:"toggle-slider"})]})})]}),a.jsxs("div",{className:"setting-item",children:[a.jsxs("div",{className:"setting-info",children:[a.jsx("label",{className:"setting-label",children:r("admin.sessionTimeout")||"Session Timeout (minutes)"}),a.jsx("p",{className:"setting-description",children:r("admin.sessionDesc")||"Auto-logout after inactivity period."})]}),a.jsx("div",{className:"setting-control",children:a.jsxs("select",{className:"form-input",value:u.sessionTimeout,onChange:C=>k("sessionTimeout",parseInt(C.target.value)),children:[a.jsx("option",{value:15,children:"15 minutes"}),a.jsx("option",{value:30,children:"30 minutes"}),a.jsx("option",{value:60,children:"1 hour"}),a.jsx("option",{value:120,children:"2 hours"}),a.jsx("option",{value:0,children:"Never"})]})})]}),a.jsxs("div",{className:"setting-item",children:[a.jsxs("div",{className:"setting-info",children:[a.jsx("label",{className:"setting-label",children:r("admin.enableAutoLogout")||"Enable Auto Logout"}),a.jsx("p",{className:"setting-description",children:r("admin.autoLogoutDesc")||"Automatically log out users after the session timeout."})]}),a.jsx("div",{className:"setting-control",children:a.jsxs("label",{className:"toggle-switch",children:[a.jsx("input",{type:"checkbox",checked:u.enableAutoLogout,onChange:C=>k("enableAutoLogout",C.target.checked)}),a.jsx("span",{className:"toggle-slider"})]})})]})]}),p==="localization"&&a.jsxs("div",{className:"settings-section-content",children:[a.jsxs("h3",{children:[a.jsx(Xo,{size:20})," ",r("admin.localization")||"Localization Settings"]}),a.jsxs("div",{className:"setting-item",children:[a.jsxs("div",{className:"setting-info",children:[a.jsx("label",{className:"setting-label",children:r("admin.language")||"Language"}),a.jsx("p",{className:"setting-description",children:r("admin.languageDesc")||"Select the interface language."})]}),a.jsx("div",{className:"setting-control",children:a.jsxs("select",{className:"form-input",value:s,onChange:C=>i(C.target.value),children:[a.jsx("option",{value:"en",children:"English"}),a.jsx("option",{value:"ms",children:"Bahasa Melayu"}),a.jsx("option",{value:"zh",children:" (Chinese)"}),a.jsx("option",{value:"vi",children:"Ting Vit"}),a.jsx("option",{value:"ko",children:" (Korean)"}),a.jsx("option",{value:"pt",children:"Portugus"})]})})]}),a.jsxs("div",{className:"setting-item",children:[a.jsxs("div",{className:"setting-info",children:[a.jsx("label",{className:"setting-label",children:r("admin.dateFormat")||"Date Format"}),a.jsx("p",{className:"setting-description",children:r("admin.dateFormatDesc")||"Format for displaying dates throughout the application."})]}),a.jsx("div",{className:"setting-control",children:a.jsxs("select",{className:"form-input",value:u.dateFormat,onChange:C=>k("dateFormat",C.target.value),children:[a.jsx("option",{value:"DD/MM/YYYY",children:"DD/MM/YYYY (31/12/2024)"}),a.jsx("option",{value:"MM/DD/YYYY",children:"MM/DD/YYYY (12/31/2024)"}),a.jsx("option",{value:"YYYY-MM-DD",children:"YYYY-MM-DD (2024-12-31)"})]})})]}),a.jsxs("div",{className:"setting-item",children:[a.jsxs("div",{className:"setting-info",children:[a.jsx("label",{className:"setting-label",children:r("admin.timeFormat")||"Time Format"}),a.jsx("p",{className:"setting-description",children:r("admin.timeFormatDesc")||"Format for displaying time."})]}),a.jsx("div",{className:"setting-control",children:a.jsxs("select",{className:"form-input",value:u.timeFormat,onChange:C=>k("timeFormat",C.target.value),children:[a.jsx("option",{value:"24h",children:"24-hour (14:30)"}),a.jsx("option",{value:"12h",children:"12-hour (2:30 PM)"})]})})]})]}),p==="workflow"&&a.jsxs("div",{className:"settings-section-content",children:[a.jsxs("h3",{children:[a.jsx(tr,{size:20})," ",r("admin.workflowSettings")||"Workflow Settings"]}),a.jsxs("div",{className:"setting-item",children:[a.jsxs("div",{className:"setting-info",children:[a.jsx("label",{className:"setting-label",children:r("admin.defaultSurveyType")||"Default Survey Type"}),a.jsx("p",{className:"setting-description",children:r("admin.surveyTypeDesc")||"Default survey type when creating new surveys."})]}),a.jsx("div",{className:"setting-control",children:a.jsxs("select",{className:"form-input",value:u.defaultSurveyType,onChange:C=>k("defaultSurveyType",C.target.value),children:[a.jsx("option",{value:"DAMAGE",children:"Damage Survey"}),a.jsx("option",{value:"GATE_IN",children:"Gate In Survey"}),a.jsx("option",{value:"GATE_OUT",children:"Gate Out Survey"}),a.jsx("option",{value:"PERIODIC",children:"Periodic Survey"})]})})]}),a.jsxs("div",{className:"setting-item",children:[a.jsxs("div",{className:"setting-info",children:[a.jsx("label",{className:"setting-label",children:r("admin.requirePhoto")||"Require Photo for Survey"}),a.jsx("p",{className:"setting-description",children:r("admin.requirePhotoDesc")||"Make at least one photo mandatory when completing surveys."})]}),a.jsx("div",{className:"setting-control",children:a.jsxs("label",{className:"toggle-switch",children:[a.jsx("input",{type:"checkbox",checked:u.requirePhotoForSurvey,onChange:C=>k("requirePhotoForSurvey",C.target.checked)}),a.jsx("span",{className:"toggle-slider"})]})})]})]}),a.jsxs("div",{className:"settings-summary-card",children:[a.jsxs("h4",{children:[a.jsx(xh,{size:16})," ",r("admin.currentSettings")||"Current Settings Summary"]}),a.jsxs("div",{className:"summary-grid",children:[a.jsxs("div",{className:"summary-item",children:[a.jsx(o_,{size:14}),a.jsxs("span",{children:[r("admin.autoApproval")||"Auto-approval",": ",a.jsxs("strong",{children:["RM ",e.autoApprovalThreshold||100]})]})]}),a.jsxs("div",{className:"summary-item",children:[a.jsx(Kr,{size:14}),a.jsxs("span",{children:[r("admin.perPage")||"Per page",": ",a.jsx("strong",{children:e.containersPerPage||200})]})]}),a.jsxs("div",{className:"summary-item",children:[a.jsx(Xo,{size:14}),a.jsxs("span",{children:[r("admin.language")||"Language",": ",a.jsx("strong",{children:s.toUpperCase()})]})]}),a.jsxs("div",{className:"summary-item",children:[a.jsx(tr,{size:14}),a.jsxs("span",{children:[r("admin.timeout")||"Timeout",": ",a.jsxs("strong",{children:[u.sessionTimeout," min"]})]})]})]})]})]})]})]})}function WW(){const{getAnnouncements:e,addAnnouncement:t,updateAnnouncement:n,deleteAnnouncement:r,getLinks:s,addLink:i,updateLink:l,deleteLink:u}=On(),{user:d}=Ft(),{t:f}=Wt(),m=en(),p=e(),x=s(),[v,k]=T.useState(!1),[y,S]=T.useState(null),[C,D]=T.useState({title:"",content:""}),[N,b]=T.useState(!1),[H,L]=T.useState(null),[R,q]=T.useState({title:"",url:"",description:""}),O=(K=null)=>{K?(S(K),D({title:K.title,content:K.content})):(S(null),D({title:"",content:""})),k(!0)},V=()=>{if(!C.title||!C.content){m.error(f("admin.requiredFields")||"Title and Content are required");return}y?(n(y.id,{title:C.title,content:C.content}),m.success(f("admin.announcementUpdated")||"Announcement updated")):(t({title:C.title,content:C.content,createdBy:(d==null?void 0:d.username)||"SYSTEM"}),m.success(f("admin.announcementCreated")||"Announcement created")),k(!1),D({title:"",content:""}),S(null)},X=K=>{confirm(f("admin.confirmDelete")||"Are you sure you want to delete this?")&&(r(K),m.success(f("admin.announcementDeleted")||"Announcement deleted"))},M=(K,W)=>{const j=W==="up"?K-1:K+1;if(j<0||j>=p.length)return;const F=p[K],U=p[j];n(F.id,{order:U.order||j}),n(U.id,{order:F.order||K}),m.info(f("admin.itemMoved")||"Item moved")},me=(K=null)=>{K?(L(K),q({title:K.title,url:K.url,description:K.description||""})):(L(null),q({title:"",url:"",description:""})),b(!0)},ae=()=>{if(!R.title||!R.url){m.error(f("admin.requiredFields")||"Title and URL are required");return}H?(l(H.id,{title:R.title,url:R.url,description:R.description}),m.success(f("admin.linkUpdated")||"Link updated")):(i({title:R.title,url:R.url,description:R.description,createdBy:(d==null?void 0:d.username)||"SYSTEM"}),m.success(f("admin.linkCreated")||"Link created")),b(!1),q({title:"",url:"",description:""}),L(null)},ce=K=>{confirm(f("admin.confirmDelete")||"Are you sure you want to delete this?")&&(u(K),m.success(f("admin.linkDeleted")||"Link deleted"))},ue=(K,W)=>{const j=W==="up"?K-1:K+1;if(j<0||j>=x.length)return;const F=x[K],U=x[j];l(F.id,{order:U.order||j}),l(U.id,{order:F.order||K}),m.info(f("admin.itemMoved")||"Item moved")};return a.jsxs("div",{className:"page",children:[a.jsx("div",{className:"page-header",children:a.jsxs("div",{children:[a.jsxs("h2",{children:[a.jsx(M3,{size:24})," ",f("admin.homePageManagement")||"Home Page Management"]}),a.jsx("p",{className:"text-muted",children:f("admin.homePageDesc")||"Manage announcements and links displayed on the portal"})]})}),a.jsxs("div",{className:"homepage-admin-grid",children:[a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"card-header",children:[a.jsxs("h3",{className:"card-title",children:[a.jsx($m,{size:18}),f("homepage.announcements")||"Announcements"]}),a.jsxs("button",{className:"btn btn-primary btn-sm",onClick:()=>O(),children:[a.jsx(Xr,{size:14})," ",f("common.add")||"Add"]})]}),a.jsx("div",{className:"homepage-item-list",children:p.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx($m,{size:32}),a.jsx("p",{children:f("homepage.noAnnouncements")||"No announcements yet"})]}):p.map((K,W)=>a.jsxs("div",{className:"homepage-item",children:[a.jsxs("div",{className:"homepage-item-order",children:[a.jsx("button",{className:"btn-icon btn-sm",onClick:()=>M(W,"up"),disabled:W===0,title:f("admin.moveUp")||"Move Up",children:a.jsx(gh,{size:14})}),a.jsx("button",{className:"btn-icon btn-sm",onClick:()=>M(W,"down"),disabled:W===p.length-1,title:f("admin.moveDown")||"Move Down",children:a.jsx(Yi,{size:14})})]}),a.jsxs("div",{className:"homepage-item-content",children:[a.jsx("h4",{children:K.title}),a.jsx("p",{children:K.content}),a.jsxs("span",{className:"homepage-item-meta",children:[new Date(K.createdAt).toLocaleDateString()," - ",K.createdBy]})]}),a.jsxs("div",{className:"homepage-item-actions",children:[a.jsx("button",{className:"btn-icon",onClick:()=>O(K),children:a.jsx(Vm,{size:16})}),a.jsx("button",{className:"btn-icon text-error",onClick:()=>X(K.id),children:a.jsx(La,{size:16})})]})]},K.id))})]}),a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"card-header",children:[a.jsxs("h3",{className:"card-title",children:[a.jsx(Uy,{size:18}),f("homepage.links")||"Links"]}),a.jsxs("button",{className:"btn btn-primary btn-sm",onClick:()=>me(),children:[a.jsx(Xr,{size:14})," ",f("common.add")||"Add"]})]}),a.jsx("div",{className:"homepage-item-list",children:x.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx(Uy,{size:32}),a.jsx("p",{children:f("homepage.noLinks")||"No links yet"})]}):x.map((K,W)=>a.jsxs("div",{className:"homepage-item",children:[a.jsxs("div",{className:"homepage-item-order",children:[a.jsx("button",{className:"btn-icon btn-sm",onClick:()=>ue(W,"up"),disabled:W===0,title:f("admin.moveUp")||"Move Up",children:a.jsx(gh,{size:14})}),a.jsx("button",{className:"btn-icon btn-sm",onClick:()=>ue(W,"down"),disabled:W===x.length-1,title:f("admin.moveDown")||"Move Down",children:a.jsx(Yi,{size:14})})]}),a.jsxs("div",{className:"homepage-item-content",children:[a.jsxs("h4",{children:[K.title,a.jsx("a",{href:K.url,target:"_blank",rel:"noopener noreferrer",className:"link-external",children:a.jsx(l_,{size:14})})]}),a.jsx("p",{children:K.description||K.url}),a.jsxs("span",{className:"homepage-item-meta",children:[new Date(K.createdAt).toLocaleDateString()," - ",K.createdBy]})]}),a.jsxs("div",{className:"homepage-item-actions",children:[a.jsx("button",{className:"btn-icon",onClick:()=>me(K),children:a.jsx(Vm,{size:16})}),a.jsx("button",{className:"btn-icon text-error",onClick:()=>ce(K.id),children:a.jsx(La,{size:16})})]})]},K.id))})]})]}),v&&a.jsx("div",{className:"modal-overlay",onClick:()=>k(!1),children:a.jsxs("div",{className:"modal",onClick:K=>K.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h3",{children:y?f("admin.editAnnouncement")||"Edit Announcement":f("admin.addAnnouncement")||"Add Announcement"}),a.jsx("button",{className:"btn-icon",onClick:()=>k(!1),children:a.jsx(Pn,{size:20})})]}),a.jsxs("div",{className:"modal-body",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label required",children:f("common.title")||"Title"}),a.jsx("input",{type:"text",className:"form-input",value:C.title,onChange:K=>D(W=>({...W,title:K.target.value})),placeholder:"Announcement title..."})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label required",children:f("common.content")||"Content"}),a.jsx("textarea",{className:"form-input",rows:4,value:C.content,onChange:K=>D(W=>({...W,content:K.target.value})),placeholder:"Announcement content..."})]})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsxs("button",{className:"btn btn-secondary",onClick:()=>k(!1),children:[a.jsx(Pn,{size:16})," ",f("common.cancel")||"Cancel"]}),a.jsxs("button",{className:"btn btn-primary",onClick:V,children:[a.jsx(Oa,{size:16})," ",f("common.save")||"Save"]})]})]})}),N&&a.jsx("div",{className:"modal-overlay",onClick:()=>b(!1),children:a.jsxs("div",{className:"modal",onClick:K=>K.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h3",{children:H?f("admin.editLink")||"Edit Link":f("admin.addLink")||"Add Link"}),a.jsx("button",{className:"btn-icon",onClick:()=>b(!1),children:a.jsx(Pn,{size:20})})]}),a.jsxs("div",{className:"modal-body",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label required",children:f("common.title")||"Title"}),a.jsx("input",{type:"text",className:"form-input",value:R.title,onChange:K=>q(W=>({...W,title:K.target.value})),placeholder:"Link title..."})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label required",children:f("common.url")||"URL"}),a.jsx("input",{type:"url",className:"form-input",value:R.url,onChange:K=>q(W=>({...W,url:K.target.value})),placeholder:"https://..."})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:f("common.description")||"Description"}),a.jsx("input",{type:"text",className:"form-input",value:R.description,onChange:K=>q(W=>({...W,description:K.target.value})),placeholder:"Brief description..."})]})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsxs("button",{className:"btn btn-secondary",onClick:()=>b(!1),children:[a.jsx(Pn,{size:16})," ",f("common.cancel")||"Cancel"]}),a.jsxs("button",{className:"btn btn-primary",onClick:ae,children:[a.jsx(Oa,{size:16})," ",f("common.save")||"Save"]})]})]})})]})}function HW(){const{t:e}=Wt(),{user:t}=Ft(),{getActiveChats:n,getChat:r,sendMessage:s,closeChat:i,deleteChat:l,markAsRead:u,getTotalUnreadAdmin:d,refreshChats:f,chats:m}=Gh(),[p,x]=T.useState(null),[v,k]=T.useState(""),[y,S]=T.useState("all"),[C,D]=T.useState(!1),N=T.useRef(null);T.useEffect(()=>{const F=setInterval(()=>{f()},2e3);return()=>clearInterval(F)},[f]);const b=()=>{D(!0),f(),setTimeout(()=>D(!1),500)},L=(()=>{let F=[...m];return y==="active"?F=F.filter(U=>U.status==="active"):y==="closed"&&(F=F.filter(U=>U.status==="closed")),F.sort((U,I)=>new Date(I.updatedAt)-new Date(U.updatedAt))})();T.useEffect(()=>{N.current&&N.current.scrollIntoView({behavior:"smooth"})},[p,m]);const R=p?r(p):null,q=F=>{x(F),u(F)},O=F=>{F.preventDefault(),!(!v.trim()||!p)&&(s(p,v.trim(),"agent"),k(""))},V=F=>{window.confirm("Are you sure you want to close this chat?")&&(i(F),p===F&&x(null))},X=(F,U)=>{U.stopPropagation(),window.confirm("Are you sure you want to permanently delete this chat? This cannot be undone.")&&(l(F),p===F&&x(null))},M=F=>{const U=new Date(F),Z=new Date-U,Y=Math.floor(Z/6e4),P=Math.floor(Z/36e5),ne=Math.floor(Z/864e5);return Y<1?"Just now":Y<60?`${Y}m ago`:P<24?`${P}h ago`:ne<7?`${ne}d ago`:U.toLocaleDateString()},me=F=>new Date(F).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),ae=F=>{if(!F.messages.length)return"No messages yet";const U=F.messages[F.messages.length-1];return(U.sender==="agent"?"You: ":"")+(U.text.length>40?U.text.substring(0,40)+"...":U.text)},ce=F=>F.messages.filter(U=>(U.sender==="user"||U.sender==="guest")&&!U.read).length,ue=F=>F.userName||F.guestName||F.guestEmail||"Unknown Guest",K=d(),W=m.filter(F=>F.status==="active").length,j=m.filter(F=>F.status==="closed").length;return a.jsxs("div",{className:"page-list-layout",children:[a.jsx("div",{className:"page-list-header",children:a.jsx("div",{className:"section-header",children:a.jsxs("div",{className:"section-title",children:[a.jsx(Qo,{size:24}),a.jsx("h1",{children:e("chat.management")||"Chat Management"}),K>0&&a.jsxs("span",{className:"badge badge-primary",children:[K," unread"]})]})})}),a.jsx("div",{className:"page-list-content",children:a.jsxs("div",{className:"chat-management",children:[a.jsxs("div",{className:"chat-list-panel",children:[a.jsxs("div",{className:"chat-list-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[a.jsx("span",{children:"Chats"}),a.jsx("span",{className:"badge",children:L.length})]}),a.jsx("button",{onClick:b,className:"btn-icon",title:"Refresh chats",style:{background:"transparent",border:"none",cursor:"pointer",color:"var(--text-secondary)",padding:"4px",borderRadius:"4px",display:"flex",alignItems:"center",transition:"all 0.2s"},children:a.jsx(Xi,{size:16,className:C?"spin":"",style:{animation:C?"spin 0.5s linear infinite":"none"}})})]}),a.jsxs("div",{className:"chat-filter-tabs",style:{display:"flex",gap:"4px",padding:"8px 12px",borderBottom:"1px solid var(--border-color)",background:"var(--surface-light)"},children:[a.jsxs("button",{className:`chat-filter-btn ${y==="all"?"active":""}`,onClick:()=>S("all"),style:{padding:"6px 12px",borderRadius:"6px",border:"none",fontSize:"12px",cursor:"pointer",background:y==="all"?"var(--primary)":"transparent",color:y==="all"?"white":"var(--text-secondary)"},children:["All (",m.length,")"]}),a.jsxs("button",{className:`chat-filter-btn ${y==="active"?"active":""}`,onClick:()=>S("active"),style:{padding:"6px 12px",borderRadius:"6px",border:"none",fontSize:"12px",cursor:"pointer",background:y==="active"?"var(--success)":"transparent",color:y==="active"?"white":"var(--text-secondary)"},children:["Active (",W,")"]}),a.jsxs("button",{className:`chat-filter-btn ${y==="closed"?"active":""}`,onClick:()=>S("closed"),style:{padding:"6px 12px",borderRadius:"6px",border:"none",fontSize:"12px",cursor:"pointer",background:y==="closed"?"var(--text-muted)":"transparent",color:y==="closed"?"white":"var(--text-secondary)"},children:["Closed (",j,")"]})]}),a.jsx("div",{className:"chat-list",children:L.length===0?a.jsxs("div",{className:"chat-empty-state",style:{padding:"40px 20px"},children:[a.jsx(Qo,{size:40}),a.jsxs("p",{children:["No ",y!=="all"?y:""," chats"]})]}):L.map(F=>{const U=ce(F),I=F.status==="closed";return a.jsxs("div",{className:`chat-list-item ${p===F.id?"active":""} ${I?"closed":""}`,onClick:()=>q(F.id),style:{opacity:I?.7:1,position:"relative"},children:[a.jsxs("div",{className:"chat-list-item-header",children:[a.jsxs("span",{className:"chat-list-item-name",children:[ue(F),I&&a.jsx("span",{style:{marginLeft:"8px",fontSize:"10px",padding:"2px 6px",borderRadius:"4px",background:"var(--text-muted)",color:"white"},children:"Closed"})]}),a.jsx("span",{className:"chat-list-item-time",children:M(F.updatedAt)})]}),a.jsxs("div",{className:"chat-list-item-unread",children:[a.jsx("span",{className:"chat-list-item-preview",children:ae(F)}),U>0&&a.jsx("span",{className:"dot"}),I&&a.jsx("button",{className:"btn-icon-delete",onClick:Z=>X(F.id,Z),title:"Delete chat",style:{marginLeft:"8px",padding:"4px",border:"none",background:"transparent",color:"var(--danger)",cursor:"pointer",borderRadius:"4px"},children:a.jsx(La,{size:14})})]})]},F.id)})})]}),a.jsx("div",{className:"chat-conversation-panel",children:R?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"chat-conversation-header",children:[a.jsxs("div",{className:"chat-conversation-info",children:[a.jsxs("h3",{children:[ue(R),R.status==="closed"&&a.jsx("span",{style:{marginLeft:"8px",fontSize:"12px",padding:"2px 8px",borderRadius:"4px",background:"var(--text-muted)",color:"white"},children:"Closed"})]}),a.jsxs("p",{children:[R.guestEmail&&a.jsxs(a.Fragment,{children:[a.jsx($h,{size:12})," ",R.guestEmail]}),R.companyName&&a.jsxs(a.Fragment,{children:[a.jsx(b3,{size:12})," ",R.companyName]}),!R.guestEmail&&!R.companyName&&a.jsxs(a.Fragment,{children:[a.jsx(tr,{size:12})," Started ",M(R.createdAt)]})]})]}),a.jsx("div",{className:"chat-conversation-actions",children:R.status==="active"?a.jsxs("button",{className:"btn btn-danger btn-sm",onClick:()=>V(R.id),children:[a.jsx(St,{size:14}),"Close Chat"]}):a.jsxs("button",{className:"btn btn-danger btn-sm",onClick:F=>X(R.id,F),children:[a.jsx(La,{size:14}),"Delete"]})})]}),a.jsxs("div",{className:"chat-conversation-messages",children:[R.messages.map(F=>a.jsxs("div",{className:`chat-message ${F.sender}`,children:[F.text,a.jsx("span",{className:"chat-message-time",children:me(F.timestamp)})]},F.id)),a.jsx("div",{ref:N})]}),R.status==="active"?a.jsxs("form",{className:"chat-conversation-input",onSubmit:O,children:[a.jsx("input",{type:"text",placeholder:"Type your reply...",value:v,onChange:F=>k(F.target.value),autoFocus:!0}),a.jsxs("button",{type:"submit",className:"btn btn-primary",disabled:!v.trim(),children:[a.jsx(Jp,{size:16}),"Send"]})]}):a.jsx("div",{className:"chat-conversation-input",style:{justifyContent:"center",background:"var(--surface-light)",color:"var(--text-muted)"},children:"This chat has been closed"})]}):a.jsxs("div",{className:"chat-empty-state",children:[a.jsx(Qo,{size:60}),a.jsx("h3",{children:"Select a chat"}),a.jsx("p",{children:"Choose a conversation from the list to start replying"})]})})]})})]})}const is={survey:{label:"Survey",icon:wn,order:1},eor:{label:"EOR",icon:jr,order:2},shunting:{label:"Shunting",icon:Va,order:3},repairOrder:{label:"Repair Order",icon:Aa,order:4},washing:{label:"Washing",icon:Zn,order:5},preinspection:{label:"Pre-Inspection",icon:hs,order:6},stacking:{label:"Stacking",icon:Kr,order:7}};function GW(){var ne;const{containers:e,reloadFromStorage:t}=qt(),{canPerform:n}=Ft(),{t:r}=Wt(),s=en(),[i,l]=T.useState(""),[u,d]=T.useState(""),[f,m]=T.useState("container"),[p,x]=T.useState(null),[v,k]=T.useState(null),[y,S]=T.useState([]),[C,D]=T.useState([]),[N,b]=T.useState([]),[H,L]=T.useState([]),[R,q]=T.useState([]),[O,V]=T.useState([]),[X,M]=T.useState([]),[me,ae]=T.useState([]),ce=T.useCallback(()=>{S(JSON.parse(localStorage.getItem("mnr_surveys")||"[]")),D(JSON.parse(localStorage.getItem("mnr_eors")||"[]")),b(JSON.parse(localStorage.getItem("mnr_repair_orders")||"[]")),L(JSON.parse(localStorage.getItem("mnr_shunting")||"[]")),q(JSON.parse(localStorage.getItem("mnr_washing")||"[]")),V(JSON.parse(localStorage.getItem("mnr_preinspections")||"[]")),M(JSON.parse(localStorage.getItem("mnr_stacking")||"[]")),ae(JSON.parse(localStorage.getItem("mnr_containers")||"[]"))},[]);T.useEffect(()=>{ce()},[ce]);const ue=T.useMemo(()=>{if(!v)return[];const J=[],de=v.id,E=v.containerNumber;return y.filter(A=>A.containerId===de||A.containerNumber===E).forEach(A=>{J.push({type:"survey",id:A.id,transactionId:A.id,status:A.status,createdAt:A.createdAt,data:A,description:`Survey ${A.status==="COMPLETED"?"Completed":A.status==="DRAFT"?"Draft":A.status}`})}),C.filter(A=>A.containerId===de||A.containerNumber===E).forEach(A=>{J.push({type:"eor",id:A.id,transactionId:A.surveyId||A.id,status:A.status,createdAt:A.createdAt,data:A,description:`EOR ${A.status.replace(/_/g," ")}`})}),H.filter(A=>A.containerId===de||A.containerNumber===E).forEach(A=>{J.push({type:"shunting",id:A.id,transactionId:A.surveyId||A.id,status:A.status,createdAt:A.createdAt,data:A,description:`Shunting ${A.status==="COMPLETED"?"Completed":A.status==="IN_PROGRESS"?"In Progress":"New"}`})}),N.filter(A=>A.containerId===de||A.containerNumber===E).forEach(A=>{J.push({type:"repairOrder",id:A.id,transactionId:A.surveyId||A.id,status:A.status,createdAt:A.createdAt,data:A,description:`Repair Order ${A.status.replace(/_/g," ")}`})}),R.filter(A=>A.containerId===de||A.containerNumber===E).forEach(A=>{J.push({type:"washing",id:A.id,transactionId:A.surveyId||A.id,status:A.status,createdAt:A.createdAt,data:A,description:`Washing ${A.status==="COMPLETED"?"Completed":A.status==="IN_PROGRESS"?"In Progress":A.status}`})}),O.filter(A=>A.containerId===de||A.containerNumber===E).forEach(A=>{J.push({type:"preinspection",id:A.id,transactionId:A.surveyId||A.id,status:A.status,createdAt:A.createdAt,data:A,description:`Pre-Inspection ${A.result?`(${A.result})`:A.status}`})}),X.filter(A=>A.containerId===de||A.containerNumber===E).forEach(A=>{J.push({type:"stacking",id:A.id,transactionId:A.surveyId||A.id,status:A.status,createdAt:A.createdAt,data:A,description:`Stacking ${A.status==="COMPLETED"?"Completed":A.status}`})}),J.sort((A,he)=>new Date(he.createdAt)-new Date(A.createdAt))},[v,y,C,N,H,R,O,X]),K=T.useMemo(()=>{if(!i||i.length<3)return[];const J=i.toLowerCase(),de=[];return y.filter(E=>{var A;return(A=E.id)==null?void 0:A.toLowerCase().includes(J)}).forEach(E=>{de.push({transactionId:E.id,containerNumber:E.containerNumber,containerId:E.containerId,type:"Survey"})}),C.filter(E=>{var A,he;return((A=E.surveyId)==null?void 0:A.toLowerCase().includes(J))||((he=E.id)==null?void 0:he.toLowerCase().includes(J))}).forEach(E=>{const A=E.surveyId||E.id;de.some(he=>he.transactionId===A)||de.push({transactionId:A,containerNumber:E.containerNumber,containerId:E.containerId,type:"EOR"})}),de.slice(0,10)},[i,y,C]),W=T.useMemo(()=>{if(!u||u.length<3)return[];const J=u.toLowerCase();return me.filter(E=>E.containerNumber.toLowerCase().includes(J)).map(E=>{const A=y.filter(he=>he.containerId===E.id||he.containerNumber===E.containerNumber).map(he=>he.id);return{...E,transactions:A}}).slice(0,10)},[u,me,y]),j=(J,de,E)=>{x(J);const A=me.find(he=>he.id===de||he.containerNumber===E);A&&k(A)},F=J=>J.length===0?"STACKING":J.some(we=>we.type==="stacking"&&we.status==="COMPLETED")?"AV":J.some(we=>we.type==="stacking")||J.some(we=>{var fe;return we.type==="preinspection"&&((fe=we.data)==null?void 0:fe.result)==="ACCEPTED"})?"COMPLETED":J.some(we=>we.type==="preinspection")||J.some(we=>we.type==="repairOrder")?"REPAIR":J.some(we=>we.type==="shunting"&&we.status==="COMPLETED")||J.some(we=>we.type==="eor"&&(we.status==="APPROVED"||we.status==="APPROVED_AUTO"))?"AR":J.some(we=>we.type==="eor")||J.some(we=>we.type==="survey")?"DM":"STACKING",U=J=>{if(!n("delete_job")){s.error("You do not have permission to delete jobs");return}const de=v.id;switch(J.type){case"survey":{const G=y.filter(Ie=>Ie.id!==J.id);localStorage.setItem("mnr_surveys",JSON.stringify(G)),S(G);break}case"eor":{const G=C.filter(Ie=>Ie.id!==J.id);localStorage.setItem("mnr_eors",JSON.stringify(G)),D(G);break}case"shunting":{const G=H.filter(Ie=>Ie.id!==J.id);localStorage.setItem("mnr_shunting",JSON.stringify(G)),L(G);break}case"repairOrder":{const G=N.filter(Ie=>Ie.id!==J.id);localStorage.setItem("mnr_repair_orders",JSON.stringify(G)),b(G);break}case"washing":{const G=R.filter(Ie=>Ie.id!==J.id);localStorage.setItem("mnr_washing",JSON.stringify(G)),q(G);break}case"preinspection":{const G=O.filter(Ie=>Ie.id!==J.id);localStorage.setItem("mnr_preinspections",JSON.stringify(G)),V(G);break}case"stacking":{const G=X.filter(Ie=>Ie.id!==J.id);localStorage.setItem("mnr_stacking",JSON.stringify(G)),M(G);break}}const E=ue.filter(G=>G.id!==J.id),A=F(E),he=me.map(G=>G.id===de?{...G,status:A}:G);localStorage.setItem("mnr_containers",JSON.stringify(he)),ae(he),k(G=>G?{...G,status:A}:null),s.success(`Deleted ${J.description}. Container status: ${A}. ${E.length} job(s) remaining.`),t()},I=J=>{const de=is[J];return de?de.icon:wn},Z=J=>{if(!J)return"badge";const de=J.toLowerCase();return de.includes("completed")||de.includes("approved")||de.includes("accepted")?"badge badge-completed":de.includes("progress")||de.includes("new")||de.includes("draft")?"badge badge-draft":de.includes("reject")||de.includes("rework")?"badge badge-rejected":"badge"},Y=J=>{var A;if(ue.length===0)return!1;const de=Math.max(...ue.map(he=>{var G;return((G=is[he.type])==null?void 0:G.order)||0}));return(((A=is[J.type])==null?void 0:A.order)||0)===de},P=J=>{var A;const de=Math.max(...ue.map(he=>{var G;return((G=is[he.type])==null?void 0:G.order)||0})),E=ue.find(he=>{var G;return((G=is[he.type])==null?void 0:G.order)===de});return E?(A=is[E.type])==null?void 0:A.label:""};return a.jsxs("div",{className:"page",children:[a.jsxs("div",{className:"page-header",children:[a.jsxs("div",{children:[a.jsx("h2",{children:"Job Monitoring"}),a.jsx("p",{children:"Search by Transaction ID or Container Number to view and delete individual jobs"})]}),a.jsx(_s,{screenId:"job_monitoring"})]}),a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Search by Transaction ID"}),a.jsxs("div",{style:{position:"relative"},children:[a.jsx("input",{type:"text",className:"form-control",placeholder:"Enter Transaction ID (min 3 chars)...",value:i,onChange:J=>l(J.target.value),style:{paddingLeft:"2.5rem"}}),a.jsx(bn,{size:18,style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)"}})]})]}),K.length>0&&!v&&a.jsxs("div",{className:"mt-4",children:[a.jsx("h4",{children:"Transaction Search Results"}),a.jsx("div",{className:"table-container",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Transaction ID"}),a.jsx("th",{children:"Container Number"}),a.jsx("th",{children:"Source"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:K.map(J=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("span",{style:{fontWeight:500},children:J.transactionId})}),a.jsx("td",{children:a.jsx("span",{className:"container-number",children:J.containerNumber})}),a.jsx("td",{children:a.jsx("span",{className:"badge badge-draft",children:J.type})}),a.jsx("td",{children:a.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>j(J.transactionId,J.containerId,J.containerNumber),children:"View Jobs"})})]},J.transactionId))})]})})]})]}),a.jsxs("div",{className:"card mt-4",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Search by Container Number"}),a.jsxs("div",{style:{position:"relative"},children:[a.jsx("input",{type:"text",className:"form-control",placeholder:"Enter Container Number (min 3 chars)...",value:u,onChange:J=>d(J.target.value),style:{paddingLeft:"2.5rem"}}),a.jsx(bn,{size:18,style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",color:"var(--neutral-400)"}})]})]}),W.length>0&&!v&&a.jsxs("div",{className:"mt-4",children:[a.jsx("h4",{children:"Container Search Results"}),a.jsx("div",{className:"table-container",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Container Number"}),a.jsx("th",{children:"Liner"}),a.jsx("th",{children:"Current Status"}),a.jsx("th",{children:"Transaction IDs"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:W.map(J=>{var de;return a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("span",{className:"container-number",children:J.containerNumber})}),a.jsx("td",{children:J.liner}),a.jsx("td",{children:a.jsx("span",{className:`badge badge-${(de=J.status)==null?void 0:de.toLowerCase()}`,children:J.status})}),a.jsx("td",{children:J.transactions.length>0?a.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px"},children:J.transactions.map(E=>a.jsx("span",{className:"badge badge-draft",style:{cursor:"pointer",fontSize:"0.7rem"},onClick:()=>j(E,J.id,J.containerNumber),children:E},E))}):a.jsx("span",{className:"text-muted",children:"No transactions"})}),a.jsx("td",{children:a.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>k(J),children:"View All Jobs"})})]},J.id)})})]})})]}),v&&a.jsxs("div",{className:"mt-4",children:[a.jsx("div",{style:{padding:"1rem",background:"var(--neutral-800)",borderRadius:"8px",marginBottom:"1rem"},children:a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("div",{children:[a.jsxs("h3",{style:{margin:0,display:"flex",alignItems:"center",gap:"0.5rem"},children:[a.jsx("span",{className:"container-number",children:v.containerNumber}),a.jsx("span",{className:`badge badge-${(ne=v.status)==null?void 0:ne.toLowerCase()}`,style:{fontSize:"0.9rem"},children:v.status})]}),a.jsxs("p",{style:{margin:"0.5rem 0 0 0",color:"var(--neutral-400)"},children:["Liner: ",v.liner," | Size: ",v.size]})]}),a.jsxs("button",{className:"btn btn-ghost",onClick:()=>k(null),children:[a.jsx(Xi,{size:16})," Clear Selection"]})]})}),a.jsx("div",{style:{display:"flex",gap:"0.25rem",marginBottom:"1rem",flexWrap:"wrap"},children:Object.entries(is).map(([J,de])=>{const E=ue.some(G=>G.type===J),A=ue.some(G=>G.type===J&&(G.status==="COMPLETED"||G.status==="APPROVED"||G.status==="APPROVED_AUTO")),he=de.icon;return a.jsxs("div",{style:{padding:"0.5rem 1rem",background:E?A?"var(--success-500)":"var(--primary-500)":"var(--neutral-700)",borderRadius:"4px",display:"flex",alignItems:"center",gap:"0.5rem",opacity:E?1:.5},children:[a.jsx(he,{size:16}),a.jsx("span",{style:{fontSize:"0.85rem"},children:de.label}),A&&a.jsx(St,{size:14})]},J)})}),a.jsxs("h4",{children:["Job History (",ue.length," jobs)"]}),ue.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx(wn,{size:48}),a.jsx("h3",{children:"No jobs found"}),a.jsx("p",{children:"This container has no workflow jobs. All jobs have been deleted."})]}):a.jsx("div",{className:"table-container",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Type"}),a.jsx("th",{children:"Transaction ID"}),a.jsx("th",{children:"Description"}),a.jsx("th",{children:"Status"}),a.jsx("th",{children:"Created At"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:ue.map(J=>{var E,A;const de=I(J.type);return a.jsxs("tr",{children:[a.jsx("td",{children:a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[a.jsx(de,{size:16}),(E=is[J.type])==null?void 0:E.label]})}),a.jsx("td",{style:{fontWeight:500,fontSize:"0.85rem"},children:J.id}),a.jsx("td",{children:J.description}),a.jsx("td",{children:a.jsx("span",{className:Z(J.status),children:J.status})}),a.jsx("td",{style:{fontSize:"0.85rem"},children:J.createdAt?new Date(J.createdAt).toLocaleString():"-"}),a.jsx("td",{children:n("delete_job")&&(Y(J)?a.jsxs("button",{className:"btn btn-danger btn-sm",onClick:()=>U(J),title:`Delete this ${(A=is[J.type])==null?void 0:A.label} job`,children:[a.jsx(La,{size:14})," Delete"]}):a.jsxs("button",{className:"btn btn-ghost btn-sm",disabled:!0,title:`Delete ${P()} first`,style:{opacity:.5,cursor:"not-allowed"},children:[a.jsx(La,{size:14})," Blocked"]}))})]},`${J.type}-${J.id}`)})})]})}),a.jsxs("div",{className:"mt-4",style:{padding:"1rem",background:"var(--primary-900)",borderRadius:"8px",border:"1px solid var(--primary-500)"},children:[a.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[a.jsx(Dr,{size:18,color:"var(--warning-500)"}),a.jsx("strong",{children:"Delete Note:"})]}),a.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.9rem"},children:["Jobs must be deleted in reverse workflow order. You can only delete the",a.jsx("strong",{children:" latest workflow step"}),' first (e.g., delete Repair Order before Shunting, delete Shunting before EOR, delete EOR before Survey). "Blocked" jobs require you to delete the later steps first.']})]})]})]})]})}const $W=()=>{const e=cn(),{washingOrders:t,containers:n,startWashingOrder:r,approveWashingOrder:s,rejectWashingOrder:i}=qt(),{getCodeList:l}=On(),{t:u}=Wt(),{user:d}=Ft(),{addToast:f}=en(),[m,p]=T.useState(""),[x,v]=T.useState("ALL"),[k,y]=T.useState("ALL"),[S,C]=T.useState("ALL"),D=l("CLEANING_PROGRAMS")||[],N=l("WASH_BAYS")||[],b={PENDING_APPROVAL:{label:"Pending Approval",color:"warning",icon:tr},PENDING_SCHEDULE:{label:"Pending Schedule",color:"info",icon:ls},SCHEDULED:{label:"Scheduled",color:"info",icon:ls},IN_PROGRESS:{label:"In Progress",color:"primary",icon:ai},PENDING_QC:{label:"Pending QC",color:"warning",icon:qr},REWORK:{label:"Rework Required",color:"danger",icon:Xi},COMPLETED:{label:"Completed",color:"success",icon:St},REJECTED:{label:"Rejected",color:"danger",icon:Gr}},H=T.useMemo(()=>t.filter(ae=>{var ce,ue,K;if(m){const W=m.toLowerCase();if(!((ce=ae.containerNumber)!=null&&ce.toLowerCase().includes(W))&&!((ue=ae.liner)!=null&&ue.toLowerCase().includes(W))&&!((K=ae.id)!=null&&K.toLowerCase().includes(W)))return!1}return!(x!=="ALL"&&ae.status!==x||k!=="ALL"&&ae.assignedBay!==k||S!=="ALL"&&ae.cleaningProgram!==S)}),[t,m,x,k,S]),L=T.useMemo(()=>({pendingApproval:t.filter(ae=>ae.status==="PENDING_APPROVAL").length,pendingSchedule:t.filter(ae=>ae.status==="PENDING_SCHEDULE").length,scheduled:t.filter(ae=>ae.status==="SCHEDULED").length,inProgress:t.filter(ae=>ae.status==="IN_PROGRESS").length,pendingQC:t.filter(ae=>ae.status==="PENDING_QC").length,rework:t.filter(ae=>ae.status==="REWORK").length,completedToday:t.filter(ae=>{if(ae.status!=="COMPLETED")return!1;const ce=new Date().toDateString();return new Date(ae.completedAt).toDateString()===ce}).length,total:t.length}),[t]),R=T.useMemo(()=>n.filter(ae=>["PENDING_WASH","COMPLETED","AV","STACKING","DM"].includes(ae.status)?!t.some(ue=>ue.containerId===ae.id&&!["COMPLETED"].includes(ue.status)):!1),[n,t]),q=ae=>{r(ae.id,d.username),f(u("washing.cleaningStarted")||"Cleaning started","success")},O=ae=>{s(ae.id,d.username),f(u("washing.orderApproved")||"Washing order approved","success")},V=ae=>{const ce=prompt(u("washing.enterRejectionReason")||"Enter rejection reason:");ce&&(i(ae.id,d.username,ce),f(u("washing.orderRejected")||"Washing order rejected","warning"))},X=ae=>D.find(ce=>ce.code===ae),M=ae=>N.find(ce=>ce.code===ae),me=ae=>ae?new Date(ae).toLocaleDateString("en-GB",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"}):"-";return a.jsxs("div",{className:"washing-list-page",children:[a.jsxs("div",{className:"page-header",children:[a.jsxs("div",{className:"header-content",children:[a.jsxs("h1",{children:[a.jsx(Zn,{size:24})," ",u("washing.title")||"Washing Station"]}),a.jsx("p",{className:"text-muted",children:u("washing.subtitle")||"Container cleaning and sanitization management"})]}),a.jsxs("div",{className:"header-actions",children:[a.jsx(_s,{screenId:"washing"}),a.jsxs("button",{className:"btn btn-primary",onClick:()=>e("/washing/new"),children:[a.jsx(Zn,{size:16})," ",u("washing.newWashingOrder")||"New Washing Order"]})]})]}),a.jsxs("div",{className:"stats-grid",children:[a.jsxs("div",{className:"stat-card warning",children:[a.jsx("div",{className:"stat-icon",children:a.jsx(Wy,{size:24})}),a.jsxs("div",{className:"stat-info",children:[a.jsx("span",{className:"stat-value",children:L.pendingApproval}),a.jsx("span",{className:"stat-label",children:u("washing.pendingApproval")||"Pending Approval"})]})]}),a.jsxs("div",{className:"stat-card info",children:[a.jsx("div",{className:"stat-icon",children:a.jsx(tr,{size:24})}),a.jsxs("div",{className:"stat-info",children:[a.jsx("span",{className:"stat-value",children:L.pendingSchedule}),a.jsx("span",{className:"stat-label",children:u("washing.pendingSchedule")||"Pending Schedule"})]})]}),a.jsxs("div",{className:"stat-card info",children:[a.jsx("div",{className:"stat-icon",children:a.jsx(ls,{size:24})}),a.jsxs("div",{className:"stat-info",children:[a.jsx("span",{className:"stat-value",children:L.scheduled}),a.jsx("span",{className:"stat-label",children:u("washing.scheduled")||"Scheduled"})]})]}),a.jsxs("div",{className:"stat-card primary",children:[a.jsx("div",{className:"stat-icon",children:a.jsx(ai,{size:24})}),a.jsxs("div",{className:"stat-info",children:[a.jsx("span",{className:"stat-value",children:L.inProgress}),a.jsx("span",{className:"stat-label",children:u("washing.inProgress")||"In Progress"})]})]}),a.jsxs("div",{className:"stat-card warning",children:[a.jsx("div",{className:"stat-icon",children:a.jsx(qr,{size:24})}),a.jsxs("div",{className:"stat-info",children:[a.jsx("span",{className:"stat-value",children:L.pendingQC}),a.jsx("span",{className:"stat-label",children:u("washing.pendingQC")||"Pending QC"})]})]}),a.jsxs("div",{className:"stat-card danger",children:[a.jsx("div",{className:"stat-icon",children:a.jsx(Xi,{size:24})}),a.jsxs("div",{className:"stat-info",children:[a.jsx("span",{className:"stat-value",children:L.rework}),a.jsx("span",{className:"stat-label",children:u("washing.rework")||"Rework"})]})]}),a.jsxs("div",{className:"stat-card success",children:[a.jsx("div",{className:"stat-icon",children:a.jsx(St,{size:24})}),a.jsxs("div",{className:"stat-info",children:[a.jsx("span",{className:"stat-value",children:L.completedToday}),a.jsx("span",{className:"stat-label",children:u("washing.completedToday")||"Completed Today"})]})]})]}),a.jsxs("div",{className:"filters-bar",children:[a.jsxs("div",{className:"search-box",children:[a.jsx(bn,{size:16}),a.jsx("input",{type:"text",placeholder:u("washing.searchPlaceholder")||"Search container, liner...",value:m,onChange:ae=>p(ae.target.value)})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx(Xp,{size:16}),a.jsxs("select",{value:x,onChange:ae=>v(ae.target.value),children:[a.jsx("option",{value:"ALL",children:u("common.allStatuses")||"All Statuses"}),Object.entries(b).map(([ae,ce])=>a.jsx("option",{value:ae,children:ce.label},ae))]}),a.jsxs("select",{value:k,onChange:ae=>y(ae.target.value),children:[a.jsx("option",{value:"ALL",children:u("washing.allBays")||"All Bays"}),N.filter(ae=>ae.active!==!1).map(ae=>a.jsx("option",{value:ae.code,children:ae.name},ae.code))]}),a.jsxs("select",{value:S,onChange:ae=>C(ae.target.value),children:[a.jsx("option",{value:"ALL",children:u("washing.allPrograms")||"All Programs"}),D.filter(ae=>ae.active!==!1).map(ae=>a.jsx("option",{value:ae.code,children:ae.name},ae.code))]})]})]}),a.jsx("div",{className:"data-table-container",children:a.jsxs("table",{className:"data-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:u("columns.containerNumber")||"Container"}),a.jsx("th",{children:u("columns.type")||"Type"}),a.jsx("th",{children:u("columns.liner")||"Liner"}),a.jsx("th",{children:u("washing.program")||"Program"}),a.jsx("th",{children:u("washing.bay")||"Bay"}),a.jsx("th",{children:u("common.status")||"Status"}),a.jsx("th",{children:u("washing.scheduledAt")||"Scheduled"}),a.jsx("th",{children:u("common.actions")||"Actions"})]})}),a.jsx("tbody",{children:H.length===0?a.jsx("tr",{children:a.jsxs("td",{colSpan:"8",className:"empty-state",children:[a.jsx(Zn,{size:48}),a.jsx("p",{children:u("washing.noOrders")||"No washing orders found"})]})}):H.map(ae=>{var j;const ce=b[ae.status]||b.PENDING_SCHEDULE,ue=ce.icon,K=X(ae.cleaningProgram),W=M(ae.assignedBay);return a.jsxs("tr",{className:ae.status==="REWORK"?"rework-row":"",children:[a.jsx("td",{children:a.jsxs("div",{className:"container-cell",children:[a.jsx("span",{className:"container-number",children:ae.containerNumber}),a.jsx("span",{className:"container-id",children:ae.id})]})}),a.jsx("td",{children:a.jsx("span",{className:`type-badge ${(j=ae.containerType)==null?void 0:j.toLowerCase()}`,children:ae.containerType})}),a.jsx("td",{children:ae.liner}),a.jsx("td",{children:a.jsx("span",{className:"program-badge",children:(K==null?void 0:K.name)||ae.cleaningProgram})}),a.jsx("td",{children:W?a.jsxs("span",{className:"bay-badge",children:[a.jsx(Ho,{size:12})," ",W.name]}):"-"}),a.jsx("td",{children:a.jsxs("span",{className:`status-badge ${ce.color}`,children:[a.jsx(ue,{size:14}),ce.label,ae.reworkCount>0&&a.jsxs("span",{className:"rework-count",children:["#",ae.reworkCount]})]})}),a.jsx("td",{children:me(ae.scheduledAt)}),a.jsx("td",{children:a.jsxs("div",{className:"action-buttons",children:[ae.status==="PENDING_APPROVAL"&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"btn btn-sm btn-success",onClick:()=>O(ae),title:u("washing.approve")||"Approve",children:[a.jsx(Wy,{size:14})," ",u("common.approve")||"Approve"]}),a.jsxs("button",{className:"btn btn-sm btn-danger",onClick:()=>V(ae),title:u("washing.reject")||"Reject",children:[a.jsx(Z3,{size:14})," ",u("common.reject")||"Reject"]})]}),ae.status==="PENDING_SCHEDULE"&&a.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>e(`/washing/schedule/${ae.id}`),children:[a.jsx(ls,{size:14})," Schedule"]}),ae.status==="SCHEDULED"&&a.jsxs("button",{className:"btn btn-sm btn-success",onClick:()=>q(ae),children:[a.jsx(ai,{size:14})," Start"]}),ae.status==="IN_PROGRESS"&&a.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>e(`/washing/work/${ae.id}`),children:[a.jsx(Zn,{size:14})," Work"]}),(ae.status==="PENDING_QC"||ae.status==="REWORK")&&a.jsxs("button",{className:"btn btn-sm btn-warning",onClick:()=>e(`/washing/qc/${ae.id}`),children:[a.jsx(qr,{size:14})," QC"]}),ae.status==="COMPLETED"&&ae.certificateNumber&&a.jsxs("button",{className:"btn btn-sm btn-ghost",onClick:()=>e(`/washing/certificate/${ae.id}`),children:[a.jsx(wn,{size:14})," Certificate"]}),a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:()=>e(`/washing/detail/${ae.id}`),children:a.jsx(qr,{size:14})})]})})]},ae.id)})})]})}),R.length>0&&a.jsxs("div",{className:"ready-section",children:[a.jsxs("h3",{children:[a.jsx(Va,{size:18})," ",u("washing.readyForWashing")||"Containers Ready for Washing"," (",R.length,")"]}),a.jsxs("div",{className:"search-box",style:{marginBottom:"16px",maxWidth:"400px"},children:[a.jsx(bn,{size:16}),a.jsx("input",{type:"text",placeholder:u("washing.searchContainer")||"Search container number...",value:m,onChange:ae=>p(ae.target.value)})]}),a.jsxs("div",{className:"data-table-container",style:{maxHeight:"400px",overflowY:"auto"},children:[a.jsxs("table",{className:"data-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:u("columns.containerNumber")}),a.jsx("th",{children:u("columns.type")}),a.jsx("th",{children:u("columns.liner")}),a.jsx("th",{children:u("columns.containerStatus")}),a.jsx("th",{children:u("common.actions")})]})}),a.jsx("tbody",{children:R.filter(ae=>{var ce;return!m||ae.containerNumber.toLowerCase().includes(m.toLowerCase())||((ce=ae.liner)==null?void 0:ce.toLowerCase().includes(m.toLowerCase()))}).slice(0,50).map(ae=>{var ce,ue;return a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("span",{className:"container-number",children:ae.containerNumber})}),a.jsx("td",{children:a.jsx("span",{className:`type-badge ${(ce=ae.type)==null?void 0:ce.toLowerCase()}`,children:ae.type})}),a.jsx("td",{children:ae.liner}),a.jsx("td",{children:a.jsx("span",{className:`status-badge status-${(ue=ae.status)==null?void 0:ue.toLowerCase()}`,children:ae.status})}),a.jsx("td",{children:a.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>e(`/washing/new?containerId=${ae.id}`),children:[a.jsx(Zn,{size:14})," ",u("washing.createOrder")||"Create Order"]})})]},ae.id)})})]}),R.length>50&&a.jsxs("p",{className:"text-muted",style:{padding:"12px",textAlign:"center"},children:["Showing 50 of ",R.length," containers. Use search to find specific containers."]})]})]})]})},VW=()=>{const e=cn(),{id:t}=ws(),[n]=hi(),r=n.get("containerId"),{containers:s,getContainer:i,createWashingOrder:l,scheduleWashingOrder:u,getWashingOrder:d}=qt(),{getCodeList:f}=On(),{t:m}=Wt(),{user:p}=Ft(),{addToast:x}=en(),v=f("CLEANING_PROGRAMS")||[],k=f("CONTAMINATION_LEVELS")||[],y=f("WASH_BAYS")||[],S=f("WASHING_TEAMS")||[],C=T.useMemo(()=>r?i(r):null,[r,i]),[D,N]=T.useState(1),[b,H]=T.useState({containerId:r||"",containerNumber:(C==null?void 0:C.containerNumber)||"",containerType:(C==null?void 0:C.type)||"",liner:(C==null?void 0:C.liner)||"",contaminationLevel:"",interiorCondition:[],exteriorCondition:[],odorPresent:!1,pestPresent:!1,hazardousResidues:!1,inspectionNotes:"",cleaningProgram:"",assignedBay:"",assignedTeam:"",scheduledAt:"",safetyNotes:"",safetyRequirements:[]}),L=[{id:"dirt",label:"Dirt/Debris"},{id:"oil",label:"Oil/Grease"},{id:"chemical",label:"Chemical Residue"},{id:"odor",label:"Odor Present"},{id:"pest",label:"Pest Signs"},{id:"moisture",label:"Moisture"}],R=[{id:"dirty",label:"Dirty"},{id:"stained",label:"Stained"},{id:"graffiti",label:"Graffiti"}],q=[{id:"mask",label:m("washing.requiresMask")||"Requires Mask"},{id:"gloves",label:m("washing.requiresGloves")||"Requires Gloves"},{id:"chemical",label:m("washing.chemicalHandling")||"Chemical Handling"},{id:"ventilation",label:m("washing.ventilationRequired")||"Ventilation Required"},{id:"twoPerson",label:m("washing.twoPersonJob")||"2-Person Job"}];T.useEffect(()=>{C&&H(K=>({...K,containerId:C.id,containerNumber:C.containerNumber,containerType:C.type,liner:C.liner}))},[C]);const O=T.useMemo(()=>{if(!b.contaminationLevel)return null;const K=k.find(W=>W.code===b.contaminationLevel);return K!=null&&K.suggestedProgram?v.find(W=>W.code===K.suggestedProgram):b.containerType==="REEFER"?v.find(W=>W.code==="REEFER_DEEP"):null},[b.contaminationLevel,b.containerType,k,v]),V=T.useMemo(()=>{if(!b.contaminationLevel)return!1;const K=k.find(W=>W.code===b.contaminationLevel);return(K==null?void 0:K.safetyAlert)||b.hazardousResidues},[b.contaminationLevel,b.hazardousResidues,k]),X=K=>{const{name:W,value:j,type:F,checked:U}=K.target;H(I=>({...I,[W]:F==="checkbox"?U:j}))},M=(K,W)=>{H(j=>({...j,[K]:j[K].includes(W)?j[K].filter(F=>F!==W):[...j[K],W]}))},me=()=>{O&&H(K=>({...K,cleaningProgram:O.code}))},ae=()=>{if(!b.contaminationLevel){x("Please select contamination level","error");return}if(!b.cleaningProgram){x("Please select a cleaning program","error");return}N(2)},ce=K=>{if(K.preventDefault(),D===1){ae();return}if(!b.assignedBay){x("Please select a wash bay","error");return}if(!b.assignedTeam){x("Please select a team","error");return}const W=v.find(F=>F.code===b.cleaningProgram),j=l({...b,cost:(W==null?void 0:W.defaultCost)||0},p.username);u(j.id,{assignedBay:b.assignedBay,assignedTeam:b.assignedTeam,scheduledAt:b.scheduledAt||new Date().toISOString(),safetyNotes:b.safetyNotes,safetyRequirements:b.safetyRequirements},p.username),x(m("washing.orderCreated")||"Washing order created","success"),e("/washing")},ue=T.useMemo(()=>y.filter(K=>K.active?b.cleaningProgram==="CHEMICAL_CLEAN"?K.specialType==="CHEMICAL"||!K.specialType:b.containerType==="REEFER"||b.cleaningProgram==="REEFER_DEEP"?K.specialType==="REEFER"||!K.specialType:!0:!1),[y,b.cleaningProgram,b.containerType]);return a.jsxs("div",{className:"washing-form-page",children:[a.jsxs("div",{className:"page-header",children:[a.jsxs("div",{className:"header-content",children:[a.jsxs("button",{className:"btn btn-ghost",onClick:()=>e("/washing"),children:[a.jsx(hr,{size:20})," ",m("common.back")||"Back"]}),a.jsxs("h1",{children:[a.jsx(Zn,{size:24})," ",m("washing.newWashingOrder")||"New Washing Order"]})]}),a.jsxs("div",{className:"step-indicator",children:[a.jsxs("span",{className:`step ${D>=1?"active":""}`,children:["1. ",m("washing.initialInspection")||"Initial Inspection"]}),a.jsxs("span",{className:`step ${D>=2?"active":""}`,children:["2. ",m("washing.schedule")||"Schedule"]})]})]}),a.jsxs("form",{className:"washing-form",onSubmit:ce,children:[a.jsxs("div",{className:"form-section",children:[a.jsxs("h3",{className:"form-section-title",children:[a.jsx(xh,{size:18})," ",m("container.title")||"Container Info"]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:m("columns.containerNumber")||"Container Number"}),a.jsx("input",{type:"text",value:b.containerNumber,readOnly:!0,className:"readonly"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:m("columns.type")||"Type"}),a.jsx("input",{type:"text",value:b.containerType,readOnly:!0,className:"readonly"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:m("columns.liner")||"Liner"}),a.jsx("input",{type:"text",value:b.liner,readOnly:!0,className:"readonly"})]})]})]}),D===1&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"form-section",children:[a.jsxs("h3",{className:"form-section-title",children:[a.jsx(St,{size:18})," ",m("washing.initialInspection")||"Initial Inspection"]}),a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{children:[m("washing.contaminationLevel")||"Contamination Level"," *"]}),a.jsxs("select",{name:"contaminationLevel",value:b.contaminationLevel,onChange:X,required:!0,children:[a.jsx("option",{value:"",children:m("common.pleaseSelect")||"Please Select"}),k.filter(K=>K.active!==!1).map(K=>a.jsxs("option",{value:K.code,children:[K.name," - ",K.description]},K.code))]})]}),V&&a.jsxs("div",{className:"safety-alert",children:[a.jsx(Dr,{size:24}),a.jsxs("div",{className:"safety-alert-content",children:[a.jsx("h4",{children:m("washing.safetyWarning")||"Safety Warning"}),a.jsx("p",{children:m("washing.hazardousWarning")||"This container requires special safety measures. Ensure proper PPE and ventilation before cleaning."})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:m("washing.interiorCondition")||"Interior Condition"}),a.jsx("div",{className:"checkbox-group",children:L.map(K=>a.jsxs("label",{className:`checkbox-item ${b.interiorCondition.includes(K.id)?"checked":""}`,children:[a.jsx("input",{type:"checkbox",checked:b.interiorCondition.includes(K.id),onChange:()=>M("interiorCondition",K.id)}),K.label]},K.id))})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:m("washing.exteriorCondition")||"Exterior Condition"}),a.jsx("div",{className:"checkbox-group",children:R.map(K=>a.jsxs("label",{className:`checkbox-item ${b.exteriorCondition.includes(K.id)?"checked":""}`,children:[a.jsx("input",{type:"checkbox",checked:b.exteriorCondition.includes(K.id),onChange:()=>M("exteriorCondition",K.id)}),K.label]},K.id))})]}),a.jsxs("div",{className:"form-row",children:[a.jsx("div",{className:"form-group",children:a.jsxs("label",{className:"checkbox-item",children:[a.jsx("input",{type:"checkbox",name:"odorPresent",checked:b.odorPresent,onChange:X}),m("washing.odorPresent")||"Odor Present"]})}),a.jsx("div",{className:"form-group",children:a.jsxs("label",{className:"checkbox-item",children:[a.jsx("input",{type:"checkbox",name:"pestPresent",checked:b.pestPresent,onChange:X}),m("washing.pestPresent")||"Pest Signs Present"]})}),a.jsx("div",{className:"form-group",children:a.jsxs("label",{className:"checkbox-item",children:[a.jsx("input",{type:"checkbox",name:"hazardousResidues",checked:b.hazardousResidues,onChange:X}),m("washing.hazardousResidues")||"Hazardous Residues"]})})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:m("washing.inspectionNotes")||"Inspection Notes"}),a.jsx("textarea",{name:"inspectionNotes",value:b.inspectionNotes,onChange:X,rows:3,placeholder:m("washing.notesPlaceholder")||"Describe container condition..."})]})]}),a.jsxs("div",{className:"form-section",children:[a.jsxs("h3",{className:"form-section-title",children:[a.jsx(Zn,{size:18})," ",m("washing.cleaningProgram")||"Cleaning Program"]}),O&&b.cleaningProgram!==O.code&&a.jsxs("div",{className:"suggested-program",children:[a.jsx(xh,{size:18}),a.jsxs("span",{children:[m("washing.suggestedProgram")||"Suggested",": ",a.jsx("strong",{children:O.name})]}),a.jsx("button",{type:"button",className:"btn btn-sm btn-primary",onClick:me,children:m("common.apply")||"Apply"})]}),a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{children:[m("washing.selectProgram")||"Select Program"," *"]}),a.jsxs("select",{name:"cleaningProgram",value:b.cleaningProgram,onChange:X,required:!0,children:[a.jsx("option",{value:"",children:m("common.pleaseSelect")||"Please Select"}),v.filter(K=>K.active!==!1).map(K=>a.jsxs("option",{value:K.code,children:[K.name," - ",K.description," (~",K.estimatedMinutes," min, RM",K.defaultCost,")"]},K.code))]})]})]})]}),D===2&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"form-section",children:[a.jsxs("h3",{className:"form-section-title",children:[a.jsx(ls,{size:18})," ",m("washing.schedule")||"Schedule"]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{children:[a.jsx(Ho,{size:14})," ",m("washing.assignBay")||"Assign Bay"," *"]}),a.jsxs("select",{name:"assignedBay",value:b.assignedBay,onChange:X,required:!0,children:[a.jsx("option",{value:"",children:m("common.pleaseSelect")||"Please Select"}),ue.map(K=>a.jsxs("option",{value:K.code,children:[K.name," ",K.specialType?`(${K.specialType})`:""]},K.code))]})]}),a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{children:[a.jsx(Js,{size:14})," ",m("washing.assignTeam")||"Assign Team"," *"]}),a.jsxs("select",{name:"assignedTeam",value:b.assignedTeam,onChange:X,required:!0,children:[a.jsx("option",{value:"",children:m("common.pleaseSelect")||"Please Select"}),S.filter(K=>K.active!==!1).map(K=>a.jsxs("option",{value:K.code,children:[K.name," (",K.members," members)"]},K.code))]})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{children:[a.jsx(tr,{size:14})," ",m("washing.scheduledAt")||"Scheduled Time"]}),a.jsx("input",{type:"datetime-local",name:"scheduledAt",value:b.scheduledAt,onChange:X})]})]}),a.jsxs("div",{className:"form-section",children:[a.jsxs("h3",{className:"form-section-title",children:[a.jsx(Bc,{size:18})," ",m("washing.safetyRequirements")||"Safety Requirements"]}),a.jsx("div",{className:"checkbox-group",children:q.map(K=>a.jsxs("label",{className:`checkbox-item ${b.safetyRequirements.includes(K.id)?"checked":""}`,children:[a.jsx("input",{type:"checkbox",checked:b.safetyRequirements.includes(K.id),onChange:()=>M("safetyRequirements",K.id)}),K.label]},K.id))}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:m("washing.safetyNotes")||"Safety Notes"}),a.jsx("textarea",{name:"safetyNotes",value:b.safetyNotes,onChange:X,rows:2,placeholder:m("washing.safetyNotesPlaceholder")||"Additional safety instructions for worker..."})]})]})]}),a.jsxs("div",{className:"form-actions",children:[D===2&&a.jsxs("button",{type:"button",className:"btn btn-ghost",onClick:()=>N(1),children:[a.jsx(hr,{size:16})," ",m("common.back")||"Back"]}),a.jsx("button",{type:"button",className:"btn btn-ghost",onClick:()=>e("/washing"),children:m("common.cancel")||"Cancel"}),a.jsx("button",{type:"submit",className:"btn btn-primary",children:D===1?a.jsxs(a.Fragment,{children:[m("common.next")||"Next"," ",a.jsx(ls,{size:16})]}):a.jsxs(a.Fragment,{children:[a.jsx(Oa,{size:16})," ",m("washing.createOrder")||"Create Order"]})})]})]})]})},qW=()=>{var ce;const e=cn(),{id:t}=ws(),{getWashingOrder:n,completeWashingOrder:r,startWashingOrder:s}=qt(),{codes:i}=On(),{t:l}=Wt(),{user:u}=Ft(),{addToast:d}=en(),f=n(t),m=(i==null?void 0:i.CLEANING_CHECKLISTS)||{},p=T.useMemo(()=>f!=null&&f.cleaningProgram?m[f.cleaningProgram]||[]:[],[f,m]),[x,v]=T.useState(!1),[k,y]=T.useState(0),S=T.useMemo(()=>{if(f!=null&&f.startedAt){const ue=new Date(f.startedAt);return Math.floor((Date.now()-ue.getTime())/1e3)}return 0},[f==null?void 0:f.startedAt]),[C,D]=T.useState({}),[N,b]=T.useState(""),[H,L]=T.useState([]);T.useEffect(()=>{(f==null?void 0:f.status)==="IN_PROGRESS"&&(v(!0),y(S))},[f==null?void 0:f.status,S]),T.useEffect(()=>{let ue;return x&&(ue=setInterval(()=>{y(K=>K+1)},1e3)),()=>clearInterval(ue)},[x]);const R=ue=>{const K=Math.floor(ue/3600),W=Math.floor(ue%3600/60),j=ue%60;return`${String(K).padStart(2,"0")}:${String(W).padStart(2,"0")}:${String(j).padStart(2,"0")}`},q=T.useMemo(()=>{const ue={};return p.forEach(K=>{const W=K.category||"OTHER";ue[W]||(ue[W]=[]),ue[W].push(K)}),ue},[p]),O=T.useMemo(()=>{const ue=p.length,K=Object.values(C).filter(W=>W.checked).length;return{total:ue,completed:K,percentage:ue>0?Math.round(K/ue*100):0}},[p,C]),V=ue=>{D(K=>{var W;return{...K,[ue]:{...K[ue],checked:!((W=K[ue])!=null&&W.checked),checkedAt:new Date().toISOString(),checkedBy:u.username}}})},X=(ue,K)=>{D(W=>({...W,[ue]:{...W[ue],note:K}}))},M=()=>{f.status==="SCHEDULED"&&(s(t,u.username),v(!0),d(l("washing.cleaningStarted")||"Cleaning started","success"))},me=()=>{v(ue=>!ue)},ae=()=>{if(!p.filter(j=>j.required).every(j=>{var F;return(F=C[j.id])==null?void 0:F.checked})){d(l("washing.completeAllRequired")||"Please complete all required items","error");return}v(!1);const W=Math.ceil(k/60);r(t,{checklistResults:C,workerNotes:N,damagesFound:H,elapsedMinutes:W},u.username),d(l("washing.cleaningCompleted")||"Cleaning completed, pending QC","success"),e("/washing")};return f?a.jsxs("div",{className:"washing-work-page",children:[a.jsxs("div",{className:"work-header",children:[a.jsxs("div",{className:"work-header-info",children:[a.jsx("button",{className:"btn btn-ghost",onClick:()=>e("/washing"),children:a.jsx(hr,{size:20})}),a.jsx("h2",{children:f.containerNumber}),a.jsx("span",{className:"program-badge",children:f.cleaningProgram})]}),a.jsxs("div",{className:"work-timer",children:[a.jsx(tr,{size:20}),a.jsx("span",{children:R(k)}),f.status==="SCHEDULED"?a.jsxs("button",{className:"btn btn-success",onClick:M,children:[a.jsx(ai,{size:16})," ",l("washing.startCleaning")||"Start"]}):a.jsx("button",{className:"btn btn-ghost",onClick:me,children:x?a.jsx(Q3,{size:16}):a.jsx(ai,{size:16})})]})]}),a.jsxs("div",{className:"progress-section",children:[a.jsx("div",{className:"progress-bar",children:a.jsx("div",{className:"progress-fill",style:{width:`${O.percentage}%`}})}),a.jsxs("span",{className:"progress-text",children:[O.completed,"/",O.total," (",O.percentage,"%)"]})]}),f.safetyNotes&&a.jsxs("div",{className:"safety-alert",children:[a.jsx(Dr,{size:20}),a.jsxs("div",{className:"safety-alert-content",children:[a.jsx("h4",{children:l("washing.safetyNotes")||"Safety Notes"}),a.jsx("p",{children:f.safetyNotes})]})]}),((ce=f.safetyRequirements)==null?void 0:ce.length)>0&&a.jsx("div",{className:"safety-requirements",children:f.safetyRequirements.map(ue=>a.jsx("span",{className:"safety-badge",children:ue},ue))}),a.jsxs("div",{className:"checklist-section",children:[a.jsxs("h3",{children:[a.jsx(St,{size:18})," ",l("washing.cleaningChecklist")||"Cleaning Checklist"]}),Object.entries(q).map(([ue,K])=>a.jsxs("div",{className:"checklist-category",children:[a.jsx("h4",{children:ue}),K.map(W=>{const j=C[W.id]||{};return a.jsxs("div",{className:`checklist-item ${j.checked?"completed":""}`,onClick:()=>V(W.id),children:[a.jsx("input",{type:"checkbox",checked:j.checked||!1,onChange:()=>{}}),a.jsxs("span",{className:"checklist-item-label",children:[W.label,W.required&&a.jsx("span",{className:"required-star",children:"*"})]}),a.jsx("div",{className:"checklist-item-notes",onClick:F=>F.stopPropagation(),children:a.jsx("input",{type:"text",placeholder:l("common.notes")||"Notes",value:j.note||"",onChange:F=>X(W.id,F.target.value)})})]},W.id)})]},ue))]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:l("washing.workerNotes")||"Worker Notes"}),a.jsx("textarea",{value:N,onChange:ue=>b(ue.target.value),rows:3,placeholder:l("washing.notesPlaceholder")||"Any observations or issues..."})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{className:"btn btn-ghost",onClick:()=>e("/washing"),children:l("common.cancel")||"Cancel"}),a.jsxs("button",{className:"btn btn-success",onClick:ae,disabled:f.status!=="IN_PROGRESS",children:[a.jsx(St,{size:16})," ",l("washing.completeCleaning")||"Complete & Submit for QC"]})]})]}):a.jsx("div",{className:"washing-work-page",children:a.jsxs("div",{className:"empty-state",children:[a.jsx(Zn,{size:48}),a.jsx("p",{children:l("washing.orderNotFound")||"Washing order not found"}),a.jsx("button",{className:"btn btn-primary",onClick:()=>e("/washing"),children:l("common.back")||"Back"})]})})},KW=()=>{var L;const e=cn(),{id:t}=ws(),{getWashingOrder:n,qcWashingOrder:r}=qt(),{t:s}=Wt(),{user:i}=Ft(),{addToast:l}=en(),u=n(t),d=[{id:"floor_clean",label:"Floor is clean and free of debris",required:!0},{id:"walls_clean",label:"Walls and ceiling are clean",required:!0},{id:"no_odor",label:"No unpleasant odors",required:!0},{id:"no_stains",label:"No visible stains or residue",required:!0},{id:"doors_clean",label:"Door seals and gaskets clean",required:!0},{id:"exterior_clean",label:"Exterior is clean",required:!1},{id:"dry",label:"Interior is completely dry",required:!0},{id:"ready_for_cargo",label:"Ready for cargo loading",required:!0}],[f,m]=T.useState({}),[p,x]=T.useState(""),[v,k]=T.useState([]),y=["Floor not clean","Walls/ceiling not clean","Odor present","Stains remaining","Not dry enough","Chemical residue detected","Incomplete cleaning"],S=R=>{m(q=>{var O;return{...q,[R]:{...q[R],passed:!((O=q[R])!=null&&O.passed)}}})},C=T.useMemo(()=>d.filter(R=>R.required).every(R=>{var q;return(q=f[R.id])==null?void 0:q.passed}),[f]),D=R=>{k(q=>q.includes(R)?q.filter(O=>O!==R):[...q,R])},N=()=>{if(!C){l(s("washing.allRequiredMustPass")||"All required items must pass","error");return}r(t,{result:"PASS",notes:p,checklistResults:f},i.username),l(s("washing.qcPassed")||"QC Passed! Certificate generated.","success"),e(`/washing/certificate/${t}`)},b=()=>{if(v.length===0){l(s("washing.selectReworkReasons")||"Please select at least one rework reason","error");return}r(t,{result:"FAIL",notes:p,checklistResults:f,reworkReasons:v},i.username),l(s("washing.qcFailed")||"QC Failed. Order sent for rework.","warning"),e("/washing")};if(!u)return a.jsx("div",{className:"washing-qc-page",children:a.jsxs("div",{className:"empty-state",children:[a.jsx(Zn,{size:48}),a.jsx("p",{children:s("washing.orderNotFound")||"Washing order not found"})]})});u.checklistResults;const H=u.workerNotes||"";return a.jsxs("div",{className:"washing-qc-page",children:[a.jsx("div",{className:"page-header",children:a.jsxs("div",{className:"header-content",children:[a.jsxs("button",{className:"btn btn-ghost",onClick:()=>e("/washing"),children:[a.jsx(hr,{size:20})," ",s("common.back")||"Back"]}),a.jsxs("h1",{children:[a.jsx(qr,{size:24})," ",s("washing.qcInspection")||"QC Inspection"]})]})}),a.jsxs("div",{className:"washing-form",children:[a.jsxs("div",{className:"form-section",children:[a.jsxs("div",{className:"form-row three-col",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:s("columns.containerNumber")||"Container"}),a.jsx("input",{type:"text",value:u.containerNumber,readOnly:!0,className:"readonly"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:s("washing.cleaningProgram")||"Program"}),a.jsx("input",{type:"text",value:u.cleaningProgram,readOnly:!0,className:"readonly"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:s("washing.elapsedTime")||"Time"}),a.jsx("input",{type:"text",value:`${u.elapsedMinutes||0} min`,readOnly:!0,className:"readonly"})]})]}),u.reworkCount>0&&a.jsxs("div",{className:"safety-alert",children:[a.jsx(Xi,{size:20}),a.jsxs("div",{className:"safety-alert-content",children:[a.jsxs("h4",{children:[s("washing.reworkAttempt")||"Rework Attempt"," #",u.reworkCount+1]}),a.jsxs("p",{children:[s("washing.previousReworkReasons")||"Previous issues",": ",(L=u.reworkReasons)==null?void 0:L.join(", ")]})]})]})]}),H&&a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:s("washing.workerNotes")||"Worker Notes"}),a.jsx("div",{className:"worker-notes-display",children:a.jsx("p",{children:H})})]}),a.jsxs("div",{className:"form-section",children:[a.jsxs("h3",{className:"form-section-title",children:[a.jsx(hs,{size:18})," ",s("washing.qcChecklist")||"QC Checklist"]}),a.jsx("div",{className:"qc-checklist",children:d.map(R=>{const q=f[R.id]||{};return a.jsxs("div",{className:`qc-item ${q.passed?"passed":q.passed===!1?"failed":""}`,children:[a.jsxs("span",{className:"qc-item-label",children:[R.label,R.required&&a.jsx("span",{className:"required-star",children:"*"})]}),a.jsxs("div",{className:"qc-item-actions",children:[a.jsxs("button",{type:"button",className:`btn btn-sm ${q.passed?"btn-success":"btn-ghost"}`,onClick:()=>S(R.id),children:[a.jsx(St,{size:16})," ",s("washing.pass")||"Pass"]}),a.jsxs("button",{type:"button",className:`btn btn-sm ${q.passed===!1?"btn-danger":"btn-ghost"}`,onClick:()=>m(O=>({...O,[R.id]:{passed:!1}})),children:[a.jsx(Gr,{size:16})," ",s("washing.fail")||"Fail"]})]})]},R.id)})})]}),!C&&a.jsxs("div",{className:"form-section",children:[a.jsxs("h3",{className:"form-section-title",children:[a.jsx(Dr,{size:18})," ",s("washing.reworkReasons")||"Rework Reasons"]}),a.jsx("div",{className:"checkbox-group",children:y.map(R=>a.jsxs("label",{className:`checkbox-item ${v.includes(R)?"checked":""}`,children:[a.jsx("input",{type:"checkbox",checked:v.includes(R),onChange:()=>D(R)}),R]},R))})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:s("washing.qcNotes")||"QC Notes"}),a.jsx("textarea",{value:p,onChange:R=>x(R.target.value),rows:6,style:{minHeight:"150px",width:"100%",resize:"vertical"},placeholder:s("washing.qcNotesPlaceholder")||"Inspection observations..."})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{className:"btn btn-ghost",onClick:()=>e("/washing"),children:s("common.cancel")||"Cancel"}),a.jsxs("button",{className:"btn btn-danger",onClick:b,disabled:C,children:[a.jsx(Gr,{size:16})," ",s("washing.failAndRework")||"Fail & Rework"]}),a.jsxs("button",{className:"btn btn-success",onClick:N,disabled:!C,children:[a.jsx(St,{size:16})," ",s("washing.passAndCertify")||"Pass & Generate Certificate"]})]})]})]})},YW=()=>{const e=cn(),{id:t}=ws(),{getWashingOrder:n}=qt(),{getCodeList:r}=On(),{t:s}=Wt(),{addToast:i}=en(),l=n(t),u=r("CLEANING_PROGRAMS")||[],d=T.useMemo(()=>l!=null&&l.cleaningProgram?u.find(k=>k.code===l.cleaningProgram):null,[l,u]),f=k=>k?new Date(k).toLocaleDateString("en-GB",{day:"2-digit",month:"long",year:"numeric"}):"-",m=k=>k?new Date(k).toLocaleString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",p=()=>{window.print()},x=()=>{i(s("common.featureComingSoon")||"PDF download coming soon","info")},v=()=>{i(s("common.featureComingSoon")||"Email feature coming soon","info")};return l?l.status!=="COMPLETED"||!l.certificateNumber?a.jsx("div",{className:"certificate-page",children:a.jsxs("div",{className:"empty-state",children:[a.jsx(Oy,{size:48}),a.jsx("p",{children:s("washing.noCertificate")||"No certificate available. QC must pass first."}),a.jsx("button",{className:"btn btn-primary",onClick:()=>e("/washing"),children:s("common.back")||"Back"})]})}):a.jsxs("div",{className:"certificate-page",children:[a.jsx("div",{className:"page-header no-print",children:a.jsxs("div",{className:"header-content",children:[a.jsxs("button",{className:"btn btn-ghost",onClick:()=>e("/washing"),children:[a.jsx(hr,{size:20})," ",s("common.back")||"Back"]}),a.jsxs("h1",{children:[a.jsx(Oy,{size:24})," ",s("washing.certificateOfCleanliness")||"Certificate of Cleanliness"]})]})}),a.jsxs("div",{className:"certificate-container",children:[a.jsxs("div",{className:"certificate-header",children:[a.jsx("div",{className:"certificate-logo",children:a.jsx(Zn,{size:40})}),a.jsx("h1",{children:s("washing.certificateOfCleanliness")||"CERTIFICATE OF CLEANLINESS"}),a.jsx("h2",{children:"Johor Port Container Depot"})]}),a.jsxs("div",{className:"certificate-body",children:[a.jsxs("div",{className:"certificate-row",children:[a.jsxs("span",{className:"certificate-label",children:[s("washing.certificateNo")||"Certificate No",":"]}),a.jsx("span",{className:"certificate-value",children:a.jsx("strong",{children:l.certificateNumber})})]}),a.jsxs("div",{className:"certificate-row",children:[a.jsxs("span",{className:"certificate-label",children:[s("columns.containerNumber")||"Container Number",":"]}),a.jsx("span",{className:"certificate-value",children:l.containerNumber})]}),a.jsxs("div",{className:"certificate-row",children:[a.jsxs("span",{className:"certificate-label",children:[s("columns.type")||"Container Type",":"]}),a.jsx("span",{className:"certificate-value",children:l.containerType})]}),a.jsxs("div",{className:"certificate-row",children:[a.jsxs("span",{className:"certificate-label",children:[s("columns.liner")||"Liner/Owner",":"]}),a.jsx("span",{className:"certificate-value",children:l.liner})]}),a.jsxs("div",{className:"certificate-row",children:[a.jsxs("span",{className:"certificate-label",children:[s("washing.cleaningProgram")||"Cleaning Program",":"]}),a.jsx("span",{className:"certificate-value",children:(d==null?void 0:d.name)||l.cleaningProgram})]}),a.jsxs("div",{className:"certificate-row",children:[a.jsxs("span",{className:"certificate-label",children:[s("washing.cleanedDate")||"Cleaning Date",":"]}),a.jsx("span",{className:"certificate-value",children:m(l.completedAt)})]}),a.jsxs("div",{className:"certificate-row",children:[a.jsxs("span",{className:"certificate-label",children:[s("washing.issueDate")||"Issue Date",":"]}),a.jsx("span",{className:"certificate-value",children:f(l.certificateIssuedAt)})]})]}),a.jsxs("div",{className:"certificate-statement",children:[a.jsx(St,{size:24,style:{color:"var(--success-500)",marginBottom:"8px"}}),a.jsx("p",{children:s("washing.certificateStatement")||"This is to certify that the above-mentioned container has been cleaned and inspected in accordance with international standards and industry best practices. The container is free from contamination, debris, and odors, and is suitable for cargo loading."})]}),a.jsxs("div",{className:"certificate-footer",children:[a.jsxs("div",{className:"certificate-signature",children:[a.jsx("div",{className:"signature-line"}),a.jsx("span",{className:"signature-name",children:l.qcInspectedBy}),a.jsx("span",{className:"signature-title",children:s("washing.qcInspector")||"QC Inspector"})]}),a.jsx("div",{className:"certificate-qr",children:a.jsx("span",{children:"QR"})}),a.jsxs("div",{className:"certificate-signature",children:[a.jsx("div",{className:"signature-line"}),a.jsx("span",{className:"signature-name",children:"Depot Supervisor"}),a.jsx("span",{className:"signature-title",children:s("washing.authorizedSignatory")||"Authorized Signatory"})]})]}),a.jsx("div",{className:"certificate-watermark",children:l.certificateNumber})]}),a.jsxs("div",{className:"certificate-actions no-print",children:[a.jsxs("button",{className:"btn btn-primary",onClick:p,children:[a.jsx(d_,{size:16})," ",s("washing.printCertificate")||"Print"]}),a.jsxs("button",{className:"btn btn-ghost",onClick:x,children:[a.jsx(cu,{size:16})," ",s("washing.downloadPDF")||"Download PDF"]}),a.jsxs("button",{className:"btn btn-ghost",onClick:v,children:[a.jsx($h,{size:16})," ",s("washing.emailToLiner")||"Email to Liner"]})]})]}):a.jsx("div",{className:"certificate-page",children:a.jsxs("div",{className:"empty-state",children:[a.jsx(Zn,{size:48}),a.jsx("p",{children:s("washing.orderNotFound")||"Washing order not found"}),a.jsx("button",{className:"btn btn-primary",onClick:()=>e("/washing"),children:s("common.back")||"Back"})]})})};function XW({children:e}){const{isAuthenticated:t,isLoading:n}=Ft();return n?a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh"},children:a.jsx("div",{className:"spinner"})}):t?e:a.jsx(pw,{to:"/login",replace:!0})}function QW(){const{isAuthenticated:e}=Ft();return a.jsxs(fT,{children:[a.jsx(_t,{path:"/login",element:a.jsx(cO,{})}),a.jsxs(_t,{path:"/",element:a.jsx(XW,{children:a.jsx(vR,{children:a.jsx(vO,{})})}),children:[a.jsx(_t,{index:!0,element:a.jsx(yO,{})}),a.jsx(_t,{path:"dashboard",element:a.jsx(kO,{})}),a.jsx(_t,{path:"containers",element:a.jsx(wO,{})}),a.jsx(_t,{path:"containers/register",element:a.jsx(CW,{})}),a.jsx(_t,{path:"containers/:id",element:a.jsx(SO,{})}),a.jsx(_t,{path:"containers/ar",element:a.jsx(NW,{})}),a.jsx(_t,{path:"surveys",element:a.jsx(EW,{})}),a.jsx(_t,{path:"surveys/search",element:a.jsx(bW,{})}),a.jsx(_t,{path:"surveys/new/:containerId",element:a.jsx(sw,{})}),a.jsx(_t,{path:"surveys/:id",element:a.jsx(sw,{})}),a.jsx(_t,{path:"eor",element:a.jsx(AW,{})}),a.jsx(_t,{path:"eor/new",element:a.jsx(xm,{})}),a.jsx(_t,{path:"eor/new/:surveyId",element:a.jsx(xm,{})}),a.jsx(_t,{path:"eor/:id",element:a.jsx(jW,{})}),a.jsx(_t,{path:"eor/:id/edit",element:a.jsx(xm,{})}),a.jsx(_t,{path:"repair-orders",element:a.jsx(RW,{})}),a.jsx(_t,{path:"repair-orders/:id",element:a.jsx(IW,{})}),a.jsx(_t,{path:"shunting",element:a.jsx(PW,{})}),a.jsx(_t,{path:"pre-inspection",element:a.jsx(DW,{})}),a.jsx(_t,{path:"washing",element:a.jsx($W,{})}),a.jsx(_t,{path:"washing/new",element:a.jsx(VW,{})}),a.jsx(_t,{path:"washing/work/:id",element:a.jsx(qW,{})}),a.jsx(_t,{path:"washing/qc/:id",element:a.jsx(KW,{})}),a.jsx(_t,{path:"washing/certificate/:id",element:a.jsx(YW,{})}),a.jsx(_t,{path:"stacking",element:a.jsx(OW,{})}),a.jsx(_t,{path:"monitoring/jobs",element:a.jsx(GW,{})}),a.jsx(_t,{path:"admin/codes",element:a.jsx(FW,{})}),a.jsx(_t,{path:"admin/groups",element:a.jsx(BW,{})}),a.jsx(_t,{path:"admin/users",element:a.jsx(UW,{})}),a.jsx(_t,{path:"admin/settings",element:a.jsx(zW,{})}),a.jsx(_t,{path:"admin/homepage",element:a.jsx(WW,{})}),a.jsx(_t,{path:"admin/chats",element:a.jsx(HW,{})})]}),a.jsx(_t,{path:"*",element:a.jsx(pw,{to:"/",replace:!0})})]})}function JW(){return a.jsx(VT,{children:a.jsx(pR,{children:a.jsx(qT,{children:a.jsx(KT,{children:a.jsx(gR,{children:a.jsx(oO,{children:a.jsx(C3,{children:a.jsx(QW,{})})})})})})})})}vE.createRoot(document.getElementById("root")).render(a.jsx(T.StrictMode,{children:a.jsx(FT,{children:a.jsx(JW,{})})}));
